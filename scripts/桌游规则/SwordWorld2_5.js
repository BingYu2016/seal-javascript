// ==UserScript==
// @name         SwordWorld2.5
// @author       木落
// @version      1.0.0
// @description  在海豹中使用剑世界2.5规则，请使用.sw help查看指令说明。大概需要10MB内存
// @timestamp    1674477074
// 2023/1/23
// @license      MIT
// @homepageURL  https://github.com/sealdice/seal-swordworld
// ==/UserScript==

(()=>{var br=Object.create;var He=Object.defineProperty;var yr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var kr=Object.getPrototypeOf,Er=Object.prototype.hasOwnProperty;var ze=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(A,o)=>(typeof require!="undefined"?require:A)[o]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var de=(e,A)=>()=>(A||e((A={exports:{}}).exports,A),A.exports);var Nr=(e,A,o,t)=>{if(A&&typeof A=="object"||typeof A=="function")for(let r of wr(A))!Er.call(e,r)&&r!==o&&He(e,r,{get:()=>A[r],enumerable:!(t=yr(A,r))||t.enumerable});return e};var Ie=(e,A,o)=>(o=e!=null?br(kr(e)):{},Nr(A||!e||!e.__esModule?He(o,"default",{value:e,enumerable:!0}):o,e));var ke=de(We=>{(function(e){"use strict";var A;if(typeof globalThis!="undefined"?e=globalThis:typeof global!="undefined"?e=global:typeof window!="undefined"&&(e=window),typeof e.console=="object"?A=e.console:e.console==null?A=e.console={}:A={},"log"in A||(A.log=function(){}),"warn"in A||(A.warn=A.log),typeof e.Opal!="undefined")return A.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),e.Opal;var o,t,r,q,C,I,h,v=e.Opal={};v.global=e,e.Opal=v,v.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var z=Object.hasOwnProperty,T=Function.prototype.bind,U=Object.setPrototypeOf,J=Array.prototype.slice,W=Array.prototype.splice,S=4,F=S;v.uid=function(){return F+=2,F},v.id=function(a){return a.$$is_number?a*2+1:(a.$$id!=null||B(a,"$$id",v.uid()),a.$$id)},v.gvars={},v.exit=function(a){v.gvars.DEBUG&&A.log("Exited with status "+a)},v.exceptions=[],v.pop_exception=function(){var a=v.exceptions.pop();a?(v.gvars["!"]=a,v.gvars["@"]=a.$backtrace()):v.gvars["!"]=v.gvars["@"]=o};function B(a,N,p){typeof a=="string"?a[N]=p:Object.defineProperty(a,N,{value:p,enumerable:!1,configurable:!0,writable:!0})}v.prop=B,v.defineProperty=v.prop,v.slice=J;var X=v.truthy=function(a){return a!==!1&&o!==a&&a!==void 0&&a!==null&&(!(a instanceof Boolean)||a.valueOf()===!0)};v.falsy=function(a){return!X(a)},v.type_error=function(a,N,p,H){return a=a.$$class,H&&p?(H=H.$$class,v.TypeError.$new("can't convert "+a+" into "+N+" ("+a+"#"+p+" gives "+H+")")):v.TypeError.$new("no implicit conversion of "+a+" into "+N)},v.coerce_to=function(a,N,p,H){if(N["$==="](a))return a;if(!a["$respond_to?"](p))throw v.type_error(a,N);return H==null&&(H=[]),v.send(a,p,H)},v.respond_to=function(a,N,p){if(a==null||!a.$$class)return!1;p=!!p;var H=a[N];if(a["$respond_to?"].$$pristine){if(typeof H=="function"&&!H.$$stub)return!0;if(!a["$respond_to_missing?"].$$pristine)return v.send(a,a["$respond_to_missing?"],[N.substr(1),p])}else return v.send(a,a["$respond_to?"],[N.substr(1),p])},v.trace_class=!1,v.tracers_for_class=[];function L(a){var N,p,H;for(N=0,p=v.tracers_for_class.length;N<p;N++)H=v.tracers_for_class[N],H.trace_object=a,H.block.$call(H)}function w(a,N){if(a.$$autoload[N].loaded){if(a.$$autoload[N].loaded&&!a.$$autoload[N].required&&a.$$autoload[N].exception)throw a.$$autoload[N].exception}else{a.$$autoload[N].loaded=!0;try{v.Kernel.$require(a.$$autoload[N].path)}catch(p){throw a.$$autoload[N].exception=p,p}if(a.$$autoload[N].required=!0,a.$$const[N]!=null)return a.$$autoload[N].success=!0,a.$$const[N]}}function b(a,N){if(a){if(a.$$const[N]!=null)return a.$$const[N];if(a.$$autoload&&a.$$autoload[N])return w(a,N)}}function M(a,N){var p,H,Q;if(a.length!==0)for(p=0,H=a.length;p<H;p++){if(Q=a[p].$$const[N],Q!=null)return Q;if(a[p].$$autoload&&a[p].$$autoload[N])return w(a[p],N)}}function D(a,N){var p,H,Q;if(a!=null)for(Q=v.ancestors(a),p=0,H=Q.length;p<H;p++){if(Q[p].$$const&&z.call(Q[p].$$const,N))return Q[p].$$const[N];if(Q[p].$$autoload&&Q[p].$$autoload[N])return w(Q[p],N)}}function G(a,N){if(a==null||a.$$is_module)return D(r,N)}function R(a,N,p){if(!p)return(a||r).$const_missing(N)}v.const_get_local=function(a,N,p){var H;if(a!=null){if(a==="::"&&(a=r),!a.$$is_module&&!a.$$is_class)throw new v.TypeError(a.toString()+" is not a class/module");if(H=b(a,N),H!=null||(H=R(a,N,p),H!=null))return H}},v.const_get_qualified=function(a,N,p){var H,Q,ee,ne=v.const_cache_version;if(N==null)return H=b(r,a),H!=null?H:v.const_get_qualified(r,a,p);if(a!=null){if(a==="::"&&(a=r),!a.$$is_module&&!a.$$is_class)throw new v.TypeError(a.toString()+" is not a class/module");return(Q=a.$$const_cache)==null&&(B(a,"$$const_cache",Object.create(null)),Q=a.$$const_cache),ee=Q[N],ee==null||ee[0]!==ne?((H=b(a,N))!=null||(H=D(a,N))!=null,Q[N]=[ne,H]):H=ee[1],H!=null?H:R(a,N,p)}},v.const_cache_version=1,v.const_get_relative=function(a,N,p){var H=a[0],Q,ee=v.const_cache_version,ne,V;return(ne=a.$$const_cache)==null&&(B(a,"$$const_cache",Object.create(null)),ne=a.$$const_cache),V=ne[N],V==null||V[0]!==ee?((Q=b(H,N))!=null||(Q=M(a,N))!=null||(Q=D(H,N))!=null||(Q=G(H,N))!=null,ne[N]=[ee,Q]):Q=V[1],Q!=null?Q:R(H,N,p)};function f(a,N,p){return(a==null||a==="::")&&(a=r),p.$$is_a_module&&((p.$$name==null||p.$$name===o)&&(p.$$name=N),p.$$base_module==null&&(p.$$base_module=a)),a.$$const=a.$$const||Object.create(null),a.$$const[N]=p,a.$$=a.$$const,v.const_cache_version++,a===r&&(v[N]=p),B(a,N,p),p}v.const_set=f,v.constants=function(a,N){N==null&&(N=!0);var p,H=[a],Q,ee,ne={},V;for(N&&(H=H.concat(v.ancestors(a))),N&&a.$$is_module&&(H=H.concat([v.Object]).concat(v.ancestors(v.Object))),Q=0,ee=H.length;Q<ee&&(p=H[Q],!(a!==r&&p==r));Q++){for(V in p.$$const)ne[V]=!0;if(p.$$autoload)for(V in p.$$autoload)ne[V]=!0}return Object.keys(ne)},v.const_remove=function(a,N){if(v.const_cache_version++,a.$$const[N]!=null){var p=a.$$const[N];return delete a.$$const[N],p}if(a.$$autoload&&a.$$autoload[N])return delete a.$$autoload[N],o;throw v.NameError.$new("constant "+a+"::"+a.$name()+" not defined")},v.const_get_relative_factory=function(a){return function(N,p){return v.$$(a,N,p)}},v.$$=v.const_get_relative,v.$$$=v.const_get_qualified,v.$r=v.const_get_relative_factory,v.allocate_class=function(a,N,p){var H,Q;if(N!=null&&N.$$bridge?Q=function(){var Z=J.call(arguments),y=new(T.apply(N.$$constructor,[null].concat(Z)));return U(y,H.$$prototype),y}:Q=function(){},a&&a!==o&&B(Q,"displayName","::"+a),H=Q,B(H,"$$name",a),B(H,"$$constructor",Q),B(H,"$$prototype",Q.prototype),B(H,"$$const",{}),B(H,"$$is_class",!0),B(H,"$$is_a_module",!0),B(H,"$$super",N),B(H,"$$cvars",{}),B(H,"$$own_included_modules",[]),B(H,"$$own_prepended_modules",[]),B(H,"$$ancestors",[]),B(H,"$$ancestors_cache_version",null),B(H,"$$subclasses",[]),B(H.$$prototype,"$$class",H),v.Class&&U(H,v.Class.prototype),N!=null){if(U(H.$$prototype,N.$$prototype),p!==!0)if(typeof WeakRef!="undefined"){var ee,ne,V=[];for(ee=0;ee<N.$$subclasses.length;ee++)ne=N.$$subclasses[ee],ne.deref()!==void 0&&V.push(ne);V.push(new WeakRef(H)),N.$$subclasses=V}else N.$$subclasses.push(H);N.$$meta&&v.build_class_singleton_class(H)}return H};function E(a,N){var p=b(a,N);if(p){if(!p.$$is_class)throw v.TypeError.$new(N+" is not a class");return p}}function g(a,N){if(a.$$super!==N)throw v.TypeError.$new("superclass mismatch for class "+a.$$name)}v.klass=function(a,N,p){var H;if(a==null||a=="::"?a=r:!a.$$is_class&&!a.$$is_module&&(a=a.$$class),N!=null&&(!N.hasOwnProperty||N.hasOwnProperty&&!N.hasOwnProperty("$$is_class")))if(N.constructor&&N.constructor.name=="Function")H=N,N=r;else throw v.TypeError.$new("superclass must be a Class ("+(N.constructor&&(N.constructor.name||N.constructor.$$name)||typeof N)+" given)");var Q=E(a,p);return Q?(N&&g(Q,N),v.trace_class&&L(Q),Q):(N==null&&(N=r),Q=v.allocate_class(p,N),f(a,p,Q),N.$inherited&&N.$inherited(Q),H&&v.bridge(H,Q),v.trace_class&&L(Q),Q)},v.allocate_module=function(a){var N=function(){};a&&B(N,"displayName",a+".$$constructor");var p=N;return a&&B(N,"displayName",a+".constructor"),B(p,"$$name",a),B(p,"$$prototype",N.prototype),B(p,"$$const",{}),B(p,"$$is_module",!0),B(p,"$$is_a_module",!0),B(p,"$$cvars",{}),B(p,"$$iclasses",[]),B(p,"$$own_included_modules",[]),B(p,"$$own_prepended_modules",[]),B(p,"$$ancestors",[p]),B(p,"$$ancestors_cache_version",null),U(p,v.Module.prototype),p};function _(a,N){var p=b(a,N);if(p==null&&a===r&&(p=D(r,N)),p&&!p.$$is_module&&p!==r)throw v.TypeError.$new(N+" is not a module");return p}v.module=function(a,N){var p;return a==null||a=="::"?a=r:!a.$$is_class&&!a.$$is_module&&(a=a.$$class),p=_(a,N),p?(v.trace_class&&L(p),p):(p=v.allocate_module(N),f(a,N,p),v.trace_class&&L(p),p)},v.get_singleton_class=function(a){return a.$$meta?a.$$meta:a.hasOwnProperty("$$is_class")?v.build_class_singleton_class(a):a.hasOwnProperty("$$is_module")?v.build_module_singleton_class(a):v.build_object_singleton_class(a)},v.build_class_singleton_class=function(a){var N,p;return a.$$meta?a.$$meta:(N=a===t?C:v.get_singleton_class(a.$$super),p=v.allocate_class(null,N,!0),B(p,"$$is_singleton",!0),B(p,"$$singleton_of",a),B(a,"$$meta",p),U(a,p.$$prototype),B(a,"$$class",v.Class),p)},v.build_module_singleton_class=function(a){if(a.$$meta)return a.$$meta;var N=v.allocate_class(null,v.Module,!0);return B(N,"$$is_singleton",!0),B(N,"$$singleton_of",a),B(a,"$$meta",N),U(a,N.$$prototype),B(a,"$$class",v.Module),N},v.build_object_singleton_class=function(a){var N=a.$$class,p=v.allocate_class(o,N,!0);return B(p,"$$is_singleton",!0),B(p,"$$singleton_of",a),delete p.$$prototype.$$class,B(a,"$$meta",p),U(a,a.$$meta.$$prototype),p},v.is_method=function(a){return a[0]==="$"&&a[1]!=="$"},v.instance_methods=function(a){for(var N=[],p=[],H=v.ancestors(a),Q=0,ee=H.length;Q<ee;Q++){var ne=H[Q],V=ne.$$prototype;V.hasOwnProperty("$$dummy")&&(V=V.$$define_methods_on);for(var Z=Object.getOwnPropertyNames(V),y=0,K=Z.length;y<K;y++){var P=Z[y];if(v.is_method(P)){var j=P.slice(1),O=V[P];O.$$stub&&N.indexOf(j)===-1&&N.push(j),!O.$$stub&&p.indexOf(j)===-1&&N.indexOf(j)===-1&&p.push(j)}}}return p},v.own_instance_methods=function(a){var N=[],p=a.$$prototype;p.hasOwnProperty("$$dummy")&&(p=p.$$define_methods_on);for(var H=Object.getOwnPropertyNames(p),Q=0,ee=H.length;Q<ee;Q++){var ne=H[Q];if(v.is_method(ne)){var V=p[ne];if(!V.$$stub){var Z=ne.slice(1);N.push(Z)}}}return N},v.methods=function(a){return v.instance_methods(a.$$meta||a.$$class)},v.own_methods=function(a){return a.$$meta?v.own_instance_methods(a.$$meta):[]},v.receiver_methods=function(a){var N=v.get_singleton_class(a),p=v.own_instance_methods(N),H=v.own_instance_methods(N.$$super);return p.concat(H)},v.class_variables=function(a){var N=v.ancestors(a),p,H=N.length,Q={};for(p=H-1;p>=0;p--){var ee=N[p];for(var ne in ee.$$cvars)Q[ne]=ee.$$cvars[ne]}return Q},v.class_variable_set=function(a,N,p){var H=v.ancestors(a),Q,ee=H.length;for(Q=ee-2;Q>=0;Q--){var ne=H[Q];if(z.call(ne.$$cvars,N))return ne.$$cvars[N]=p,p}return a.$$cvars[N]=p,p},v.class_variable_get=function(a,N,p){if(z.call(a.$$cvars,N))return a.$$cvars[N];var H=v.ancestors(a),Q,ee=H.length;for(Q=0;Q<ee;Q++){var ne=H[Q];if(z.call(ne.$$cvars,N))return ne.$$cvars[N]}if(!p)throw v.NameError.$new("uninitialized class variable "+N+" in "+a.$name());return o};function u(a){return a.hasOwnProperty("$$iclass")&&a.hasOwnProperty("$$root")}function c(a){for(var N=[],p,H=Object.getPrototypeOf(a.$$prototype);H&&!H.hasOwnProperty("$$class");)p=d(H),p&&N.push(p),H=Object.getPrototypeOf(H);return N}function s(a){var N=[],p,H=Object.getPrototypeOf(a.$$prototype);if(a.$$prototype.hasOwnProperty("$$dummy"))for(;H&&H!==a.$$prototype.$$define_methods_on;)p=d(H),p&&N.push(p),H=Object.getPrototypeOf(H);return N}v.append_features=function(a,N){var p=v.ancestors(a),H=[];if(p.indexOf(N)!==-1)throw v.ArgumentError.$new("cyclic include detected");for(var Q=0,ee=p.length;Q<ee;Q++){var ne=p[Q],V=n(ne);B(V,"$$included",!0),H.push(V)}var Z=v.ancestors(N),y=l(H),K,P;if(Z.indexOf(a)===-1)K=N.$$prototype,P=Object.getPrototypeOf(N.$$prototype);else{for(var j=N.$$prototype,O=Object.getPrototypeOf(j);O!=null&&!(O.$$module===a&&u(O));)j=O,O=Object.getPrototypeOf(O);if(O){for(var re=Object.getPrototypeOf(O);re.hasOwnProperty("$$iclass")&&!u(re);)re=Object.getPrototypeOf(re);K=j,P=re}else K=N.$$prototype,P=Object.getPrototypeOf(N.$$prototype)}U(K,y.first),U(y.last,P),N.$$own_included_modules=c(N),v.const_cache_version++},v.prepend_features=function(a,N){var p=v.ancestors(a),H=[];if(p.indexOf(N)!==-1)throw v.ArgumentError.$new("cyclic prepend detected");for(var Q=0,ee=p.length;Q<ee;Q++){var ne=p[Q],V=n(ne);B(V,"$$prepended",!0),H.push(V)}var Z=l(H),y=N.$$prototype,K=Object.getPrototypeOf(y),P,j,O;y.hasOwnProperty("$$dummy")?P=y.$$define_methods_on:(P=$(N),i(N),B(y,"$$dummy",!0),B(y,"$$define_methods_on",P),U(y,P),U(P,K));var re=v.ancestors(N);if(re.indexOf(a)===-1)for(j=y,O=Object.getPrototypeOf(y);O!=null&&!(O.hasOwnProperty("$$root")||O===P||!O.hasOwnProperty("$$iclass"));)O=Object.getPrototypeOf(O);else throw v.RuntimeError.$new("Prepending a module multiple times is not supported");U(j,Z.first),U(Z.last,O),N.$$own_prepended_modules=s(N),v.const_cache_version++};function i(a){for(var N=a.$$prototype,p=Object.getOwnPropertyNames(N),H=0;H<p.length;H++){var Q=p[H];v.is_method(Q)&&delete N[Q]}}function n(a){var N=$(a);return a.$$is_module&&a.$$iclasses.push(N),N}function $(a){var N={},p=a.$$prototype;p.hasOwnProperty("$$dummy")&&(p=p.$$define_methods_on);var H=Object.getOwnPropertyNames(p),Q=H.length,ee;for(ee=0;ee<Q;ee++){var ne=H[ee];B(N,ne,p[ne])}return B(N,"$$iclass",!0),B(N,"$$module",a),N}function l(a){var N=a.length,p=a[0];if(B(p,"$$root",!0),N===1)return{first:p,last:p};for(var H=p,Q=1;Q<N;Q++){var ee=a[Q];U(H,ee),H=ee}return{first:a[0],last:a[N-1]}}v.bridge=function(a,N){if(a.hasOwnProperty("$$bridge"))throw v.ArgumentError.$new("already bridged");B(a,"$$bridge",N),U(a.prototype,(N.$$super||v.Object).$$prototype),B(N,"$$prototype",a.prototype),B(N.$$prototype,"$$class",N),B(N,"$$constructor",a),B(N,"$$bridge",!0)};function d(a){if(!a.hasOwnProperty("$$dummy")){if(a.hasOwnProperty("$$iclass"))return a.$$module;if(a.hasOwnProperty("$$class"))return a.$$class}}function m(a){return a.$$own_prepended_modules.concat([a]).concat(a.$$own_included_modules)}v.ancestors=function(a){if(!a)return[];if(a.$$ancestors_cache_version===v.const_cache_version)return a.$$ancestors;var N=[],p,H,Q;for(p=0,H=m(a),Q=H.length;p<Q;p++)N.push(H[p]);if(a.$$super)for(p=0,H=v.ancestors(a.$$super),Q=H.length;p<Q;p++)N.push(H[p]);return a.$$ancestors_cache_version=v.const_cache_version,a.$$ancestors=N,N},v.included_modules=function(a){for(var N=[],p=null,H=Object.getPrototypeOf(a.$$prototype);H&&Object.getPrototypeOf(H);H=Object.getPrototypeOf(H))p=d(H),p&&p.$$is_module&&H.$$iclass&&H.$$included&&N.push(p);return N},v.add_stubs=function(a){var N=v.BasicObject.$$prototype,p,H;a=a.split(",");for(var Q=0,ee=a.length;Q<ee;Q++)p="$"+a[Q],H=N[p],(H==null||H.$$stub)&&v.add_stub_for(N,p)},v.add_stub_for=function(a,N){B(a,N,v.stub_for(N))},v.stub_for=function(a){function N(){this.$method_missing.$$p=N.$$p,delete N.$$p;for(var p=new Array(arguments.length),H=0,Q=p.length;H<Q;H++)p[H]=arguments[H];return this.$method_missing.apply(this,[a.slice(1)].concat(p))}return N.$$stub=!0,N},v.ac=function(a,N,p,H){var Q="";throw p.$$is_a_module?Q+=p.$$name+".":Q+=p.$$class.$$name+"#",Q+=H,v.ArgumentError.$new("["+Q+"] wrong number of arguments (given "+a+", expected "+N+")")},v.block_ac=function(a,N,p){var H="`block in "+p+"'";throw v.ArgumentError.$new(H+": wrong number of arguments (given "+a+", expected "+N+")")},v.find_super=function(a,N,p,H,Q){var ee="$"+N,ne,V;a.hasOwnProperty("$$meta")?ne=v.ancestors(a.$$meta):ne=v.ancestors(a.$$class);for(var Z=ne.indexOf(p.$$owner),y=Z+1;y<ne.length;y++){var K=ne[y],P=K.$$prototype;if(P.hasOwnProperty("$$dummy")&&(P=P.$$define_methods_on),P.hasOwnProperty(ee)){V=P[ee];break}}if(!H&&V&&V.$$stub&&a.$method_missing.$$pristine)throw v.NoMethodError.$new("super: no superclass method `"+N+"' for "+a,N);return V.$$stub&&!Q?null:V},v.find_block_super=function(a,N,p,H,Q){var ee=N;if(!p)throw v.RuntimeError.$new("super called outside of method");if(Q&&p.$$define_meth)throw v.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return p.$$def&&(ee=p.$$jsid),v.find_super(a,ee,p,H)},v.find_super_dispatcher=v.find_super,v.find_iter_super_dispatcher=v.find_block_super,v.ret=function(a){throw v.returner.$v=a,v.returner},v.brk=function(a,N){throw N.$v=a,N},v.new_brk=function(){return new Error("unexpected break")},v.yield1=function(a,N){if(typeof a!="function")throw v.LocalJumpError.$new("no block given");var p=a.$$has_top_level_mlhs_arg,H=a.$$has_trailing_comma_in_args;return(a.length>1||(p||H)&&a.length===1)&&(N=v.to_ary(N)),(a.length>1||H&&a.length===1)&&N.$$is_array?a.apply(null,N):a(N)},v.yieldX=function(a,N){if(typeof a!="function")throw v.LocalJumpError.$new("no block given");if(a.length>1&&N.length===1&&N[0].$$is_array)return a.apply(null,N[0]);if(!N.$$is_array){for(var p=new Array(N.length),H=0,Q=p.length;H<Q;H++)p[H]=N[H];return a.apply(null,p)}return a.apply(null,N)},v.rescue=function(a,N){for(var p=0;p<N.length;p++){var H=N[p];if(H.$$is_array){var Q=v.rescue(a,H);if(Q)return Q}else{if(H===v.JS.Error)return H;if(H["$==="](a))return H}}return null},v.is_a=function(a,N){if(N!=null&&a.$$meta===N||a.$$class===N)return!0;if(a.$$is_number&&N.$$is_number_class)return N.$$is_integer_class?a%1===0:!0;var p,H,Q=v.ancestors(a.$$is_class?v.get_singleton_class(a):a.$$meta||a.$$class);for(p=0,H=Q.length;p<H;p++)if(Q[p]===N)return!0;return!1},v.to_hash=function(a){if(a.$$is_hash)return a;if(a["$respond_to?"]("to_hash",!0)){var N=a.$to_hash();if(N.$$is_hash)return N;throw v.TypeError.$new("Can't convert "+a.$$class+" to Hash ("+a.$$class+"#to_hash gives "+N.$$class+")")}else throw v.TypeError.$new("no implicit conversion of "+a.$$class+" into Hash")},v.to_ary=function(a){if(a.$$is_array)return a;if(a["$respond_to?"]("to_ary",!0)){var N=a.$to_ary();if(N===o)return[a];if(N.$$is_array)return N;throw v.TypeError.$new("Can't convert "+a.$$class+" to Array ("+a.$$class+"#to_ary gives "+N.$$class+")")}else return[a]},v.to_a=function(a){if(a.$$is_array)return a.slice();if(a["$respond_to?"]("to_a",!0)){var N=a.$to_a();if(N===o)return[a];if(N.$$is_array)return N;throw v.TypeError.$new("Can't convert "+a.$$class+" to Array ("+a.$$class+"#to_a gives "+N.$$class+")")}else return[a]},v.extract_kwargs=function(a){var N=a[a.length-1];return N!=null&&v.respond_to(N,"$to_hash",!0)?(W.call(a,a.length-1),N.$to_hash()):v.hash2([],{})},v.kwrestargs=function(a,N){var p=[],H={},Q,ee=a.$$smap;for(Q in ee)N[Q]||(p.push(Q),H[Q]=ee[Q]);return v.hash2(p,H)};function k(a,N){typeof N=="number"?a.$$arity=N:typeof N=="object"&&Object.assign(a,N)}v.send=function(a,N,p,H,Q){var ee;if(k(H,Q),typeof N=="function")ee=N,N=null;else if(typeof N=="string")ee=a["$"+N];else throw v.NameError.$new("Passed method should be a string or a function");return v.send2(a,ee,N,p,H)},v.send2=function(a,N,p,H,Q,ee){return N==null&&p!=null&&a.$method_missing&&(N=a.$method_missing,H=[p].concat(H)),k(Q,ee),typeof Q=="function"&&(N.$$p=Q),N.apply(a,H)},v.refined_send=function(a,N,p,H,Q,ee){var ne,V,Z,y,K,P,j,O,re,te;for(N.hasOwnProperty("$$meta")?y=v.ancestors(N.$$meta):y=v.ancestors(N.$$class),k(Q,ee),ne=0;ne<y.length;ne++)for(K=v.id(y[ne]),V=0;V<a.length;V++)for(P=a[V],Z=P.length-1;Z>=0;Z--)if(j=P[Z],typeof j.$$refine_modules!="undefined"&&(O=j.$$refine_modules,typeof O[K]!="undefined"&&(re=O[K],typeof re.$$prototype["$"+p]!="undefined")))return te=re.$$prototype["$"+p],v.send2(N,te,p,H,Q);return v.send(N,p,H,Q)},v.lambda=function(a,N){return a.$$is_lambda=!0,k(a,N),a},v.def=function(a,N,p,H){return k(p,H),a===v.top?v.defn(v.Object,N,p):!a.$$eval&&a.$$is_a_module?v.defn(a,N,p):v.defs(a,N,p)},v.defn=function(a,N,p){p.displayName=N,p.$$owner=a;var H=N.substr(1),Q=a.$$prototype;if(Q.hasOwnProperty("$$dummy")&&(Q=Q.$$define_methods_on),B(Q,N,p),a.$$is_module){a.$$module_function&&v.defs(a,N,p);for(var ee=0,ne=a.$$iclasses,V=ne.length;ee<V;ee++){var Z=ne[ee];B(Z,N,p)}}var y=a.$$singleton_of;return a.$method_added&&!a.$method_added.$$stub&&!y?a.$method_added(H):y&&y.$singleton_method_added&&!y.$singleton_method_added.$$stub&&y.$singleton_method_added(H),H},v.defs=function(a,N,p,H){if(k(p,H),a.$$is_string||a.$$is_number)throw v.TypeError.$new("can't define singleton");return v.defn(v.get_singleton_class(a),N,p)},v.rdef=function(a,N){if(!z.call(a.$$prototype,N))throw v.NameError.$new("method '"+N.substr(1)+"' not defined in "+a.$name());delete a.$$prototype[N],a.$$is_singleton?a.$$prototype.$singleton_method_removed&&!a.$$prototype.$singleton_method_removed.$$stub&&a.$$prototype.$singleton_method_removed(N.substr(1)):a.$method_removed&&!a.$method_removed.$$stub&&a.$method_removed(N.substr(1))},v.udef=function(a,N){if(!a.$$prototype[N]||a.$$prototype[N].$$stub)throw v.NameError.$new("method '"+N.substr(1)+"' not defined in "+a.$name());v.add_stub_for(a.$$prototype,N),a.$$is_singleton?a.$$prototype.$singleton_method_undefined&&!a.$$prototype.$singleton_method_undefined.$$stub&&a.$$prototype.$singleton_method_undefined(N.substr(1)):a.$method_undefined&&!a.$method_undefined.$$stub&&a.$method_undefined(N.substr(1))};function x(a){return typeof a=="function"&&!a.$$stub}v.alias=function(a,N,p){var H="$"+N,Q="$"+p,ee,ne;if(typeof a.$$prototype=="undefined"&&(a=v.Object),ee=a.$$prototype["$"+p],a.$$eval)return v.alias(v.get_singleton_class(a),N,p);if(!x(ee)){for(var V=a.$$super;typeof ee!="function"&&V;)ee=V[Q],V=V.$$super;if(!x(ee)&&a.$$is_module&&(ee=v.Object.$$prototype[Q]),!x(ee))throw v.NameError.$new("undefined method `"+p+"' for class `"+a.$name()+"'")}ee.$$alias_of&&(ee=ee.$$alias_of),ne=function(){var Z=ne.$$p,y,K,P;for(y=new Array(arguments.length),K=0,P=arguments.length;K<P;K++)y[K]=arguments[K];return delete ne.$$p,v.send(this,ee,y,Z)};try{Object.defineProperty(ne,"length",{value:ee.length})}catch(Z){}return ne.displayName=N,ne.$$arity=ee.$$arity,ne.$$parameters=ee.$$parameters,ne.$$source_location=ee.$$source_location,ne.$$alias_of=ee,ne.$$alias_name=N,v.defn(a,H,ne),a},v.alias_gvar=function(a,N){return Object.defineProperty(v.gvars,a,{configurable:!0,enumerable:!0,get:function(){return v.gvars[N]},set:function(p){v.gvars[N]=p}}),o},v.alias_native=function(a,N,p){var H="$"+N,Q=a.$$prototype[p];if(typeof Q!="function"||Q.$$stub)throw v.NameError.$new("undefined native method `"+p+"' for class `"+a.$name()+"'");return v.defn(a,H,Q),a},v.hash_init=function(a){a.$$smap=Object.create(null),a.$$map=Object.create(null),a.$$keys=[]},v.hash_clone=function(a,N){N.$$none=a.$$none,N.$$proc=a.$$proc;for(var p=0,H=a.$$keys,Q=a.$$smap,ee=H.length,ne,V;p<ee;p++)ne=H[p],ne.$$is_string?V=Q[ne]:(V=ne.value,ne=ne.key),v.hash_put(N,ne,V)},v.hash_put=function(a,N,p){if(N.$$is_string){z.call(a.$$smap,N)||a.$$keys.push(N),a.$$smap[N]=p;return}var H,Q,ee;if(H=a.$$by_identity?v.id(N):N.$hash(),!z.call(a.$$map,H)){Q={key:N,key_hash:H,value:p},a.$$keys.push(Q),a.$$map[H]=Q;return}for(Q=a.$$map[H];Q;){if(N===Q.key||N["$eql?"](Q.key)){ee=void 0,Q.value=p;break}ee=Q,Q=Q.next}ee&&(Q={key:N,key_hash:H,value:p},a.$$keys.push(Q),ee.next=Q)},v.hash_get=function(a,N){if(N.$$is_string)return z.call(a.$$smap,N)?a.$$smap[N]:void 0;var p,H;if(p=a.$$by_identity?v.id(N):N.$hash(),z.call(a.$$map,p))for(H=a.$$map[p];H;){if(N===H.key||N["$eql?"](H.key))return H.value;H=H.next}},v.hash_delete=function(a,N){var p,H=a.$$keys,Q=H.length,ee,ne;if(N.$$is_string){if(typeof N!="string"&&(N=N.valueOf()),!z.call(a.$$smap,N))return;for(p=0;p<Q;p++)if(ne=H[p],ne.$$is_string&&typeof ne!="string"&&(ne=ne.valueOf()),ne===N){H.splice(p,1);break}return ee=a.$$smap[N],delete a.$$smap[N],ee}var V=N.$hash();if(z.call(a.$$map,V))for(var Z=a.$$map[V],y;Z;){if(N===Z.key||N["$eql?"](Z.key)){for(ee=Z.value,p=0;p<Q;p++)if(H[p]===Z){H.splice(p,1);break}return y&&Z.next?y.next=Z.next:y?delete y.next:Z.next?a.$$map[V]=Z.next:delete a.$$map[V],ee}y=Z,Z=Z.next}},v.hash_rehash=function(a){for(var N=0,p=a.$$keys.length,H,Q,ee;N<p;N++)if(!a.$$keys[N].$$is_string&&(H=a.$$keys[N].key.$hash(),H!==a.$$keys[N].key_hash)){for(Q=a.$$map[a.$$keys[N].key_hash],ee=void 0;Q;){if(Q===a.$$keys[N]){ee&&Q.next?ee.next=Q.next:ee?delete ee.next:Q.next?a.$$map[a.$$keys[N].key_hash]=Q.next:delete a.$$map[a.$$keys[N].key_hash];break}ee=Q,Q=Q.next}if(a.$$keys[N].key_hash=H,!z.call(a.$$map,H)){a.$$map[H]=a.$$keys[N];continue}for(Q=a.$$map[H],ee=void 0;Q;){if(Q===a.$$keys[N]){ee=void 0;break}ee=Q,Q=Q.next}ee&&(ee.next=a.$$keys[N])}},v.hash=function(){var a=arguments.length,N,p,H,Q,ee,ne;if(a===1&&arguments[0].$$is_hash)return arguments[0];if(p=new v.Hash,v.hash_init(p),a===1&&arguments[0].$$is_array){for(N=arguments[0],Q=N.length,H=0;H<Q;H++){if(N[H].length!==2)throw v.ArgumentError.$new("value not of length 2: "+N[H].$inspect());ee=N[H][0],ne=N[H][1],v.hash_put(p,ee,ne)}return p}if(a===1){N=arguments[0];for(ee in N)z.call(N,ee)&&(ne=N[ee],v.hash_put(p,ee,ne));return p}if(a%2!==0)throw v.ArgumentError.$new("odd number of arguments for Hash");for(H=0;H<a;H+=2)ee=arguments[H],ne=arguments[H+1],v.hash_put(p,ee,ne);return p},v.hash2=function(a,N){var p=new v.Hash;return p.$$smap=N,p.$$map=Object.create(null),p.$$keys=a,p},v.range=function(a,N,p){var H=new v.Range;return H.begin=a,H.end=N,H.excl=p,H},v.ivar=function(a){return a==="constructor"||a==="displayName"||a==="__count__"||a==="__noSuchMethod__"||a==="__parent__"||a==="__proto__"||a==="hasOwnProperty"||a==="valueOf"?a+"$":a},v.escape_regexp=function(a){return a.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},v.global_regexp=function(a){return a.global?a:(a.$$g==null?a.$$g=new RegExp(a.source,(a.multiline?"gm":"g")+(a.ignoreCase?"i":"")):a.$$g.lastIndex=null,a.$$g)},v.global_multiline_regexp=function(a){var N;if(a.multiline){if(a.global)return a;a.$$g!=null?N=a.$$g:N=a.$$g=new RegExp(a.source,"gm"+(a.ignoreCase?"i":""))}else a.$$gm!=null?N=a.$$gm:N=a.$$gm=new RegExp(a.source,"gm"+(a.ignoreCase?"i":""));return N.lastIndex=null,N},v.regexp=function(a,N){for(var p,H=typeof N!="undefined"&&N&&N.indexOf("i")>=0,Q=0,ee=a.length;Q<ee;Q++)p=a[Q],p instanceof RegExp&&(p.ignoreCase!==H&&v.Kernel.$warn("ignore case doesn't match for "+p.source.$inspect(),v.hash({uplevel:1})),p=p.source),p===""&&(p="(?:"+p+")"),a[Q]=p;return N?new RegExp(a.join(""),N):new RegExp(a.join(""))},v.modules={},v.loaded_features=["corelib/runtime"],v.current_dir=".",v.require_table={"corelib/runtime":!0},v.normalize=function(a){var N,p,H=[],Q="/";v.current_dir!=="."&&(a=v.current_dir.replace(/\/*$/,"/")+a),a=a.replace(/^\.\//,""),a=a.replace(/\.(rb|opal|js)$/,""),N=a.split(Q);for(var ee=0,ne=N.length;ee<ne;ee++)p=N[ee],p!==""&&(p===".."?H.pop():H.push(p));return H.join(Q)},v.loaded=function(a){var N,p,H;for(N=0,p=a.length;N<p;N++)H=v.normalize(a[N]),!v.require_table[H]&&(v.loaded_features.push(H),v.require_table[H]=!0)},v.load=function(a){a=v.normalize(a),v.loaded([a]);var N=v.modules[a];if(N){var p=N(v);if(typeof Promise!="undefined"&&p instanceof Promise)return p.then(function(){return!0})}else{var H=v.config.missing_require_severity,Q="cannot load such file -- "+a;if(H==="error")throw v.LoadError?v.LoadError.$new(Q):Q;H==="warning"&&A.warn("WARNING: LoadError: "+Q)}return!0},v.require=function(a){return a=v.normalize(a),v.require_table[a]?!1:v.load(a)},v.encodings=Object.create(null),v.set_encoding=function(a,N,p){if(typeof p=="undefined"&&(p="encoding"),typeof a=="string"||a.$$frozen===!0)throw v.FrozenError.$new("can't modify frozen String");var H=v.find_encoding(N);return H===a[p]||(a[p]=H),a},v.find_encoding=function(a){var N=v.encodings,p=N[a]||N[a.toUpperCase()];if(!p)throw v.ArgumentError.$new("unknown encoding name - "+a);return p},v.enc=function(a,N){var p=new String(a);return p=v.set_encoding(p,N),p.internal_encoding=p.encoding,p},v.binary=function(a){var N=new String(a);return v.set_encoding(N,"binary","internal_encoding")},v.last_promise=null,v.promise_unhandled_exception=!1,v.queue=function(a){if(v.last_promise)return v.last_promise=v.last_promise.then(function(){if(!v.promise_unhandled_exception)return a(v)}).catch(function(p){v.respond_to(p,"$full_message")&&(p=p.$full_message()),A.error(p),v.promise_unhandled_exception=!0,v.exit(1)}),v.last_promise;var N=a(v);return typeof Promise=="function"&&typeof N=="object"&&N instanceof Promise&&(v.last_promise=N),N},v.rb_plus=function(a,N){return typeof a=="number"&&typeof N=="number"?a+N:a["$+"](N)},v.rb_minus=function(a,N){return typeof a=="number"&&typeof N=="number"?a-N:a["$-"](N)},v.rb_times=function(a,N){return typeof a=="number"&&typeof N=="number"?a*N:a["$*"](N)},v.rb_divide=function(a,N){return typeof a=="number"&&typeof N=="number"?a/N:a["$/"](N)},v.rb_lt=function(a,N){return typeof a=="number"&&typeof N=="number"?a<N:a["$<"](N)},v.rb_gt=function(a,N){return typeof a=="number"&&typeof N=="number"?a>N:a["$>"](N)},v.rb_le=function(a,N){return typeof a=="number"&&typeof N=="number"?a<=N:a["$<="](N)},v.rb_ge=function(a,N){return typeof a=="number"&&typeof N=="number"?a>=N:a["$>="](N)},v.eqeq=function(a,N){return typeof a=="number"&&typeof N=="number"||typeof a=="string"&&typeof N=="string"?a===N:X(a["$=="](N))},v.eqeqeq=function(a,N){return typeof a=="number"&&typeof N=="number"||typeof a=="string"&&typeof N=="string"?a===N:X(a["$==="](N))},v.neqeq=function(a,N){return typeof a=="number"&&typeof N=="number"||typeof a=="string"&&typeof N=="string"?a!==N:X(a["$!="](N))},v.not=function(a){return a===!0?!1:a==null||a===!1||o===a?!0:X(a["$!"]())},v.BasicObject=t=v.allocate_class("BasicObject",null),v.Object=r=v.allocate_class("Object",v.BasicObject),v.Module=q=v.allocate_class("Module",v.Object),v.Class=C=v.allocate_class("Class",v.Module),v.Opal=I=v.allocate_module("Opal"),v.Kernel=h=v.allocate_module("Kernel"),U(v.BasicObject,v.Class.$$prototype),U(v.Object,v.Class.$$prototype),U(v.Module,v.Class.$$prototype),U(v.Class,v.Class.$$prototype),t.$$const.BasicObject=t,f(r,"BasicObject",t),f(r,"Object",r),f(r,"Module",q),f(r,"Class",C),f(r,"Opal",I),f(r,"Kernel",h),t.$$class=C,r.$$class=C,q.$$class=C,C.$$class=C,I.$$class=q,h.$$class=q,B(r.$$prototype,"toString",function(){var a=this.$to_s();return a.$$is_string&&typeof a=="object"?a.valueOf():a}),B(r.$$prototype,"$require",v.require),v.top=new r,v.top.$to_s=v.top.$inspect=function(){return"main"},v.top.$define_method=Y;function Y(){var a=v.slice.call(arguments),N=Y.$$p;return delete Y.$$p,v.send(r,"define_method",a,N)}v.NilClass=v.allocate_class("NilClass",v.Object),f(r,"NilClass",v.NilClass),o=v.nil=new v.NilClass,o.$$id=S,o.call=o.apply=function(){throw v.LocalJumpError.$new("no block given")},v.breaker=new Error("unexpected break (old)"),v.returner=new Error("unexpected return"),TypeError.$$super=Error}).call(We);Opal.loaded(["corelib/runtime.js"]);Opal.modules["corelib/helpers"]=function(e){var A=e.nil,o=e.$$$,t=e.type_error,r=e.coerce_to,q=e.module,C=e.defs,I=e.eqeqeq,h=e.Kernel,v=e.truthy,z=e.Opal;return function(T){var U=q(T,"Opal");C(U,"$bridge",function(S,F){return e.bridge(S,F)},2),C(U,"$coerce_to!",function(S,F,B,X){var L,w,b=A;return L=e.slice.call(arguments,3),w=L,b=r(S,F,B,w),I(F,b)||h.$raise(t(S,F,B,b)),b},-4),C(U,"$coerce_to?",function(S,F,B,X){var L,w,b=A;return L=e.slice.call(arguments,3),w=L,!v(S["$respond_to?"](B))||(b=r(S,F,B,w),v(b["$nil?"]()))?A:(I(F,b)||h.$raise(t(S,F,B,b)),b)},-4),C(U,"$try_convert",function(S,F,B){return I(F,S)?S:v(S["$respond_to?"](B))?S.$__send__(B):A},3),C(U,"$compare",function(S,F){var B=A;return B=S["$<=>"](F),v(B===A)&&h.$raise(o("ArgumentError"),"comparison of "+S.$class()+" with "+F.$class()+" failed"),B},2),C(U,"$destructure",function(S){if(S.length==1)return S[0];if(S.$$is_array)return S;for(var F=new Array(S.length),B=0,X=F.length;B<X;B++)F[B]=S[B];return F},1),C(U,"$respond_to?",function(S,F,B){return B==null&&(B=!1),S==null||!S.$$class?!1:S["$respond_to?"](F,B)},-3),C(U,"$instance_variable_name!",function(S){return S=z["$coerce_to!"](S,o("String"),"to_str"),v(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(S))||h.$raise(o("NameError").$new("'"+S+"' is not allowed as an instance variable name",S)),S},1),C(U,"$class_variable_name!",function(S){return S=z["$coerce_to!"](S,o("String"),"to_str"),v(S.length<3||S.slice(0,2)!=="@@")&&h.$raise(o("NameError").$new("`"+S+"' is not allowed as a class variable name",S)),S},1),C(U,"$const_name?",function(S){return typeof S!="string"&&(S=z["$coerce_to!"](S,o("String"),"to_str")),S[0]===S[0].toUpperCase()},1),C(U,"$const_name!",function(S){var F,B=this;return v((F=o("::","String","skip_raise"))?"constant":A)&&(S=z["$coerce_to!"](S,o("String"),"to_str")),(!S||S[0]!=S[0].toUpperCase())&&B.$raise(o("NameError"),"wrong constant name "+S),S},1),C(U,"$pristine",function(S,F){var B,X;B=e.slice.call(arguments,1),X=B;for(var L,w,b=X.length-1;b>=0;b--)L=X[b],w=S.$$prototype["$"+L],w&&!w.$$stub&&(w.$$pristine=!0);return A},-2);var J=[];return C(U,"$inspect",function(S){var F=A,B=!1;return function(){try{try{return S===null?"null":S===void 0?"undefined":typeof S.$$class=="undefined"?Object.prototype.toString.apply(S):typeof S.$inspect!="function"||S.$inspect.$$stub||J.indexOf(S.$__id__())!==-1?"#<"+S.$$class+":0x"+S.$__id__().$to_s(16)+">":(J.push(S.$__id__()),B=!0,S.$inspect())}catch(X){if(e.rescue(X,[o("Exception")])){F=X;try{return"#<"+S.$$class+":0x"+S.$__id__().$to_s(16)+">"}finally{e.pop_exception()}}else throw X}}finally{B&&J.pop()}}()},-1)}("::")};Opal.modules["corelib/module"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.truthy,q=e.coerce_to,C=e.const_set,I=e.Object,h=e.klass,v=e.defs,z=e.send,T=e.def,U=e.eqeqeq,J=e.Module,W=e.Kernel,S=e.rb_lt,F=e.rb_gt,B=e.to_a,X=e.hash2,L=e.Opal,w=e.eqeq,b=e.lambda,M=e.range,D=e.send2,G=e.find_super,R=e.alias;return function(f,E,g){var _=h(f,E,"Module"),u=[_].concat(g),c=e.$r(u);return v(_,"$allocate",function(){var i=this,n=e.allocate_module(o,function(){});return i!==e.Module&&Object.setPrototypeOf(n,i.$$prototype),n},0),T(_,"$initialize",function s(){var i=s.$$p||o,n=this;return delete s.$$p,i!==o?z(n,"module_eval",[],i.$to_proc()):o},0),T(_,"$===",function(i){var n=this;return r(i==null)?!1:e.is_a(i,n)},1),T(_,"$<",function(i){var n=this;U(J,i)||W.$raise(t("TypeError"),"compared with non class/module");var $=n,l,d,m;if($===i)return!1;for(d=0,l=e.ancestors(n),m=l.length;d<m;d++)if(l[d]===i)return!0;for(d=0,l=e.ancestors(i),m=l.length;d<m;d++)if(l[d]===n)return!1;return o},1),T(_,"$<=",function(i){var n=this,$=o;return r($=n["$equal?"](i))?$:S(n,i)},1),T(_,"$>",function(i){var n=this;return U(J,i)||W.$raise(t("TypeError"),"compared with non class/module"),S(i,n)},1),T(_,"$>=",function(i){var n=this,$=o;return r($=n["$equal?"](i))?$:F(n,i)},1),T(_,"$<=>",function(i){var n=this,$=o;return n===i?0:!U(J,i)||($=S(n,i),r($["$nil?"]()))?o:r($)?-1:1},1),T(_,"$alias_method",function(i,n){var $=this;return i=q(i,t("String"),"to_str"),n=q(n,t("String"),"to_str"),e.alias($,i,n),$},2),T(_,"$alias_native",function(i,n){var $=this;return n==null&&(n=i),e.alias_native($,i,n),$},-2),T(_,"$ancestors",function(){var i=this;return e.ancestors(i)},0),T(_,"$append_features",function(i){var n=this;return e.append_features(n,i),n},1),T(_,"$attr_accessor",function(i){var n,$,l=this;return n=e.slice.call(arguments),$=n,z(l,"attr_reader",B($)),z(l,"attr_writer",B($))},-1),T(_,"$attr",function(i){var n,$,l=this;return n=e.slice.call(arguments),$=n,$.length==2&&($[1]===!0||$[1]===!1)?(l.$warn("optional boolean argument is obsoleted",X(["uplevel"],{uplevel:1})),$[1]?l.$attr_accessor($[0]):l.$attr_reader($[0]),o):z(l,"attr_reader",B($))},-1),T(_,"$attr_reader",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;for(var d=l.$$prototype,m=$.length-1;m>=0;m--){var k=$[m],x="$"+k,Y=e.ivar(k),a=function(N){return function(){return this[N]==null?o:this[N]}}(Y);e.prop(d,Y,o),a.$$parameters=[],a.$$arity=0,e.defn(l,x,a)}return o},-1),T(_,"$attr_writer",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;for(var d=l.$$prototype,m=$.length-1;m>=0;m--){var k=$[m],x="$"+k+"=",Y=e.ivar(k),a=function(N){return function(p){return this[N]=p}}(Y);a.$$parameters=[["req"]],a.$$arity=1,e.prop(d,Y,o),e.defn(l,x,a)}return o},-1),T(_,"$autoload",function(i,n){var $=this;return c("Opal")["$const_name?"](i)||W.$raise(t("NameError"),"autoload must be constant name: "+i),n==""&&W.$raise(t("ArgumentError"),"empty file name"),$.$$const.hasOwnProperty(i)||($.$$autoload||($.$$autoload={}),e.const_cache_version++,$.$$autoload[i]={path:n,loaded:!1,required:!1,success:!1,exception:!1}),o},2),T(_,"$autoload?",function(i){var n=this;if(n.$$autoload&&n.$$autoload[i]&&!n.$$autoload[i].required&&!n.$$autoload[i].success)return n.$$autoload[i].path;for(var $=n.$ancestors(),l=0,d=$.length;l<d;l++)if($[l].$$autoload&&$[l].$$autoload[i]&&!$[l].$$autoload[i].required&&!$[l].$$autoload[i].success)return $[l].$$autoload[i].path;return o},1),T(_,"$class_variables",function(){var i=this;return Object.keys(e.class_variables(i))},0),T(_,"$class_variable_get",function(i){var n=this;return i=L["$class_variable_name!"](i),e.class_variable_get(n,i,!1)},1),T(_,"$class_variable_set",function(i,n){var $=this;return i=L["$class_variable_name!"](i),e.class_variable_set($,i,n)},2),T(_,"$class_variable_defined?",function(i){var n=this;return i=L["$class_variable_name!"](i),e.class_variables(n).hasOwnProperty(i)},1),T(_,"$remove_class_variable",function(i){var n=this;if(i=L["$class_variable_name!"](i),e.hasOwnProperty.call(n.$$cvars,i)){var $=n.$$cvars[i];return delete n.$$cvars[i],$}else W.$raise(t("NameError"),"cannot remove "+i+" for "+n)},1),T(_,"$constants",function(i){var n=this;return i==null&&(i=!0),e.constants(n,i)},-1),v(_,"$constants",function(i){var n=this;if(i==null){var $=(n.$$nesting||[]).concat(I),l,d={},m,k;for(m=0,k=$.length;m<k;m++)for(l in $[m].$$const)d[l]=!0;return Object.keys(d)}else return e.constants(n,i)},-1),v(_,"$nesting",function(){var i=this;return i.$$nesting||[]},0),T(_,"$const_defined?",function(i,n){var $=this;n==null&&(n=!0),i=c("Opal")["$const_name!"](i),r(i["$=~"](t(L,"CONST_NAME_REGEXP")))||W.$raise(t("NameError").$new("wrong constant name "+i,i));var l,d=[$],m,k,x;for(n&&(d=d.concat(e.ancestors($)),$.$$is_module&&(d=d.concat([I]).concat(e.ancestors(I)))),k=0,x=d.length;k<x;k++)if(l=d[k],l.$$const[i]!=null||l.$$autoload&&l.$$autoload[i]&&!l.$$autoload[i].required&&!l.$$autoload[i].success)return!0;return!1},-2),T(_,"$const_get",function(i,n){var $=this;return n==null&&(n=!0),i=c("Opal")["$const_name!"](i),i.indexOf("::")===0&&i!=="::"&&(i=i.slice(2)),r(i.indexOf("::")!=-1&&i!="::")?z(i.$split("::"),"inject",[$],function(d,m){return d==null&&(d=o),m==null&&(m=o),d.$const_get(m)},2):(r(i["$=~"](t(L,"CONST_NAME_REGEXP")))||W.$raise(t("NameError").$new("wrong constant name "+i,i)),n?e.$$([$],i):e.const_get_local($,i))},-2),T(_,"$const_missing",function(i){var n=this,$=o;return $=w(n,I)?i:""+n+"::"+i,W.$raise(t("NameError").$new("uninitialized constant "+$,i))},1),T(_,"$const_set",function(i,n){var $=this;return i=L["$const_name!"](i),(r(i["$!~"](t(L,"CONST_NAME_REGEXP")))||r(i["$start_with?"]("::")))&&W.$raise(t("NameError").$new("wrong constant name "+i,i)),C($,i,n),n},2),T(_,"$public_constant",function(i){return o},1),T(_,"$define_method",function s(i,n){var $=s.$$p||o,l=this,d=o,m=o;delete s.$$p,n===void 0&&$===o&&W.$raise(t("ArgumentError"),"tried to create a Proc object without a block"),$=r(d=$)?d:U(t("Proc"),m=n)?n:U(t("Method"),m)?n.$to_proc().$$unbound:U(t("UnboundMethod"),m)?b(function x(Y){var a,N,p=x.$$s==null?this:x.$$s,H=o;return a=e.slice.call(arguments),N=a,H=n.$bind(p),z(H,"call",B(N))},{$$arity:-1,$$s:l}):W.$raise(t("TypeError"),"wrong argument type "+$.$class()+" (expected Proc/Method)");var k="$"+i;return $.$$jsid=i,$.$$s=null,$.$$def=$,$.$$define_meth=!0,e.defn(l,k,$)},-2),T(_,"$remove_method",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;for(var d=0,m=$.length;d<m;d++)e.rdef(l,"$"+$[d]);return l},-1),T(_,"$singleton_class?",function(){var i=this;return!!i.$$is_singleton},0),T(_,"$include",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;for(var d=$.length-1;d>=0;d--){var m=$[d];m.$$is_module||W.$raise(t("TypeError"),"wrong argument type "+m.$class()+" (expected Module)"),m.$append_features(l),m.$included(l)}return l},-1),T(_,"$included_modules",function(){var i=this;return e.included_modules(i)},0),T(_,"$include?",function(i){var n=this;i.$$is_module||W.$raise(t("TypeError"),"wrong argument type "+i.$class()+" (expected Module)");var $,l,d,m=e.ancestors(n);for($=0,l=m.length;$<l;$++)if(d=m[$],d===i&&d!==n)return!0;return!1},1),T(_,"$instance_method",function(i){var n=this,$=n.$$prototype["$"+i];return(!$||$.$$stub)&&W.$raise(t("NameError").$new("undefined method `"+i+"' for class `"+n.$name()+"'",i)),t("UnboundMethod").$new(n,$.$$owner||n,$,i)},1),T(_,"$instance_methods",function(i){var n=this;return i==null&&(i=!0),r(i)?e.instance_methods(n):e.own_instance_methods(n)},-1),T(_,"$included",function(i){return o},1),T(_,"$extended",function(i){return o},1),T(_,"$extend_object",function(i){return o},1),T(_,"$method_added",function(i){var n,$;return n=e.slice.call(arguments),$=n,o},-1),T(_,"$method_removed",function(i){var n,$;return n=e.slice.call(arguments),$=n,o},-1),T(_,"$method_undefined",function(i){var n,$;return n=e.slice.call(arguments),$=n,o},-1),T(_,"$module_eval",function s(i){var n=s.$$p||o,$,l,d,m=this,k=o,x=o,Y=o,a=o,N=o,p=o,H=o;delete s.$$p,$=e.slice.call(arguments),l=$,r(n["$nil?"]())&&r(!!e.compile)?(r(M(1,3,!1)["$cover?"](l.$size()))||W.$raise(t("ArgumentError"),"wrong number of arguments (0 for 1..3)"),d=[].concat(B(l)),k=d[0]==null?o:d[0],x=d[1]==null?o:d[1],Y=d[2]==null?o:d[2],a=X(["file","eval"],{file:r(N=x)?N:"(eval)",eval:!0}),p=e.hash({arity_check:!1}).$merge(a),H=L.$compile(k,p),n=z(W,"proc",[],function ne(){var V=ne.$$s==null?this:ne.$$s;return new Function("Opal,self","return "+H)(e,V)},{$$arity:0,$$s:m})):r(l["$any?"]())&&W.$raise(t("ArgumentError"),"wrong number of arguments ("+l.$size()+` for 0)

  NOTE:If you want to enable passing a String argument please add "require 'opal-parser'" to your script
`);var Q=n.$$s,ee;return n.$$s=null,ee=n.apply(m,[m]),n.$$s=Q,ee},-1),T(_,"$module_exec",function s(i){var n=s.$$p||o,$,l,d=this;delete s.$$p,$=e.slice.call(arguments),l=$,n===o&&W.$raise(t("LocalJumpError"),"no block given");var m=n.$$s,k;return n.$$s=null,k=n.apply(d,l),n.$$s=m,k},-1),T(_,"$method_defined?",function(i){var n=this,$=n.$$prototype["$"+i];return!!$&&!$.$$stub},1),T(_,"$module_function",function(i){var n,$,l=this;if(n=e.slice.call(arguments),$=n,$.length===0)return l.$$module_function=!0,o;for(var d=0,m=$.length;d<m;d++){var k=$[d],x="$"+k,Y=l.$$prototype[x];e.defs(l,x,Y)}return $.length===1?$[0]:$;return l},-1),T(_,"$name",function(){var i=this;if(i.$$full_name)return i.$$full_name;for(var n=[],$=i;$;){if($.$$name===o||$.$$name==null)return o;if(n.unshift($.$$name),$=$.$$base_module,$===I)break}return n.length===0?o:i.$$full_name=n.join("::")},0),T(_,"$prepend",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n,$.length===0&&W.$raise(t("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var d=$.length-1;d>=0;d--){var m=$[d];m.$$is_module||W.$raise(t("TypeError"),"wrong argument type "+m.$class()+" (expected Module)"),m.$prepend_features(l),m.$prepended(l)}return l},-1),T(_,"$prepend_features",function(i){var n=this;return n.$$is_module||W.$raise(t("TypeError"),"wrong argument type "+n.$class()+" (expected Module)"),e.prepend_features(n,i),n},1),T(_,"$prepended",function(i){return o},1),T(_,"$remove_const",function(i){var n=this;return e.const_remove(n,i)},1),T(_,"$to_s",function(){var i=this,n=o;return r(n=e.Module.$name.call(i))?n:"#<"+(i.$$is_module?"Module":"Class")+":0x"+i.$__id__().$to_s(16)+">"},0),T(_,"$undef_method",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;for(var d=0,m=$.length;d<m;d++)e.udef(l,"$"+$[d]);return l},-1),T(_,"$instance_variables",function(){var i=this,n=o;n=(e.Module.$$nesting=u,i.$constants());var $=[];for(var l in i)i.hasOwnProperty(l)&&l.charAt(0)!=="$"&&l!=="constructor"&&!n["$include?"](l)&&$.push("@"+l);return $},0),T(_,"$dup",function s(){var i=s.$$p||o,n=this,$=o;return delete s.$$p,$=D(n,G(n,"dup",s,!1,!0),"dup",[],i),$.$copy_class_variables(n),$.$copy_constants(n),$},0),T(_,"$copy_class_variables",function(i){var n=this;for(var $ in i.$$cvars)n.$$cvars[$]=i.$$cvars[$]},1),T(_,"$copy_constants",function(i){var n=this,$,l=i.$$const;for($ in l)C(n,$,l[$])},1),T(_,"$refine",function s(i){var n=s.$$p||o,$,l=this,d=o,m=o,k=o;return delete s.$$p,$=[l,o,o],d=$[0],m=$[1],k=$[2],k=e.id(i),typeof l.$$refine_modules=="undefined"&&(l.$$refine_modules={}),typeof l.$$refine_modules[k]=="undefined"?m=l.$$refine_modules[k]=t("Refinement").$new():m=l.$$refine_modules[k],m.refinement_module=d,m.refined_class=i,z(m,"class_exec",[],n.$to_proc()),m},1),T(_,"$using",function(i){return W.$raise("Module#using is not permitted in methods")},1),R(_,"class_eval","module_eval"),R(_,"class_exec","module_exec"),R(_,"inspect","to_s")}("::",null,A),function(f,E){var g=h(f,E,"Refinement"),_=g.$$prototype;return _.refinement_module=_.refined_class=o,T(g,"$inspect",function u(){var c=u.$$p||o,s=this;return delete u.$$p,r(s.refinement_module)?"#<refinement:"+s.refined_class.$inspect()+"@"+s.refinement_module.$inspect()+">":D(s,G(s,"inspect",u,!1,!0),"inspect",[],c)},0)}("::",J)};Opal.modules["corelib/class"]=function(e){var A=e.top,o=[],t=e.nil,r=e.klass,q=e.send,C=e.defs,I=e.def,h=e.rb_plus,v=e.send2,z=e.find_super,T=e.alias;return A.$require("corelib/module"),function(U,J,W){var S=r(U,J,"Class"),F=[S].concat(W),B=e.$r(F);return C(S,"$new",function X(L){var w=X.$$p||t;if(delete X.$$p,L==null&&(L=B("Object")),!L.$$is_class)throw e.TypeError.$new("superclass must be a Class");var b=e.allocate_class(t,L);return L.$inherited(b),w!==t&&q(b,"class_eval",[],w.$to_proc()),b},-1),I(S,"$allocate",function(){var L=this,w=new L.$$constructor;return w.$$id=e.uid(),w},0),I(S,"$descendants",function(){var L=this;return h(L.$subclasses(),q(L.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())},0),I(S,"$inherited",function(L){return t},1),I(S,"$initialize_dup",function(L){var w=this;w.$initialize_copy(L),w.$$name=null,w.$$full_name=null},1),I(S,"$new",function X(L){var w=X.$$p||t,b,M,D=this;delete X.$$p,b=e.slice.call(arguments),M=b;var G=D.$allocate();return e.send(G,G.$initialize,M,w),G},-1),I(S,"$subclasses",function(){var L=this;if(typeof WeakRef!="undefined"){var w,b,M=[];for(w=0;w<L.$$subclasses.length;w++)b=L.$$subclasses[w].deref(),b!==void 0&&M.push(b);return M}else return L.$$subclasses},0),I(S,"$superclass",function(){var L=this;return L.$$super||t},0),I(S,"$to_s",function X(){var L=X.$$p||t,w=this;delete X.$$p;var b=w.$$singleton_of;return b&&b.$$is_a_module?"#<Class:"+b.$name()+">":b?"#<Class:#<"+b.$$class.$name()+":0x"+e.id(b).$to_s(16)+">>":v(w,z(w,"to_s",X,!1,!0),"to_s",[],null)},0),T(S,"inspect","to_s")}("::",null,o)};Opal.modules["corelib/basic_object"]=function(e){"use strict";var A=e.nil,o=e.$$$,t=e.klass,r=e.def,q=e.alias,C=e.truthy,I=e.range,h=e.Kernel,v=e.to_a,z=e.hash2,T=e.Opal,U=e.send,J=e.eqeq,W=e.rb_ge;return function(S,F){var B=t(S,F,"BasicObject");return r(B,"$initialize",function(L){var w,b;return w=e.slice.call(arguments),b=w,A},-1),r(B,"$==",function(L){var w=this;return w===L},1),r(B,"$eql?",function(L){var w=this;return w["$=="](L)},1),q(B,"equal?","=="),r(B,"$__id__",function(){var L=this;return L.$$id!=null||e.prop(L,"$$id",e.uid()),L.$$id},0),r(B,"$__send__",function X(L,w){var b=X.$$p||A,M,D,G=this;delete X.$$p,M=e.slice.call(arguments,1),D=M,L.$$is_string||G.$raise(o("TypeError"),""+G.$inspect()+" is not a symbol nor a string");var R=G["$"+L];return R?(b!==A&&(R.$$p=b),R.apply(G,D)):(b!==A&&(G.$method_missing.$$p=b),G.$method_missing.apply(G,[L].concat(D)))},-2),r(B,"$!",function(){return!1},0),r(B,"$!=",function(L){var w=this;return w["$=="](L)["$!"]()},1),r(B,"$instance_eval",function X(L){var w=X.$$p||A,b,M,D,G=this,R=A,f=A,E=A,g=A,_=A,u=A,c=A;if(delete X.$$p,b=e.slice.call(arguments),M=b,C(w["$nil?"]())&&C(!!e.compile))C(I(1,3,!1)["$cover?"](M.$size()))||h.$raise(o("ArgumentError"),"wrong number of arguments (0 for 1..3)"),D=[].concat(v(M)),R=D[0]==null?A:D[0],f=D[1]==null?A:D[1],E=D[2]==null?A:D[2],g=z(["file","eval"],{file:C(_=f)?_:"(eval)",eval:!0}),u=e.hash({arity_check:!1}).$merge(g),c=T.$compile(R,u),w=U(h,"proc",[],function n(){var $=n.$$s==null?this:n.$$s;return new Function("Opal,self","return "+c)(e,$)},{$$arity:0,$$s:G});else{if(C(w["$nil?"]())&&C(W(M.$length(),1))&&J(M.$first()["$[]"](0),"@"))return G.$instance_variable_get(M.$first());C(M["$any?"]())&&h.$raise(o("ArgumentError"),"wrong number of arguments ("+M.$size()+" for 0)")}var s=w.$$s,i;if(w.$$s=null,G.$$is_a_module){G.$$eval=!0;try{i=w.call(G,G)}finally{G.$$eval=!1}}else i=w.call(G,G);return w.$$s=s,i},-1),r(B,"$instance_exec",function X(L){var w=X.$$p||A,b,M,D=this;delete X.$$p,b=e.slice.call(arguments),M=b,C(w)||h.$raise(o("ArgumentError"),"no block given");var G=w.$$s,R;if(w.$$s=null,D.$$is_a_module){D.$$eval=!0;try{R=w.apply(D,M)}finally{D.$$eval=!1}}else R=w.apply(D,M);return w.$$s=G,R},-1),r(B,"$singleton_method_added",function(L){var w,b;return w=e.slice.call(arguments),b=w,A},-1),r(B,"$singleton_method_removed",function(L){var w,b;return w=e.slice.call(arguments),b=w,A},-1),r(B,"$singleton_method_undefined",function(L){var w,b;return w=e.slice.call(arguments),b=w,A},-1),r(B,"$method_missing",function X(L,w){var b=X.$$p||A,M,D,G=this,R=A;return delete X.$$p,M=e.slice.call(arguments,1),D=M,R=T.$inspect(G),h.$raise(o("NoMethodError").$new("undefined method `"+L+"' for "+R,L,D),A,h.$caller(1))},-2),T.$pristine(B,"method_missing"),r(B,"$respond_to_missing?",function(L,w){return w==null&&(w=!1),!1},-2)}("::",null)};Opal.modules["corelib/kernel"]=function(e){"use strict";var A=[],o=e.nil,t=e.$$$,r=e.truthy,q=e.coerce_to,C=e.respond_to,I=e.Opal,h=e.module,v=e.def,z=e.Kernel,T=e.gvars,U=e.hash2,J=e.send,W=e.to_a,S=e.rb_plus,F=e.eqeq,B=e.eqeqeq,X=e.rb_le,L=e.rb_lt,w=e.Object,b=e.alias,M=e.klass;return function(D,G){var R=h(D,"Kernel"),f=[R].concat(G),E=e.$r(f);v(R,"$=~",function(u){return!1},1),v(R,"$!~",function(u){var c=this;return c["$=~"](u)["$!"]()},1),v(R,"$===",function(u){var c=this,s=o;return r(s=c.$object_id()["$=="](u.$object_id()))?s:c["$=="](u)},1),v(R,"$<=>",function(u){var c=this;c.$$comparable=!0;var s=c["$=="](u);return s&&s!==o?0:o},1),v(R,"$method",function(u){var c=this,s=c["$"+u];return(!s||s.$$stub)&&z.$raise(t("NameError").$new("undefined method `"+u+"' for class `"+c.$class()+"'",u)),t("Method").$new(c,s.$$owner||c.$class(),s,u)},1),v(R,"$methods",function(u){var c=this;return u==null&&(u=!0),r(u)?e.methods(c):e.own_methods(c)},-1),v(R,"$public_methods",function(u){var c=this;return u==null&&(u=!0),r(u)?e.methods(c):e.receiver_methods(c)},-1),v(R,"$Array",function(u){var c;return u===o?[]:u.$$is_array?u:(c=I["$coerce_to?"](u,t("Array"),"to_ary"),c!==o||(c=I["$coerce_to?"](u,t("Array"),"to_a"),c!==o)?c:[u])},1),v(R,"$at_exit",function _(){var u=_.$$p||o,c=o;return T.__at_exit__==null&&(T.__at_exit__=o),delete _.$$p,T.__at_exit__=r(c=T.__at_exit__)?c:[],T.__at_exit__["$<<"](u),u},0),v(R,"$caller",function(u,c){u==null&&(u=1),c==null&&(c=o);var s,i;s=new Error().$backtrace(),i=[];for(var n=u+1,$=s.length;n<$;n++)s[n].match(/runtime\.js/)||i.push(s[n]);return c!=o&&(i=i.slice(0,c)),i},-1),v(R,"$class",function(){var u=this;return u.$$class},0),v(R,"$copy_instance_variables",function(u){var c=this,s=Object.keys(u),i,n,$;for(i=0,n=s.length;i<n;i++)$=s[i],$.charAt(0)!=="$"&&u.hasOwnProperty($)&&(c[$]=u[$])},1),v(R,"$copy_singleton_methods",function(u){var c=this,s,i,n,$;if(u.hasOwnProperty("$$meta")){var l=e.get_singleton_class(u),d=e.get_singleton_class(c);for(n=Object.getOwnPropertyNames(l.$$prototype),s=0,$=n.length;s<$;s++)i=n[s],e.is_method(i)&&(d.$$prototype[i]=l.$$prototype[i]);d.$$const=Object.assign({},l.$$const),Object.setPrototypeOf(d.$$prototype,Object.getPrototypeOf(l.$$prototype))}for(s=0,n=Object.getOwnPropertyNames(u),$=n.length;s<$;s++)i=n[s],i.charAt(0)==="$"&&i.charAt(1)!=="$"&&u.hasOwnProperty(i)&&(c[i]=u[i])},1),v(R,"$clone",function(u){var c,s=this,i=o;if(u==null)u=U([],{});else if(!u.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return c=u.$$smap.freeze,c==null&&(c=!0),i=s.$class().$allocate(),i.$copy_instance_variables(s),i.$copy_singleton_methods(s),i.$initialize_clone(s),i},-1),v(R,"$initialize_clone",function(u){var c=this;return c.$initialize_copy(u)},1),v(R,"$define_singleton_method",function _(u,c){var s=_.$$p||o,i=this;return delete _.$$p,J(i.$singleton_class(),"define_method",[u,c],s.$to_proc())},-2),v(R,"$dup",function(){var u=this,c=o;return c=u.$class().$allocate(),c.$copy_instance_variables(u),c.$initialize_dup(u),c},0),v(R,"$initialize_dup",function(u){var c=this;return c.$initialize_copy(u)},1),v(R,"$enum_for",function _(u,c){var s=_.$$p||o,i,n,$,l=this;return delete _.$$p,i=e.slice.call(arguments),i.length>0&&(n=i.shift()),n==null&&(n="each"),$=i,J(t("Enumerator"),"for",[l,n].concat(W($)),s.$to_proc())},-1),v(R,"$equal?",function(u){var c=this;return c===u},1),v(R,"$exit",function(u){var c,s=o,i=o;for(T.__at_exit__==null&&(T.__at_exit__=o),u==null&&(u=!0),T.__at_exit__=r(s=T.__at_exit__)?s:[];!r(T.__at_exit__["$empty?"]());)i=T.__at_exit__.$pop(),i.$call();return u.$$is_boolean?u=u?0:1:u=q(u,t("Integer"),"to_int"),e.exit(u),o},-1),v(R,"$extend",function(u){var c,s,i=this;c=e.slice.call(arguments),s=c;for(var n=i.$singleton_class(),$=s.length-1;$>=0;$--){var l=s[$];l.$$is_module||z.$raise(t("TypeError"),"wrong argument type "+l.$class()+" (expected Module)"),l.$append_features(n),l.$extend_object(i),l.$extended(i)}return i},-1),v(R,"$gets",function(u){var c,s;return T.stdin==null&&(T.stdin=o),c=e.slice.call(arguments),s=c,J(T.stdin,"gets",W(s))},-1),v(R,"$hash",function(){var u=this;return u.$__id__()},0),v(R,"$initialize_copy",function(u){return o},1);var g=[];return v(R,"$inspect",function(){var u=this,c=o,s=o,i=o,n=o;return function(){try{try{return c="",s=u.$__id__(),r(g["$include?"](s))?c=" ...":(g["$<<"](s),i=!0,J(u.$instance_variables(),"each",[],function $(l){var d=$.$$s==null?this:$.$$s,m=o,k=o;return l==null&&(l=o),m=d.$instance_variable_get(l),k=E("Opal").$inspect(m),c=S(c," "+l+"="+k)},{$$arity:1,$$s:u})),"#<"+u.$class()+":0x"+s.$to_s(16)+c+">"}catch($){if(e.rescue($,[E("StandardError")])){n=$;try{return"#<"+u.$class()+":0x"+s.$to_s(16)+">"}finally{e.pop_exception()}}else throw $}}finally{r(i)&&g.$pop()}}()},0),v(R,"$instance_of?",function(u){var c=this;return!u.$$is_class&&!u.$$is_module&&z.$raise(t("TypeError"),"class or module required"),c.$$class===u},1),v(R,"$instance_variable_defined?",function(u){var c=this;return u=I["$instance_variable_name!"](u),e.hasOwnProperty.call(c,u.substr(1))},1),v(R,"$instance_variable_get",function(u){var c=this;u=I["$instance_variable_name!"](u);var s=c[e.ivar(u.substr(1))];return s==null?o:s},1),v(R,"$instance_variable_set",function(u,c){var s=this;return u=I["$instance_variable_name!"](u),s[e.ivar(u.substr(1))]=c},2),v(R,"$remove_instance_variable",function(u){var c=this;u=I["$instance_variable_name!"](u);var s=e.ivar(u.substr(1)),i;return c.hasOwnProperty(s)?(i=c[s],delete c[s],i):z.$raise(t("NameError"),"instance variable "+u+" not defined")},1),v(R,"$instance_variables",function(){var u=this,c=[],s;for(var i in u)u.hasOwnProperty(i)&&i.charAt(0)!=="$"&&(i.substr(-1)==="$"?s=i.slice(0,i.length-1):s=i,c.push("@"+s));return c},0),v(R,"$Integer",function(u,c){var s,i,n;return u.$$is_string?u==="0"?0:(c===void 0?c=0:(c=q(c,t("Integer"),"to_int"),(c===1||c<0||c>36)&&z.$raise(t("ArgumentError"),"invalid radix "+c)),i=u.toLowerCase(),i=i.replace(/(\d)_(?=\d)/g,"$1"),i=i.replace(/^(\s*[+-]?)(0[bodx]?)/,function($,l,d){switch(d){case"0b":if(c===0||c===2)return c=2,l;case"0":case"0o":if(c===0||c===8)return c=8,l;case"0d":if(c===0||c===10)return c=10,l;case"0x":if(c===0||c===16)return c=16,l}z.$raise(t("ArgumentError"),'invalid value for Integer(): "'+u+'"')}),c=c===0?10:c,n="0-"+(c<=10?c-1:"9a-"+String.fromCharCode(97+(c-11))),new RegExp("^\\s*[+-]?["+n+"]+\\s*$").test(i)||z.$raise(t("ArgumentError"),'invalid value for Integer(): "'+u+'"'),s=parseInt(i,c),isNaN(s)&&z.$raise(t("ArgumentError"),'invalid value for Integer(): "'+u+'"'),s):(c!==void 0&&z.$raise(t("ArgumentError"),"base specified for non string value"),u===o&&z.$raise(t("TypeError"),"can't convert nil into Integer"),u.$$is_number?((u===1/0||u===-1/0||isNaN(u))&&z.$raise(t("FloatDomainError"),u),Math.floor(u)):u["$respond_to?"]("to_int")&&(s=u.$to_int(),s!==o)?s:I["$coerce_to!"](u,t("Integer"),"to_i"))},-2),v(R,"$Float",function(u){var c;return u===o&&z.$raise(t("TypeError"),"can't convert nil into Float"),u.$$is_string?(c=u.toString(),c=c.replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(c)?z.$Integer(c):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(c)||z.$raise(t("ArgumentError"),'invalid value for Float(): "'+u+'"'),parseFloat(c))):I["$coerce_to!"](u,t("Float"),"to_f")},1),v(R,"$Hash",function(u){return r(u["$nil?"]())||F(u,[])?U([],{}):B(t("Hash"),u)?u:I["$coerce_to!"](u,t("Hash"),"to_hash")},1),v(R,"$is_a?",function(u){var c=this;return!u.$$is_class&&!u.$$is_module&&z.$raise(t("TypeError"),"class or module required"),e.is_a(c,u)},1),v(R,"$itself",function(){var u=this;return u},0),v(R,"$lambda",function _(){var u=_.$$p||o;return delete _.$$p,e.lambda(u)},0),v(R,"$load",function(u){return u=I["$coerce_to!"](u,t("String"),"to_str"),e.load(u)},1),v(R,"$loop",function _(){var u,c=_.$$p||o,s=this,i=o;if(delete _.$$p,c===o)return J(s,"enum_for",["loop"],function(){return t(t("Float"),"INFINITY")},0);for(;r(!0);)try{e.yieldX(c,[])}catch(n){if(e.rescue(n,[t("StopIteration")])){i=n;try{return i.$result()}finally{e.pop_exception()}}else throw n}return s},0),v(R,"$nil?",function(){return!1},0),v(R,"$printf",function(u){var c,s,i=this;return c=e.slice.call(arguments),s=c,r(s["$any?"]())&&i.$print(J(i,"format",W(s))),o},-1),v(R,"$proc",function _(){var u=_.$$p||o;return delete _.$$p,r(u)||z.$raise(t("ArgumentError"),"tried to create Proc object without a block"),u.$$is_lambda=!1,u},0),v(R,"$puts",function(u){var c,s;return T.stdout==null&&(T.stdout=o),c=e.slice.call(arguments),s=c,J(T.stdout,"puts",W(s))},-1),v(R,"$p",function(u){var c,s;return c=e.slice.call(arguments),s=c,J(s,"each",[],function(n){return T.stdout==null&&(T.stdout=o),n==null&&(n=o),T.stdout.$puts(n.$inspect())},1),r(X(s.$length(),1))?s["$[]"](0):s},-1),v(R,"$print",function(u){var c,s;return T.stdout==null&&(T.stdout=o),c=e.slice.call(arguments),s=c,J(T.stdout,"print",W(s))},-1),v(R,"$readline",function(u){var c,s;return T.stdin==null&&(T.stdin=o),c=e.slice.call(arguments),s=c,J(T.stdin,"readline",W(s))},-1),v(R,"$warn",function(u,c){var s,i,n,$,l,d,m=this,k=o;if(T.VERBOSE==null&&(T.VERBOSE=o),T.stderr==null&&(T.stderr=o),s=e.slice.call(arguments),i=e.extract_kwargs(s),i==null)i=U([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n=s,$=i.$$smap.uplevel,$==null&&($=o),r($)&&($=I["$coerce_to!"]($,t("Integer"),"to_str"),r(L($,0))&&z.$raise(t("ArgumentError"),"negative level ("+$+")"),k=(d=(l=m.$caller(S($,1),1).$first(),l===o||l==null?o:J(l,"split",[":in `"])),d===o||d==null?o:J(d,"first",[])),r(k)&&(k=""+k+": "),n=J(n,"map",[],function(Y){return Y==null&&(Y=o),""+k+"warning: "+Y},1)),r(T.VERBOSE["$nil?"]())||r(n["$empty?"]())?o:J(T.stderr,"puts",W(n))},-1),v(R,"$raise",function(u,c,s){throw T["!"]==null&&(T["!"]=o),T["@"]==null&&(T["@"]=o),c==null&&(c=o),s==null&&(s=o),u==null&&T["!"]!==o?T["!"]:(u==null?u=t("RuntimeError").$new(""):C(u,"$to_str")?u=t("RuntimeError").$new(u.$to_str()):u.$$is_class&&C(u,"$exception")?u=u.$exception(c):u.$$is_exception||(u=t("TypeError").$new("exception class/object expected")),s!==o&&u.$set_backtrace(s),T["!"]!==o&&e.exceptions.push(T["!"]),T["!"]=u,T["@"]=u.$backtrace(),u)},-1),v(R,"$rand",function(u){return u===void 0?t(t("Random"),"DEFAULT").$rand():(u.$$is_number&&(u<0&&(u=Math.abs(u)),u%1!==0&&(u=u.$to_i()),u===0&&(u=void 0)),t(t("Random"),"DEFAULT").$rand(u))},-1),v(R,"$respond_to?",function(u,c){var s=this;c==null&&(c=!1);var i=s["$"+u];return typeof i=="function"&&!i.$$stub?!0:s["$respond_to_missing?"].$$pristine===!0?!1:s["$respond_to_missing?"](u,c)},-2),v(R,"$respond_to_missing?",function(u,c){return c==null&&(c=!1),!1},-2),I.$pristine(R,"respond_to?","respond_to_missing?"),v(R,"$require",function(u){return typeof u!="string"&&e.String&&e.Array&&(u=I["$coerce_to!"](u,t("String"),"to_str")),e.require(u)},1),v(R,"$require_relative",function(u){return I["$try_convert!"](u,t("String"),"to_str"),u=t("File").$expand_path(t("File").$join(e.current_file,"..",u)),e.require(u)},1),v(R,"$require_tree",function(u,c){var s;if(c==null)c=U([],{});else if(!c.$$is_hash)throw e.ArgumentError.$new("expected kwargs");s=c.$$smap.autoload,s==null&&(s=!1);var i=[];u=t("File").$expand_path(u),u=e.normalize(u),u==="."&&(u="");for(var n in e.modules)n["$start_with?"](u)&&(s?i.push([n,!0]):i.push([n,e.require(n)]));return i},-2),v(R,"$singleton_class",function(){var u=this;return e.get_singleton_class(u)},0),v(R,"$sleep",function(u){u==null&&(u=o),u===o&&z.$raise(t("TypeError"),"can't convert NilClass into time interval"),u.$$is_number||z.$raise(t("TypeError"),"can't convert "+u.$class()+" into time interval"),u<0&&z.$raise(t("ArgumentError"),"time interval must be positive");for(var c=e.global.performance?function(){return performance.now()}:function(){return new Date},s=c();c()-s<=u*1e3;);return Math.round(u)},-1),v(R,"$srand",function(u){return u==null&&(u=E("Random").$new_seed()),t("Random").$srand(u)},-1),v(R,"$String",function(u){var c=o;return r(c=I["$coerce_to?"](u,t("String"),"to_str"))?c:I["$coerce_to!"](u,t("String"),"to_s")},1),v(R,"$tap",function _(){var u=_.$$p||o,c=this;return delete _.$$p,e.yield1(u,c),c},0),v(R,"$to_proc",function(){var u=this;return u},0),v(R,"$to_s",function(){var u=this;return"#<"+u.$class()+":0x"+u.$__id__().$to_s(16)+">"},0),v(R,"$catch",function _(u){var c=_.$$p||o,s=o,i=o;delete _.$$p,u==null&&(u=o);try{return u=r(s=u)?s:w.$new(),e.yield1(c,u)}catch(n){if(e.rescue(n,[t("UncaughtThrowError")])){i=n;try{return F(i.$tag(),u)?i.$value():z.$raise()}finally{e.pop_exception()}}else throw n}},-1),v(R,"$throw",function(u,c){return c==null&&(c=o),z.$raise(t("UncaughtThrowError").$new(u,c))},-2),v(R,"$open",function _(u){var c=_.$$p||o,s,i;return delete _.$$p,s=e.slice.call(arguments),i=s,J(t("File"),"open",W(i),c.$to_proc())},-1),v(R,"$yield_self",function _(){var u=_.$$p||o,c=this;return delete _.$$p,u===o?J(c,"enum_for",["yield_self"],function(){return 1},0):e.yield1(u,c)},0),b(R,"fail","raise"),b(R,"kind_of?","is_a?"),b(R,"object_id","__id__"),b(R,"public_send","__send__"),b(R,"send","__send__"),b(R,"then","yield_self"),b(R,"to_enum","enum_for")}("::",A),function(D,G){var R=M(D,G,"Object");return delete w.$$prototype.$require,R.$include(z)}("::",null)};Opal.modules["corelib/main"]=function(e){var A=e.top,o=[],t=e.nil,r=e.def,q=e.Object,C=e.Kernel;return function(I,h){return r(I,"$to_s",function(){return"main"},0),r(I,"$include",function(z){return q.$include(z)},1),r(I,"$autoload",function(z){var T,U;return T=e.slice.call(arguments),U=T,e.Object.$autoload.apply(e.Object,U)},-1),r(I,"$using",function(z){return C.$raise("main.using is permitted only at toplevel")},1)}(e.get_singleton_class(A),o)};Opal.modules["corelib/error/errno"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.truthy,C=e.rb_plus,I=e.send2,h=e.find_super,v=e.def,z=e.klass;return function(T,U){var J=r(T,"Errno"),W=[J].concat(U),S=o,F=o;S=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2]],F=o;var B;for(B=0;B<S.length;B++)(function(){var X=S[B][0],L=S[B][1],w=S[B][2];F=e.klass(J,e.SystemCallError,X),F.errno=w,function(b,M){return v(b,"$new",function D(G){var R=D.$$p||o,f=this,E=o;return delete D.$$p,G==null&&(G=o),E=L,q(G)&&(E=C(E," - "+G)),I(f,h(f,"new",D,!1,!0),"new",[E],null)},-1)}(e.get_singleton_class(F),W)})()}("::",A),function(T,U,J){var W=z(T,U,"SystemCallError"),S=[W].concat(J);return v(W,"$errno",function(){var B=this;return B.$class().$errno()},0),function(F,B){return F.$attr_reader("errno")}(e.get_singleton_class(W),S)}("::",t("StandardError"),A)};Opal.modules["corelib/error"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.gvars,C=e.defs,I=e.send,h=e.to_a,v=e.def,z=e.truthy,T=e.hash2,U=e.Kernel,J=e.not,W=e.rb_plus,S=e.eqeq,F=e.Object,B=e.send2,X=e.find_super,L=e.module;return function(w,b,M){var D=r(w,b,"Exception"),G=[D].concat(M),R=e.$r(G),f=D.$$prototype;f.message=o,e.prop(D.$$prototype,"$$is_exception",!0);var E;C(D,"$new",function(u){var c,s,i=this;q["!"]==null&&(q["!"]=o),c=e.slice.call(arguments),s=c;var n=s.length>0?s[0]:o,$=new i.$$constructor(n);return $.name=i.$$name,$.message=n,$.cause=q["!"],e.send($,$.$initialize,s),e.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace($,E),$},-1),E=D.$new,C(D,"$exception",function(u){var c,s,i=this;return c=e.slice.call(arguments),s=c,I(i,"new",h(s))},-1),v(D,"$initialize",function(u){var c,s,i=this;return c=e.slice.call(arguments),s=c,i.message=s.length>0?s[0]:o},-1);function g(_){for(var u=[],c,s=0;s<_.length;s++){var i=_[s];!i||!i.$$is_string||((c=i.match(/^    at (.*?) \((.*?)\)$/))?u.push(c[2]+":in `"+c[1]+"'"):(c=i.match(/^    at (.*?)$/))?u.push(c[1]+":in `undefined'"):(c=i.match(/^  from (.*?)$/))?u.push(c[1]):(c=i.match(/^(.*?)@(.*?)$/))&&u.push(c[2]+":in `"+c[1]+"'"))}return u}return v(D,"$backtrace",function(){var u=this;if(u.backtrace)return u.backtrace;var c=u.stack;return typeof c!="undefined"&&c.$$is_string?u.backtrace=g(c.split(`
`).slice(0,15)):c?u.backtrace=g(c.slice(0,15)):[]},0),v(D,"$backtrace_locations",function(){var u,c=this;return c.backtrace_locations||(c.backtrace_locations=(u=c.$backtrace(),u===o||u==null?o:I(u,"map",[],function(i){return i==null&&(i=o),t(t(t("Thread"),"Backtrace"),"Location").$new(i)},1))),c.backtrace_locations},0),v(D,"$cause",function(){var u=this;return u.cause||o},0),v(D,"$exception",function(u){var c=this;if(u==null&&(u=o),u===o||c===u)return c;var s=c.$clone();return s.message=u,c.backtrace&&(s.backtrace=c.backtrace.$dup()),s.stack=c.stack,s.cause=c.cause,s},-1),v(D,"$message",function(){var u=this;return u.$to_s()},0),v(D,"$full_message",function(u){var c,s,i=this,n=o,$=o,l=o,d=o,m=o,k=o,x=o,Y=o,a=o;return q.stderr==null&&(q.stderr=o),u==null&&(u=o),z((c=R("Hash","skip_raise"))?"constant":o)?(u=T(["highlight","order"],{highlight:q.stderr["$tty?"](),order:"top"}).$merge(z(n=u)?n:T([],{})),s=[u["$[]"]("highlight"),u["$[]"]("order")],$=s[0],l=s[1],z([!0,!1]["$include?"]($))||U.$raise(t("ArgumentError"),"expected true or false as highlight: "+$),z(["top","bottom"]["$include?"](l))||U.$raise(t("ArgumentError"),"expected :top or :bottom as order: "+l),z($)?(d="\x1B[1;4m",m="\x1B[1m",k="\x1B[m"):d=m=k="",x=i.$backtrace().$dup(),(J(x)||z(x["$empty?"]()))&&(x=i.$caller()),Y=x.$shift(),a=""+Y+": ",a=W(a,""+m+i.$to_s()+" ("+d+i.$class()+k+m+")"+k+`
`),a=W(a,I(x,"map",[],function(p){return p==null&&(p=o),"	from "+p+`
`},1).$join()),z(i.$cause())&&(a=W(a,i.$cause().$full_message(T(["highlight"],{highlight:$})))),S(l,"bottom")&&(a=a.$split(`
`).$reverse().$join(`
`),a=W(""+m+"Traceback"+k+` (most recent call last):
`,a)),a):""+i.message+`
`+i.stack},-1),v(D,"$inspect",function(){var u=this,c=o;return c=u.$to_s(),z(c["$empty?"]())?u.$class().$to_s():"#<"+u.$class().$to_s()+": "+u.$to_s()+">"},0),v(D,"$set_backtrace",function(u){var c=this,s=!0,i,n;if(u===o)c.backtrace=o,c.stack="";else if(u.$$is_string)c.backtrace=[u],c.stack="  from "+u;else{if(u.$$is_array){for(i=0,n=u.length;i<n;i++)if(!u[i].$$is_string){s=!1;break}}else s=!1;s===!1&&U.$raise(t("TypeError"),"backtrace must be Array of String"),c.backtrace=u,c.stack=I(u,"map",[],function(l){return l==null&&(l=o),W("  from ",l)},1).join(`
`)}return u},1),v(D,"$to_s",function(){var u=this,c=o,s=o;return z(c=z(s=u.message)?u.message.$to_s():s)?c:u.$class().$to_s()},0)}("::",Error,A),r("::",t("Exception"),"ScriptError"),r("::",t("ScriptError"),"SyntaxError"),r("::",t("ScriptError"),"LoadError"),r("::",t("ScriptError"),"NotImplementedError"),r("::",t("Exception"),"SystemExit"),r("::",t("Exception"),"NoMemoryError"),r("::",t("Exception"),"SignalException"),r("::",t("SignalException"),"Interrupt"),r("::",t("Exception"),"SecurityError"),r("::",t("Exception"),"SystemStackError"),r("::",t("Exception"),"StandardError"),r("::",t("StandardError"),"EncodingError"),r("::",t("StandardError"),"ZeroDivisionError"),r("::",t("StandardError"),"NameError"),r("::",t("NameError"),"NoMethodError"),r("::",t("StandardError"),"RuntimeError"),r("::",t("RuntimeError"),"FrozenError"),r("::",t("StandardError"),"LocalJumpError"),r("::",t("StandardError"),"TypeError"),r("::",t("StandardError"),"ArgumentError"),r("::",t("ArgumentError"),"UncaughtThrowError"),r("::",t("StandardError"),"IndexError"),r("::",t("IndexError"),"StopIteration"),r("::",t("StopIteration"),"ClosedQueueError"),r("::",t("IndexError"),"KeyError"),r("::",t("StandardError"),"RangeError"),r("::",t("RangeError"),"FloatDomainError"),r("::",t("StandardError"),"IOError"),r("::",t("IOError"),"EOFError"),r("::",t("StandardError"),"SystemCallError"),r("::",t("StandardError"),"RegexpError"),r("::",t("StandardError"),"ThreadError"),r("::",t("StandardError"),"FiberError"),F.$autoload("Errno","corelib/error/errno"),function(w,b){var M=r(w,b,"UncaughtThrowError"),D=M.$$prototype;return D.tag=o,M.$attr_reader("tag","value"),v(M,"$initialize",function G(R,f){var E=G.$$p||o,g=this;return delete G.$$p,f==null&&(f=o),g.tag=R,g.value=f,B(g,X(g,"initialize",G,!1,!0),"initialize",["uncaught throw "+g.tag.$inspect()],null)},-2)}("::",t("ArgumentError")),function(w,b){var M=r(w,b,"NameError");return M.$attr_reader("name"),v(M,"$initialize",function D(G,R){var f=D.$$p||o,E=this;return delete D.$$p,R==null&&(R=o),B(E,X(E,"initialize",D,!1,!0),"initialize",[G],null),E.name=R},-2)}("::",null),function(w,b){var M=r(w,b,"NoMethodError");return M.$attr_reader("args"),v(M,"$initialize",function D(G,R,f){var E=D.$$p||o,g=this;return delete D.$$p,R==null&&(R=o),f==null&&(f=[]),B(g,X(g,"initialize",D,!1,!0),"initialize",[G,R],null),g.args=f},-2)}("::",null),function(w,b){var M=r(w,b,"StopIteration");return M.$attr_reader("result")}("::",null),function(w,b){var M=r(w,b,"KeyError"),D=M.$$prototype;return D.receiver=D.key=o,v(M,"$initialize",function G(R,f){var E,g,_=G.$$p||o,u=this;if(delete G.$$p,f==null)f=T([],{});else if(!f.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return E=f.$$smap.receiver,E==null&&(E=o),g=f.$$smap.key,g==null&&(g=o),B(u,X(u,"initialize",G,!1,!0),"initialize",[R],null),u.receiver=E,u.key=g},-2),v(M,"$receiver",function(){var R=this,f=o;return z(f=R.receiver)?f:U.$raise(t("ArgumentError"),"no receiver is available")},0),v(M,"$key",function(){var R=this,f=o;return z(f=R.key)?f:U.$raise(t("ArgumentError"),"no key is available")},0)}("::",null),function(w,b){var M=L(w,"JS"),D=[M].concat(b);return r(D[0],null,"Error"),o}("::",A)};Opal.modules["corelib/constants"]=function(e){var A=e.nil,o=e.$$$,t=e.const_set;return t("::","RUBY_PLATFORM","opal"),t("::","RUBY_ENGINE","opal"),t("::","RUBY_VERSION","3.1.0"),t("::","RUBY_ENGINE_VERSION","1.4.1"),t("::","RUBY_RELEASE_DATE","2022-01-12"),t("::","RUBY_PATCHLEVEL",0),t("::","RUBY_REVISION","0"),t("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2021 Adam Beynon and the Opal contributors"),t("::","RUBY_DESCRIPTION","opal "+o("RUBY_ENGINE_VERSION")+" ("+o("RUBY_RELEASE_DATE")+" revision "+o("RUBY_REVISION")+")")};Opal.modules["opal/base"]=function(e){var A=e.nil,o=e.Object;return o.$require("corelib/runtime"),o.$require("corelib/helpers"),o.$require("corelib/module"),o.$require("corelib/class"),o.$require("corelib/basic_object"),o.$require("corelib/kernel"),o.$require("corelib/main"),o.$require("corelib/error"),o.$require("corelib/constants")};Opal.modules["corelib/nil"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.Kernel,C=e.def,I=e.hash2,h=e.NilClass,v=e.truthy,z=e.rb_gt,T=e.alias;return function(U,J,W){var S=r(U,J,"NilClass"),F=[S].concat(W);return S.$$prototype.$$meta=S,function(B,X){return C(B,"$allocate",function(){var w=this;return q.$raise(t("TypeError"),"allocator undefined for "+w.$name())},0),e.udef(B,"$new"),o}(e.get_singleton_class(S),F),C(S,"$!",function(){return!0},0),C(S,"$&",function(X){return!1},1),C(S,"$|",function(X){return X!==!1&&X!==o},1),C(S,"$^",function(X){return X!==!1&&X!==o},1),C(S,"$==",function(X){return X===o},1),C(S,"$dup",function(){return o},0),C(S,"$clone",function(X){var L;if(X==null)X=I([],{});else if(!X.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return L=X.$$smap.freeze,L==null&&(L=!0),o},-1),C(S,"$inspect",function(){return"nil"},0),C(S,"$nil?",function(){return!0},0),C(S,"$singleton_class",function(){return h},0),C(S,"$to_a",function(){return[]},0),C(S,"$to_h",function(){return e.hash()},0),C(S,"$to_i",function(){return 0},0),C(S,"$to_s",function(){return""},0),C(S,"$to_c",function(){return t("Complex").$new(0,0)},0),C(S,"$rationalize",function(X){var L,w;return L=e.slice.call(arguments),w=L,v(z(w.$length(),1))&&q.$raise(t("ArgumentError")),q.$Rational(0,1)},-1),C(S,"$to_r",function(){return q.$Rational(0,1)},0),C(S,"$instance_variables",function(){return[]},0),T(S,"to_f","to_i")}("::",null,A)};Opal.modules["corelib/boolean"]=function(e){"use strict";var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.Kernel,C=e.def,I=e.hash2,h=e.truthy,v=e.send2,z=e.find_super,T=e.to_a,U=e.alias;return function(J,W,S){var F=r(J,W,"Boolean"),B=[F].concat(S);e.prop(F.$$prototype,"$$is_boolean",!0);for(var X=["$$class","$$meta"],L=0;L<X.length;L++)Object.defineProperty(F.$$prototype,X[L],{configurable:!0,enumerable:!1,get:function(){return this==!0?e.TrueClass:this==!1?e.FalseClass:e.Boolean}});return Object.defineProperty(F.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return this==!0?2:this==!1?0:o}}),function(w,b){return C(w,"$allocate",function(){var D=this;return q.$raise(t("TypeError"),"allocator undefined for "+D.$name())},0),e.udef(w,"$new"),o}(e.get_singleton_class(F),B),C(F,"$__id__",function(){var b=this;return b.valueOf()?2:0},0),C(F,"$!",function(){var b=this;return b!=!0},0),C(F,"$&",function(b){var M=this;return M==!0?b!==!1&&b!==o:!1},1),C(F,"$|",function(b){var M=this;return M==!0?!0:b!==!1&&b!==o},1),C(F,"$^",function(b){var M=this;return M==!0?b===!1||b===o:b!==!1&&b!==o},1),C(F,"$==",function(b){var M=this;return M==!0===b.valueOf()},1),C(F,"$singleton_class",function(){var b=this;return b.$$meta},0),C(F,"$to_s",function(){var b=this;return b==!0?"true":"false"},0),C(F,"$dup",function(){var b=this;return b},0),C(F,"$clone",function(b){var M,D=this;if(b==null)b=I([],{});else if(!b.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return M=b.$$smap.freeze,M==null&&(M=!0),D},-1),C(F,"$method_missing",function w(b,M){var D=w.$$p||o,G,R,f=this;delete w.$$p,G=e.slice.call(arguments,1),R=G;var E=f.$$class.$$prototype["$"+b];return h(typeof E!="undefined"&&!E.$$stub)||v(f,z(f,"method_missing",w,!1,!0),"method_missing",[b].concat(T(R)),D),e.send(f,E,R,D)},-2),C(F,"$respond_to_missing?",function(b,M){var D=this;M==null&&(M=!1);var G=D.$$class.$$prototype["$"+b];return typeof G!="undefined"&&!G.$$stub},-2),U(F,"eql?","=="),U(F,"equal?","=="),U(F,"inspect","to_s"),U(F,"object_id","__id__")}("::",Boolean,A),r("::",t("Boolean"),"TrueClass"),r("::",t("Boolean"),"FalseClass"),o};Opal.modules["corelib/comparable"]=function(e){var A=e.nil,o=e.$$$,t=e.truthy,r=e.module,q=e.rb_gt,C=e.rb_lt,I=e.eqeqeq,h=e.Kernel,v=e.def;return function(z){var T=r(z,"Comparable"),U=A;function J(F){return e.is_a(F,e.Integer)?F:q(F,0)?1:C(F,0)?-1:0}function W(F,B){var X;I(A,U=B)||I(!0,U)||I(!1,U)||I(o("Integer"),U)||I(o("Float"),U)?X=B.$inspect():X=B.$$class,h.$raise(o("ArgumentError"),"comparison of "+F.$class()+" with "+X+" failed")}function S(F,B){var X=F["$<=>"](B);return t(X)||W(F,B),J(X)}return v(T,"$==",function(B){var X=this,L=A;return t(X["$equal?"](B))?!0:X["$<=>"]==e.Kernel["$<=>"]?!1:X.$$comparable?(delete X.$$comparable,!1):t(L=X["$<=>"](B))?J(L)==0:!1},1),v(T,"$>",function(B){var X=this;return S(X,B)>0},1),v(T,"$>=",function(B){var X=this;return S(X,B)>=0},1),v(T,"$<",function(B){var X=this;return S(X,B)<0},1),v(T,"$<=",function(B){var X=this;return S(X,B)<=0},1),v(T,"$between?",function(B,X){var L=this;return!(C(L,B)||q(L,X))},2),v(T,"$clamp",function(B,X){var L=this;X==null&&(X=A);var w,b;if(X===A&&(e.is_a(B,e.Range)||h.$raise(o("TypeError"),"wrong argument type "+B.$class()+" (expected Range)"),b=B.excl,X=B.end,B=B.begin,X!==A&&b&&h.$raise(o("ArgumentError"),"cannot clamp with an exclusive range")),B!==A&&X!==A&&S(B,X)>0&&h.$raise(o("ArgumentError"),"min argument must be smaller than max argument"),B!==A){if(w=S(L,B),w==0)return L;if(w<0)return B}return X!==A&&(w=S(L,X),w>0)?X:L},-2)}("::")};Opal.modules["corelib/regexp"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.coerce_to,q=e.klass,C=e.const_set,I=e.send2,h=e.find_super,v=e.def,z=e.truthy,T=e.gvars,U=e.Kernel,J=e.Opal,W=e.alias,S=e.send,F=e.hash2,B=e.rb_plus,X=e.rb_ge,L=e.to_a,w=e.eqeqeq,b=e.rb_minus;return q("::",t("StandardError"),"RegexpError"),function(M,D,G){var R=q(M,D,"Regexp"),f=[R].concat(G),E=e.$r(f);return C(R,"IGNORECASE",1),C(R,"EXTENDED",2),C(R,"MULTILINE",4),e.prop(R.$$prototype,"$$is_regexp",!0),function(g,_){var u=[g].concat(_),c=e.$r(u);return v(g,"$allocate",function s(){var i=s.$$p||o,n=this,$=o;return delete s.$$p,$=I(n,h(n,"allocate",s,!1,!0),"allocate",[],i),$.uninitialized=!0,$},0),v(g,"$escape",function(i){return e.escape_regexp(i)},1),v(g,"$last_match",function(i){return T["~"]==null&&(T["~"]=o),i==null&&(i=o),z(i["$nil?"]())?T["~"]:z(T["~"])?T["~"]["$[]"](i):o},-1),v(g,"$union",function(i){var n,$,l=this;n=e.slice.call(arguments),$=n;var d,m,k,x,Y;if($.length==0)return/(?!)/;if($.length==1&&$[0].$$is_regexp)return $[0];d=$[0].$$is_array,$.length>1&&d&&U.$raise(t("TypeError"),"no implicit conversion of Array into String"),d&&($=$[0]),x=void 0,m=[];for(var a=0;a<$.length;a++)k=$[a],k.$$is_string?m.push(l.$escape(k)):k.$$is_regexp?(Y=k.$options(),x!=null&&x!=Y&&U.$raise(t("TypeError"),"All expressions must use the same options"),x=Y,m.push("("+k.source+")")):m.push(l.$escape(k.$to_str()));return l.$new(m.$join("|"),x)},-1),v(g,"$new",function(i,n){if(i.$$is_regexp)return new RegExp(i);if(i=J["$coerce_to!"](i,t("String"),"to_str"),i.charAt(i.length-1)==="\\"&&i.charAt(i.length-2)!=="\\"&&U.$raise(t("RegexpError"),"too short escape sequence: /"+i+"/"),n===void 0||n["$!"]())return new RegExp(i);if(n.$$is_number){var $="";c("IGNORECASE")&n&&($+="i"),c("MULTILINE")&n&&($+="m"),n=$}else n="i";return new RegExp(i,n)},-2),W(g,"compile","new"),W(g,"quote","escape")}(e.get_singleton_class(R),f),v(R,"$==",function(_){var u=this;return _ instanceof RegExp&&u.toString()===_.toString()},1),v(R,"$===",function(_){var u=this;return u.$match(J["$coerce_to?"](_,t("String"),"to_str"))!==o},1),v(R,"$=~",function(_){var u=this,c=o;return T["~"]==null&&(T["~"]=o),z(c=u.$match(_))?T["~"].$begin(0):c},1),v(R,"$inspect",function(){var _=this,u=/^\/(.*)\/([^\/]*)$/,c=_.toString(),s=u.exec(c);if(s){for(var i=s[1],n=s[2],$=i.split(""),l=$.length,d=!1,m="",k=0;k<l;k++){var x=$[k];!d&&x=="/"&&(m=m.concat("\\")),m=m.concat(x),x=="\\"?d?d=!1:d=!0:d=!1}return"/"+m+"/"+n}else return c},0),v(R,"$match",function g(_,u){var c=g.$$p||o,s=this;if(T["~"]==null&&(T["~"]=o),delete g.$$p,s.uninitialized&&U.$raise(t("TypeError"),"uninitialized Regexp"),u===void 0){if(_===o)return T["~"]=o;var i=s.exec(r(_,t("String"),"to_str"));return i?(T["~"]=t("MatchData").$new(s,i),c===o?T["~"]:e.yield1(c,T["~"])):T["~"]=o}if(u=r(u,t("Integer"),"to_int"),_===o||(_=r(_,t("String"),"to_str"),u<0&&(u+=_.length,u<0)))return T["~"]=o;for(var n,$=e.global_regexp(s);;){if(n=$.exec(_),n===null)return T["~"]=o;if(n.index>=u)return T["~"]=t("MatchData").$new($,n),c===o?T["~"]:e.yield1(c,T["~"]);$.lastIndex=n.index+1}},-2),v(R,"$match?",function(_,u){var c=this;if(c.uninitialized&&U.$raise(t("TypeError"),"uninitialized Regexp"),u===void 0)return _===o?!1:c.test(r(_,t("String"),"to_str"));if(u=r(u,t("Integer"),"to_int"),_===o||(_=r(_,t("String"),"to_str"),u<0&&(u+=_.length,u<0)))return!1;var s,i=e.global_regexp(c);return s=i.exec(_),!(s===null||s.index<u)},-2),v(R,"$names",function(){var _=this;return S(_.$source().$scan(/\(?<(\w+)>/,F(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()},0),v(R,"$named_captures",function(){var _=this;return S(S(S(_.$source().$scan(/\(?<(\w+)>/,F(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(c){return c==null&&(c=o),S(c,"map",[],function(i){return i==null&&(i=o),B(i.$last(),1)},1)},1)},0),v(R,"$~",function(){var _=this;return T._==null&&(T._=o),_["$=~"](T._)},0),v(R,"$source",function(){var _=this;return _.source},0),v(R,"$options",function(){var _=this;_.uninitialized&&U.$raise(t("TypeError"),"uninitialized Regexp");var u=0;return _.multiline&&(u|=E("MULTILINE")),_.ignoreCase&&(u|=E("IGNORECASE")),u},0),v(R,"$casefold?",function(){var _=this;return _.ignoreCase},0),W(R,"eql?","=="),W(R,"to_s","source")}("::",RegExp,A),function(M,D,G){var R=q(M,D,"MatchData"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.matches=o,R.$attr_reader("post_match","pre_match","regexp","string"),v(R,"$initialize",function(u,c,s){var i,n=this;if(s==null)s=F([],{});else if(!s.$$is_hash)throw e.ArgumentError.$new("expected kwargs");i=s.$$smap.no_matchdata,i==null&&(i=!1),z(i)||(T["~"]=n),n.regexp=u,n.begin=c.index,n.string=c.input,n.pre_match=c.input.slice(0,c.index),n.post_match=c.input.slice(c.index+c[0].length),n.matches=[];for(var $=0,l=c.length;$<l;$++){var d=c[$];d==null?n.matches.push(o):n.matches.push(d)}},-3),v(R,"$match",function(u){var c=this,s=o;return z(s=c["$[]"](u))?s:z(u["$is_a?"](E("Integer")))&&z(X(u,c.$length()))?U.$raise(t("IndexError"),"index "+u+" out of matches"):o},1),v(R,"$match_length",function(u){var c,s=this;return c=s.$match(u),c===o||c==null?o:S(c,"length",[])},1),v(R,"$[]",function(u){var c,s,i=this;return c=e.slice.call(arguments),s=c,s[0].$$is_string?(i.$regexp().$names()["$include?"](s["$[]"](0))["$!"]()&&U.$raise(t("IndexError"),"undefined group name reference: "+s["$[]"](0)),i.$named_captures()["$[]"](s["$[]"](0))):S(i.matches,"[]",L(s))},-1),v(R,"$offset",function(u){var c=this;return u!==0&&U.$raise(t("ArgumentError"),"MatchData#offset only supports 0th element"),[c.begin,c.begin+c.matches[u].length]},1),v(R,"$==",function(u){var c=this,s=o,i=o,n=o,$=o;return w(t("MatchData"),u)?z(s=z(i=z(n=z($=c.string==u.string)?c.regexp.toString()==u.regexp.toString():$)?c.pre_match==u.pre_match:n)?c.post_match==u.post_match:i)?c.begin==u.begin:s:!1},1),v(R,"$begin",function(u){var c=this;return u!==0&&U.$raise(t("ArgumentError"),"MatchData#begin only supports 0th element"),c.begin},1),v(R,"$end",function(u){var c=this;return u!==0&&U.$raise(t("ArgumentError"),"MatchData#end only supports 0th element"),c.begin+c.matches[u].length},1),v(R,"$captures",function(){var u=this;return u.matches.slice(1)},0),v(R,"$named_captures",function(){var u=this,c=o;return c=u.$captures(),S(u.$regexp().$named_captures(),"transform_values",[],function(i){return i==null&&(i=o),c["$[]"](b(i.$last(),1))},1)},0),v(R,"$names",function(){var u=this;return u.$regexp().$names()},0),v(R,"$inspect",function(){var u=this,c="#<MatchData "+u.matches[0].$inspect();if(u.$regexp().$names()["$empty?"]())for(var s=1,i=u.matches.length;s<i;s++)c+=" "+s+":"+u.matches[s].$inspect();else S(u.$named_captures(),"each",[],function($,l){return $==null&&($=o),l==null&&(l=o),c+=" "+$+":"+l.$inspect()},2);return c+">"},0),v(R,"$length",function(){var u=this;return u.matches.length},0),v(R,"$to_a",function(){var u=this;return u.matches},0),v(R,"$to_s",function(){var u=this;return u.matches[0]},0),v(R,"$values_at",function(u){var c,s,i=this;c=e.slice.call(arguments),s=c;var n,$,l,d=[];for(n=0;n<s.length;n++){if(s[n].$$is_range&&($=s[n].$to_a(),$.unshift(n,1),Array.prototype.splice.apply(s,$)),l=J["$coerce_to!"](s[n],t("Integer"),"to_int"),l<0&&(l+=i.matches.length,l<0)){d.push(o);continue}d.push(i.matches[l])}return d},-1),W(R,"eql?","=="),W(R,"size","length")}(A[0],null,A)};Opal.modules["corelib/string"]=function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.coerce_to,I=e.respond_to,h=e.global_multiline_regexp,v=e.klass,z=e.def,T=e.Opal,U=e.defs,J=e.send,W=e.to_a,S=e.hash2,F=e.eqeqeq,B=e.Kernel,X=e.truthy,L=e.gvars,w=e.rb_divide,b=e.rb_plus,M=e.alias,D=e.const_set;return A.$require("corelib/comparable"),A.$require("corelib/regexp"),function(G,R,f){var E=v(G,R,"String"),g=[E].concat(f),_=e.$r(g);E.$include(q("Comparable")),e.prop(E.$$prototype,"$$is_string",!0),e.prop(E.$$prototype,"$$cast",function(c){var s=this.$$class;return s.$$constructor===String?c:new s.$$constructor(c)}),z(E,"$__id__",function(){var s=this;return s.toString()},0),U(E,"$try_convert",function(s){return T["$coerce_to?"](s,q("String"),"to_str")},1),U(E,"$new",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;var l=n[0]||"",d=n[n.length-1];return l=C(l,q("String"),"to_str"),d&&d.$$is_hash&&d.$$smap.encoding&&(l=l.$force_encoding(d.$$smap.encoding)),l=new $.$$constructor(l),l.$initialize.$$pristine||J(l,"initialize",W(n)),l},-1),z(E,"$initialize",function(s,i){var n,$,l,d,m;if(n=e.slice.call(arguments),$=e.extract_kwargs(n),$==null)$=S([],{});else if(!$.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n.length>0&&(l=n.shift()),d=$.$$smap.encoding,d==null&&(d=r),m=$.$$smap.capacity,m==null&&(m=r),r},-1),z(E,"$%",function(s){var i=this;return F(q("Array"),s)?J(i,"format",[i].concat(W(s))):i.$format(i,s)},1),z(E,"$*",function(s){var i=this;if(s=C(s,q("Integer"),"to_int"),s<0&&B.$raise(q("ArgumentError"),"negative argument"),s===0)return i.$$cast("");var n="",$=i.toString();for($.length*s>=1<<28&&B.$raise(q("RangeError"),"multiply count must not overflow maximum string size");(s&1)===1&&(n+=$),s>>>=1,s!==0;)$+=$;return i.$$cast(n)},1),z(E,"$+",function(s){var i=this;if(s=C(s,q("String"),"to_str"),s==""&&i.$$class===e.String)return i;if(i==""&&s.$$class===e.String)return s;var n=i+s;return i.encoding===n.encoding&&s.encoding===n.encoding||i.encoding.name==="UTF-8"||s.encoding.name==="UTF-8"?n:e.enc(n,i.encoding)},1),z(E,"$<=>",function(s){var i=this;if(X(s["$respond_to?"]("to_str")))return s=s.$to_str().$to_s(),i>s?1:i<s?-1:0;var n=s["$<=>"](i);return n===r?r:n>0?-1:n<0?1:0},1),z(E,"$==",function(s){var i=this;return s.$$is_string?i.toString()===s.toString():I(s,"$to_str")?s["$=="](i):!1},1),z(E,"$=~",function(s){var i=this;return s.$$is_string&&B.$raise(q("TypeError"),"type mismatch: String given"),s["$=~"](i)},1),z(E,"$[]",function(s,i){var n=this,$=n.length,l,d;if(s.$$is_range)return l=s.excl,d=s,i=s.end===r?-1:C(s.end,q("Integer"),"to_int"),s=s.begin===r?0:C(s.begin,q("Integer"),"to_int"),Math.abs(s)>$?r:(s<0&&(s+=$),i<0&&(i+=$),(!l||d.end===r)&&(i+=1),i=i-s,i<0&&(i=0),n.$$cast(n.substr(s,i)));if(s.$$is_string)return i!=null&&B.$raise(q("TypeError")),n.indexOf(s)!==-1?n.$$cast(s):r;if(s.$$is_regexp){var m=n.match(s);return m===null?(L["~"]=r,r):(L["~"]=q("MatchData").$new(s,m),i==null?n.$$cast(m[0]):(i=C(i,q("Integer"),"to_int"),i<0&&-i<m.length?n.$$cast(m[i+=m.length]):i>=0&&i<m.length?n.$$cast(m[i]):r))}return s=C(s,q("Integer"),"to_int"),s<0&&(s+=$),i==null?s>=$||s<0?r:n.$$cast(n.substr(s,1)):(i=C(i,q("Integer"),"to_int"),i<0||s>$||s<0?r:n.$$cast(n.substr(s,i)))},-2),z(E,"$b",function(){var s=this;return new String(s).$force_encoding("binary")},0),z(E,"$capitalize",function(){var s=this;return s.$$cast(s.charAt(0).toUpperCase()+s.substr(1).toLowerCase())},0),z(E,"$casecmp",function(s){var i=this;if(!X(s["$respond_to?"]("to_str")))return r;s=C(s,q("String"),"to_str").$to_s();var n=/^[\x00-\x7F]*$/;return n.test(i)&&n.test(s)&&(i=i.toLowerCase(),s=s.toLowerCase()),i["$<=>"](s)},1),z(E,"$casecmp?",function(s){var i=this,n=i.$casecmp(s);return n===r?r:n===0},1),z(E,"$center",function(s,i){var n=this;if(i==null&&(i=" "),s=C(s,q("Integer"),"to_int"),i=C(i,q("String"),"to_str").$to_s(),X(i["$empty?"]())&&B.$raise(q("ArgumentError"),"zero width padding"),X(s<=n.length))return n;var $=n.$ljust(w(b(s,n.length),2).$ceil(),i),l=n.$rjust(w(b(s,n.length),2).$floor(),i);return n.$$cast(l+$.slice(n.length))},-2),z(E,"$chomp",function(s){var i=this;if(L["/"]==null&&(L["/"]=r),s==null&&(s=L["/"]),X(s===r||i.length===0))return i;s=T["$coerce_to!"](s,q("String"),"to_str").$to_s();var n;if(s===`
`)n=i.replace(/\r?\n?$/,"");else if(s==="")n=i.replace(/(\r?\n)+$/,"");else if(i.length>=s.length){var $=i.substr(i.length-s.length,s.length);$===s&&(n=i.substr(0,i.length-s.length))}return n!=null?i.$$cast(n):i},-1),z(E,"$chop",function(){var s=this,i=s.length,n;return i<=1?n="":s.charAt(i-1)===`
`&&s.charAt(i-2)==="\r"?n=s.substr(0,i-2):n=s.substr(0,i-1),s.$$cast(n)},0),z(E,"$chr",function(){var s=this;return s.charAt(0)},0),z(E,"$clone",function(){var s=this,i=r;return i=new String(s),i.$copy_singleton_methods(s),i.$initialize_clone(s),i},0),z(E,"$dup",function(){var s=this,i=r;return i=new String(s),i.$initialize_dup(s),i},0),z(E,"$count",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i,n.length===0&&B.$raise(q("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var l=u(n);return l===null?0:$.length-$.replace(new RegExp(l,"g"),"").length},-1),z(E,"$delete",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i,n.length===0&&B.$raise(q("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var l=u(n);return l===null?$:$.$$cast($.replace(new RegExp(l,"g"),""))},-1),z(E,"$delete_prefix",function(s){var i=this;return s.$$is_string||(s=C(s,q("String"),"to_str")),i.slice(0,s.length)===s?i.$$cast(i.slice(s.length)):i},1),z(E,"$delete_suffix",function(s){var i=this;return s.$$is_string||(s=C(s,q("String"),"to_str")),i.slice(i.length-s.length)===s?i.$$cast(i.slice(0,i.length-s.length)):i},1),z(E,"$downcase",function(){var s=this;return s.$$cast(s.toLowerCase())},0),z(E,"$each_line",function c(s,i){var n=c.$$p||r,$,l,d,m,k=this;if(L["/"]==null&&(L["/"]=r),delete c.$$p,$=e.slice.call(arguments),l=e.extract_kwargs($),l==null)l=S([],{});else if(!l.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if($.length>0&&(d=$.shift()),d==null&&(d=L["/"]),m=l.$$smap.chomp,m==null&&(m=!1),n===r)return k.$enum_for("each_line",d,S(["chomp"],{chomp:m}));if(d===r)return e.yield1(n,k),k;d=C(d,q("String"),"to_str");var x,Y,a,N,p,H,Q,ee;if(d.length===0){for(x=k.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/),Y=0,a=x.length;Y<a;Y+=2)(x[Y]||x[Y+1])&&(ee=(x[Y]||"")+(x[Y+1]||""),m&&(ee=ee.$chomp(`
`)),e.yield1(n,ee));return k}for(p=k.$chomp(d),H=k.length!=p.length,Q=p.split(d),Y=0,N=Q.length;Y<N;Y++)ee=Q[Y],(Y<N-1||H)&&(ee+=d),m&&(ee=ee.$chomp(d)),e.yield1(n,ee);return k},-1),z(E,"$empty?",function(){var s=this;return s.length===0},0),z(E,"$end_with?",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;for(var l=0,d=n.length;l<d;l++){var m=C(n[l],q("String"),"to_str").$to_s();if($.length>=m.length&&$.substr($.length-m.length,m.length)==m)return!0}return!1},-1),z(E,"$gsub",function c(s,i){var n=c.$$p||r,$=this;if(delete c.$$p,i===void 0&&n===r)return $.$enum_for("gsub",s);var l="",d=r,m=0,k,x;s.$$is_regexp?s=h(s):(s=C(s,q("String"),"to_str"),s=new RegExp(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));for(var Y;;){if(k=s.exec($),k===null){L["~"]=r,l+=$.slice(m);break}d=q("MatchData").$new(s,k),i===void 0?(Y=s.lastIndex,x=n(k[0]),s.lastIndex=Y):i.$$is_hash?x=i["$[]"](k[0]).$to_s():(i.$$is_string||(i=C(i,q("String"),"to_str")),x=i.replace(/([\\]+)([0-9+&`'])/g,function(a,N,p){if(N.length%2===0)return a;switch(p){case"+":for(var H=k.length-1;H>0;H--)if(k[H]!==void 0)return N.slice(1)+k[H];return"";case"&":return N.slice(1)+k[0];case"`":return N.slice(1)+$.slice(0,k.index);case"'":return N.slice(1)+$.slice(k.index+k[0].length);default:return N.slice(1)+(k[p]||"")}}).replace(/\\\\/g,"\\")),s.lastIndex===k.index?(l+=$.slice(m,k.index)+x+($[k.index]||""),s.lastIndex+=1):l+=$.slice(m,k.index)+x,m=s.lastIndex}return L["~"]=d,$.$$cast(l)},-2),z(E,"$hash",function(){var s=this;return s.toString()},0),z(E,"$hex",function(){var s=this;return s.$to_i(16)},0),z(E,"$include?",function(s){var i=this;return s.$$is_string||(s=C(s,q("String"),"to_str")),i.indexOf(s)!==-1},1),z(E,"$index",function(s,i){var n=this,$,l,d;if(i===void 0)i=0;else if(i=C(i,q("Integer"),"to_int"),i<0&&(i+=n.length,i<0))return r;if(s.$$is_regexp)for(d=h(s);;){if(l=d.exec(n),l===null){L["~"]=r,$=-1;break}if(l.index>=i){L["~"]=q("MatchData").$new(d,l),$=l.index;break}d.lastIndex=l.index+1}else s=C(s,q("String"),"to_str"),s.length===0&&i>n.length?$=-1:$=n.indexOf(s,i);return $===-1?r:$},-2),z(E,"$inspect",function(){var s=this,i=/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\x07":"\\a","\x1B":"\\e","\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"},$=s.replace(i,function(l){return n[l]?n[l]:(l=l.charCodeAt(0),l<=255&&(s.encoding["$binary?"]()||s.internal_encoding["$binary?"]())?"\\x"+("00"+l.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+l.toString(16).toUpperCase()).slice(-4))});return'"'+$.replace(/\#[\$\@\{]/g,"\\$&")+'"'},0),z(E,"$intern",function(){var s=this;return s.toString()},0),z(E,"$lines",function c(s,i){var n=c.$$p||r,$,l,d,m,k=this,x=r;if(L["/"]==null&&(L["/"]=r),delete c.$$p,$=e.slice.call(arguments),l=e.extract_kwargs($),l==null)l=S([],{});else if(!l.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return $.length>0&&(d=$.shift()),d==null&&(d=L["/"]),m=l.$$smap.chomp,m==null&&(m=!1),x=J(k,"each_line",[d,S(["chomp"],{chomp:m})],n.$to_proc()),X(n)?k:x.$to_a()},-1),z(E,"$ljust",function(s,i){var n=this;if(i==null&&(i=" "),s=C(s,q("Integer"),"to_int"),i=C(i,q("String"),"to_str").$to_s(),X(i["$empty?"]())&&B.$raise(q("ArgumentError"),"zero width padding"),X(s<=n.length))return n;var $=-1,l="";for(s-=n.length;++$<s;)l+=i;return n.$$cast(n+l.slice(0,s))},-2),z(E,"$lstrip",function(){var s=this;return s.replace(/^[\u0000\s]*/,"")},0),z(E,"$ascii_only?",function(){var s=this;return s.encoding.ascii?/^[\x00-\x7F]*$/.test(s):!1},0),z(E,"$match",function c(s,i){var n=c.$$p||r,$=this;return delete c.$$p,(F(_("String"),s)||X(s["$respond_to?"]("to_str")))&&(s=q("Regexp").$new(s.$to_str())),F(q("Regexp"),s)||B.$raise(q("TypeError"),"wrong argument type "+s.$class()+" (expected Regexp)"),J(s,"match",[$,i],n.$to_proc())},-2),z(E,"$match?",function(s,i){var n=this;return(F(_("String"),s)||X(s["$respond_to?"]("to_str")))&&(s=q("Regexp").$new(s.$to_str())),F(q("Regexp"),s)||B.$raise(q("TypeError"),"wrong argument type "+s.$class()+" (expected Regexp)"),s["$match?"](n,i)},-2),z(E,"$next",function(){var s=this,i=s.length;if(i===0)return s.$$cast("");for(var n=s,$=s.search(/[a-zA-Z0-9]/),l=!1,d;i--;){if(d=s.charCodeAt(i),d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122)switch(d){case 57:l=!0,d=48;break;case 90:l=!0,d=65;break;case 122:l=!0,d=97;break;default:l=!1,d+=1}else $===-1?d===255?(l=!0,d=0):(l=!1,d+=1):l=!0;if(n=n.slice(0,i)+String.fromCharCode(d)+n.slice(i+1),l&&(i===0||i===$)){switch(d){case 65:break;case 97:break;default:d+=1}i===0?n=String.fromCharCode(d)+n:n=n.slice(0,i)+String.fromCharCode(d)+n.slice(i),l=!1}if(!l)break}return s.$$cast(n)},0),z(E,"$oct",function(){var s=this,i,n=s,$=8;return/^\s*_/.test(n)?0:(n=n.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(l,d,m,k){switch(k.charAt(0)){case"+":case"-":return l;case"0":if(k.charAt(1)==="x"&&m==="0x")return l}switch(m){case"0b":$=2;break;case"0":case"0o":$=8;break;case"0d":$=10;break;case"0x":$=16;break}return d+k}),i=parseInt(n.replace(/_(?!_)/g,""),$),isNaN(i)?0:i)},0),z(E,"$ord",function(){var s=this;return typeof s.codePointAt=="function"?s.codePointAt(0):s.charCodeAt(0)},0),z(E,"$partition",function(s){var i=this,n,$;return s.$$is_regexp?($=s.exec(i),$===null?n=-1:(q("MatchData").$new(s,$),s=$[0],n=$.index)):(s=C(s,q("String"),"to_str"),n=i.indexOf(s)),n===-1?[i,"",""]:[i.slice(0,n),i.slice(n,n+s.length),i.slice(n+s.length)]},1),z(E,"$reverse",function(){var s=this;return s.split("").reverse().join("")},0),z(E,"$rindex",function(s,i){var n=this,$,l,d,m;if(i===void 0)i=n.length;else if(i=C(i,q("Integer"),"to_int"),i<0&&(i+=n.length,i<0))return r;if(s.$$is_regexp){for(l=null,d=h(s);m=d.exec(n),!(m===null||m.index>i);)l=m,d.lastIndex=l.index+1;l===null?(L["~"]=r,$=-1):(q("MatchData").$new(d,l),$=l.index)}else s=C(s,q("String"),"to_str"),$=n.lastIndexOf(s,i);return $===-1?r:$},-2),z(E,"$rjust",function(s,i){var n=this;if(i==null&&(i=" "),s=C(s,q("Integer"),"to_int"),i=C(i,q("String"),"to_str").$to_s(),X(i["$empty?"]())&&B.$raise(q("ArgumentError"),"zero width padding"),X(s<=n.length))return n;var $=Math.floor(s-n.length),l=Math.floor($/i.length),d=Array(l+1).join(i),m=$-d.length;return n.$$cast(d+i.slice(0,m)+n)},-2),z(E,"$rpartition",function(s){var i=this,n,$,l,d;if(s.$$is_regexp){for($=null,l=h(s);d=l.exec(i),d!==null;)$=d,l.lastIndex=$.index+1;$===null?n=-1:(q("MatchData").$new(l,$),s=$[0],n=$.index)}else s=C(s,q("String"),"to_str"),n=i.lastIndexOf(s);return n===-1?["","",i]:[i.slice(0,n),i.slice(n,n+s.length),i.slice(n+s.length)]},1),z(E,"$rstrip",function(){var s=this;return s.replace(/[\s\u0000]*$/,"")},0),z(E,"$scan",function c(s,i){var n=c.$$p||r,$,l=this;if(delete c.$$p,i==null)i=S([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");$=i.$$smap.no_matchdata,$==null&&($=!1);var d=[],m=r,k;for(s.$$is_regexp?s=h(s):(s=C(s,q("String"),"to_str"),s=new RegExp(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));(k=s.exec(l))!=null;)m=q("MatchData").$new(s,k,S(["no_matchdata"],{no_matchdata:$})),n===r?k.length==1?d.push(k[0]):d.push(m.$captures()):k.length==1?e.yield1(n,k[0]):e.yield1(n,m.$captures()),s.lastIndex===k.index&&(s.lastIndex+=1);return $||(L["~"]=m),n!==r?l:d},-2),z(E,"$singleton_class",function(){var s=this;return e.get_singleton_class(s)},0),z(E,"$split",function(s,i){var n=this,$=r;if(L[";"]==null&&(L[";"]=r),n.length===0)return[];if(i===void 0)i=0;else if(i=T["$coerce_to!"](i,q("Integer"),"to_int"),i===1)return[n];(s===void 0||s===r)&&(s=X($=L[";"])?$:" ");var l=[],d=n.toString(),m=0,k,x,Y;if(s.$$is_regexp?s=h(s):(s=C(s,q("String"),"to_str").$to_s(),s===" "?(s=/\s+/gm,d=d.replace(/^\s+/,"")):s=new RegExp(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm")),l=d.split(s),l.length===1&&l[0]===d)return[n.$$cast(l[0])];for(;(x=l.indexOf(void 0))!==-1;)l.splice(x,1);function a(){for(x=0;x<l.length;x++)l[x]=n.$$cast(l[x])}if(i===0){for(;l[l.length-1]==="";)l.length-=1;return a(),l}if(k=s.exec(d),i<0){if(k!==null&&k[0]===""&&s.source.indexOf("(?=")===-1)for(x=0,Y=k.length;x<Y;x++)l.push("");return a(),l}if(k!==null&&k[0]==="")return l.splice(i-1,l.length-1,l.slice(i-1).join("")),a(),l;if(i>=l.length)return a(),l;for(x=0;k!==null&&(x++,m=s.lastIndex,x+1!==i);)k=s.exec(d);return l.splice(i-1,l.length-1,d.slice(m)),a(),l},-1),z(E,"$squeeze",function(s){var i,n,$=this;if(i=e.slice.call(arguments),n=i,n.length===0)return $.$$cast($.replace(/(.)\1+/g,"$1"));var l=u(n);return l===null?$:$.$$cast($.replace(new RegExp("("+l+")\\1+","g"),"$1"))},-1),z(E,"$start_with?",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;for(var l=0,d=n.length;l<d;l++)if(n[l].$$is_regexp){var m=n[l],k=m.exec($);if(k!=null&&k.index===0)return L["~"]=q("MatchData").$new(m,k),!0;L["~"]=r}else{var x=C(n[l],q("String"),"to_str").$to_s();if($.indexOf(x)===0)return!0}return!1},-1),z(E,"$strip",function(){var s=this;return s.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")},0),z(E,"$sub",function c(s,i){var n=c.$$p||r,$=this;delete c.$$p,s.$$is_regexp||(s=C(s,q("String"),"to_str"),s=new RegExp(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var l,d=s.exec($);return d===null?(L["~"]=r,l=$.toString()):(q("MatchData").$new(s,d),i===void 0?(n===r&&B.$raise(q("ArgumentError"),"wrong number of arguments (1 for 2)"),l=$.slice(0,d.index)+n(d[0])+$.slice(d.index+d[0].length)):i.$$is_hash?l=$.slice(0,d.index)+i["$[]"](d[0]).$to_s()+$.slice(d.index+d[0].length):(i=C(i,q("String"),"to_str"),i=i.replace(/([\\]+)([0-9+&`'])/g,function(m,k,x){if(k.length%2===0)return m;switch(x){case"+":for(var Y=d.length-1;Y>0;Y--)if(d[Y]!==void 0)return k.slice(1)+d[Y];return"";case"&":return k.slice(1)+d[0];case"`":return k.slice(1)+$.slice(0,d.index);case"'":return k.slice(1)+$.slice(d.index+d[0].length);default:return k.slice(1)+(d[x]||"")}}).replace(/\\\\/g,"\\"),l=$.slice(0,d.index)+i+$.slice(d.index+d[0].length))),$.$$cast(l)},-2),z(E,"$sum",function(s){var i=this;s==null&&(s=16),s=C(s,q("Integer"),"to_int");for(var n=0,$=i.length,l=0;l<$;l++)n+=i.charCodeAt(l);return s<=0?n:n&Math.pow(2,s)-1},-1),z(E,"$swapcase",function(){var s=this,i=s.replace(/([a-z]+)|([A-Z]+)/g,function(n,$,l){return $?n.toUpperCase():n.toLowerCase()});return s.constructor===String?i:s.$class().$new(i)},0),z(E,"$to_f",function(){var s=this;if(s.charAt(0)==="_")return 0;var i=parseFloat(s.replace(/_/g,""));return isNaN(i)||i==1/0||i==-1/0?0:i},0),z(E,"$to_i",function(s){var i=this;s==null&&(s=10);var n,$=i.toLowerCase(),l=C(s,q("Integer"),"to_int");return(l===1||l<0||l>36)&&B.$raise(q("ArgumentError"),"invalid radix "+l),/^\s*_/.test($)?0:($=$.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(d,m,k,x){switch(x.charAt(0)){case"+":case"-":return d;case"0":if(x.charAt(1)==="x"&&k==="0x"&&(l===0||l===16))return d}switch(k){case"0b":if(l===0||l===2)return l=2,m+x;break;case"0":case"0o":if(l===0||l===8)return l=8,m+x;break;case"0d":if(l===0||l===10)return l=10,m+x;break;case"0x":if(l===0||l===16)return l=16,m+x;break}return d}),n=parseInt($.replace(/_(?!_)/g,""),l),isNaN(n)?0:n)},-1),z(E,"$to_proc",function c(){var s=c.$$p||r,i=this,n=r;return delete c.$$p,n=b("$",i.valueOf()),J(B,"proc",[],function $(l){var d=$.$$p||r,m,k;delete $.$$p,m=e.slice.call(arguments),k=m,k.length===0&&B.$raise(q("ArgumentError"),"no receiver given");var x=k[0];x==null&&(x=r);var Y=x[n];return Y?(typeof d=="function"&&(Y.$$p=d),k.length===1?Y.call(x):Y.apply(x,k.slice(1))):x.$method_missing.apply(x,k)},-1)},0),z(E,"$to_s",function(){var s=this;return s.toString()},0),z(E,"$tr",function(s,i){var n=this;if(s=C(s,q("String"),"to_str").$to_s(),i=C(i,q("String"),"to_str").$to_s(),s.length==0||s===i)return n;var $,l,d,m,k,x,Y,a={},N=s.split(""),p=N.length,H=i.split(""),Q=H.length,ee=!1,ne=null;N[0]==="^"&&N.length>1&&(ee=!0,N.shift(),ne=H[Q-1],p-=1);var V=[],Z=null;for(l=!1,$=0;$<p;$++)if(m=N[$],Z==null)Z=m,V.push(m);else if(m==="-")Z==="-"?(V.push("-"),V.push("-")):$==p-1?V.push("-"):l=!0;else if(l){for(k=Z.charCodeAt(0),x=m.charCodeAt(0),k>x&&B.$raise(q("ArgumentError"),'invalid range "'+String.fromCharCode(k)+"-"+String.fromCharCode(x)+'" in string transliteration'),d=k+1;d<x;d++)V.push(String.fromCharCode(d));V.push(m),l=null,Z=null}else V.push(m);if(N=V,p=N.length,ee)for($=0;$<p;$++)a[N[$]]=!0;else{if(Q>0){var y=[],K=null;for(l=!1,$=0;$<Q;$++)if(m=H[$],K==null)K=m,y.push(m);else if(m==="-")K==="-"?(y.push("-"),y.push("-")):$==Q-1?y.push("-"):l=!0;else if(l){for(k=K.charCodeAt(0),x=m.charCodeAt(0),k>x&&B.$raise(q("ArgumentError"),'invalid range "'+String.fromCharCode(k)+"-"+String.fromCharCode(x)+'" in string transliteration'),d=k+1;d<x;d++)y.push(String.fromCharCode(d));y.push(m),l=null,K=null}else y.push(m);H=y,Q=H.length}var P=p-Q;if(P>0){var j=Q>0?H[Q-1]:"";for($=0;$<P;$++)H.push(j)}for($=0;$<p;$++)a[N[$]]=H[$]}var O="";for($=0,Y=n.length;$<Y;$++){m=n.charAt($);var re=a[m];ee?O+=re==null?ne:m:O+=re!=null?re:m}return n.$$cast(O)},2),z(E,"$tr_s",function(s,i){var n=this;if(s=C(s,q("String"),"to_str").$to_s(),i=C(i,q("String"),"to_str").$to_s(),s.length==0)return n;var $,l,d,m,k,x,Y,a={},N=s.split(""),p=N.length,H=i.split(""),Q=H.length,ee=!1,ne=null;N[0]==="^"&&N.length>1&&(ee=!0,N.shift(),ne=H[Q-1],p-=1);var V=[],Z=null;for(l=!1,$=0;$<p;$++)if(m=N[$],Z==null)Z=m,V.push(m);else if(m==="-")Z==="-"?(V.push("-"),V.push("-")):$==p-1?V.push("-"):l=!0;else if(l){for(k=Z.charCodeAt(0),x=m.charCodeAt(0),k>x&&B.$raise(q("ArgumentError"),'invalid range "'+String.fromCharCode(k)+"-"+String.fromCharCode(x)+'" in string transliteration'),d=k+1;d<x;d++)V.push(String.fromCharCode(d));V.push(m),l=null,Z=null}else V.push(m);if(N=V,p=N.length,ee)for($=0;$<p;$++)a[N[$]]=!0;else{if(Q>0){var y=[],K=null;for(l=!1,$=0;$<Q;$++)if(m=H[$],Z==null)Z=m,y.push(m);else if(m==="-")K==="-"?(y.push("-"),y.push("-")):$==Q-1?y.push("-"):l=!0;else if(l){for(k=Z.charCodeAt(0),x=m.charCodeAt(0),k>x&&B.$raise(q("ArgumentError"),'invalid range "'+String.fromCharCode(k)+"-"+String.fromCharCode(x)+'" in string transliteration'),d=k+1;d<x;d++)y.push(String.fromCharCode(d));y.push(m),l=null,Z=null}else y.push(m);H=y,Q=H.length}var P=p-Q;if(P>0){var j=Q>0?H[Q-1]:"";for($=0;$<P;$++)H.push(j)}for($=0;$<p;$++)a[N[$]]=H[$]}var O="",re=null;for($=0,Y=n.length;$<Y;$++){m=n.charAt($);var te=a[m];ee?te==null?re==null&&(O+=ne,re=!0):(O+=m,re=null):te!=null?(re==null||re!==te)&&(O+=te,re=te):(O+=m,re=null)}return n.$$cast(O)},2),z(E,"$upcase",function(){var s=this;return s.$$cast(s.toUpperCase())},0),z(E,"$upto",function c(s,i){var n=c.$$p||r,$=this;if(delete c.$$p,i==null&&(i=!1),n===r)return $.$enum_for("upto",s,i);var l,d,m=$.toString();if(s=C(s,q("String"),"to_str"),m.length===1&&s.length===1)for(l=m.charCodeAt(0),d=s.charCodeAt(0);l<=d&&!(i&&l===d);)n(String.fromCharCode(l)),l+=1;else if(parseInt(m,10).toString()===m&&parseInt(s,10).toString()===s)for(l=parseInt(m,10),d=parseInt(s,10);l<=d&&!(i&&l===d);)n(l.toString()),l+=1;else for(;m.length<=s.length&&m<=s&&!(i&&m===s);)n(m),m=m.$succ();return $},-2);function u(c){function s(a){var N="",p,H=a.length,Q,ee,ne,V,Z;for(p=0;p<H;p++)if(Q=a.charAt(p),Q==="-"&&p>0&&p<H-1&&!ee){for(ne=a.charCodeAt(p-1),V=a.charCodeAt(p+1),ne>V&&B.$raise(q("ArgumentError"),'invalid range "'+ne+"-"+V+'" in string transliteration'),Z=ne+1;Z<V+1;Z++)N+=String.fromCharCode(Z);ee=!0,p++}else ee=Q==="\\",N+=Q;return N}function i(a,N){if(a.length===0)return N;var p="",H,Q=a.length,ee;for(H=0;H<Q;H++)ee=a.charAt(H),N.indexOf(ee)!==-1&&(p+=ee);return p}var n,$,l,d,m,k,x="",Y="";for(n=0,$=c.length;n<$;n++)l=C(c[n],q("String"),"to_str"),d=l.charAt(0)==="^"&&l.length>1,l=s(d?l.slice(1):l),d?Y=i(Y,l):x=i(x,l);if(x.length>0&&Y.length>0){for(k="",n=0,$=x.length;n<$;n++)m=x.charAt(n),Y.indexOf(m)===-1&&(k+=m);x=k,Y=""}return x.length>0?"["+q("Regexp").$escape(x)+"]":Y.length>0?"[^"+q("Regexp").$escape(Y)+"]":null}return z(E,"$instance_variables",function(){return[]},0),U(E,"$_load",function(s){var i,n,$=this;return i=e.slice.call(arguments),n=i,J($,"new",W(n))},-1),z(E,"$unicode_normalize",function(s){var i=this;return s==null&&(s="nfc"),X(["nfc","nfd","nfkc","nfkd"]["$include?"](s))||B.$raise(q("ArgumentError"),"Invalid normalization form "+s),i.normalize(s.$upcase())},-1),z(E,"$unicode_normalized?",function(s){var i=this;return s==null&&(s="nfc"),i.$unicode_normalize(s)["$=="](i)},-1),z(E,"$unpack",function(s){return B.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},1),z(E,"$unpack1",function(s){return B.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},1),z(E,"$freeze",function(){var s=this;return typeof s=="string"||(s.$$frozen=!0),s},0),z(E,"$-@",function(){var s=this;return typeof s=="string"||s.$$frozen===!0?s:s.encoding.name=="UTF-8"&&s.internal_encoding.name=="UTF-8"?s.toString():s.$dup().$freeze()},0),z(E,"$frozen?",function(){var s=this;return typeof s=="string"||s.$$frozen===!0},0),M(E,"+@","dup"),M(E,"===","=="),M(E,"byteslice","[]"),M(E,"eql?","=="),M(E,"equal?","==="),M(E,"object_id","__id__"),M(E,"slice","[]"),M(E,"succ","next"),M(E,"to_str","to_s"),M(E,"to_sym","intern"),T.$pristine(E,"initialize")}("::",String,o),D(o[0],"Symbol",t("String"))};Opal.modules["corelib/enumerable"]=function(e){var A=e.nil,o=e.$$$,t=e.truthy,r=e.coerce_to,q=e.yield1,C=e.yieldX,I=e.module,h=e.send,v=e.to_a,z=e.Opal,T=e.def,U=e.Kernel,J=e.rb_gt,W=e.rb_times,S=e.rb_lt,F=e.eqeq,B=e.rb_plus,X=e.rb_minus,L=e.rb_divide,w=e.rb_le,b=e.hash2,M=e.lambda,D=e.not,G=e.alias;return function(R){var f=I(R,"Enumerable");function E(g){return g.length===0&&(g=[A]),g.length>1&&(g=[g]),g}return T(f,"$all?",function g(_){try{var u=g.$$p||A,c=this;return delete g.$$p,t(_!==void 0)?h(c,"each",[],function(i){var n,$,l=A;if(n=e.slice.call(arguments),$=n,l=E($),t(h(_,"public_send",["==="].concat(v(l)))))return A;e.ret(!1)},-1):u!==A?h(c,"each",[],function(i){var n,$;if(n=e.slice.call(arguments),$=n,t(e.yieldX(u,v($))))return A;e.ret(!1)},-1):h(c,"each",[],function(i){var n,$;if(n=e.slice.call(arguments),$=n,t(z.$destructure($)))return A;e.ret(!1)},-1),!0}catch(s){if(s===e.returner)return s.$v;throw s}},-1),T(f,"$any?",function g(_){try{var u=g.$$p||A,c=this;return delete g.$$p,t(_!==void 0)?h(c,"each",[],function(i){var n,$,l=A;if(n=e.slice.call(arguments),$=n,l=E($),t(h(_,"public_send",["==="].concat(v(l)))))e.ret(!0);else return A},-1):u!==A?h(c,"each",[],function(i){var n,$;if(n=e.slice.call(arguments),$=n,t(e.yieldX(u,v($))))e.ret(!0);else return A},-1):h(c,"each",[],function(i){var n,$;if(n=e.slice.call(arguments),$=n,t(z.$destructure($)))e.ret(!0);else return A},-1),!1}catch(s){if(s===e.returner)return s.$v;throw s}},-1),T(f,"$chunk",function g(){var _=g.$$p||A,u=this;return delete g.$$p,_===A?h(u,"to_enum",["chunk"],function c(){var s=c.$$s==null?this:c.$$s;return s.$enumerator_size()},{$$arity:0,$$s:u}):h(o("Enumerator"),"new",[],function c(s){var i=c.$$s==null?this:c.$$s;s==null&&(s=A);var n=A,$=[];function l(){$.length>0&&s.$yield(n,$)}i.$each.$$p=function(d){var m=q(_,d);m===A?(l(),$=[],n=A):(n===A||n===m?$.push(d):(l(),$=[d]),n=m)},i.$each(),l()},{$$arity:1,$$s:u})},0),T(f,"$chunk_while",function g(){var _=g.$$p||A,u=this;return delete g.$$p,_===A&&U.$raise(o("ArgumentError"),"no block given"),h(u,"slice_when",[],function(s,i){return s==null&&(s=A),i==null&&(i=A),e.yieldX(_,[s,i])["$!"]()},2)},0),T(f,"$collect",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return h(u,"enum_for",["collect"],function s(){var i=s.$$s==null?this:s.$$s;return i.$enumerator_size()},{$$arity:0,$$s:u});var c=[];return u.$each.$$p=function(){var s=C(_,arguments);c.push(s)},u.$each(),c},0),T(f,"$collect_concat",function g(){var _=g.$$p||A,u=this;return delete g.$$p,_===A?h(u,"enum_for",["collect_concat"],function c(){var s=c.$$s==null?this:c.$$s;return s.$enumerator_size()},{$$arity:0,$$s:u}):h(u,"map",[],function(s){return s==null&&(s=A),e.yield1(_,s)},1).$flatten(1)},0),T(f,"$compact",function(){var _=this;return _.$to_a().$compact()},0),T(f,"$count",function g(_){var u=g.$$p||A,c=this,s=A;return delete g.$$p,s=0,_!=null&&u!==A&&c.$warn("warning: given block not used"),t(_!=null)?u=h(U,"proc",[],function(n){var $,l;return $=e.slice.call(arguments),l=$,z.$destructure(l)["$=="](_)},-1):t(u["$nil?"]())&&(u=h(U,"proc",[],function(){return!0},0)),h(c,"each",[],function(n){var $,l;return $=e.slice.call(arguments),l=$,t(C(u,l))?s++:A},-1),s},-1),T(f,"$cycle",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_==null&&(_=A),u===A)return h(c,"enum_for",["cycle",_],function l(){var d=l.$$s==null?this:l.$$s;return t(_["$nil?"]())?t(d["$respond_to?"]("size"))?o(o("Float"),"INFINITY"):A:(_=z["$coerce_to!"](_,o("Integer"),"to_int"),t(J(_,0))?W(d.$enumerator_size(),_):0)},{$$arity:0,$$s:c});if(!t(_["$nil?"]())&&(_=z["$coerce_to!"](_,o("Integer"),"to_int"),t(_<=0)))return A;var s=[],i,n,$;if(c.$each.$$p=function(){var l=z.$destructure(arguments),d=q(u,l);s.push(l)},c.$each(),s.length===0)return A;if(_===A)for(;;)for(i=0,n=s.length;i<n;i++)$=q(u,s[i]);else for(;_>1;){for(i=0,n=s.length;i<n;i++)$=q(u,s[i]);_--}},-1),T(f,"$detect",function g(_){try{var u=g.$$p||A,c=this;return delete g.$$p,u===A?c.$enum_for("detect",_):(h(c,"each",[],function(i){var n,$,l=A;if(n=e.slice.call(arguments),$=n,l=z.$destructure($),t(e.yield1(u,l)))e.ret(l);else return A},-1),_!==void 0?typeof _=="function"?_():_:A)}catch(s){if(s===e.returner)return s.$v;throw s}},-1),T(f,"$drop",function(_){var u=this;_=r(_,o("Integer"),"to_int"),t(_<0)&&U.$raise(o("ArgumentError"),"attempt to drop negative size");var c=[],s=0;return u.$each.$$p=function(){_<=s&&c.push(z.$destructure(arguments)),s++},u.$each(),c},1),T(f,"$drop_while",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return u.$enum_for("drop_while");var c=[],s=!0;return u.$each.$$p=function(){var i=z.$destructure(arguments);if(s){var n=q(_,i);t(n)||(s=!1,c.push(i))}else c.push(i)},u.$each(),c},0),T(f,"$each_cons",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,t(arguments.length!=1)&&U.$raise(o("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),_=z.$try_convert(_,o("Integer"),"to_int"),t(_<=0)&&U.$raise(o("ArgumentError"),"invalid size"),u===A)return h(c,"enum_for",["each_cons",_],function i(){var n=i.$$s==null?this:i.$$s,$=A;return $=n.$enumerator_size(),t($["$nil?"]())?A:F($,0)||t(S($,_))?0:B(X($,_),1)},{$$arity:0,$$s:c});var s=[];return c.$each.$$p=function(){var i=z.$destructure(arguments);s.push(i),s.length>_&&s.shift(),s.length==_&&q(u,s.slice(0,_))},c.$each(),c},1),T(f,"$each_entry",function g(_){var u=g.$$p||A,c,s,i=this;return delete g.$$p,c=e.slice.call(arguments),s=c,u===A?h(i,"to_enum",["each_entry"].concat(v(s)),function n(){var $=n.$$s==null?this:n.$$s;return $.$enumerator_size()},{$$arity:0,$$s:i}):(i.$each.$$p=function(){var n=z.$destructure(arguments);q(u,n)},i.$each.apply(i,s),i)},-1),T(f,"$each_slice",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_=r(_,o("Integer"),"to_int"),t(_<=0)&&U.$raise(o("ArgumentError"),"invalid slice size"),u===A)return h(c,"enum_for",["each_slice",_],function i(){var n=i.$$s==null?this:i.$$s;return t(n["$respond_to?"]("size"))?L(n.$size(),_).$ceil():A},{$$arity:0,$$s:c});var s=[];return c.$each.$$p=function(){var i=z.$destructure(arguments);s.push(i),s.length===_&&(q(u,s),s=[])},c.$each(),s.length>0&&q(u,s),c},1),T(f,"$each_with_index",function g(_){var u=g.$$p||A,c,s,i=this;if(delete g.$$p,c=e.slice.call(arguments),s=c,u===A)return h(i,"enum_for",["each_with_index"].concat(v(s)),function $(){var l=$.$$s==null?this:$.$$s;return l.$enumerator_size()},{$$arity:0,$$s:i});var n=0;return i.$each.$$p=function(){var $=z.$destructure(arguments);u($,n),n++},i.$each.apply(i,s),i},-1),T(f,"$each_with_object",function g(_){var u=g.$$p||A,c=this;return delete g.$$p,u===A?h(c,"enum_for",["each_with_object",_],function s(){var i=s.$$s==null?this:s.$$s;return i.$enumerator_size()},{$$arity:0,$$s:c}):(c.$each.$$p=function(){var s=z.$destructure(arguments);u(s,_)},c.$each(),_)},1),T(f,"$entries",function(_){var u,c,s=this;u=e.slice.call(arguments),c=u;var i=[];return s.$each.$$p=function(){i.push(z.$destructure(arguments))},s.$each.apply(s,c),i},-1),T(f,"$filter_map",function g(){var _=g.$$p||A,u=this;return delete g.$$p,_===A?h(u,"enum_for",["filter_map"],function c(){var s=c.$$s==null?this:c.$$s;return s.$enumerator_size()},{$$arity:0,$$s:u}):h(h(u,"map",[],_.$to_proc()),"select",[],"itself".$to_proc())},0),T(f,"$find_all",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return h(u,"enum_for",["find_all"],function s(){var i=s.$$s==null?this:s.$$s;return i.$enumerator_size()},{$$arity:0,$$s:u});var c=[];return u.$each.$$p=function(){var s=z.$destructure(arguments),i=q(_,s);t(i)&&c.push(s)},u.$each(),c},0),T(f,"$find_index",function g(_){try{var u=g.$$p||A,c=this,s=A;return delete g.$$p,t(_===void 0&&u===A)?c.$enum_for("find_index"):(_!=null&&u!==A&&c.$warn("warning: given block not used"),s=0,t(_!=null)?h(c,"each",[],function(n){var $,l;return $=e.slice.call(arguments),l=$,F(z.$destructure(l),_)&&e.ret(s),s+=1},-1):h(c,"each",[],function(n){var $,l;return $=e.slice.call(arguments),l=$,t(e.yieldX(u,v(l)))&&e.ret(s),s+=1},-1),A)}catch(i){if(i===e.returner)return i.$v;throw i}},-1),T(f,"$first",function(_){try{var u=this,c=A,s=A;return t(_===void 0)?h(u,"each",[],function(n){n==null&&(n=A),e.ret(n)},1):(c=[],_=r(_,o("Integer"),"to_int"),t(_<0)&&U.$raise(o("ArgumentError"),"attempt to take negative size"),t(_==0)?[]:(s=0,h(u,"each",[],function(n){var $,l;if($=e.slice.call(arguments),l=$,c.push(z.$destructure(l)),t(_<=++s))e.ret(c);else return A},-1),c))}catch(i){if(i===e.returner)return i.$v;throw i}},-1),T(f,"$grep",function g(_){var u=g.$$p||A,c=this,s=A;return delete g.$$p,s=[],h(c,"each",[],function(n){var $,l,d=A;return $=e.slice.call(arguments),l=$,d=E(l),t(h(_,"__send__",["==="].concat(v(d))))?(u!==A?(t(J(l.$length(),1))&&(l=[l]),l=e.yieldX(u,v(l))):t(w(l.$length(),1))&&(l=l["$[]"](0)),s.$push(l)):A},-1),s},1),T(f,"$grep_v",function g(_){var u=g.$$p||A,c=this,s=A;return delete g.$$p,s=[],h(c,"each",[],function(n){var $,l,d=A;return $=e.slice.call(arguments),l=$,d=E(l),t(h(_,"__send__",["==="].concat(v(d))))?A:(u!==A?(t(J(l.$length(),1))&&(l=[l]),l=e.yieldX(u,v(l))):t(w(l.$length(),1))&&(l=l["$[]"](0)),s.$push(l))},-1),s},1),T(f,"$group_by",function g(){var _=g.$$p||A,u=this,c=A,s=A,i=A;if(delete g.$$p,_===A)return h(u,"enum_for",["group_by"],function $(){var l=$.$$s==null?this:$.$$s;return l.$enumerator_size()},{$$arity:0,$$s:u});c=b([],{});var n;return u.$each.$$p=function(){var $=z.$destructure(arguments),l=q(_,$);(t(s=c["$[]"](l))?s:(i=[l,[]],h(c,"[]=",v(i)),i[X(i.length,1)]))["$<<"]($)},u.$each(),n!==void 0?n:c},0),T(f,"$include?",function(_){try{var u=this;return h(u,"each",[],function(s){var i,n;if(i=e.slice.call(arguments),n=i,F(z.$destructure(n),_))e.ret(!0);else return A},-1),!1}catch(c){if(c===e.returner)return c.$v;throw c}},1),T(f,"$inject",function g(_,u){var c=g.$$p||A,s=this;delete g.$$p;var i=_;return c!==A&&u===void 0?s.$each.$$p=function(){var n=z.$destructure(arguments);if(i===void 0){i=n;return}n=C(c,[i,n]),i=n}:(u===void 0&&(o("Symbol")["$==="](_)||U.$raise(o("TypeError"),""+_.$inspect()+" is not a Symbol"),u=_,i=void 0),s.$each.$$p=function(){var n=z.$destructure(arguments);if(i===void 0){i=n;return}i=i.$__send__(u,n)}),s.$each(),i==null?A:i},-1),T(f,"$lazy",function(){var _=this;return h(o(o("Enumerator"),"Lazy"),"new",[_,_.$enumerator_size()],function(c,s){var i,n;return c==null&&(c=A),i=e.slice.call(arguments,1),n=i,h(c,"yield",v(n))},-2)},0),T(f,"$enumerator_size",function(){var _=this;return t(_["$respond_to?"]("size"))?_.$size():A},0),T(f,"$max",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_===void 0||_===A){var s,i;return c.$each.$$p=function(){var n=z.$destructure(arguments);if(s===void 0){s=n;return}u!==A?i=C(u,[n,s]):i=n["$<=>"](s),i===A&&U.$raise(o("ArgumentError"),"comparison failed"),i>0&&(s=n)},c.$each(),s===void 0?A:s}return _=r(_,o("Integer"),"to_int"),h(c,"sort",[],u.$to_proc()).$reverse().$first(_)},-1),T(f,"$max_by",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_==null&&(_=A),!t(u))return h(c,"enum_for",["max_by",_],function n(){var $=n.$$s==null?this:n.$$s;return $.$enumerator_size()},{$$arity:0,$$s:c});if(!t(_["$nil?"]()))return h(c,"sort_by",[],u.$to_proc()).$reverse().$take(_);var s,i;return c.$each.$$p=function(){var n=z.$destructure(arguments),$=q(u,n);if(s===void 0){s=n,i=$;return}$["$<=>"](i)>0&&(s=n,i=$)},c.$each(),s===void 0?A:s},-1),T(f,"$min",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_==null&&(_=A),!t(_["$nil?"]()))return u!==A?h(c,"sort",[],function(n,$){return n==null&&(n=A),$==null&&($=A),e.yieldX(u,[n,$])},2).$take(_):c.$sort().$take(_);var s;return u!==A?c.$each.$$p=function(){var i=z.$destructure(arguments);if(s===void 0){s=i;return}var n=u(i,s);n===A&&U.$raise(o("ArgumentError"),"comparison failed"),n<0&&(s=i)}:c.$each.$$p=function(){var i=z.$destructure(arguments);if(s===void 0){s=i;return}z.$compare(i,s)<0&&(s=i)},c.$each(),s===void 0?A:s},-1),T(f,"$min_by",function g(_){var u=g.$$p||A,c=this;if(delete g.$$p,_==null&&(_=A),!t(u))return h(c,"enum_for",["min_by",_],function n(){var $=n.$$s==null?this:n.$$s;return $.$enumerator_size()},{$$arity:0,$$s:c});if(!t(_["$nil?"]()))return h(c,"sort_by",[],u.$to_proc()).$take(_);var s,i;return c.$each.$$p=function(){var n=z.$destructure(arguments),$=q(u,n);if(s===void 0){s=n,i=$;return}$["$<=>"](i)<0&&(s=n,i=$)},c.$each(),s===void 0?A:s},-1),T(f,"$minmax",function g(){var _=g.$$p||A,u=this,c=A;delete g.$$p,_=t(c=_)?c:h(U,"proc",[],function(l,d){return l==null&&(l=A),d==null&&(d=A),l["$<=>"](d)},2);var s=A,i=A,n=!0;return u.$each.$$p=function(){var $=z.$destructure(arguments);if(n)s=i=$,n=!1;else{var l=_.$call(s,$);l===A?U.$raise(o("ArgumentError"),"comparison failed"):l>0&&(s=$);var d=_.$call(i,$);d===A?U.$raise(o("ArgumentError"),"comparison failed"):d<0&&(i=$)}},u.$each(),[s,i]},0),T(f,"$minmax_by",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,!t(_))return h(u,"enum_for",["minmax_by"],function $(){var l=$.$$s==null?this:$.$$s;return l.$enumerator_size()},{$$arity:0,$$s:u});var c=A,s=A,i,n;return u.$each.$$p=function(){var $=z.$destructure(arguments),l=q(_,$);(i===void 0||l["$<=>"](i)<0)&&(c=$,i=l),(n===void 0||l["$<=>"](n)>0)&&(s=$,n=l)},u.$each(),[c,s]},0),T(f,"$none?",function g(_){try{var u=g.$$p||A,c=this;return delete g.$$p,t(_!==void 0)?h(c,"each",[],function(i){var n,$,l=A;if(n=e.slice.call(arguments),$=n,l=E($),t(h(_,"public_send",["==="].concat(v(l)))))e.ret(!1);else return A},-1):u!==A?h(c,"each",[],function(i){var n,$;if(n=e.slice.call(arguments),$=n,t(e.yieldX(u,v($))))e.ret(!1);else return A},-1):h(c,"each",[],function(i){var n,$,l=A;if(n=e.slice.call(arguments),$=n,l=z.$destructure($),t(l))e.ret(!1);else return A},-1),!0}catch(s){if(s===e.returner)return s.$v;throw s}},-1),T(f,"$one?",function g(_){try{var u=g.$$p||A,c=this,s=A;return delete g.$$p,s=0,t(_!==void 0)?h(c,"each",[],function(n){var $,l,d=A;if($=e.slice.call(arguments),l=$,d=E(l),t(h(_,"public_send",["==="].concat(v(d)))))if(s=B(s,1),t(J(s,1)))e.ret(!1);else return A;else return A},-1):u!==A?h(c,"each",[],function(n){var $,l;if($=e.slice.call(arguments),l=$,!t(e.yieldX(u,v(l))))return A;if(s=B(s,1),t(J(s,1)))e.ret(!1);else return A},-1):h(c,"each",[],function(n){var $,l;if($=e.slice.call(arguments),l=$,!t(z.$destructure(l)))return A;if(s=B(s,1),t(J(s,1)))e.ret(!1);else return A},-1),s["$=="](1)}catch(i){if(i===e.returner)return i.$v;throw i}},-1),T(f,"$partition",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return h(u,"enum_for",["partition"],function n(){var $=n.$$s==null?this:n.$$s;return $.$enumerator_size()},{$$arity:0,$$s:u});var c=[],s=[],i;return u.$each.$$p=function(){var n=z.$destructure(arguments),$=q(_,n);t($)?c.push(n):s.push(n)},u.$each(),[c,s]},0),T(f,"$reject",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return h(u,"enum_for",["reject"],function s(){var i=s.$$s==null?this:s.$$s;return i.$enumerator_size()},{$$arity:0,$$s:u});var c=[];return u.$each.$$p=function(){var s=z.$destructure(arguments),i=q(_,s);t(i)||c.push(s)},u.$each(),c},0),T(f,"$reverse_each",function g(){var _=g.$$p||A,u=this;if(delete g.$$p,_===A)return h(u,"enum_for",["reverse_each"],function i(){var n=i.$$s==null?this:i.$$s;return n.$enumerator_size()},{$$arity:0,$$s:u});var c=[];u.$each.$$p=function(){c.push(arguments)},u.$each();for(var s=c.length-1;s>=0;s--)C(_,c[s]);return c},0),T(f,"$slice_before",function g(_){var u=g.$$p||A,c=this;return delete g.$$p,t(_===void 0&&u===A)&&U.$raise(o("ArgumentError"),"both pattern and block are given"),t(_!==void 0&&u!==A||arguments.length>1)&&U.$raise(o("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),h(o("Enumerator"),"new",[],function s(i){var n=s.$$s==null?this:s.$$s;i==null&&(i=A);var $=[];u!==A?_===void 0?n.$each.$$p=function(){var l=z.$destructure(arguments),d=q(u,l);t(d)&&$.length>0&&(i["$<<"]($),$=[]),$.push(l)}:n.$each.$$p=function(){var l=z.$destructure(arguments),d=u(l,_.$dup());t(d)&&$.length>0&&(i["$<<"]($),$=[]),$.push(l)}:n.$each.$$p=function(){var l=z.$destructure(arguments),d=_["$==="](l);t(d)&&$.length>0&&(i["$<<"]($),$=[]),$.push(l)},n.$each(),$.length>0&&i["$<<"]($)},{$$arity:1,$$s:c})},-1),T(f,"$slice_after",function g(_){var u=g.$$p||A,c=this;return delete g.$$p,t(_===void 0&&u===A)&&U.$raise(o("ArgumentError"),"both pattern and block are given"),t(_!==void 0&&u!==A||arguments.length>1)&&U.$raise(o("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),t(_!==void 0)&&(u=h(U,"proc",[],function(i){return i==null&&(i=A),_["$==="](i)},1)),h(o("Enumerator"),"new",[],function s(i){var n=s.$$s==null?this:s.$$s;i==null&&(i=A);var $;n.$each.$$p=function(){var l=z.$destructure(arguments),d=q(u,l);$==null&&($=[]),t(d)?($.push(l),i.$yield($),$=null):$.push(l)},n.$each(),$!=null&&i.$yield($)},{$$arity:1,$$s:c})},-1),T(f,"$slice_when",function g(){var _=g.$$p||A,u=this;return delete g.$$p,_===A&&U.$raise(o("ArgumentError"),"wrong number of arguments (0 for 1)"),h(o("Enumerator"),"new",[],function c(s){var i=c.$$s==null?this:c.$$s;s==null&&(s=A);var n=A,$=A;i.$each_cons.$$p=function(){var l=z.$destructure(arguments),d=l[0],m=l[1],k=C(_,[d,m]);$=m,n===A&&(n=[]),t(k)?(n.push(d),s.$yield(n),n=[]):n.push(d)},i.$each_cons(2),n!==A&&(n.push($),s.$yield(n))},{$$arity:1,$$s:u})},0),T(f,"$sort",function g(){var _=g.$$p||A,u=this,c=A;return delete g.$$p,c=u.$to_a(),_===A&&(_=M(function(i,n){return i==null&&(i=A),n==null&&(n=A),i["$<=>"](n)},2)),h(c,"sort",[],_.$to_proc())},0),T(f,"$sort_by",function g(){var _=g.$$p||A,u=this,c=A;return delete g.$$p,_===A?h(u,"enum_for",["sort_by"],function s(){var i=s.$$s==null?this:s.$$s;return i.$enumerator_size()},{$$arity:0,$$s:u}):(c=h(u,"map",[],function(){var i=A;return i=z.$destructure(arguments),[e.yield1(_,i),i]},0),h(c,"sort!",[],function(i,n){return i==null&&(i=A),n==null&&(n=A),i[0]["$<=>"](n[0])},2),h(c,"map!",[],function(i){return i==null&&(i=A),i[1]},1))},0),T(f,"$sum",function g(_){var u=g.$$p||A,c=this,s=A,i=A;return delete g.$$p,_==null&&(_=0),s=_,i=0,h(c,"each",[],function($){var l,d,m=A,k=A,x=A;return l=e.slice.call(arguments),d=l,m=u!==A?e.yieldX(u,v(d)):z.$destructure(d),D([o(o("Float"),"INFINITY"),o(o("Float"),"INFINITY")["$-@"]()]["$include?"](m))&&t(m["$respond_to?"]("-"))?(k=X(m,i),x=B(s,k),i=X(X(x,s),k),s=x):s=B(s,m)},-1),s},-1),T(f,"$take",function(_){var u=this;return u.$first(_)},1),T(f,"$take_while",function g(){try{var _=g.$$p||A,u=this,c=A;return delete g.$$p,t(_)?(c=[],h(u,"each",[],function(i){var n,$,l=A;return n=e.slice.call(arguments),$=n,l=z.$destructure($),t(e.yield1(_,l))||e.ret(c),c.push(l)},-1)):u.$enum_for("take_while")}catch(s){if(s===e.returner)return s.$v;throw s}},0),T(f,"$uniq",function g(){var _=g.$$p||A,u=this,c=A;return delete g.$$p,c=b([],{}),h(u,"each",[],function(i){var n,$,l=A,d=A,m=A;return n=e.slice.call(arguments),$=n,l=z.$destructure($),d=_!==A?e.yield1(_,l):l,t(c["$key?"](d))?A:(m=[d,l],h(c,"[]=",v(m)),m[X(m.length,1)])},-1),c.$values()},0),T(f,"$tally",function(_){var u=this,c=A;return c=h(h(u,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),t(_)?(h(c,"each",[],function(i,n){var $=A;return i==null&&(i=A),n==null&&(n=A),$=[i,B(_.$fetch(i,0),n)],h(_,"[]=",v($)),$[X($.length,1)]},2),_):c},-1),T(f,"$to_h",function g(_){var u=g.$$p||A,c,s,i=this;if(delete g.$$p,c=e.slice.call(arguments),s=c,u!==A)return h(h(i,"map",[],u.$to_proc()),"to_h",v(s));var n=b([],{});return i.$each.$$p=function(){var $=z.$destructure(arguments),l=z["$coerce_to?"]($,o("Array"),"to_ary"),d,m;l.$$is_array||U.$raise(o("TypeError"),"wrong element type "+l.$class()+" (expected array)"),l.length!==2&&U.$raise(o("ArgumentError"),"wrong array length (expected 2, was "+l.$length()+")"),d=l[0],m=l[1],e.hash_put(n,d,m)},i.$each.apply(i,s),n},-1),T(f,"$zip",function g(_){var u=g.$$p||A,c,s,i=this;return delete g.$$p,c=e.slice.call(arguments),s=c,h(i.$to_a(),"zip",v(s))},-1),G(f,"find","detect"),G(f,"filter","find_all"),G(f,"flat_map","collect_concat"),G(f,"map","collect"),G(f,"member?","include?"),G(f,"reduce","inject"),G(f,"select","find_all"),G(f,"to_a","entries")}("::")};Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.truthy,C=e.to_a,I=e.eqeq,h=e.Kernel,v=e.def,z=e.rb_gt,T=e.rb_lt,U=e.rb_le,J=e.rb_ge,W=e.rb_plus,S=e.rb_minus,F=e.eqeqeq,B=e.not,X=e.rb_times,L=e.rb_divide,w=e.alias;return function(b,M,D){var G=r(b,M,"Enumerator"),R=[G].concat(D);return function(f,E,g){var _=r(f,E,"ArithmeticSequence"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;s.step_arg2=s.receiver_num=s.step_arg1=s.step=s.range=s.topfx=s.bypfx=s.creation_method=s.skipped_arg=o,e.prop(_.$$prototype,"$$is_arithmetic_seq",!0);var i=1/0;return v(_,"$initialize",function($,l,d){var m,k=this,x=o;return d==null&&(d="step"),k.creation_method=d,q($["$is_a?"](t("Array")))?(m=[].concat(C($)),k.step_arg1=m[0]==null?o:m[0],k.step_arg2=m[1]==null?o:m[1],k.topfx=m[2]==null?o:m[2],k.bypfx=m[3]==null?o:m[3],k.receiver_num=l,k.step=1,k.range=q(k.step_arg2)?(k.step=k.step_arg2,e.Range.$new(k.receiver_num,k.step_arg1,!1)):q(k.step_arg1)?e.Range.$new(k.receiver_num,k.step_arg1,!1):e.Range.$new(k.receiver_num,o,!1)):(q(l)||(k.skipped_arg=!0),m=[$,q(x=l)?x:1],k.range=m[0],k.step=m[1]),k.object=k,I(k.step,0)&&h.$raise(c("ArgumentError"),"step can't be 0"),q(k.step["$respond_to?"]("to_int"))?o:h.$raise(c("ArgumentError"),"no implicit conversion of "+k.step.$class()+" into Integer")},-2),_.$attr_reader("step"),v(_,"$begin",function(){var $=this;return $.range.$begin()},0),v(_,"$end",function(){var $=this;return $.range.$end()},0),v(_,"$exclude_end?",function(){var $=this;return $.range["$exclude_end?"]()},0),v(_,"$_lesser_than_end?",function($){var l=this,d=o,m=o;return d=q(m=l.$end())?m:i,q(z(l.$step(),0))?q(l["$exclude_end?"]())?T($,d):U($,d):q(l["$exclude_end?"]())?z($,d):J($,d)},1),v(_,"$_greater_than_begin?",function($){var l=this,d=o,m=o;return d=q(m=l.$begin())?m:i["$-@"](),q(z(l.$step(),0))?z($,d):T($,d)},1),v(_,"$first",function($){var l,d=this,m=o,k=o,x=o;if(m=q(k=d.$begin())?k:i["$-@"](),!q($))return q(d["$_lesser_than_end?"](m))?m:o;for(x=[];q(q(k=d["$_lesser_than_end?"](m))?z($,0):k);)x["$<<"](m),m=W(m,d.$step()),$=S($,1);return x},-1),v(_,"$each",function n(){var $=n.$$p||o,l,d=this,m=o,k=o;if(delete n.$$p,$===o)return d;for(F(o,m=d.$begin())&&h.$raise(c("TypeError"),"nil can't be coerced into Integer"),k=q(m=d.$begin())?m:i["$-@"]();q(d["$_lesser_than_end?"](k));)e.yield1($,k),k=W(k,d.$step());return d},0),v(_,"$last",function($){var l,d=this,m=o,k=o,x=o;if(F(i,m=d.$end())||F(i["$-@"](),m)?h.$raise(t("FloatDomainError"),d.$end()):F(o,m)&&h.$raise(t("RangeError"),"cannot get the last element of endless arithmetic sequence"),k=S(d.$end(),S(d.$end(),d.$begin())["$%"](d.$step())),q(d["$_lesser_than_end?"](k))||(k=S(k,d.$step())),!q($))return q(d["$_greater_than_begin?"](k))?k:o;for(x=[];q(q(m=d["$_greater_than_begin?"](k))?z($,0):m);)x["$<<"](k),k=S(k,d.$step()),$=S($,1);return x.$reverse()},-1),v(_,"$size",function(){var $=this,l=o,d=o;return l=q(z($.$step(),0))?1:-1,B($["$_lesser_than_end?"]($.$begin()))?0:q([i["$-@"](),i]["$include?"]($.$step()))?1:q([X(i["$-@"](),l),o]["$include?"]($.$begin()))||q([X(i,l),o]["$include?"]($.$end()))?i:(d=S($.$end(),S($.$end(),$.$begin())["$%"]($.$step())),q($["$_lesser_than_end?"](d))||(d=S(d,$.$step())),W(L(S(d,$.$begin()),$.$step()).$abs().$to_i(),1))},0),v(_,"$==",function($){var l=this,d=o,m=o,k=o,x=o;return q(d=q(m=q(k=q(x=l.$class()["$=="]($.$class()))?l.$begin()["$=="]($.$begin()):x)?l.$end()["$=="]($.$end()):k)?l.$step()["$=="]($.$step()):m)?l["$exclude_end?"]()["$=="]($["$exclude_end?"]()):d},1),v(_,"$hash",function(){var $=this;return[$.$begin(),$.$end(),$.$step(),$["$exclude_end?"]()].$hash()},0),v(_,"$inspect",function(){var $=this,l=o;return q($.receiver_num)?(l=q($.step_arg2)?"("+$.topfx+$.step_arg1.$inspect()+", "+$.bypfx+$.step_arg2.$inspect()+")":q($.step_arg1)?"("+$.topfx+$.step_arg1.$inspect()+")":o,"("+$.receiver_num.$inspect()+"."+$.creation_method+l+")"):(l=q($.skipped_arg)?o:"("+$.step+")","(("+$.range.$inspect()+")."+$.creation_method+l+")")},0),w(_,"===","=="),w(_,"eql?","==")}(G,G,R)}("::",null,A)};Opal.modules["corelib/enumerator/chain"]=function(e){var A=e.nil,o=e.$$$,t=e.klass,r=e.def,q=e.send,C=e.to_a,I=e.truthy,h=e.rb_plus;return function(v,z){var T=t(v,z,"Enumerator");return function(U,J){var W=t(U,J,"Chain"),S=W.$$prototype;return S.enums=S.iterated=A,r(W,"$initialize",function(B){var X,L,w=this;return X=e.slice.call(arguments),L=X,w.enums=L,w.iterated=[],w.object=w},-1),r(W,"$each",function F(B){var X=F.$$p||A,L,w,b=this;return delete F.$$p,L=e.slice.call(arguments),w=L,X===A?q(b,"to_enum",["each"].concat(C(w)),function M(){var D=M.$$s==null?this:M.$$s;return D.$size()},{$$arity:0,$$s:b}):(q(b.enums,"each",[],function M(D){var G=M.$$s==null?this:M.$$s;return G.iterated==null&&(G.iterated=A),D==null&&(D=A),G.iterated["$<<"](D),q(D,"each",C(w),X.$to_proc())},{$$arity:1,$$s:b}),b)},-1),r(W,"$size",function(B){try{var X,L,w=this,b=A;return X=e.slice.call(arguments),L=X,b=0,q(w.enums,"each",[],function(D){var G=A;return D==null&&(D=A),G=q(D,"size",C(L)),I([A,o(o("Float"),"INFINITY")]["$include?"](G))&&e.ret(G),b=h(b,G)},1),b}catch(M){if(M===e.returner)return M.$v;throw M}},-1),r(W,"$rewind",function(){var B=this;return q(B.iterated,"reverse_each",[],function(L){return L==null&&(L=A),I(L["$respond_to?"]("rewind"))?L.$rewind():A},1),B.iterated=[],B},0),r(W,"$inspect",function(){var B=this;return"#<Enumerator::Chain: "+B.enums.$inspect()+">"},0)}(T,T)}("::",null)};Opal.modules["corelib/enumerator/generator"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.breaker,q=e.klass,C=e.truthy,I=e.Kernel,h=e.def,v=e.send;return function(z,T,U){var J=q(z,T,"Enumerator"),W=[J].concat(U);return function(S,F,B){var X=q(S,F,"Generator"),L=[X].concat(B),w=e.$r(L),b=X.$$prototype;return b.block=o,X.$include(t("Enumerable")),h(X,"$initialize",function M(){var D=M.$$p||o,G=this;return delete M.$$p,C(D)||I.$raise(t("LocalJumpError"),"no block given"),G.block=D},0),h(X,"$each",function M(D){var G=M.$$p||o,R,f,E=this,g=o;delete M.$$p,R=e.slice.call(arguments),f=R,g=v(w("Yielder"),"new",[],G.$to_proc());try{f.unshift(g),e.yieldX(E.block,f)}catch(_){if(_===r)return r.$v;throw _}return E},-1)}(W[0],null,W)}(A[0],null,A)};Opal.modules["corelib/enumerator/lazy"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.truthy,q=e.coerce_to,C=e.yield1,I=e.yieldX,h=e.klass,v=e.send2,z=e.find_super,T=e.to_a,U=e.defs,J=e.Kernel,W=e.send,S=e.def,F=e.Opal,B=e.rb_lt,X=e.eqeqeq,L=e.rb_plus,w=e.alias;return function(b,M,D){var G=h(b,M,"Enumerator"),R=[G].concat(D);return function(f,E,g){var _=h(f,E,"Lazy"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;return s.enumerator=o,h(_,t("Exception"),"StopLazyError"),U(_,"$for",function i(n,$){var l,d,m=i.$$p||o,k=this,x=o;return delete i.$$p,l=e.slice.call(arguments,1),d=l,x=v(k,z(k,"for",i,!1,!0),"for",[n].concat(T(d)),m),x.enumerator=n,x},-2),S(_,"$initialize",function i(n,$){var l=i.$$p||o,d=this;return delete i.$$p,$==null&&($=o),l===o&&J.$raise(t("ArgumentError"),"tried to call lazy new without a block"),d.enumerator=n,v(d,z(d,"initialize",i,!1,!0),"initialize",[$],function(k,x){var Y,a;k==null&&(k=o),Y=e.slice.call(arguments,1),a=Y;try{return W(n,"each",T(a),function(p){var H,Q;H=e.slice.call(arguments),Q=H,Q.unshift(k),I(l,Q)},-1)}catch(N){if(e.rescue(N,[c("StopLazyError")]))try{return o}finally{e.pop_exception()}else throw N}},-2)},-2),S(_,"$lazy",function(){var n=this;return n},0),S(_,"$collect",function i(){var n=i.$$p||o,$=this;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy map without a block"),W(c("Lazy"),"new",[$,$.$enumerator_size()],function(d,m){var k,x;d==null&&(d=o),k=e.slice.call(arguments,1),x=k;var Y=I(n,x);d.$yield(Y)},-2)},0),S(_,"$collect_concat",function i(){var n=i.$$p||o,$=this;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy map without a block"),W(c("Lazy"),"new",[$,o],function(d,m){var k,x;d==null&&(d=o),k=e.slice.call(arguments,1),x=k;var Y=I(n,x);if(Y["$respond_to?"]("force")&&Y["$respond_to?"]("each"))W(Y,"each",[],function(p){return p==null&&(p=o),d.$yield(p)},1);else{var a=F.$try_convert(Y,t("Array"),"to_ary");a===o?d.$yield(Y):W(Y,"each",[],function(p){return p==null&&(p=o),d.$yield(p)},1)}},-2)},0),S(_,"$drop",function(n){var $=this,l=o,d=o,m=o;return n=q(n,t("Integer"),"to_int"),r(B(n,0))&&J.$raise(t("ArgumentError"),"attempt to drop negative size"),l=$.$enumerator_size(),d=X(t("Integer"),l)&&r(B(n,l))?n:l,m=0,W(c("Lazy"),"new",[$,d],function(x,Y){var a,N;return x==null&&(x=o),a=e.slice.call(arguments,1),N=a,r(B(m,n))?m=L(m,1):W(x,"yield",T(N))},-2)},1),S(_,"$drop_while",function i(){var n=i.$$p||o,$=this,l=o;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy drop_while without a block"),l=!0,W(c("Lazy"),"new",[$,o],function(m,k){var x,Y;if(m==null&&(m=o),x=e.slice.call(arguments,1),Y=x,r(l)){var a=I(n,Y);r(a)||(l=!1,W(m,"yield",T(Y)))}else return W(m,"yield",T(Y))},-2)},0),S(_,"$enum_for",function i(n,$){var l=i.$$p||o,d,m,k,x=this;return delete i.$$p,d=e.slice.call(arguments),d.length>0&&(m=d.shift()),m==null&&(m="each"),k=d,W(x.$class(),"for",[x,m].concat(T(k)),l.$to_proc())},-1),S(_,"$find_all",function i(){var n=i.$$p||o,$=this;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy select without a block"),W(c("Lazy"),"new",[$,o],function(d,m){var k,x;d==null&&(d=o),k=e.slice.call(arguments,1),x=k;var Y=I(n,x);r(Y)&&W(d,"yield",T(x))},-2)},0),S(_,"$grep",function i(n){var $=i.$$p||o,l=this;return delete i.$$p,r($)?W(c("Lazy"),"new",[l,o],function(m,k){var x,Y;m==null&&(m=o),x=e.slice.call(arguments,1),Y=x;var a=F.$destructure(Y),N=n["$==="](a);r(N)&&(N=C($,a),m.$yield(C($,a)))},-2):W(c("Lazy"),"new",[l,o],function(m,k){var x,Y;m==null&&(m=o),x=e.slice.call(arguments,1),Y=x;var a=F.$destructure(Y),N=n["$==="](a);r(N)&&m.$yield(a)},-2)},1),S(_,"$reject",function i(){var n=i.$$p||o,$=this;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy reject without a block"),W(c("Lazy"),"new",[$,o],function(d,m){var k,x;d==null&&(d=o),k=e.slice.call(arguments,1),x=k;var Y=I(n,x);r(Y)||W(d,"yield",T(x))},-2)},0),S(_,"$take",function(n){var $=this,l=o,d=o,m=o;return n=q(n,t("Integer"),"to_int"),r(B(n,0))&&J.$raise(t("ArgumentError"),"attempt to take negative size"),l=$.$enumerator_size(),d=X(t("Integer"),l)&&r(B(n,l))?n:l,m=0,W(c("Lazy"),"new",[$,d],function(x,Y){var a,N;return x==null&&(x=o),a=e.slice.call(arguments,1),N=a,r(B(m,n))?(W(x,"yield",T(N)),m=L(m,1)):J.$raise(c("StopLazyError"))},-2)},1),S(_,"$take_while",function i(){var n=i.$$p||o,$=this;return delete i.$$p,r(n)||J.$raise(t("ArgumentError"),"tried to call lazy take_while without a block"),W(c("Lazy"),"new",[$,o],function(d,m){var k,x;d==null&&(d=o),k=e.slice.call(arguments,1),x=k;var Y=I(n,x);r(Y)?W(d,"yield",T(x)):J.$raise(c("StopLazyError"))},-2)},0),S(_,"$inspect",function(){var n=this;return"#<"+n.$class()+": "+n.enumerator.$inspect()+">"},0),w(_,"force","to_a"),w(_,"filter","find_all"),w(_,"flat_map","collect_concat"),w(_,"map","collect"),w(_,"select","find_all"),w(_,"to_enum","enum_for")}(G,G,R)}("::",null,A)};Opal.modules["corelib/enumerator/yielder"]=function(e){var A=[],o=e.nil,t=e.breaker,r=e.klass,q=e.def,C=e.send,I=e.to_a;return function(h,v,z){var T=r(h,v,"Enumerator"),U=[T].concat(z);return function(J,W){var S=r(J,W,"Yielder"),F=S.$$prototype;return F.block=o,q(S,"$initialize",function B(){var X=B.$$p||o,L=this;return delete B.$$p,L.block=X,L},0),q(S,"$yield",function(X){var L,w,b=this;L=e.slice.call(arguments),w=L;var M=e.yieldX(b.block,w);if(M===t)throw t;return M},-1),q(S,"$<<",function(X){var L=this;return L.$yield(X),L},1),q(S,"$to_proc",function(){var X=this;return C(X,"proc",[],function L(w){var b,M,D=L.$$s==null?this:L.$$s;return b=e.slice.call(arguments),M=b,C(D,"yield",I(M))},{$$arity:-1,$$s:X})},0)}(U[0],null)}(A[0],null,A)};Opal.modules["corelib/enumerator"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.slice,C=e.coerce_to,I=e.klass,h=e.defs,v=e.truthy,z=e.send,T=e.not,U=e.def,J=e.rb_plus,W=e.to_a,S=e.Opal,F=e.send2,B=e.find_super,X=e.rb_ge,L=e.Kernel,w=e.rb_le,b=e.alias;return A.$require("corelib/enumerable"),function(M,D,G){var R=I(M,D,"Enumerator"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.size=g.args=g.object=g.method=g.values=g.cursor=t,R.$include(r("Enumerable")),R.$$prototype.$$is_enumerator=!0,h(R,"$for",function _(u,c,s){var i=_.$$p||t,n,$,l,d=this;delete _.$$p,n=e.slice.call(arguments,1),n.length>0&&($=n.shift()),$==null&&($="each"),l=n;var m=d.$allocate();return m.object=u,m.size=i,m.method=$,m.args=l,m.cursor=0,m},-2),U(R,"$initialize",function _(u){var c=_.$$p||t,s,i,n=this;return delete _.$$p,s=e.slice.call(arguments),i=s,n.cursor=0,v(c)?(n.object=z(E("Generator"),"new",[],c.$to_proc()),n.method="each",n.args=[],n.size=arguments[0]||t,v(n.size)&&T(n.size["$respond_to?"]("call"))?n.size=C(n.size,r("Integer"),"to_int"):t):(n.object=arguments[0],n.method=arguments[1]||"each",n.args=q.call(arguments,2),n.size=t)},-1),U(R,"$each",function _(u){var c=_.$$p||t,s,i,n=this;return delete _.$$p,s=e.slice.call(arguments),i=s,v(c["$nil?"]())&&v(i["$empty?"]())?n:(i=J(n.args,i),v(c["$nil?"]())?z(n.$class(),"new",[n.object,n.method].concat(W(i))):z(n.object,"__send__",[n.method].concat(W(i)),c.$to_proc()))},-1),U(R,"$size",function(){var u=this;return v(u.size["$respond_to?"]("call"))?z(u.size,"call",W(u.args)):u.size},0),U(R,"$with_index",function _(u){var c=_.$$p||t,s=this;if(delete _.$$p,u==null&&(u=0),u=v(u)?C(u,r("Integer"),"to_int"):0,!v(c))return z(s,"enum_for",["with_index",u],function $(){var l=$.$$s==null?this:$.$$s;return l.$size()},{$$arity:0,$$s:s});var i,n=u;return s.$each.$$p=function(){var $=S.$destructure(arguments),l=c($,n);return n++,l},s.$each()},-1),U(R,"$each_with_index",function _(){var u=_.$$p||t,c=this;return delete _.$$p,u===t?z(c,"enum_for",["each_with_index"],function s(){var i=s.$$s==null?this:s.$$s;return i.$size()},{$$arity:0,$$s:c}):(F(c,B(c,"each_with_index",_,!1,!0),"each_with_index",[],u),c.object)},0),U(R,"$rewind",function(){var u=this;return u.cursor=0,u},0),U(R,"$peek_values",function(){var u=this,c=t;return u.values=v(c=u.values)?c:z(u,"map",[],function(i){var n,$;return n=e.slice.call(arguments),$=n,$},-1),v(X(u.cursor,u.values.$length()))&&L.$raise(r("StopIteration"),"iteration reached an end"),u.values["$[]"](u.cursor)},0),U(R,"$peek",function(){var u=this,c=t;return c=u.$peek_values(),v(w(c.$length(),1))?c["$[]"](0):c},0),U(R,"$next_values",function(){var u=this,c=t;return c=u.$peek_values(),u.cursor=J(u.cursor,1),c},0),U(R,"$next",function(){var u=this,c=t;return c=u.$next_values(),v(w(c.$length(),1))?c["$[]"](0):c},0),U(R,"$feed",function(u){var c=this;return c.$raise(E("NotImplementedError"),"Opal doesn't support Enumerator#feed")},1),U(R,"$+",function(u){var c=this;return r(r("Enumerator"),"Chain").$new(c,u)},1),U(R,"$inspect",function(){var u=this,c=t;return c="#<"+u.$class()+": "+u.object.$inspect()+":"+u.method,v(u.args["$any?"]())&&(c=J(c,"("+u.args.$inspect()["$[]"](r("Range").$new(1,-2))+")")),J(c,">")},0),b(R,"with_object","each_with_object"),R.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),R.$autoload("Chain","corelib/enumerator/chain"),R.$autoload("Generator","corelib/enumerator/generator"),R.$autoload("Lazy","corelib/enumerator/lazy"),R.$autoload("Yielder","corelib/enumerator/yielder")}("::",null,o)};Opal.modules["corelib/numeric"]=function(e){var A=e.top,o=e.nil,t=e.$$$,r=e.klass,q=e.truthy,C=e.Kernel,I=e.def,h=e.to_ary,v=e.eqeqeq,z=e.rb_minus,T=e.rb_times,U=e.rb_lt,J=e.eqeq,W=e.rb_divide,S=e.Opal,F=e.hash2,B=e.not,X=e.send,L=e.rb_ge,w=e.rb_le,b=e.rb_plus,M=e.rb_gt,D=e.alias;return A.$require("corelib/comparable"),function(G,R){var f=r(G,R,"Numeric");return f.$include(t("Comparable")),I(f,"$coerce",function(g){var _=this;return q(g["$instance_of?"](_.$class()))?[g,_]:[C.$Float(g),C.$Float(_)]},1),I(f,"$__coerced__",function(g,_){var u,c,s=this,i=o,n=o,$=o;return q(_["$respond_to?"]("coerce"))?(c=_.$coerce(s),u=h(c),i=u[0]==null?o:u[0],n=u[1]==null?o:u[1],i.$__send__(g,n)):v("+",$=g)||v("-",$)||v("*",$)||v("/",$)||v("%",$)||v("&",$)||v("|",$)||v("^",$)||v("**",$)?C.$raise(t("TypeError"),""+_.$class()+" can't be coerced into Numeric"):v(">",$)||v(">=",$)||v("<",$)||v("<=",$)||v("<=>",$)?C.$raise(t("ArgumentError"),"comparison of "+s.$class()+" with "+_.$class()+" failed"):o},2),I(f,"$<=>",function(g){var _=this;return q(_["$equal?"](g))?0:o},1),I(f,"$+@",function(){var g=this;return g},0),I(f,"$-@",function(){var g=this;return z(0,g)},0),I(f,"$%",function(g){var _=this;return z(_,T(g,_.$div(g)))},1),I(f,"$abs",function(){var g=this;return U(g,0)?g["$-@"]():g},0),I(f,"$abs2",function(){var g=this;return T(g,g)},0),I(f,"$angle",function(){var g=this;return U(g,0)?t(t("Math"),"PI"):0},0),I(f,"$ceil",function(g){var _=this;return g==null&&(g=0),_.$to_f().$ceil(g)},-1),I(f,"$conj",function(){var g=this;return g},0),I(f,"$denominator",function(){var g=this;return g.$to_r().$denominator()},0),I(f,"$div",function(g){var _=this;return J(g,0)&&C.$raise(t("ZeroDivisionError"),"divided by o"),W(_,g).$floor()},1),I(f,"$divmod",function(g){var _=this;return[_.$div(g),_["$%"](g)]},1),I(f,"$fdiv",function(g){var _=this;return W(_.$to_f(),g)},1),I(f,"$floor",function(g){var _=this;return g==null&&(g=0),_.$to_f().$floor(g)},-1),I(f,"$i",function(){var g=this;return C.$Complex(0,g)},0),I(f,"$imag",function(){return 0},0),I(f,"$integer?",function(){return!1},0),I(f,"$nonzero?",function(){var g=this;return q(g["$zero?"]())?o:g},0),I(f,"$numerator",function(){var g=this;return g.$to_r().$numerator()},0),I(f,"$polar",function(){var g=this;return[g.$abs(),g.$arg()]},0),I(f,"$quo",function(g){var _=this;return W(S["$coerce_to!"](_,t("Rational"),"to_r"),g)},1),I(f,"$real",function(){var g=this;return g},0),I(f,"$real?",function(){return!0},0),I(f,"$rect",function(){var g=this;return[g,0]},0),I(f,"$round",function(g){var _=this;return _.$to_f().$round(g)},-1),I(f,"$step",function E(g,_,u){var c=E.$$p||o,s,i,n,$,l,d,m,k=this,x=o;if(delete E.$$p,s=e.slice.call(arguments),i=e.extract_kwargs(s),i==null)i=F([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");s.length>0&&(n=s.shift()),s.length>0&&($=s.shift()),l=i.$$smap.to,d=i.$$smap.by,n!==void 0&&l!==void 0&&C.$raise(t("ArgumentError"),"to is given twice"),$!==void 0&&d!==void 0&&C.$raise(t("ArgumentError"),"step is given twice"),l!==void 0&&(n=l),d!==void 0&&($=d),n===void 0&&(n=o);function Y(){$===o&&C.$raise(t("TypeError"),"step must be numeric"),$!=null&&$["$=="](0)&&C.$raise(t("ArgumentError"),"step can't be 0"),($===o||$==null)&&($=1);var y=$["$<=>"](0);y===o&&C.$raise(t("ArgumentError"),"0 can't be coerced into "+$.$class()),(n===o||n==null)&&(n=y>0?t(t("Float"),"INFINITY"):t(t("Float"),"INFINITY")["$-@"]()),S.$compare(k,n)}function a(){if($>0&&k>n||$<0&&k<n)return 0;if($===1/0||$===-1/0)return 1;var y=Math.abs,K=Math.floor,P=(y(k)+y(n)+y(n-k))/y($)*t(t("Float"),"EPSILON");return P===1/0||P===-1/0?0:(P>.5&&(P=.5),K((n-k)/$+P)+1)}function N(){if(Y(),$===0)return 1/0;if($%1!==0)return a();if($>0&&k>n||$<0&&k<n)return 0;var y=Math.ceil,K=Math.abs,P=K(k-n)+1,j=K($);return y(P/j)}if(c===o)return(B(n)||q(n["$is_a?"](t("Numeric"))))&&(B($)||q($["$is_a?"](t("Numeric"))))?t(t("Enumerator"),"ArithmeticSequence").$new([n,$,q(l)?"to: ":o,q(d)?"by: ":o],k):X(k,"enum_for",["step",n,$],N.$to_proc());Y();var p=$["$negative?"](),H=$["$=="](0)||n===1/0&&!p||n===-1/0&&p;if(k.$$is_number&&$.$$is_number&&n.$$is_number)if(k%1===0&&(H||n%1===0)&&$%1===0){var Q=k;if(H)for(;;Q+=$)c(Q);else if(p)for(;Q>=n;Q+=$)c(Q);else for(;Q<=n;Q+=$)c(Q);return k}else{var ee=k.$to_f().valueOf();$=$.$to_f().valueOf(),n=n.$to_f().valueOf();var ne=a();if(!isFinite($))ne!==0&&c(ee);else if($===0)for(;;)c(ee);else for(var V=0;V<ne;V++){var Z=V*$+k;($>=0?n<Z:n>Z)&&(Z=n),c(Z)}return k}for(x=k;q(p?L(x,n):w(x,n));)e.yield1(c,x),x=b(x,$)},-1),I(f,"$to_c",function(){var g=this;return C.$Complex(g,0)},0),I(f,"$to_int",function(){var g=this;return g.$to_i()},0),I(f,"$truncate",function(g){var _=this;return g==null&&(g=0),_.$to_f().$truncate(g)},-1),I(f,"$zero?",function(){var g=this;return g["$=="](0)},0),I(f,"$positive?",function(){var g=this;return M(g,0)},0),I(f,"$negative?",function(){var g=this;return U(g,0)},0),I(f,"$dup",function(){var g=this;return g},0),I(f,"$clone",function(g){var _,u=this;if(g==null)g=F([],{});else if(!g.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return _=g.$$smap.freeze,_==null&&(_=!0),u},-1),I(f,"$finite?",function(){return!0},0),I(f,"$infinite?",function(){return o},0),D(f,"arg","angle"),D(f,"conjugate","conj"),D(f,"imaginary","imag"),D(f,"magnitude","abs"),D(f,"modulo","%"),D(f,"phase","arg"),D(f,"rectangular","rect")}("::",null)};Opal.modules["corelib/array"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.truthy,C=e.falsy,I=e.hash_ids,h=e.yield1,v=e.hash_get,z=e.hash_put,T=e.hash_delete,U=e.coerce_to,J=e.respond_to,W=e.klass,S=e.defs,F=e.Kernel,B=e.def,X=e.Opal,L=e.eqeqeq,w=e.hash2,b=e.send2,M=e.find_super,D=e.send,G=e.rb_gt,R=e.rb_times,f=e.eqeq,E=e.rb_minus,g=e.to_a,_=e.to_ary,u=e.gvars,c=e.rb_ge,s=e.rb_lt,i=e.neqeq,n=e.alias;return A.$require("corelib/enumerable"),A.$require("corelib/numeric"),function($,l,d){var m=W($,l,"Array"),k=[m].concat(d),x=e.$r(k);m.$include(r("Enumerable")),e.prop(m.$$prototype,"$$is_array",!0);function Y(Z){for(var y=Z[0],K=1,P=Z.length;K<P;K++)Z[K-1]=Z[K];return Z.pop(),y}function a(Z,y){return y.$$name===e.Array?Z:y.$allocate().$replace(Z.$to_a())}function N(Z,y,K){for(var P,j=null,O=new Array(Z.length),re=0,te=0,ie=Z.length;re<ie;re++){if(!j)try{P=h(K,Z[re])}catch($e){j=$e}(j||y(P))&&(O[te]=Z[re],te+=1)}if(te!==re&&(Z.splice.apply(Z,[0,O.length].concat(O)),Z.splice(te,O.length)),j)throw j}S(m,"$[]",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,a(P,j)},-1),B(m,"$initialize",function Z(y,K){var P=Z.$$p||t,j=this;if(delete Z.$$p,y==null&&(y=t),K==null&&(K=t),K!==t&&P!==t&&F.$warn("warning: block supersedes default value argument"),y>r(r("Integer"),"MAX")&&F.$raise(r("ArgumentError"),"array size too big"),arguments.length>2&&F.$raise(r("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),arguments.length===0)return j.splice(0,j.length),j;if(arguments.length===1){if(y.$$is_array)return j.$replace(y.$to_a()),j;if(y["$respond_to?"]("to_ary"))return j.$replace(y.$to_ary()),j}y=U(y,r("Integer"),"to_int"),y<0&&F.$raise(r("ArgumentError"),"negative array size"),j.splice(0,j.length);var O,re;if(P===t)for(O=0;O<y;O++)j.push(K);else for(O=0,re;O<y;O++)re=P(O),j[O]=re;return j},-1),S(m,"$try_convert",function(y){return X["$coerce_to?"](y,r("Array"),"to_ary")},1),B(m,"$&",function(y){var K=this;y=L(r("Array"),y)?y.$to_a():U(y,r("Array"),"to_ary").$to_a();var P=[],j=w([],{}),O,re,te;for(O=0,re=y.length;O<re;O++)z(j,y[O],!0);for(O=0,re=K.length;O<re;O++)te=K[O],T(j,te)!==void 0&&P.push(te);return P},1),B(m,"$|",function(y){var K=this;y=L(r("Array"),y)?y.$to_a():U(y,r("Array"),"to_ary").$to_a();var P=w([],{}),j,O,re;for(j=0,O=K.length;j<O;j++)z(P,K[j],!0);for(j=0,O=y.length;j<O;j++)z(P,y[j],!0);return P.$keys()},1),B(m,"$*",function(y){var K=this;if(q(y["$respond_to?"]("to_str")))return K.$join(y.$to_str());y=U(y,r("Integer"),"to_int"),q(y<0)&&F.$raise(r("ArgumentError"),"negative argument");for(var P=[],j=K.$to_a(),O=0;O<y;O++)P=P.concat(j);return P},1),B(m,"$+",function(y){var K=this;return y=L(r("Array"),y)?y.$to_a():U(y,r("Array"),"to_ary").$to_a(),K.concat(y)},1),B(m,"$-",function(y){var K=this;if(y=L(r("Array"),y)?y.$to_a():U(y,r("Array"),"to_ary").$to_a(),q(K.length===0))return[];if(q(y.length===0))return K.slice();var P=[],j=w([],{}),O,re,te;for(O=0,re=y.length;O<re;O++)z(j,y[O],!0);for(O=0,re=K.length;O<re;O++)te=K[O],v(j,te)===void 0&&P.push(te);return P},1),B(m,"$<<",function(y){var K=this;return K.push(y),K},1),B(m,"$<=>",function(y){var K=this;if(L(r("Array"),y))y=y.$to_a();else if(q(y["$respond_to?"]("to_ary")))y=y.$to_ary().$to_a();else return t;if(K.$hash()===y.$hash())return 0;for(var P=Math.min(K.length,y.length),j=0;j<P;j++){var O=K[j]["$<=>"](y[j]);if(O!==0)return O}return K.length["$<=>"](y.length)},1),B(m,"$==",function(y){var K=this,P={};function j(O,re){var te,ie,$e,se;if(O===re)return!0;if(!re.$$is_array)return J(re,"$to_ary")?re["$=="](O):!1;if(O.$$constructor!==Array&&(O=O.$to_a()),re.$$constructor!==Array&&(re=re.$to_a()),O.length!==re.length)return!1;for(P[O.$object_id()]=!0,te=0,ie=O.length;te<ie;te++)if($e=O[te],se=re[te],$e.$$is_array){if(se.$$is_array&&se.length!==$e.length||!P.hasOwnProperty($e.$object_id())&&!j($e,se))return!1}else if(!$e["$=="](se))return!1;return!0}return j(K,y)},1);function p(Z,y){var K=Z.length,P,j,O,re;return P=y.excl,j=y.begin===t?0:U(y.begin,e.Integer,"to_int"),O=y.end===t?-1:U(y.end,e.Integer,"to_int"),j<0&&(j+=K,j<0)||(y.excl_rev&&y.begin!==t&&(j+=1),j>K)?t:O<0&&(O+=K,O<0)?[]:((!P||y.end===t)&&(O+=1),re=Z.slice(j,O),re)}function H(Z,y){var K,P=[],j=0,O;for(y.step<0?(O={begin:y.range.end,end:y.range.begin,excl:!1,excl_rev:y.range.excl},K=p(Z,O).$reverse()):K=p(Z,y.range);j<K.length;)P.push(K[j]),j+=Math.abs(y.step);return P}function Q(Z,y,K){var P=Z.length,j,O,re,te;return y=U(y,e.Integer,"to_int"),y<0&&(y+=P,y<0)?t:K===void 0?y>=P||y<0?t:Z[y]:(K=U(K,e.Integer,"to_int"),K<0||y>P||y<0?t:(te=Z.slice(y,y+K),te))}B(m,"$[]",function(y,K){var P=this;return y.$$is_range?p(P,y):y.$$is_arithmetic_seq?H(P,y):Q(P,y,K)},-2),B(m,"$[]=",function(y,K,P){var j=this,O=t,re=t,te,ie=j.length;if(L(r("Range"),y)){O=L(r("Array"),K)?K.$to_a():q(K["$respond_to?"]("to_ary"))?K.$to_ary().$to_a():[K];var $e=y.excl,se=y.begin===t?0:U(y.begin,e.Integer,"to_int"),oe=y.end===t?-1:U(y.end,e.Integer,"to_int");if(se<0&&(se+=ie,se<0&&F.$raise(r("RangeError"),""+y.$inspect()+" out of range")),oe<0&&(oe+=ie),(!$e||y.end===t)&&(oe+=1),se>ie)for(te=ie;te<se;te++)j[te]=t;return oe<0?j.splice.apply(j,[se,0].concat(O)):j.splice.apply(j,[se,oe-se].concat(O)),K}else{q(P===void 0)?re=1:(re=K,K=P,O=L(r("Array"),K)?K.$to_a():q(K["$respond_to?"]("to_ary"))?K.$to_ary().$to_a():[K]);var le;if(y=U(y,r("Integer"),"to_int"),re=U(re,r("Integer"),"to_int"),y<0&&(le=y,y+=ie,y<0&&F.$raise(r("IndexError"),"index "+le+" too small for array; minimum "+-j.length)),re<0&&F.$raise(r("IndexError"),"negative length ("+re+")"),y>ie)for(te=ie;te<y;te++)j[te]=t;return P===void 0?j[y]=K:j.splice.apply(j,[y,re].concat(O)),K}},-3),B(m,"$any?",function Z(y){var K=Z.$$p||t,P=this;return delete Z.$$p,P.length===0?!1:b(P,M(P,"any?",Z,!1,!0),"any?",[y],K)},-1),B(m,"$assoc",function(y){for(var K=this,P=0,j=K.length,O;P<j;P++)if(O=K[P],O.length&&O[0]["$=="](y))return O;return t},1),B(m,"$at",function(y){var K=this;return y=U(y,r("Integer"),"to_int"),y<0&&(y+=K.length),y<0||y>=K.length?t:K[y]},1),B(m,"$bsearch_index",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return K.$enum_for("bsearch_index");for(var P=0,j=K.length,O,re,te,ie=!1,$e=t;P<j;){if(O=P+Math.floor((j-P)/2),re=K[O],te=h(y,re),te===!0)$e=O,ie=!0;else if(te===!1||te===t)ie=!1;else if(te.$$is_number){if(te===0)return O;ie=te<0}else F.$raise(r("TypeError"),"wrong argument type "+te.$class()+" (must be numeric, true, false or nil)");ie?j=O:P=O+1}return $e},0),B(m,"$bsearch",function Z(){var y=Z.$$p||t,K=this,P=t;return delete Z.$$p,y===t?K.$enum_for("bsearch"):(P=D(K,"bsearch_index",[],y.$to_proc()),P!=null&&P.$$is_number?K[P]:P)},0),B(m,"$cycle",function Z(y){var K=Z.$$p||t,P=this;if(delete Z.$$p,y==null&&(y=t),K===t)return D(P,"enum_for",["cycle",y],function te(){var ie=te.$$s==null?this:te.$$s;return q(y["$nil?"]())?r(r("Float"),"INFINITY"):(y=X["$coerce_to!"](y,r("Integer"),"to_int"),q(G(y,0))?R(ie.$enumerator_size(),y):0)},{$$arity:0,$$s:P});if(q(P["$empty?"]())||f(y,0))return t;var j,O,re;if(y===t)for(;;)for(j=0,O=P.length;j<O;j++)re=h(K,P[j]);else{if(y=X["$coerce_to!"](y,r("Integer"),"to_int"),y<=0)return P;for(;y>0;){for(j=0,O=P.length;j<O;j++)re=h(K,P[j]);y--}}return P},-1),B(m,"$clear",function(){var y=this;return y.splice(0,y.length),y},0),B(m,"$count",function Z(y){var K=Z.$$p||t,P=this;return delete Z.$$p,q(y!==void 0)||q(K)?b(P,M(P,"count",Z,!1,!0),"count",[y],K):P.$size()},-1),B(m,"$initialize_copy",function(y){var K=this;return K.$replace(y)},1),B(m,"$collect",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["collect"],function te(){var ie=te.$$s==null?this:te.$$s;return ie.$size()},{$$arity:0,$$s:K});for(var P=[],j=0,O=K.length;j<O;j++){var re=h(y,K[j]);P.push(re)}return P},0),B(m,"$collect!",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["collect!"],function re(){var te=re.$$s==null?this:re.$$s;return te.$size()},{$$arity:0,$$s:K});for(var P=0,j=K.length;P<j;P++){var O=h(y,K[P]);K[P]=O}return K},0);function ee(Z,y){return Z===y||y===0?1:y>0&&Z>y?ee(Z-1,y-1)+ee(Z-1,y):0}B(m,"$combination",function Z(y){var K=Z.$$p||t,P=this,j=t;if(delete Z.$$p,j=X["$coerce_to!"](y,r("Integer"),"to_int"),K===t)return D(P,"enum_for",["combination",j],function le(){var ce=le.$$s==null?this:le.$$s;return ee(ce.length,j)},{$$arity:0,$$s:P});var O,re,te,ie,$e,se,oe;if(j===0)e.yield1(K,[]);else if(j===1)for(O=0,re=P.length;O<re;O++)e.yield1(K,[P[O]]);else if(j===P.length)e.yield1(K,P.slice());else if(j>=0&&j<P.length){for(te=[],O=0;O<=j+1;O++)te.push(0);for(ie=[],$e=0,se=!1,te[0]=-1;!se;){for(ie[$e]=P[te[$e+1]];$e<j-1;)$e++,oe=te[$e+1]=te[$e]+1,ie[$e]=P[oe];e.yield1(K,ie.slice()),$e++;do se=$e===0,te[$e]++,$e--;while(te[$e+1]+j===P.length+$e+1)}}return P},1),B(m,"$repeated_combination",function Z(y){var K=Z.$$p||t,P=this,j=t;if(delete Z.$$p,j=X["$coerce_to!"](y,r("Integer"),"to_int"),K===t)return D(P,"enum_for",["repeated_combination",j],function re(){var te=re.$$s==null?this:re.$$s;return ee(te.length+j-1,j)},{$$arity:0,$$s:P});function O(re,te,ie,$e){if(ie.length==re){var se=ie.slice();e.yield1(K,se);return}for(var oe=te;oe<$e.length;oe++)ie.push($e[oe]),O(re,oe,ie,$e),ie.pop()}return j>=0&&O(j,0,[],P),P},1),B(m,"$compact",function(){for(var y=this,K=[],P=0,j=y.length,O;P<j;P++)(O=y[P])!==t&&K.push(O);return K},0),B(m,"$compact!",function(){for(var y=this,K=y.length,P=0,j=y.length;P<j;P++)y[P]===t&&(y.splice(P,1),j--,P--);return y.length===K?t:y},0),B(m,"$concat",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,P=D(P,"map",[],function O(re){var te=O.$$s==null?this:O.$$s;return re==null&&(re=t),re=L(r("Array"),re)?re.$to_a():U(re,r("Array"),"to_ary").$to_a(),q(re["$equal?"](te))&&(re=re.$dup()),re},{$$arity:1,$$s:j}),D(P,"each",[],function O(re){var te=O.$$s==null?this:O.$$s;re==null&&(re=t);for(var ie=0,$e=re.length;ie<$e;ie++)te.push(re[ie])},{$$arity:1,$$s:j}),j},-1),B(m,"$delete",function Z(y){var K=Z.$$p||t,P=this;delete Z.$$p;for(var j=P.length,O=0,re=j;O<re;O++)P[O]["$=="](y)&&(P.splice(O,1),re--,O--);return P.length===j?K!==t?e.yieldX(K,[]):t:y},1),B(m,"$delete_at",function(y){var K=this;if(y=U(y,r("Integer"),"to_int"),y<0&&(y+=K.length),y<0||y>=K.length)return t;var P=K[y];return K.splice(y,1),P},1),B(m,"$delete_if",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,y===t?D(K,"enum_for",["delete_if"],function P(){var j=P.$$s==null?this:P.$$s;return j.$size()},{$$arity:0,$$s:K}):(N(K,C,y),K)},0),B(m,"$difference",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,D(P,"reduce",[j.$to_a().$dup()],function(re,te){return re==null&&(re=t),te==null&&(te=t),E(re,te)},2)},-1),B(m,"$dig",function(y,K){var P,j,O=this,re=t;return P=e.slice.call(arguments,1),j=P,re=O["$[]"](y),re===t||j.length===0?re:(q(re["$respond_to?"]("dig"))||F.$raise(r("TypeError"),""+re.$class()+" does not have #dig method"),D(re,"dig",g(j)))},-2),B(m,"$drop",function(y){var K=this;return y=U(y,r("Integer"),"to_int"),y<0&&F.$raise(r("ArgumentError")),K.slice(y)},1),B(m,"$dup",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,K.$$class===e.Array&&K.$$class.$allocate.$$pristine&&K.$copy_instance_variables.$$pristine&&K.$initialize_dup.$$pristine?K.slice(0):b(K,M(K,"dup",Z,!1,!0),"dup",[],y)},0),B(m,"$each",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["each"],function re(){var te=re.$$s==null?this:re.$$s;return te.$size()},{$$arity:0,$$s:K});for(var P=0,j=K.length;P<j;P++)var O=h(y,K[P]);return K},0),B(m,"$each_index",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["each_index"],function re(){var te=re.$$s==null?this:re.$$s;return te.$size()},{$$arity:0,$$s:K});for(var P=0,j=K.length;P<j;P++)var O=h(y,P);return K},0),B(m,"$empty?",function(){var y=this;return y.length===0},0),B(m,"$eql?",function(y){var K=this,P={};function j(O,re){var te,ie,$e,se;if(!re.$$is_array||(re=re.$to_a(),O.length!==re.length))return!1;for(P[O.$object_id()]=!0,te=0,ie=O.length;te<ie;te++)if($e=O[te],se=re[te],$e.$$is_array){if(se.$$is_array&&se.length!==$e.length||!P.hasOwnProperty($e.$object_id())&&!j($e,se))return!1}else if(!$e["$eql?"](se))return!1;return!0}return j(K,y)},1),B(m,"$fetch",function Z(y,K){var P=Z.$$p||t,j=this;delete Z.$$p;var O=y;if(y=U(y,r("Integer"),"to_int"),y<0&&(y+=j.length),y>=0&&y<j.length)return j[y];if(P!==t&&K!=null&&j.$warn("warning: block supersedes default value argument"),P!==t)return P(O);if(K!=null)return K;j.length===0?F.$raise(r("IndexError"),"index "+O+" outside of array bounds: 0...0"):F.$raise(r("IndexError"),"index "+O+" outside of array bounds: -"+j.length+"..."+j.length)},-2),B(m,"$fill",function Z(y){var K=Z.$$p||t,P,j,O,re,te=this,ie=t,$e=t,se=t,oe=t,le=t;delete Z.$$p,P=e.slice.call(arguments),j=P;var ce,ue,ae;if(q(K)?(q(j.length>2)&&F.$raise(r("ArgumentError"),"wrong number of arguments ("+j.$length()+" for 0..2)"),re=j,O=_(re),ie=O[0]==null?t:O[0],$e=O[1]==null?t:O[1]):(q(j.length==0)?F.$raise(r("ArgumentError"),"wrong number of arguments (0 for 1..3)"):q(j.length>3)&&F.$raise(r("ArgumentError"),"wrong number of arguments ("+j.$length()+" for 1..3)"),re=j,O=_(re),se=O[0]==null?t:O[0],ie=O[1]==null?t:O[1],$e=O[2]==null?t:O[2]),L(r("Range"),ie)){if(q($e)&&F.$raise(r("TypeError"),"length invalid with range"),oe=ie.begin===t?0:U(ie.begin,r("Integer"),"to_int"),q(oe<0)&&(oe+=this.length),q(oe<0)&&F.$raise(r("RangeError"),""+ie.$inspect()+" out of range"),le=ie.end===t?-1:U(ie.end,r("Integer"),"to_int"),q(le<0)&&(le+=this.length),q(ie["$exclude_end?"]())||(le+=1),q(le<=oe))return te}else if(q(ie))if(oe=U(ie,r("Integer"),"to_int"),q(oe<0)&&(oe+=this.length),q(oe<0)&&(oe=0),q($e)){if(le=U($e,r("Integer"),"to_int"),q(le==0))return te;le+=oe}else le=this.length;else oe=0,le=this.length;if(q(oe>this.length))for(ce=this.length;ce<le;ce++)te[ce]=t;if(q(le>this.length)&&(this.length=le),q(K))for(ue=this.length;oe<le;oe++)ae=K(oe),te[oe]=ae;else for(ue=this.length;oe<le;oe++)te[oe]=se;return te},-1),B(m,"$first",function(y){var K=this;return y==null?K.length===0?t:K[0]:(y=U(y,r("Integer"),"to_int"),y<0&&F.$raise(r("ArgumentError"),"negative array size"),K.slice(0,y))},-1),B(m,"$flatten",function(y){var K=this;function P(j,O){var re=[],te,ie,$e,se;for(j=j.$to_a(),te=0,ie=j.length;te<ie;te++){if($e=j[te],!J($e,"$to_ary",!0)){re.push($e);continue}if(se=$e.$to_ary(),se===t){re.push($e);continue}switch(se.$$is_array||F.$raise(r("TypeError")),se===K&&F.$raise(r("ArgumentError")),O){case void 0:re=re.concat(P(se));break;case 0:re.push(se);break;default:re.push.apply(re,P(se,O-1))}}return re}return y!==void 0&&(y=U(y,r("Integer"),"to_int")),P(K,y)},-1),B(m,"$flatten!",function(y){var K=this,P=K.$flatten(y);if(K.length==P.length){for(var j=0,O=K.length;j<O&&K[j]===P[j];j++);if(j==O)return t}return K.$replace(P),K},-1),B(m,"$hash",function(){var y=this,K=I===void 0,P=["A"],j=y.$object_id(),O,re,te;try{if(K&&(I=Object.create(null)),I[j])return"self";for(te in I)if(O=I[te],y["$eql?"](O))return"self";for(I[j]=y,re=0;re<y.length;re++)O=y[re],P.push(O.$hash());return P.join(",")}finally{K&&(I=void 0)}},0),B(m,"$include?",function(y){for(var K=this,P=0,j=K.length;P<j;P++)if(K[P]["$=="](y))return!0;return!1},1),B(m,"$index",function Z(y){var K=Z.$$p||t,P=this;delete Z.$$p;var j,O,re;if(y!=null&&K!==t&&P.$warn("warning: given block not used"),y!=null){for(j=0,O=P.length;j<O;j++)if(P[j]["$=="](y))return j}else if(K!==t){for(j=0,O=P.length;j<O;j++)if(re=K(P[j]),re!==!1&&re!==t)return j}else return P.$enum_for("index");return t},-1),B(m,"$insert",function(y,K){var P,j,O=this;if(P=e.slice.call(arguments,1),j=P,y=U(y,r("Integer"),"to_int"),j.length>0){if(y<0&&(y+=O.length+1,y<0&&F.$raise(r("IndexError"),""+y+" is out of bounds")),y>O.length)for(var re=O.length;re<y;re++)O.push(t);O.splice.apply(O,[y,0].concat(j))}return O},-2);var ne=[];B(m,"$inspect",function(){var y=this,K=[],P=y.$__id__(),j=!0;return function(){try{if(ne.indexOf(P)!==-1)return j=!1,"[...]";ne.push(P);for(var O=0,re=y.length;O<re;O++){var te=y["$[]"](O);K.push(x("Opal").$inspect(te))}return"["+K.join(", ")+"]"}finally{j&&ne.pop()}}()},0),B(m,"$intersection",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,D(P,"reduce",[j.$to_a().$dup()],function(re,te){return re==null&&(re=t),te==null&&(te=t),re["$&"](te)},2)},-1),B(m,"$intersect?",function(y){var K=this;return K.$intersection(y)["$empty?"]()["$!"]()},1),B(m,"$join",function(y){var K=this;if(u[","]==null&&(u[","]=t),y==null&&(y=t),q(K.length===0))return"";q(y===t)&&(y=u[","]);var P=[],j,O,re,te;for(j=0,O=K.length;j<O;j++){if(re=K[j],J(re,"$to_str")&&(te=re.$to_str(),te!==t)){P.push(te.$to_s());continue}if(J(re,"$to_ary")&&(te=re.$to_ary(),te===K&&F.$raise(r("ArgumentError")),te!==t)){P.push(te.$join(y));continue}if(J(re,"$to_s")&&(te=re.$to_s(),te!==t)){P.push(te);continue}F.$raise(r("NoMethodError").$new(""+x("Opal").$inspect(K.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"))}return y===t?P.join(""):P.join(X["$coerce_to!"](y,r("String"),"to_str").$to_s())},-1),B(m,"$keep_if",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,y===t?D(K,"enum_for",["keep_if"],function P(){var j=P.$$s==null?this:P.$$s;return j.$size()},{$$arity:0,$$s:K}):(N(K,q,y),K)},0),B(m,"$last",function(y){var K=this;return y==null?K.length===0?t:K[K.length-1]:(y=U(y,r("Integer"),"to_int"),y<0&&F.$raise(r("ArgumentError"),"negative array size"),y>K.length&&(y=K.length),K.slice(K.length-y,K.length))},-1),B(m,"$length",function(){var y=this;return y.length},0),B(m,"$max",function Z(y){var K=Z.$$p||t,P=this;return delete Z.$$p,D(P.$each(),"max",[y],K.$to_proc())},-1),B(m,"$min",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,D(K.$each(),"min",[],y.$to_proc())},0);function V(Z,y){for(var K=y>=0?1:0;y;)K*=Z,Z--,y--;return K}return B(m,"$permutation",function Z(y){var K=Z.$$p||t,P=this,j=t,O=t;if(delete Z.$$p,K===t)return D(P,"enum_for",["permutation",y],function se(){var oe=se.$$s==null?this:se.$$s;return V(oe.length,y===void 0?oe.length:y)},{$$arity:0,$$s:P});var re,te,ie;if(y===void 0?y=P.length:y=U(y,r("Integer"),"to_int"),!(y<0||P.length<y))if(y===0)e.yield1(K,[]);else if(y===1)for(var $e=0;$e<P.length;$e++)e.yield1(K,[P[$e]]);else j=x("Array").$new(y),O=x("Array").$new(P.length,!1),re=function(se,oe,le,ce,ue){P=this;for(var ae=0;ae<P.length;ae++)if(ce["$[]"](ae)["$!"]())if(oe[le]=ae,le<se-1)ce[ae]=!0,re.call(P,se,oe,le+1,ce,ue),ce[ae]=!1;else{ie=[];for(var _e=0;_e<oe.length;_e++)ie.push(P[oe[_e]]);h(ue,ie)}},K!==t?(te=P.slice(),re.call(te,y,j,0,O,K)):re.call(P,y,j,0,O,K);return P},-1),B(m,"$repeated_permutation",function Z(y){var K=Z.$$p||t,P=this,j=t;if(delete Z.$$p,j=X["$coerce_to!"](y,r("Integer"),"to_int"),K===t)return D(P,"enum_for",["repeated_permutation",j],function re(){var te=re.$$s==null?this:re.$$s;return q(c(j,0))?te.$size()["$**"](j):0},{$$arity:0,$$s:P});function O(re,te,ie){if(te.length==re){var $e=te.slice();e.yield1(K,$e);return}for(var se=0;se<ie.length;se++)te.push(ie[se]),O(re,te,ie),te.pop()}return O(j,[],P.slice()),P},1),B(m,"$pop",function(y){var K=this;return q(y===void 0)?q(K.length===0)?t:K.pop():(y=U(y,r("Integer"),"to_int"),q(y<0)&&F.$raise(r("ArgumentError"),"negative array size"),q(K.length===0)?[]:q(y===1)?[K.pop()]:q(y>K.length)?K.splice(0,K.length):K.splice(K.length-y,K.length))},-1),B(m,"$product",function Z(y){var K=Z.$$p||t,P,j,O=this;delete Z.$$p,P=e.slice.call(arguments),j=P;var re=K!==t?null:[],te=j.length+1,ie=new Array(te),$e=new Array(te),se=new Array(te),oe,le,ce,ue,ae=1;for(se[0]=O,oe=1;oe<te;oe++)se[oe]=U(j[oe-1],r("Array"),"to_ary");for(oe=0;oe<te;oe++){if(ue=se[oe].length,ue===0)return re||O;ae*=ue,ae>2147483647&&F.$raise(r("RangeError"),"too big to product"),$e[oe]=ue,ie[oe]=0}e:for(;;){for(ce=[],oe=0;oe<te;oe++)ce.push(se[oe][ie[oe]]);for(re?re.push(ce):e.yield1(K,ce),le=te-1,ie[le]++;ie[le]===$e[le];){if(ie[le]=0,--le<0)break e;ie[le]++}}return re||O},-1),B(m,"$push",function(y){var K,P,j=this;K=e.slice.call(arguments),P=K;for(var O=0,re=P.length;O<re;O++)j.push(P[O]);return j},-1),B(m,"$rassoc",function(y){for(var K=this,P=0,j=K.length,O;P<j;P++)if(O=K[P],O.length&&O[1]!==void 0&&O[1]["$=="](y))return O;return t},1),B(m,"$reject",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["reject"],function te(){var ie=te.$$s==null?this:te.$$s;return ie.$size()},{$$arity:0,$$s:K});for(var P=[],j=0,O=K.length,re;j<O;j++)re=y(K[j]),(re===!1||re===t)&&P.push(K[j]);return P},0),B(m,"$reject!",function Z(){var y=Z.$$p||t,K=this,P=t;return delete Z.$$p,y===t?D(K,"enum_for",["reject!"],function j(){var O=j.$$s==null?this:j.$$s;return O.$size()},{$$arity:0,$$s:K}):(P=K.$length(),D(K,"delete_if",[],y.$to_proc()),f(K.$length(),P)?t:K)},0),B(m,"$replace",function(y){var K=this;return y=L(r("Array"),y)?y.$to_a():U(y,r("Array"),"to_ary").$to_a(),K.splice(0,K.length),K.push.apply(K,y),K},1),B(m,"$reverse",function(){var y=this;return y.slice(0).reverse()},0),B(m,"$reverse!",function(){var y=this;return y.reverse()},0),B(m,"$reverse_each",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,y===t?D(K,"enum_for",["reverse_each"],function P(){var j=P.$$s==null?this:P.$$s;return j.$size()},{$$arity:0,$$s:K}):(D(K.$reverse(),"each",[],y.$to_proc()),K)},0),B(m,"$rindex",function Z(y){var K=Z.$$p||t,P=this;delete Z.$$p;var j,O;if(y!=null&&K!==t&&P.$warn("warning: given block not used"),y!=null){for(j=P.length-1;j>=0&&!(j>=P.length);j--)if(P[j]["$=="](y))return j}else if(K!==t){for(j=P.length-1;j>=0&&!(j>=P.length);j--)if(O=K(P[j]),O!==!1&&O!==t)return j}else if(y==null)return P.$enum_for("rindex");return t},-1),B(m,"$rotate",function(y){var K=this;y==null&&(y=1);var P,j,O,re;return y=U(y,r("Integer"),"to_int"),K.length===1?K.slice():K.length===0?[]:(P=K.slice(),j=y%P.length,O=P.slice(j),re=P.slice(0,j),O.concat(re))},-1),B(m,"$rotate!",function(y){var K=this,P=t;return y==null&&(y=1),K.length===0||K.length===1?K:(y=U(y,r("Integer"),"to_int"),P=K.$rotate(y),K.$replace(P))},-1),function(Z,y){var K=W(Z,y,"SampleRandom"),P=K.$$prototype;return P.rng=t,B(K,"$initialize",function(O){var re=this;return re.rng=O},1),B(K,"$rand",function(O){var re=this,te=t;return te=U(re.rng.$rand(O),r("Integer"),"to_int"),q(te<0)&&F.$raise(r("RangeError"),"random value must be >= 0"),q(te<O)||F.$raise(r("RangeError"),"random value must be less than Array size"),te},1)}(m,null),B(m,"$sample",function(y,K){var P=this,j=t,O=t;if(q(y===void 0))return P.$at(F.$rand(P.length));if(q(K===void 0)?q(j=X["$coerce_to?"](y,r("Hash"),"to_hash"))?(K=j,y=t):(K=t,y=U(y,r("Integer"),"to_int")):(y=U(y,r("Integer"),"to_int"),K=U(K,r("Hash"),"to_hash")),q(y)&&q(y<0)&&F.$raise(r("ArgumentError"),"count must be greater than 0"),q(K)&&(O=K["$[]"]("random")),O=q(O)&&q(O["$respond_to?"]("rand"))?x("SampleRandom").$new(O):F,!q(y))return P[O.$rand(P.length)];var re,te,ie,$e,se,oe,le,ce;switch(y>P.length&&(y=P.length),y){case 0:return[];case 1:return[P[O.$rand(P.length)]];case 2:return $e=O.$rand(P.length),se=O.$rand(P.length),$e===se&&(se=$e===0?$e+1:$e-1),[P[$e],P[se]];break;default:if(P.length/y>3){for(re=!1,te=0,ie=x("Array").$new(y),$e=1,ie[0]=O.$rand(P.length);$e<y;){for(oe=O.$rand(P.length),se=0;se<$e;){for(;oe===ie[se];){if(te++,te>100){re=!0;break}oe=O.$rand(P.length)}if(re)break;se++}if(re)break;ie[$e]=oe,$e++}if(!re){for($e=0;$e<y;)ie[$e]=P[ie[$e]],$e++;return ie}}ie=P.slice();for(var ue=0;ue<y;ue++)le=O.$rand(P.length),ce=ie[ue],ie[ue]=ie[le],ie[le]=ce;return y===P.length?ie:ie["$[]"](0,y)}},-1),B(m,"$select",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["select"],function ie(){var $e=ie.$$s==null?this:ie.$$s;return $e.$size()},{$$arity:0,$$s:K});for(var P=[],j=0,O=K.length,re,te;j<O;j++)re=K[j],te=h(y,re),q(te)&&P.push(re);return P},0),B(m,"$select!",function Z(){var y=Z.$$p||t,K=this;if(delete Z.$$p,y===t)return D(K,"enum_for",["select!"],function j(){var O=j.$$s==null?this:j.$$s;return O.$size()},{$$arity:0,$$s:K});var P=K.length;return D(K,"keep_if",[],y.$to_proc()),K.length===P?t:K},0),B(m,"$shift",function(y){var K=this;return q(y===void 0)?q(K.length===0)?t:Y(K):(y=U(y,r("Integer"),"to_int"),q(y<0)&&F.$raise(r("ArgumentError"),"negative array size"),q(K.length===0)?[]:K.splice(0,y))},-1),B(m,"$shuffle",function(y){var K=this;return K.$dup().$to_a()["$shuffle!"](y)},-1),B(m,"$shuffle!",function(y){var K=this,P,j=K.length,O,re;for(y!==void 0&&(y=X["$coerce_to?"](y,r("Hash"),"to_hash"),y!==t&&(y=y["$[]"]("random"),y!==t&&y["$respond_to?"]("rand")&&(P=y)));j;)P?(O=P.$rand(j).$to_int(),O<0&&F.$raise(r("RangeError"),"random number too small "+O),O>=j&&F.$raise(r("RangeError"),"random number too big "+O)):O=K.$rand(j),re=K[--j],K[j]=K[O],K[O]=re;return K},-1),B(m,"$slice!",function(y,K){var P=this,j=t,O=t,re=t,te=t,ie=t;if(j=t,q(K===void 0))if(L(r("Range"),y)){O=y,j=P["$[]"](O),re=O.begin===t?0:U(O.begin,r("Integer"),"to_int"),te=O.end===t?-1:U(O.end,r("Integer"),"to_int"),re<0&&(re+=P.length),te<0?te+=P.length:te>=P.length&&(te=P.length-1,O.excl&&(te+=1));var $e=te-re;O.excl&&O.end!==t?te-=1:$e+=1,re<P.length&&re>=0&&te<P.length&&te>=0&&$e>0&&P.splice(re,$e)}else{if(ie=U(y,r("Integer"),"to_int"),ie<0&&(ie+=P.length),ie<0||ie>=P.length)return t;j=P[ie],ie===0?P.shift():P.splice(ie,1)}else{if(ie=U(y,r("Integer"),"to_int"),K=U(K,r("Integer"),"to_int"),K<0)return t;var se=ie+K;j=P["$[]"](ie,K),ie<0&&(ie+=P.length),ie+K>P.length&&(K=P.length-ie),ie<P.length&&ie>=0&&P.splice(ie,K)}return j},-2),B(m,"$sort",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,q(K.length>1)?(y===t&&(y=function(P,j){return P["$<=>"](j)}),K.slice().sort(function(P,j){var O=y(P,j);return O===t&&F.$raise(r("ArgumentError"),"comparison of "+P.$inspect()+" with "+j.$inspect()+" failed"),G(O,0)?1:s(O,0)?-1:0})):K},0),B(m,"$sort!",function Z(){var y=Z.$$p||t,K=this;delete Z.$$p;var P;y!==t?P=D(K.slice(),"sort",[],y.$to_proc()):P=K.slice().$sort(),K.length=0;for(var j=0,O=P.length;j<O;j++)K.push(P[j]);return K},0),B(m,"$sort_by!",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,y===t?D(K,"enum_for",["sort_by!"],function P(){var j=P.$$s==null?this:P.$$s;return j.$size()},{$$arity:0,$$s:K}):K.$replace(D(K,"sort_by",[],y.$to_proc()))},0),B(m,"$take",function(y){var K=this;return y<0&&F.$raise(r("ArgumentError")),K.slice(0,y)},1),B(m,"$take_while",function Z(){var y=Z.$$p||t,K=this;delete Z.$$p;for(var P=[],j=0,O=K.length,re,te;j<O;j++){if(re=K[j],te=y(re),te===!1||te===t)return P;P.push(re)}return P},0),B(m,"$to_a",function(){var y=this;return y.$$class===e.Array?y:e.Array.$new(y)},0),B(m,"$to_ary",function(){var y=this;return y},0),B(m,"$to_h",function Z(){var y=Z.$$p||t,K=this,P=t;delete Z.$$p,P=K,y!==t&&(P=D(P,"map",[],y.$to_proc()));var j,O=P.length,re,te,ie,$e=w([],{});for(j=0;j<O;j++)re=X["$coerce_to?"](P[j],r("Array"),"to_ary"),re.$$is_array||F.$raise(r("TypeError"),"wrong element type "+re.$class()+" at "+j+" (expected array)"),re.length!==2&&F.$raise(r("ArgumentError"),"wrong array length at "+j+" (expected 2, was "+re.$length()+")"),te=re[0],ie=re[1],z($e,te,ie);return $e},0),B(m,"$transpose",function(){var y=this,K=t,P=t;return q(y["$empty?"]())?[]:(K=[],P=t,D(y,"each",[],function(O){var re=t;return O==null&&(O=t),O=L(r("Array"),O)?O.$to_a():U(O,r("Array"),"to_ary").$to_a(),P=q(re=P)?re:O.length,i(O.length,P)&&F.$raise(r("IndexError"),"element size differs ("+O.length+" should be "+P+")"),D(O.length,"times",[],function(ie){var $e=t,se=t;return ie==null&&(ie=t),$e=q(re=K["$[]"](ie))?re:(se=[ie,[]],D(K,"[]=",g(se)),se[E(se.length,1)]),$e["$<<"](O.$at(ie))},1)},1),K)},0),B(m,"$union",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,D(P,"reduce",[j.$uniq()],function(re,te){return re==null&&(re=t),te==null&&(te=t),re["$|"](te)},2)},-1),B(m,"$uniq",function Z(){var y=Z.$$p||t,K=this;delete Z.$$p;var P=w([],{}),j,O,re,te;if(y===t)for(j=0,O=K.length;j<O;j++)re=K[j],v(P,re)===void 0&&z(P,re,re);else for(j=0,O=K.length;j<O;j++)re=K[j],te=h(y,re),v(P,te)===void 0&&z(P,te,re);return P.$values()},0),B(m,"$uniq!",function Z(){var y=Z.$$p||t,K=this;delete Z.$$p;var P=K.length,j=w([],{}),O,re,te,ie;for(O=0,re=P;O<re;O++){if(te=K[O],ie=y===t?te:h(y,te),v(j,ie)===void 0){z(j,ie,te);continue}K.splice(O,1),re--,O--}return K.length===P?t:K},0),B(m,"$unshift",function(y){var K,P,j=this;K=e.slice.call(arguments),P=K;var O=j.length,re=P.length;if(re==0)return j;for(var te=O-re,ie=0;ie<re;ie++)j.push(j[te+ie]);for(var $e=O-1;$e-re>=0;)j[$e]=j[$e-re],$e--;for(var se=0;se<re;se++)j[se]=P[se];return j},-1),B(m,"$values_at",function(y){var K,P,j=this,O=t;return K=e.slice.call(arguments),P=K,O=[],D(P,"each",[],function re(te){var ie=re.$$s==null?this:re.$$s,$e=t,se=t,oe=t;return te==null&&(te=t),q(te["$is_a?"](r("Range")))?($e=te.$end()===t?-1:U(te.$end(),r("Integer"),"to_int"),se=te.$begin()===t?0:U(te.$begin(),r("Integer"),"to_int"),se<0?(se=se+ie.length,t):($e<0&&($e=$e+ie.length),te["$exclude_end?"]()&&te.$end()!==t&&$e--,$e<se?t:D(se,"upto",[$e],function le(ce){var ue=le.$$s==null?this:le.$$s;return ce==null&&(ce=t),O["$<<"](ue.$at(ce))},{$$arity:1,$$s:ie}))):(oe=U(te,r("Integer"),"to_int"),O["$<<"](ie.$at(oe)))},{$$arity:1,$$s:j}),O},-1),B(m,"$zip",function Z(y){var K=Z.$$p||t,P,j,O=this,re=t;delete Z.$$p,P=e.slice.call(arguments),j=P;var te=[],ie=O.length,$e,se,oe,le,ce;for(le=0,ce=j.length;le<ce;le++)if(se=j[le],!se.$$is_array){if(se.$$is_range||se.$$is_enumerator){j[le]=se.$take(ie);continue}j[le]=(q(re=X["$coerce_to?"](se,r("Array"),"to_ary"))?re:X["$coerce_to!"](se,r("Enumerator"),"to_enum","each")).$to_a()}for(oe=0;oe<ie;oe++){for($e=[O[oe]],le=0,ce=j.length;le<ce;le++)se=j[le][oe],se==null&&(se=t),$e[le+1]=se;te[oe]=$e}if(K!==t){for(oe=0;oe<ie;oe++)e.yield1(K,te[oe]);return t}return te},-1),S(m,"$inherited",function(y){y.$$prototype.$to_a=function(){return this.slice(0,this.length)}},1),B(m,"$instance_variables",function Z(){var y=Z.$$p||t,K=this;return delete Z.$$p,D(b(K,M(K,"instance_variables",Z,!1,!0),"instance_variables",[],y),"reject",[],function(j){var O=t;return j==null&&(j=t),q(O=/^@\d+$/.test(j))?O:j["$=="]("@length")},1)},0),B(m,"$pack",function(y){var K,P;return K=e.slice.call(arguments),P=K,F.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),n(m,"append","push"),n(m,"filter","select"),n(m,"filter!","select!"),n(m,"map","collect"),n(m,"map!","collect!"),n(m,"prepend","unshift"),n(m,"size","length"),n(m,"slice","[]"),n(m,"to_s","inspect"),X.$pristine(m.$singleton_class(),"allocate"),X.$pristine(m,"copy_instance_variables","initialize_dup")}("::",Array,o)};Opal.modules["corelib/hash"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.yield1,C=e.hash,I=e.hash_init,h=e.hash_get,v=e.hash_put,z=e.hash_delete,T=e.klass,U=e.Opal,J=e.Kernel,W=e.defs,S=e.def,F=e.send,B=e.rb_ge,X=e.rb_gt,L=e.hash2,w=e.truthy,b=e.to_a,M=e.rb_minus,D=e.alias;return A.$require("corelib/enumerable"),function(G,R,f){var E=T(G,R,"Hash"),g=[E].concat(f),_=e.$r(g);E.$include(r("Enumerable")),E.$$prototype.$$is_hash=!0,W(E,"$[]",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;var l,d=n.length,m;if(d===1){if(l=U["$coerce_to?"](n["$[]"](0),r("Hash"),"to_hash"),l!==t)return $.$allocate()["$merge!"](l);for(n=U["$coerce_to?"](n["$[]"](0),r("Array"),"to_ary"),n===t&&J.$raise(r("ArgumentError"),"odd number of arguments for Hash"),d=n.length,l=$.$allocate(),m=0;m<d;m++)if(n[m].$$is_array)switch(n[m].length){case 1:l.$store(n[m][0],t);break;case 2:l.$store(n[m][0],n[m][1]);break;default:J.$raise(r("ArgumentError"),"invalid number of elements ("+n[m].length+" for 1..2)")}return l}for(d%2!==0&&J.$raise(r("ArgumentError"),"odd number of arguments for Hash"),l=$.$allocate(),m=0;m<d;m+=2)l.$store(n[m],n[m+1]);return l},-1),W(E,"$allocate",function(){var s=this,i=new s.$$constructor;return I(i),i.$$none=t,i.$$proc=t,i},0),W(E,"$try_convert",function(s){return U["$coerce_to?"](s,r("Hash"),"to_hash")},1),S(E,"$initialize",function c(s){var i=c.$$p||t,n=this;return delete c.$$p,s!==void 0&&i!==t&&J.$raise(r("ArgumentError"),"wrong number of arguments (1 for 0)"),n.$$none=s===void 0?t:s,n.$$proc=i,n},-1),S(E,"$==",function(s){var i=this;if(i===s)return!0;if(!s.$$is_hash||i.$$keys.length!==s.$$keys.length)return!1;for(var n=0,$=i.$$keys,l=$.length,d,m,k;n<l;n++)if(d=$[n],d.$$is_string?(m=i.$$smap[d],k=s.$$smap[d]):(m=d.value,k=h(s,d.key)),k===void 0||!m["$eql?"](k))return!1;return!0},1),S(E,"$>=",function(s){var i=this,n=t;return s=U["$coerce_to!"](s,r("Hash"),"to_hash"),i.$$keys.length<s.$$keys.length?!1:(n=!0,F(s,"each",[],function $(l,d){var m=$.$$s==null?this:$.$$s,k=t;if(l==null&&(l=t),d==null&&(d=t),k=m.$fetch(l,null),k==null||k!==d){n=!1;return}},{$$arity:2,$$s:i}),n)},1),S(E,"$>",function(s){var i=this;return s=U["$coerce_to!"](s,r("Hash"),"to_hash"),i.$$keys.length<=s.$$keys.length?!1:B(i,s)},1),S(E,"$<",function(s){var i=this;return s=U["$coerce_to!"](s,r("Hash"),"to_hash"),X(s,i)},1),S(E,"$<=",function(s){var i=this;return s=U["$coerce_to!"](s,r("Hash"),"to_hash"),B(s,i)},1),S(E,"$[]",function(s){var i=this,n=h(i,s);return n!==void 0?n:i.$default(s)},1),S(E,"$[]=",function(s,i){var n=this;return v(n,s,i),i},2),S(E,"$assoc",function(s){for(var i=this,n=0,$=i.$$keys,l=$.length,d;n<l;n++)if(d=$[n],d.$$is_string){if(d["$=="](s))return[d,i.$$smap[d]]}else if(d.key["$=="](s))return[d.key,d.value];return t},1),S(E,"$clear",function(){var s=this;return I(s),s},0),S(E,"$clone",function(){var s=this,i=new s.$$class;return I(i),e.hash_clone(s,i),i},0),S(E,"$compact",function(){for(var s=this,i=C(),n=0,$=s.$$keys,l=$.length,d,m,k;n<l;n++)d=$[n],d.$$is_string?m=s.$$smap[d]:(m=d.value,d=d.key),m!==t&&v(i,d,m);return i},0),S(E,"$compact!",function(){for(var s=this,i=!1,n=0,$=s.$$keys,l=$.length,d,m,k;n<l;n++)d=$[n],d.$$is_string?m=s.$$smap[d]:(m=d.value,d=d.key),m===t&&z(s,d)!==void 0&&(i=!0,l--,n--);return i?s:t},0),S(E,"$compare_by_identity",function(){var s=this,i,n,$,l=s.$$keys,d;if(s.$$by_identity)return s;if(s.$$keys.length===0)return s.$$by_identity=!0,s;for(d=L([],{}).$compare_by_identity(),i=0,n=l.length;i<n;i++)$=l[i],$.$$is_string||($=$.key),v(d,$,h(s,$));return s.$$by_identity=!0,s.$$map=d.$$map,s.$$smap=d.$$smap,s},0),S(E,"$compare_by_identity?",function(){var s=this;return s.$$by_identity===!0},0),S(E,"$default",function(s){var i=this;return s!==void 0&&i.$$proc!==t&&i.$$proc!==void 0?i.$$proc.$call(i,s):i.$$none===void 0?t:i.$$none},-1),S(E,"$default=",function(s){var i=this;return i.$$proc=t,i.$$none=s,s},1),S(E,"$default_proc",function(){var s=this;return s.$$proc!==void 0?s.$$proc:t},0),S(E,"$default_proc=",function(s){var i=this,n=s;return n!==t&&(n=U["$coerce_to!"](n,r("Proc"),"to_proc"),n["$lambda?"]()&&n.$arity().$abs()!==2&&J.$raise(r("TypeError"),"default_proc takes two arguments")),i.$$none=t,i.$$proc=n,s},1),S(E,"$delete",function c(s){var i=c.$$p||t,n=this;delete c.$$p;var $=z(n,s);return $!==void 0?$:i!==t?e.yield1(i,s):t},1),S(E,"$delete_if",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["delete_if"],function x(){var Y=x.$$s==null?this:x.$$s;return Y.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d,m,k;n<l;n++)d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),k=s(d,m),k!==!1&&k!==t&&z(i,d)!==void 0&&(l--,n--);return i},0),S(E,"$dig",function(s,i){var n,$,l=this,d=t;return n=e.slice.call(arguments,1),$=n,d=l["$[]"](s),d===t||$.length===0?d:(w(d["$respond_to?"]("dig"))||J.$raise(r("TypeError"),""+d.$class()+" does not have #dig method"),F(d,"dig",b($)))},-2),S(E,"$each",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["each"],function k(){var x=k.$$s==null?this:k.$$s;return x.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d,m;n<l;n++)d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),q(s,[d,m]);return i},0),S(E,"$each_key",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["each_key"],function m(){var k=m.$$s==null?this:m.$$s;return k.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d;n<l;n++)d=$[n],s(d.$$is_string?d:d.key);return i},0),S(E,"$each_value",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["each_value"],function m(){var k=m.$$s==null?this:m.$$s;return k.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d;n<l;n++)d=$[n],s(d.$$is_string?i.$$smap[d]:d.value);return i},0),S(E,"$empty?",function(){var s=this;return s.$$keys.length===0},0),S(E,"$except",function(s){var i,n,$=this;return i=e.slice.call(arguments),n=i,F($.$dup(),"except!",b(n))},-1),S(E,"$except!",function(s){var i,n,$=this;return i=e.slice.call(arguments),n=i,F(n,"each",[],function l(d){var m=l.$$s==null?this:l.$$s;return d==null&&(d=t),m.$delete(d)},{$$arity:1,$$s:$}),$},-1),S(E,"$fetch",function c(s,i){var n=c.$$p||t,$=this;delete c.$$p;var l=h($,s);return l!==void 0?l:n!==t?n(s):i!==void 0?i:J.$raise(r("KeyError").$new("key not found: "+s.$inspect(),L(["key","receiver"],{key:s,receiver:$})))},-2),S(E,"$fetch_values",function c(s){var i=c.$$p||t,n,$,l=this;return delete c.$$p,n=e.slice.call(arguments),$=n,F($,"map",[],function d(m){var k=d.$$s==null?this:d.$$s;return m==null&&(m=t),F(k,"fetch",[m],i.$to_proc())},{$$arity:1,$$s:l})},-1),S(E,"$flatten",function(s){var i=this;s==null&&(s=1),s=U["$coerce_to!"](s,r("Integer"),"to_int");for(var n=[],$=0,l=i.$$keys,d=l.length,m,k;$<d;$++){if(m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),n.push(m),k.$$is_array){if(s===1){n.push(k);continue}n=n.concat(k.$flatten(s-2));continue}n.push(k)}return n},-1),S(E,"$has_key?",function(s){var i=this;return h(i,s)!==void 0},1),S(E,"$has_value?",function(s){for(var i=this,n=0,$=i.$$keys,l=$.length,d;n<l;n++)if(d=$[n],(d.$$is_string?i.$$smap[d]:d.value)["$=="](s))return!0;return!1},1),S(E,"$hash",function(){var s=this,i=e.hash_ids===void 0,n=s.$object_id(),$=["Hash"],l,d;try{if(i&&(e.hash_ids=Object.create(null)),e[n])return"self";for(l in e.hash_ids)if(d=e.hash_ids[l],s["$eql?"](d))return"self";e.hash_ids[n]=s;for(var m=0,k=s.$$keys,x=k.length;m<x;m++)l=k[m],l.$$is_string?$.push([l,s.$$smap[l].$hash()]):$.push([l.key_hash,l.value.$hash()]);return $.sort().join()}finally{i&&(e.hash_ids=void 0)}},0),S(E,"$index",function(s){for(var i=this,n=0,$=i.$$keys,l=$.length,d,m;n<l;n++)if(d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),m["$=="](s))return d;return t},1),S(E,"$indexes",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;for(var l=[],d=0,m=n.length,k,x;d<m;d++){if(k=n[d],x=h($,k),x===void 0){l.push($.$default());continue}l.push(x)}return l},-1);var u;return S(E,"$inspect",function(){var s=this,i=u===void 0,n=s.$object_id(),$=[];return function(){try{if(i&&(u={}),u.hasOwnProperty(n))return"{...}";u[n]=!0;for(var l=0,d=s.$$keys,m=d.length,k,x;l<m;l++)k=d[l],k.$$is_string?x=s.$$smap[k]:(x=k.value,k=k.key),k=_("Opal").$inspect(k),x=_("Opal").$inspect(x),$.push(k+"=>"+x);return"{"+$.join(", ")+"}"}finally{i&&(u=void 0)}}()},0),S(E,"$invert",function(){for(var s=this,i=C(),n=0,$=s.$$keys,l=$.length,d,m;n<l;n++)d=$[n],d.$$is_string?m=s.$$smap[d]:(m=d.value,d=d.key),v(i,m,d);return i},0),S(E,"$keep_if",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["keep_if"],function x(){var Y=x.$$s==null?this:x.$$s;return Y.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d,m,k;n<l;n++)d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),k=s(d,m),(k===!1||k===t)&&z(i,d)!==void 0&&(l--,n--);return i},0),S(E,"$keys",function(){for(var s=this,i=[],n=0,$=s.$$keys,l=$.length,d;n<l;n++)d=$[n],d.$$is_string?i.push(d):i.push(d.key);return i},0),S(E,"$length",function(){var s=this;return s.$$keys.length},0),S(E,"$merge",function c(s){var i=c.$$p||t,n,$,l=this;return delete c.$$p,n=e.slice.call(arguments),$=n,F(l.$dup(),"merge!",b($),i.$to_proc())},-1),S(E,"$merge!",function c(s){var i=c.$$p||t,n,$,l=this;delete c.$$p,n=e.slice.call(arguments),$=n;var d,m,k,x,Y,a,N,p;for(d=0;d<$.length;++d)if(k=U["$coerce_to!"]($[d],r("Hash"),"to_hash"),x=k.$$keys,Y=x.length,i===t)for(m=0;m<Y;m++)a=x[m],a.$$is_string?p=k.$$smap[a]:(p=a.value,a=a.key),v(l,a,p);else for(m=0;m<Y;m++){if(a=x[m],a.$$is_string?p=k.$$smap[a]:(p=a.value,a=a.key),N=h(l,a),N===void 0){v(l,a,p);continue}v(l,a,i(a,N,p))}return l},-1),S(E,"$rassoc",function(s){for(var i=this,n=0,$=i.$$keys,l=$.length,d,m;n<l;n++)if(d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),m["$=="](s))return[d,m];return t},1),S(E,"$rehash",function(){var s=this;return e.hash_rehash(s),s},0),S(E,"$reject",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["reject"],function Y(){var a=Y.$$s==null?this:Y.$$s;return a.$size()},{$$arity:0,$$s:i});for(var n=C(),$=0,l=i.$$keys,d=l.length,m,k,x;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),x=s(m,k),(x===!1||x===t)&&v(n,m,k);return n},0),S(E,"$reject!",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["reject!"],function Y(){var a=Y.$$s==null?this:Y.$$s;return a.$size()},{$$arity:0,$$s:i});for(var n=!1,$=0,l=i.$$keys,d=l.length,m,k,x;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),x=s(m,k),x!==!1&&x!==t&&z(i,m)!==void 0&&(n=!0,d--,$--);return n?i:t},0),S(E,"$replace",function(s){var i=this,n=t;s=U["$coerce_to!"](s,r("Hash"),"to_hash"),I(i);for(var $=0,l=s.$$keys,d=l.length,m,k,x;$<d;$++)m=l[$],m.$$is_string?x=s.$$smap[m]:(x=m.value,m=m.key),v(i,m,x);return w(s.$default_proc())?(n=[s.$default_proc()],F(i,"default_proc=",b(n)),n[M(n.length,1)]):(n=[s.$default()],F(i,"default=",b(n)),n[M(n.length,1)]),i},1),S(E,"$select",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["select"],function Y(){var a=Y.$$s==null?this:Y.$$s;return a.$size()},{$$arity:0,$$s:i});for(var n=C(),$=0,l=i.$$keys,d=l.length,m,k,x;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),x=s(m,k),x!==!1&&x!==t&&v(n,m,k);return n},0),S(E,"$select!",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["select!"],function Y(){var a=Y.$$s==null?this:Y.$$s;return a.$size()},{$$arity:0,$$s:i});for(var n=t,$=0,l=i.$$keys,d=l.length,m,k,x;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),x=s(m,k),(x===!1||x===t)&&(z(i,m)!==void 0&&(d--,$--),n=i);return n},0),S(E,"$shift",function(){var s=this,i=s.$$keys,n;return i.length>0?(n=i[0],n=n.$$is_string?n:n.key,[n,z(s,n)]):s.$default(t)},0),S(E,"$slice",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i;for(var l=C(),d=0,m=n.length;d<m;d++){var k=n[d],x=h($,k);x!==void 0&&v(l,k,x)}return l},-1),S(E,"$to_a",function(){for(var s=this,i=[],n=0,$=s.$$keys,l=$.length,d,m;n<l;n++)d=$[n],d.$$is_string?m=s.$$smap[d]:(m=d.value,d=d.key),i.push([d,m]);return i},0),S(E,"$to_h",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,s!==t)return F(i,"map",[],s.$to_proc()).$to_h();if(i.$$class===e.Hash)return i;var n=new e.Hash;return I(n),e.hash_clone(i,n),n},0),S(E,"$to_hash",function(){var s=this;return s},0),S(E,"$to_proc",function(){var s=this;return F(s,"proc",[],function i(n){var $=i.$$s==null?this:i.$$s;return n==null&&J.$raise(r("ArgumentError"),"no key given"),$["$[]"](n)},{$$arity:-1,$$s:s})},0),S(E,"$transform_keys",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["transform_keys"],function x(){var Y=x.$$s==null?this:x.$$s;return Y.$size()},{$$arity:0,$$s:i});for(var n=C(),$=0,l=i.$$keys,d=l.length,m,k;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),m=q(s,m),v(n,m,k);return n},0),S(E,"$transform_keys!",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["transform_keys!"],function x(){var Y=x.$$s==null?this:x.$$s;return Y.$size()},{$$arity:0,$$s:i});var n=e.slice.call(i.$$keys),$,l=n.length,d,m,k;for($=0;$<l;$++)d=n[$],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),k=q(s,d),z(i,d),v(i,k,m);return i},0),S(E,"$transform_values",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["transform_values"],function x(){var Y=x.$$s==null?this:x.$$s;return Y.$size()},{$$arity:0,$$s:i});for(var n=C(),$=0,l=i.$$keys,d=l.length,m,k;$<d;$++)m=l[$],m.$$is_string?k=i.$$smap[m]:(k=m.value,m=m.key),k=q(s,k),v(n,m,k);return n},0),S(E,"$transform_values!",function c(){var s=c.$$p||t,i=this;if(delete c.$$p,!w(s))return F(i,"enum_for",["transform_values!"],function k(){var x=k.$$s==null?this:k.$$s;return x.$size()},{$$arity:0,$$s:i});for(var n=0,$=i.$$keys,l=$.length,d,m;n<l;n++)d=$[n],d.$$is_string?m=i.$$smap[d]:(m=d.value,d=d.key),m=q(s,m),v(i,d,m);return i},0),S(E,"$values",function(){for(var s=this,i=[],n=0,$=s.$$keys,l=$.length,d;n<l;n++)d=$[n],d.$$is_string?i.push(s.$$smap[d]):i.push(d.value);return i},0),D(E,"dup","clone"),D(E,"each_pair","each"),D(E,"eql?","=="),D(E,"filter","select"),D(E,"filter!","select!"),D(E,"include?","has_key?"),D(E,"indices","indexes"),D(E,"key","index"),D(E,"key?","has_key?"),D(E,"member?","has_key?"),D(E,"size","length"),D(E,"store","[]="),D(E,"to_s","inspect"),D(E,"update","merge!"),D(E,"value?","has_value?"),D(E,"values_at","indexes")}("::",null,o)};Opal.modules["corelib/number"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.klass,C=e.Opal,I=e.Kernel,h=e.def,v=e.eqeqeq,z=e.truthy,T=e.rb_gt,U=e.not,J=e.rb_lt,W=e.send2,S=e.find_super,F=e.send,B=e.rb_plus,X=e.rb_minus,L=e.eqeq,w=e.rb_divide,b=e.to_ary,M=e.rb_times,D=e.rb_le,G=e.rb_ge,R=e.alias,f=e.const_set;return A.$require("corelib/numeric"),function(E,g,_){var u=q(E,g,"Number"),c=[u].concat(_);C.$bridge(Number,u),e.prop(u.$$prototype,"$$is_number",!0),u.$$is_number_class=!0,function(i,n){return h(i,"$allocate",function(){var l=this;return I.$raise(r("TypeError"),"allocator undefined for "+l.$name())},0),e.udef(i,"$new"),t}(e.get_singleton_class(u),c),h(u,"$coerce",function(n){var $=this;if(n===t)I.$raise(r("TypeError"),"can't convert "+n.$class()+" into Float");else{if(n.$$is_string)return[I.$Float(n),$];if(n["$respond_to?"]("to_f"))return[C["$coerce_to!"](n,r("Float"),"to_f"),$];if(n.$$is_number)return[n,$];I.$raise(r("TypeError"),"can't convert "+n.$class()+" into Float")}},1),h(u,"$__id__",function(){var n=this;return n*2+1},0),h(u,"$+",function(n){var $=this;return n.$$is_number?$+n:$.$__coerced__("+",n)},1),h(u,"$-",function(n){var $=this;return n.$$is_number?$-n:$.$__coerced__("-",n)},1),h(u,"$*",function(n){var $=this;return n.$$is_number?$*n:$.$__coerced__("*",n)},1),h(u,"$/",function(n){var $=this;return n.$$is_number?$/n:$.$__coerced__("/",n)},1),h(u,"$%",function(n){var $=this;if(n.$$is_number){if(n==-1/0)return n;if(n==0)I.$raise(r("ZeroDivisionError"),"divided by 0");else return n<0||$<0?($%n+n)%n:$%n}else return $.$__coerced__("%",n)},1),h(u,"$&",function(n){var $=this;return n.$$is_number?$&n:$.$__coerced__("&",n)},1),h(u,"$|",function(n){var $=this;return n.$$is_number?$|n:$.$__coerced__("|",n)},1),h(u,"$^",function(n){var $=this;return n.$$is_number?$^n:$.$__coerced__("^",n)},1),h(u,"$<",function(n){var $=this;return n.$$is_number?$<n:$.$__coerced__("<",n)},1),h(u,"$<=",function(n){var $=this;return n.$$is_number?$<=n:$.$__coerced__("<=",n)},1),h(u,"$>",function(n){var $=this;return n.$$is_number?$>n:$.$__coerced__(">",n)},1),h(u,"$>=",function(n){var $=this;return n.$$is_number?$>=n:$.$__coerced__(">=",n)},1);var s=function(i,n){return n.$$is_number?isNaN(i)||isNaN(n)?t:i>n?1:i<n?-1:0:i.$__coerced__("<=>",n)};return h(u,"$<=>",function(n){var $=this;try{return s($,n)}catch(l){if(e.rescue(l,[r("ArgumentError")]))try{return t}finally{e.pop_exception()}else throw l}},1),h(u,"$<<",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),n>0?$<<n:$>>-n},1),h(u,"$>>",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),n>0?$>>n:$<<-n},1),h(u,"$[]",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),n<0?0:n>=32?$<0?1:0:$>>n&1},1),h(u,"$+@",function(){var n=this;return+n},0),h(u,"$-@",function(){var n=this;return-n},0),h(u,"$~",function(){var n=this;return~n},0),h(u,"$**",function(n){var $=this;return v(r("Integer"),n)?U(r("Integer")["$==="]($))||z(T(n,0))?Math.pow($,n):r("Rational").$new($,1)["$**"](n):J($,0)&&(v(r("Float"),n)||v(r("Rational"),n))?r("Complex").$new($,0)["$**"](n.$to_f()):z(n.$$is_number!=null)?Math.pow($,n):$.$__coerced__("**",n)},1),h(u,"$===",function(n){var $=this;return n.$$is_number?$.valueOf()===n.valueOf():n["$respond_to?"]("==")?n["$=="]($):!1},1),h(u,"$==",function(n){var $=this;return n.$$is_number?$.valueOf()===n.valueOf():n["$respond_to?"]("==")?n["$=="]($):!1},1),h(u,"$abs",function(){var n=this;return Math.abs(n)},0),h(u,"$abs2",function(){var n=this;return Math.abs(n*n)},0),h(u,"$allbits?",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),($&n)==n},1),h(u,"$anybits?",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),($&n)!==0},1),h(u,"$angle",function(){var n=this;return z(n["$nan?"]())?n:n==0?1/n>0?0:Math.PI:n<0?Math.PI:0},0),h(u,"$bit_length",function(){var n=this;if(v(r("Integer"),n)||I.$raise(r("NoMethodError").$new("undefined method `bit_length` for "+n+":Float","bit_length")),n===0||n===-1)return 0;for(var $=0,l=n<0?~n:n;l!=0;)$+=1,l>>>=1;return $},0),h(u,"$ceil",function(n){var $=this;n==null&&(n=0);var l=$.$to_f();if(l%1===0&&n>=0)return l;var d=Math.pow(10,n),m=Math.ceil(l*d)/d;return l%1===0&&(m=Math.round(m)),m},-1),h(u,"$chr",function(n){var $=this;return e.enc(String.fromCharCode($),n||"BINARY")},-1),h(u,"$denominator",function i(){var n=i.$$p||t,$=this;return delete i.$$p,z($["$nan?"]())||z($["$infinite?"]())?1:W($,S($,"denominator",i,!1,!0),"denominator",[],n)},0),h(u,"$downto",function i(n){var $=i.$$p||t,l=this;if(delete i.$$p,$===t)return F(l,"enum_for",["downto",n],function m(){var k=m.$$s==null?this:m.$$s;return v(r("Numeric"),n)||I.$raise(r("ArgumentError"),"comparison of "+k.$class()+" with "+n.$class()+" failed"),z(T(n,k))?0:B(X(k,n),1)},{$$arity:0,$$s:l});n.$$is_number||I.$raise(r("ArgumentError"),"comparison of "+l.$class()+" with "+n.$class()+" failed");for(var d=l;d>=n;d--)$(d);return l},1),h(u,"$equal?",function(n){var $=this,l=t;return z(l=$["$=="](n))?l:isNaN($)&&isNaN(n)},1),h(u,"$even?",function(){var n=this;return n%2===0},0),h(u,"$floor",function(n){var $=this;n==null&&(n=0);var l=$.$to_f();if(l%1===0&&n>=0)return l;var d=Math.pow(10,n),m=Math.floor(l*d)/d;return l%1===0&&(m=Math.round(m)),m},-1),h(u,"$gcd",function(n){var $=this;v(r("Integer"),n)||I.$raise(r("TypeError"),"not an integer");for(var l=Math.abs($),d=Math.abs(n);l>0;){var m=l;l=d%l,d=m}return d},1),h(u,"$gcdlcm",function(n){var $=this;return[$.$gcd(n),$.$lcm(n)]},1),h(u,"$integer?",function(){var n=this;return n%1===0},0),h(u,"$is_a?",function i(n){var $=i.$$p||t,l=this;return delete i.$$p,L(n,r("Integer"))&&v(r("Integer"),l)||L(n,r("Integer"))&&v(r("Integer"),l)||L(n,r("Float"))&&v(r("Float"),l)?!0:W(l,S(l,"is_a?",i,!1,!0),"is_a?",[n],$)},1),h(u,"$instance_of?",function i(n){var $=i.$$p||t,l=this;return delete i.$$p,L(n,r("Integer"))&&v(r("Integer"),l)||L(n,r("Integer"))&&v(r("Integer"),l)||L(n,r("Float"))&&v(r("Float"),l)?!0:W(l,S(l,"instance_of?",i,!1,!0),"instance_of?",[n],$)},1),h(u,"$lcm",function(n){var $=this;return v(r("Integer"),n)||I.$raise(r("TypeError"),"not an integer"),$==0||n==0?0:Math.abs($*n/$.$gcd(n))},1),h(u,"$next",function(){var n=this;return n+1},0),h(u,"$nobits?",function(n){var $=this;return n=C["$coerce_to!"](n,r("Integer"),"to_int"),($&n)==0},1),h(u,"$nonzero?",function(){var n=this;return n==0?t:n},0),h(u,"$numerator",function i(){var n=i.$$p||t,$=this;return delete i.$$p,z($["$nan?"]())||z($["$infinite?"]())?$:W($,S($,"numerator",i,!1,!0),"numerator",[],n)},0),h(u,"$odd?",function(){var n=this;return n%2!==0},0),h(u,"$ord",function(){var n=this;return n},0),h(u,"$pow",function(n,$){var l=this;return l==0&&I.$raise(r("ZeroDivisionError"),"divided by 0"),$===void 0?l["$**"](n):(r("Integer")["$==="](n)||I.$raise(r("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),n<0&&I.$raise(r("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),r("Integer")["$==="]($)||I.$raise(r("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),$===0&&I.$raise(r("ZeroDivisionError"),"divided by 0"),l["$**"](n)["$%"]($))},-2),h(u,"$pred",function(){var n=this;return n-1},0),h(u,"$quo",function i(n){var $=i.$$p||t,l=this;return delete i.$$p,v(r("Integer"),l)?W(l,S(l,"quo",i,!1,!0),"quo",[n],$):w(l,n)},1),h(u,"$rationalize",function(n){var $,l,d=this,m=t,k=t;return arguments.length>1&&I.$raise(r("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),v(r("Integer"),d)?r("Rational").$new(d,1):z(d["$infinite?"]())?I.$raise(r("FloatDomainError"),"Infinity"):z(d["$nan?"]())?I.$raise(r("FloatDomainError"),"NaN"):z(n==null)?(l=r("Math").$frexp(d),$=b(l),m=$[0]==null?t:$[0],k=$[1]==null?t:$[1],m=r("Math").$ldexp(m,r(r("Float"),"MANT_DIG")).$to_i(),k=X(k,r(r("Float"),"MANT_DIG")),r("Rational").$new(M(2,m),1["$<<"](X(1,k))).$rationalize(r("Rational").$new(1,1["$<<"](X(1,k))))):d.$to_r().$rationalize(n)},-1),h(u,"$remainder",function(n){var $=this;return X($,M(n,w($,n).$truncate()))},1),h(u,"$round",function(n){var $,l,d=this,m=t,k=t;if(v(r("Integer"),d)){if(z(n==null)||(v(r("Float"),n)&&z(n["$infinite?"]())&&I.$raise(r("RangeError"),"Infinity"),n=C["$coerce_to!"](n,r("Integer"),"to_int"),z(J(n,r(r("Integer"),"MIN")))&&I.$raise(r("RangeError"),"out of bounds"),z(n>=0)))return d;if(n=n["$-@"](),.415241*n-.125>d.$size())return 0;var x=Math.pow(10,n),Y=Math.floor((Math.abs(d)+x/2)/x)*x;return d<0?-Y:Y}else{if(z(d["$nan?"]())&&z(n==null)&&I.$raise(r("FloatDomainError"),"NaN"),n=C["$coerce_to!"](n||0,r("Integer"),"to_int"),z(D(n,0)))z(d["$nan?"]())?I.$raise(r("RangeError"),"NaN"):z(d["$infinite?"]())&&I.$raise(r("FloatDomainError"),"Infinity");else{if(L(n,0))return Math.round(d);if(z(d["$nan?"]())||z(d["$infinite?"]()))return d}return l=r("Math").$frexp(d),$=b(l),m=$[0]==null?t:$[0],k=$[1]==null?t:$[1],z(G(n,X(B(r(r("Float"),"DIG"),2),z(T(k,0))?w(k,4):X(w(k,3),1))))?d:z(J(n,(z(T(k,0))?B(w(k,3),1):w(k,4))["$-@"]()))?0:Math.round(d*Math.pow(10,n))/Math.pow(10,n)}},-1),h(u,"$times",function i(){var n=i.$$p||t,$=this;if(delete i.$$p,!z(n))return F($,"enum_for",["times"],function d(){var m=d.$$s==null?this:d.$$s;return m},{$$arity:0,$$s:$});for(var l=0;l<$;l++)n(l);return $},0),h(u,"$to_f",function(){var n=this;return n},0),h(u,"$to_i",function(){var n=this;return n<0?Math.ceil(n):Math.floor(n)},0),h(u,"$to_r",function(){var n,$,l=this,d=t,m=t;return v(r("Integer"),l)?r("Rational").$new(l,1):($=r("Math").$frexp(l),n=b($),d=n[0]==null?t:n[0],m=n[1]==null?t:n[1],d=r("Math").$ldexp(d,r(r("Float"),"MANT_DIG")).$to_i(),m=X(m,r(r("Float"),"MANT_DIG")),M(d,r(r("Float"),"RADIX")["$**"](m)).$to_r())},0),h(u,"$to_s",function(n){var $=this;return n==null&&(n=10),n=C["$coerce_to!"](n,r("Integer"),"to_int"),(z(J(n,2))||z(T(n,36)))&&I.$raise(r("ArgumentError"),"invalid radix "+n),L($,0)&&z(1/$===-1/0)?"-0.0":$.toString(n)},-1),h(u,"$truncate",function(n){var $=this;n==null&&(n=0);var l=$.$to_f();if(l%1===0&&n>=0)return l;var d=Math.pow(10,n),m=parseInt(l*d,10)/d;return l%1===0&&(m=Math.round(m)),m},-1),h(u,"$digits",function(n){var $=this;n==null&&(n=10),J($,0)&&I.$raise(r(r("Math"),"DomainError"),"out of domain"),n=C["$coerce_to!"](n,r("Integer"),"to_int"),z(J(n,2))&&I.$raise(r("ArgumentError"),"invalid radix "+n),$!=parseInt($)&&I.$raise(r("NoMethodError"),"undefined method `digits' for "+$.$inspect());var l=$,d=[];if($==0)return[0];for(;l!=0;)d.push(l%n),l=parseInt(l/n,10);return d},-1),h(u,"$divmod",function i(n){var $=i.$$p||t,l=this;return delete i.$$p,z(l["$nan?"]())||z(n["$nan?"]())?I.$raise(r("FloatDomainError"),"NaN"):z(l["$infinite?"]())?I.$raise(r("FloatDomainError"),"Infinity"):W(l,S(l,"divmod",i,!1,!0),"divmod",[n],$)},1),h(u,"$upto",function i(n){var $=i.$$p||t,l=this;if(delete i.$$p,$===t)return F(l,"enum_for",["upto",n],function m(){var k=m.$$s==null?this:m.$$s;return v(r("Numeric"),n)||I.$raise(r("ArgumentError"),"comparison of "+k.$class()+" with "+n.$class()+" failed"),z(J(n,k))?0:B(X(n,k),1)},{$$arity:0,$$s:l});n.$$is_number||I.$raise(r("ArgumentError"),"comparison of "+l.$class()+" with "+n.$class()+" failed");for(var d=l;d<=n;d++)$(d);return l},1),h(u,"$zero?",function(){var n=this;return n==0},0),h(u,"$size",function(){return 4},0),h(u,"$nan?",function(){var n=this;return isNaN(n)},0),h(u,"$finite?",function(){var n=this;return n!=1/0&&n!=-1/0&&!isNaN(n)},0),h(u,"$infinite?",function(){var n=this;return n==1/0?1:n==-1/0?-1:t},0),h(u,"$positive?",function(){var n=this;return n!=0&&(n==1/0||1/n>0)},0),h(u,"$negative?",function(){var n=this;return n==-1/0||1/n<0},0),R(u,"arg","angle"),R(u,"eql?","=="),R(u,"fdiv","/"),R(u,"inspect","to_s"),R(u,"kind_of?","is_a?"),R(u,"magnitude","abs"),R(u,"modulo","%"),R(u,"object_id","__id__"),R(u,"phase","angle"),R(u,"succ","next"),R(u,"to_int","to_i")}("::",r("Numeric"),o),f("::","Fixnum",r("Number")),function(E,g,_){var u=q(E,g,"Integer"),c=[u].concat(_);return u.$$is_number_class=!0,u.$$is_integer_class=!0,function(s,i){var n=[s].concat(i),$=e.$r(n);return h(s,"$allocate",function(){var d=this;return I.$raise(r("TypeError"),"allocator undefined for "+d.$name())},0),e.udef(s,"$new"),h(s,"$sqrt",function(d){return d=C["$coerce_to!"](d,r("Integer"),"to_int"),d<0&&I.$raise(r(r("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(d),10)},1),h(s,"$try_convert",function(d){var m=this;return $("Opal")["$coerce_to?"](d,m,"to_int")},1)}(e.get_singleton_class(u),c),f(u,"MAX",Math.pow(2,30)-1),f(u,"MIN",-Math.pow(2,30))}("::",r("Numeric"),o),function(E,g,_){var u=q(E,g,"Float"),c=[u].concat(_);return u.$$is_number_class=!0,function(s,i){return h(s,"$allocate",function(){var $=this;return I.$raise(r("TypeError"),"allocator undefined for "+$.$name())},0),e.udef(s,"$new"),h(s,"$===",function($){return!!$.$$is_number},1)}(e.get_singleton_class(u),c),f(u,"INFINITY",1/0),f(u,"MAX",Number.MAX_VALUE),f(u,"MIN",Number.MIN_VALUE),f(u,"NAN",NaN),f(u,"DIG",15),f(u,"MANT_DIG",53),f(u,"RADIX",2),f(u,"EPSILON",Number.EPSILON||2220446049250313e-31)}("::",r("Numeric"),o)};Opal.modules["corelib/range"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.klass,C=e.truthy,I=e.Kernel,h=e.def,v=e.not,z=e.send2,T=e.find_super,U=e.rb_lt,J=e.rb_le,W=e.send,S=e.eqeq,F=e.eqeqeq,B=e.rb_gt,X=e.rb_minus,L=e.Opal,w=e.rb_divide,b=e.rb_plus,M=e.rb_times,D=e.rb_ge,G=e.alias;return A.$require("corelib/enumerable"),function(R,f,E){var g=q(R,f,"Range"),_=[g].concat(E),u=e.$r(_),c=g.$$prototype;c.begin=c.end=c.excl=t,g.$include(r("Enumerable")),g.$$prototype.$$is_range=!0,g.$attr_reader("begin","end"),h(g,"$initialize",function(n,$,l){var d=this;return l==null&&(l=!1),C(d.begin)&&I.$raise(r("NameError"),"'initialize' called twice"),C(n["$<=>"]($))||C(n["$nil?"]())||C($["$nil?"]())||I.$raise(r("ArgumentError"),"bad value for range"),d.begin=n,d.end=$,d.excl=l},-3),h(g,"$===",function(n){var $=this;return $["$include?"](n)},1);function s(i){return i.begin===t||i.end===t||i.begin===-1/0||i.end===1/0||i.begin===1/0||i.end===-1/0}return h(g,"$count",function i(){var n=i.$$p||t,$=this;return delete i.$$p,v(n!==t)&&C(s($))?r(r("Float"),"INFINITY"):z($,T($,"count",i,!1,!0),"count",[],n)},0),h(g,"$to_a",function i(){var n=i.$$p||t,$=this;return delete i.$$p,C(s($))&&I.$raise(r("TypeError"),"cannot convert endless range to an array"),z($,T($,"to_a",i,!1,!0),"to_a",[],n)},0),h(g,"$cover?",function(n){var $=this,l=t,d=t,m=t,k=t,x=t;return l=C(d=C(m=C(k=$.begin["$nil?"]())?-1:k)?m:$.begin["$<=>"](n))&&d,x=C(d=C(m=C(k=$.end["$nil?"]())?-1:k)?m:n["$<=>"]($.end))&&d,C(d=C(m=C($.excl)?C(k=x)?U(x,0):k:C(k=x)?J(x,0):k)?l:m)?J(l,0):d},1),h(g,"$each",function i(){var n=i.$$p||t,$,l=this,d=t,m=t,k=t;if(delete i.$$p,n===t)return W(l,"enum_for",["each"],function a(){var N=a.$$s==null?this:a.$$s;return N.$size()},{$$arity:0,$$s:l});var x,Y;if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!==0||l.end%1!==0)&&I.$raise(r("TypeError"),"can't iterate from Float"),x=l.begin,Y=l.end+(C(l.excl)?0:1);x<Y;x++)n(x);return l}if(l.begin.$$is_string&&l.end.$$is_string)return W(l.begin,"upto",[l.end,l.excl],n.$to_proc()),l;for(d=l.begin,m=l.end,C(d["$respond_to?"]("succ"))||I.$raise(r("TypeError"),"can't iterate from "+d.$class());C(C(k=l.end["$nil?"]())?k:U(d["$<=>"](m),0));)e.yield1(n,d),d=d.$succ();return v(l.excl)&&S(d,m)&&e.yield1(n,d),l},0),h(g,"$eql?",function(n){var $=this,l=t,d=t;return F(r("Range"),n)?C(l=C(d=$.excl["$==="](n["$exclude_end?"]()))?$.begin["$eql?"](n.$begin()):d)?$.end["$eql?"](n.$end()):l:!1},1),h(g,"$exclude_end?",function(){var n=this;return n.excl},0),h(g,"$first",function i(n){var $=i.$$p||t,l=this;return delete i.$$p,C(l.begin["$nil?"]())&&I.$raise(r("RangeError"),"cannot get the minimum of beginless range"),C(n==null)?l.begin:z(l,T(l,"first",i,!1,!0),"first",[n],$)},-1),h(g,"$last",function(n){var $=this;return C($.end["$nil?"]())&&I.$raise(r("RangeError"),"cannot get the maximum of endless range"),C(n==null)?$.end:$.$to_a().$last(n)},-1),h(g,"$max",function i(){var n=i.$$p||t,$=this;return delete i.$$p,C($.end["$nil?"]())?I.$raise(r("RangeError"),"cannot get the maximum of endless range"):n!==t?z($,T($,"max",i,!1,!0),"max",[],n):v($.begin["$nil?"]())&&(C(B($.begin,$.end))||C($.excl)&&S($.begin,$.end))?t:$.excl?$.end-1:$.end},0),h(g,"$min",function i(){var n=i.$$p||t,$=this;return delete i.$$p,C($.begin["$nil?"]())?I.$raise(r("RangeError"),"cannot get the minimum of beginless range"):n!==t?z($,T($,"min",i,!1,!0),"min",[],n):v($.end["$nil?"]())&&(C(B($.begin,$.end))||C($.excl)&&S($.begin,$.end))?t:$.begin},0),h(g,"$size",function(){var n=this,$=t,l=t,d=t;return $=r(r("Float"),"INFINITY"),S(n.begin,$)&&v(n.end["$nil?"]())||S(n.end,$["$-@"]())&&v(n.begin["$nil?"]())?0:C(s(n))?$:F(r("Numeric"),n.begin)&&F(r("Numeric"),n.end)?(l=n.begin,d=n.end,C(n.excl)&&(d=X(d,1)),C(U(d,l))?0:(Math.abs(d-l)+1).$to_i()):t},0),h(g,"$step",function i(n){var $=i.$$p||t,l=this,d=t,m=t;delete i.$$p;function k(){n==null?n=1:n.$$is_number||(n=L["$coerce_to!"](n,r("Integer"),"to_int")),n<0?I.$raise(r("ArgumentError"),"step can't be negative"):n===0&&I.$raise(r("ArgumentError"),"step can't be 0")}function x(){if(!l.begin["$respond_to?"]("succ")||l.begin.$$is_string&&l.end.$$is_string)return t;if(n%1===0)return w(l.$size(),n).$ceil();var Y=l.begin,a=l.end,N=Math.abs,p=Math.floor,H=(N(Y)+N(a)+N(a-Y))/N(n)*r(r("Float"),"EPSILON"),Q;return H>.5&&(H=.5),l.excl?(Q=p((a-Y)/n-H),Q*n+Y<a&&Q++):Q=p((a-Y)/n+H)+1,Q}return $===t?(C(l.begin["$is_a?"](u("Numeric")))||C(l.begin["$nil?"]()))&&(C(l.end["$is_a?"](u("Numeric")))||C(l.end["$nil?"]()))&&v(C(d=l.begin["$nil?"]())?l.end["$nil?"]():d)?r(r("Enumerator"),"ArithmeticSequence").$new(l,n,"step"):W(l,"enum_for",["step",n],function(){return k(),x()},0):(k(),C(l.begin.$$is_number&&l.end.$$is_number)?(m=0,function(){var Y=e.new_brk();try{return W(l,"loop",[],function a(){var N=a.$$s==null?this:a.$$s,p=t;return N.begin==null&&(N.begin=t),N.excl==null&&(N.excl=t),N.end==null&&(N.end=t),p=b(N.begin,M(m,n)),C(N.excl)?C(D(p,N.end))&&e.brk(t,Y):C(B(p,N.end))&&e.brk(t,Y),e.yield1($,p),m=b(m,1)},{$$arity:0,$$s:l,$$brk:Y})}catch(a){if(a===Y)return a.$v;throw a}}()):(l.begin.$$is_string&&l.end.$$is_string&&n%1!==0&&I.$raise(r("TypeError"),"no implicit conversion to float from string"),W(l,"each_with_index",[],function(a,N){return a==null&&(a=t),N==null&&(N=t),S(N["$%"](n),0)?e.yield1($,a):t},2)),l)},-1),h(g,"$%",function(n){var $=this;return C($.begin["$is_a?"](u("Numeric")))&&C($.end["$is_a?"](u("Numeric")))?r(r("Enumerator"),"ArithmeticSequence").$new($,n,"%"):$.$step(n)},1),h(g,"$bsearch",function i(){var n=i.$$p||t,$=this;return delete i.$$p,n===t?$.$enum_for("bsearch"):(C(s($)&&($.begin.$$is_number||$.end.$$is_number))&&I.$raise(r("NotImplementedError"),"Can't #bsearch an infinite range"),C($.begin.$$is_number&&$.end.$$is_number)||I.$raise(r("TypeError"),"can't do binary search for "+$.begin.$class()),W($.$to_a(),"bsearch",[],n.$to_proc()))},0),h(g,"$to_s",function(){var n=this,$=t;return""+(C($=n.begin)?$:"")+(C(n.excl)?"...":"..")+(C($=n.end)?$:"")},0),h(g,"$inspect",function(){var n=this,$=t;return""+(C($=n.begin)?n.begin.$inspect():$)+(C(n.excl)?"...":"..")+(C($=n.end)?n.end.$inspect():$)},0),h(g,"$marshal_load",function(n){var $=this;return $.begin=n["$[]"]("begin"),$.end=n["$[]"]("end"),$.excl=n["$[]"]("excl")},1),h(g,"$hash",function(){var n=this;return[n.begin,n.end,n.excl].$hash()},0),G(g,"==","eql?"),G(g,"include?","cover?"),G(g,"member?","cover?")}("::",null,o)};Opal.modules["corelib/proc"]=function(e){var A=e.nil,o=e.$$$,t=e.slice,r=e.klass,q=e.truthy,C=e.Kernel,I=e.defs,h=e.def,v=e.send,z=e.to_a,T=e.Opal,U=e.alias;return function(J,W){var S=r(J,W,"Proc");return e.prop(S.$$prototype,"$$is_proc",!0),e.prop(S.$$prototype,"$$is_lambda",!1),I(S,"$new",function F(){var B=F.$$p||A;return delete F.$$p,q(B)||C.$raise(o("ArgumentError"),"tried to create a Proc object without a block"),B},0),h(S,"$call",function F(B){var X=F.$$p||A,L,w,b=this;delete F.$$p,L=e.slice.call(arguments),w=L,X!==A&&(b.$$p=X);var M,D=b.$$brk;if(D)try{b.$$is_lambda?M=b.apply(null,w):M=e.yieldX(b,w)}catch(G){if(G===D)return D.$v;throw G}else b.$$is_lambda?M=b.apply(null,w):M=e.yieldX(b,w);return M},-1),h(S,"$>>",function F(B){var X=F.$$p||A,L=this;return delete F.$$p,v(C,"proc",[],function w(b){var M=w.$$p||A,D,G,R=w.$$s==null?this:w.$$s,f=A;return delete w.$$p,D=e.slice.call(arguments),G=D,f=v(R,"call",z(G),M.$to_proc()),B.$call(f)},{$$arity:-1,$$s:L})},1),h(S,"$<<",function F(B){var X=F.$$p||A,L=this;return delete F.$$p,v(C,"proc",[],function w(b){var M=w.$$p||A,D,G,R=w.$$s==null?this:w.$$s,f=A;return delete w.$$p,D=e.slice.call(arguments),G=D,f=v(B,"call",z(G),M.$to_proc()),R.$call(f)},{$$arity:-1,$$s:L})},1),h(S,"$to_proc",function(){var B=this;return B},0),h(S,"$lambda?",function(){var B=this;return!!B.$$is_lambda},0),h(S,"$arity",function(){var B=this;return B.$$is_curried?-1:B.$$arity},0),h(S,"$source_location",function(){var B=this;return B.$$is_curried,A},0),h(S,"$binding",function(){var B,X=this;return X.$$is_curried&&C.$raise(o("ArgumentError"),"Can't create Binding"),q((B=o("::","Binding","skip_raise"))?"constant":A)?o("Binding").$new(A,[],X.$$s,X.$source_location()):A},0),h(S,"$parameters",function(){var B=this;if(B.$$is_curried)return[["rest"]];if(B.$$parameters){if(B.$$is_lambda)return B.$$parameters;var X=[],L,w;for(L=0,w=B.$$parameters.length;L<w;L++){var b=B.$$parameters[L];b[0]==="req"&&(b=["opt",b[1]]),X.push(b)}return X}else return[]},0),h(S,"$curry",function(B){var X=this;B===void 0?B=X.length:(B=T["$coerce_to!"](B,o("Integer"),"to_int"),X.$$is_lambda&&B!==X.length&&C.$raise(o("ArgumentError"),"wrong number of arguments ("+B+" for "+X.length+")"));function L(){var w=t.call(arguments),b=w.length,M;return b>B&&X.$$is_lambda&&!X.$$is_curried&&C.$raise(o("ArgumentError"),"wrong number of arguments ("+b+" for "+B+")"),b>=B?X.$call.apply(X,w):(M=function(){return L.apply(null,w.concat(t.call(arguments)))},M.$$is_lambda=X.$$is_lambda,M.$$is_curried=!0,M)}return L.$$is_lambda=X.$$is_lambda,L.$$is_curried=!0,L},-1),h(S,"$dup",function(){var B=this,X=B.$$original_proc||B,L=function(){return X.apply(this,arguments)};for(var w in B)B.hasOwnProperty(w)&&(L[w]=B[w]);return L},0),U(S,"===","call"),U(S,"clone","dup"),U(S,"yield","call"),U(S,"[]","call")}("::",Function)};Opal.modules["corelib/method"]=function(e){var A=e.nil,o=e.$$$,t=e.klass,r=e.def,q=e.truthy,C=e.alias,I=e.Kernel,h=e.send,v=e.to_a;return function(z,T){var U=t(z,T,"Method"),J=U.$$prototype;return J.method=J.receiver=J.owner=J.name=A,U.$attr_reader("owner","receiver","name"),r(U,"$initialize",function(S,F,B,X){var L=this;return L.receiver=S,L.owner=F,L.name=X,L.method=B},4),r(U,"$arity",function(){var S=this;return S.method.$arity()},0),r(U,"$parameters",function(){var S=this;return S.method.$$parameters},0),r(U,"$source_location",function(){var S=this,F=A;return q(F=S.method.$$source_location)?F:["(eval)",0]},0),r(U,"$comments",function(){var S=this,F=A;return q(F=S.method.$$comments)?F:[]},0),r(U,"$call",function W(S){var F=W.$$p||A,B,X,L=this;return delete W.$$p,B=e.slice.call(arguments),X=B,L.method.$$p=F,L.method.apply(L.receiver,X)},-1),r(U,"$curry",function(S){var F=this;return F.method.$curry(S)},-1),r(U,"$>>",function(S){var F=this;return F.method["$>>"](S)},1),r(U,"$<<",function(S){var F=this;return F.method["$<<"](S)},1),r(U,"$unbind",function(){var S=this;return o("UnboundMethod").$new(S.receiver.$class(),S.owner,S.method,S.name)},0),r(U,"$to_proc",function(){var S=this,F=S.$call.bind(S);return F.$$unbound=S.method,F.$$is_lambda=!0,F.$$arity=S.method.$$arity,F.$$parameters=S.method.$$parameters,F},0),r(U,"$inspect",function(){var S=this;return"#<"+S.$class()+": "+S.receiver.$class()+"#"+S.name+" (defined in "+S.owner+" in "+S.$source_location().$join(":")+")>"},0),C(U,"[]","call"),C(U,"===","call")}("::",null),function(z,T){var U=t(z,T,"UnboundMethod"),J=U.$$prototype;return J.method=J.owner=J.name=J.source=A,U.$attr_reader("source","owner","name"),r(U,"$initialize",function(S,F,B,X){var L=this;return L.source=S,L.owner=F,L.method=B,L.name=X},4),r(U,"$arity",function(){var S=this;return S.method.$arity()},0),r(U,"$parameters",function(){var S=this;return S.method.$$parameters},0),r(U,"$source_location",function(){var S=this,F=A;return q(F=S.method.$$source_location)?F:["(eval)",0]},0),r(U,"$comments",function(){var S=this,F=A;return q(F=S.method.$$comments)?F:[]},0),r(U,"$bind",function(S){var F=this;if(F.owner.$$is_module||e.is_a(S,F.owner))return o("Method").$new(S,F.owner,F.method,F.name);I.$raise(o("TypeError"),"can't bind singleton method to a different class (expected "+S+".kind_of?("+F.owner+" to be true)")},1),r(U,"$bind_call",function W(S,F){var B=W.$$p||A,X,L,w=this;return delete W.$$p,X=e.slice.call(arguments,1),L=X,h(w.$bind(S),"call",v(L),B.$to_proc())},-2),r(U,"$inspect",function(){var S=this;return"#<"+S.$class()+": "+S.source+"#"+S.name+" (defined in "+S.owner+" in "+S.$source_location().$join(":")+")>"},0)}("::",null)};Opal.modules["corelib/variables"]=function(e){var A=e.nil,o=e.gvars,t=e.const_set,r=e.Object,q=e.hash2;return o["&"]=o["~"]=o["`"]=o["'"]=A,o.LOADED_FEATURES=o['"']=e.loaded_features,o.LOAD_PATH=o[":"]=[],o["/"]=`
`,o[","]=A,t("::","ARGV",[]),t("::","ARGF",r.$new()),t("::","ENV",q([],{})),o.VERBOSE=!1,o.DEBUG=!1,o.SAFE=0};Opal.modules["corelib/io"]=function(e){var A=e.nil,o=e.$$$,t=e.klass,r=e.const_set,q=e.not,C=e.truthy,I=e.def,h=e.Kernel,v=e.gvars,z=e.send,T=e.to_a,U=e.rb_plus,J=e.neqeq,W=e.range,S=e.hash2,F=e.eqeq,B=e.to_ary,X=e.rb_gt,L=e.alias,w=e.rb_minus,b=A;(function(D,G){var R=t(D,G,"IO"),f=R.$$prototype;return f.fd=f.read_buffer=f.closed=A,r(R,"SEEK_SET",0),r(R,"SEEK_CUR",1),r(R,"SEEK_END",2),r(R,"SEEK_DATA",3),r(R,"SEEK_HOLE",4),r(R,"READABLE",1),r(R,"WRITABLE",4),R.$attr_reader("eof"),R.$attr_accessor("read_proc","sync","tty","write_proc"),I(R,"$initialize",function(g,_){var u=this;return _==null&&(_="r"),u.fd=g,u.flags=_,u.eof=!1,C(_["$include?"]("r"))&&q(_["$match?"](/[wa+]/))?u.closed="write":C(_["$match?"](/[wa]/))&&q(_["$match?"](/[r+]/))?u.closed="read":A},-2),I(R,"$fileno",function(){var g=this;return g.fd},0),I(R,"$tty?",function(){var g=this;return g.tty==!0},0),I(R,"$write",function(g){var _=this;return _.write_proc(g),g.$size()},1),I(R,"$flush",function(){return A},0),I(R,"$<<",function(g){var _=this;return _.$write(g),_},1),I(R,"$print",function(g){var _,u,c=this;v[","]==null&&(v[","]=A),_=e.slice.call(arguments),u=_;for(var s=0,i=u.length;s<i;s++)u[s]=h.$String(u[s]);return c.$write(u.join(v[","])),A},-1),I(R,"$puts",function(g){var _,u,c=this;_=e.slice.call(arguments),u=_;var s;if(u.length===0)return c.$write(`
`),A;for(var i=0,n=u.length;i<n;i++)if(u[i].$$is_array){var $=u[i].$flatten();$.length>0&&z(c,"puts",T($))}else u[i].$$is_string?s=u[i].valueOf():s=h.$String(u[i]),s.endsWith(`
`)||(s+=`
`),c.$write(s);return A},-1),I(R,"$getc",function(){var g,_=this,u=A,c=A,s=A;_.read_buffer=C(u=_.read_buffer)?u:"",c="";do if(_.read_buffer=U(_.read_buffer,c),J(_.read_buffer,""))return s=_.read_buffer["$[]"](0),_.read_buffer=_.read_buffer["$[]"](W(1,-1,!1)),s;while(C(c=_.$sysread_noraise(1)));return A},0),I(R,"$getbyte",function(){var g,_=this;return g=_.$getc(),g===A||g==null?A:z(g,"ord",[])},0),I(R,"$readbyte",function(){var g=this;return g.$readchar().$ord()},0),I(R,"$readchar",function(){var g=this,_=A;return C(_=g.$getc())?_:h.$raise(o("EOFError"),"end of file reached")},0),I(R,"$readline",function(g){var _,u,c=this,s=A;return _=e.slice.call(arguments),u=_,C(s=z(c,"gets",T(u)))?s:h.$raise(o("EOFError"),"end of file reached")},-1),I(R,"$gets",function(g,_,u){var c,s,i,n=this,$=A,l=A,d=A,m=A,k=A,x=A;v["/"]==null&&(v["/"]=A),g==null&&(g=!1),_==null&&(_=A),u==null&&(u=S([],{})),C(g.$$is_number)&&q(_)&&(c=[!1,g,_],g=c[0],_=c[1],u=c[2]),C(g.$$is_hash)&&q(_)&&F(u,S([],{}))?(c=[!1,A,g],g=c[0],_=c[1],u=c[2]):C(_.$$is_hash)&&F(u,S([],{}))&&(c=[g,A,_],g=c[0],_=c[1],u=c[2]),$=g,F(g,!1)&&(g=v["/"]),F(g,"")&&(g=/\r?\n\r?\n/),g=C(l=g)?l:"",F($,"")||(g=g.$to_str()),d=F($,"")?2:g.$length(),F(g," ")&&(g=/ /),n.read_buffer=C(l=n.read_buffer)?l:"",m="",k=A;do if(n.read_buffer=U(n.read_buffer,m),J(g,"")&&C(C(g.$$is_regexp)?n.read_buffer["$match?"](g):n.read_buffer["$include?"](g))){x=n.read_buffer,i=n.read_buffer.$split(g,2),s=B(i),k=s[0]==null?A:s[0],n.read_buffer=s[1]==null?A:s[1],J(k,x)&&(k=U(k,x["$[]"](k.$length(),d)));break}while(C(m=n.$sysread_noraise(F(g,"")?65536:1)));return C(k)||(c=[C(l=n.read_buffer)?l:"",""],k=c[0],n.read_buffer=c[1],F(k,"")&&(k=A)),C(k)&&(C(_)&&(k=k["$[]"](e.Range.$new(0,_,!0)),n.read_buffer=U(k["$[]"](e.Range.$new(_,-1,!1)),n.read_buffer)),C(u["$[]"]("chomp"))&&(k=k.$sub(/\r?\n$/,"")),F($,"")&&(k=k.$sub(/^[\r\n]+/,""))),F($,!1)&&(v._=k),k},-1),I(R,"$sysread",function(g){var _=this,u=A;return C(u=_.read_proc(g))?u:(_.eof=!0,h.$raise(o("EOFError"),"end of file reached"))},1),I(R,"$sysread_noraise",function(g){var _=this;try{return _.$sysread(g)}catch(u){if(e.rescue(u,[o("EOFError")]))try{return A}finally{e.pop_exception()}else throw u}},1),I(R,"$readpartial",function(g){var _,u=this,c=A,s=A,i=A;return u.read_buffer=C(c=u.read_buffer)?c:"",s=u.$sysread(g),_=[U(u.read_buffer,C(c=s)?c:""),""],i=_[0],u.read_buffer=_[1],F(i,"")&&(i=A),i},1),I(R,"$read",function(g){var _,u,c=this,s=A,i=A,n=A;g==null&&(g=A),c.read_buffer=C(s=c.read_buffer)?s:"",i="",n=A;do if(c.read_buffer=U(c.read_buffer,i),C(g)&&C(X(c.read_buffer.$length(),g)))return u=[c.read_buffer["$[]"](e.Range.$new(0,g,!0)),c.read_buffer["$[]"](e.Range.$new(g,-1,!1))],n=u[0],c.read_buffer=u[1],n;while(C(i=c.$sysread_noraise(C(s=g)?s:65536)));return _=[c.read_buffer,""],n=_[0],c.read_buffer=_[1],n},-1),I(R,"$readlines",function(g){var _=this;return v["/"]==null&&(v["/"]=A),g==null&&(g=v["/"]),_.$each_line(g).$to_a()},-1),I(R,"$each",function E(g,_){var u=E.$$p||A,c,s,i,n,$=this,l=A;if(v["/"]==null&&(v["/"]=A),delete E.$$p,c=e.slice.call(arguments),c.length>0&&(s=c.shift()),s==null&&(s=v["/"]),i=c,u===A)return z($,"enum_for",["each",s].concat(T(i)));for(;C(l=z($,"gets",[s].concat(T(i))));)e.yield1(u,l);return $},-1),I(R,"$each_byte",function E(){var g=E.$$p||A,_,u=this,c=A;if(delete E.$$p,g===A)return u.$enum_for("each_byte");for(;C(c=u.$getbyte());)e.yield1(g,c);return u},0),I(R,"$each_char",function E(){var g=E.$$p||A,_,u=this,c=A;if(delete E.$$p,g===A)return u.$enum_for("each_char");for(;C(c=u.$getc());)e.yield1(g,c);return u},0),I(R,"$close",function(){var g=this;return g.closed="both"},0),I(R,"$close_read",function(){var g=this;return F(g.closed,"write")?g.closed="both":g.closed="read"},0),I(R,"$close_write",function(){var g=this;return F(g.closed,"read")?g.closed="both":g.closed="write"},0),I(R,"$closed?",function(){var g=this;return g.closed["$=="]("both")},0),I(R,"$closed_read?",function(){var g=this,_=A;return C(_=g.closed["$=="]("read"))?_:g.closed["$=="]("both")},0),I(R,"$closed_write?",function(){var g=this,_=A;return C(_=g.closed["$=="]("write"))?_:g.closed["$=="]("both")},0),I(R,"$check_writable",function(){var g=this;return C(g["$closed_write?"]())?h.$raise(o("IOError"),"not opened for writing"):A},0),I(R,"$check_readable",function(){var g=this;return C(g["$closed_read?"]())?h.$raise(o("IOError"),"not opened for reading"):A},0),L(R,"each_line","each"),L(R,"eof?","eof")})("::",null),r("::","STDIN",v.stdin=o("IO").$new(0,"r")),r("::","STDOUT",v.stdout=o("IO").$new(1,"w")),r("::","STDERR",v.stderr=o("IO").$new(2,"w"));var M=e.global.console;return b=[typeof process=="object"&&typeof process.stdout=="object"?function(D){process.stdout.write(D)}:function(D){M.log(D)}],z(o("STDOUT"),"write_proc=",T(b)),b[w(b.length,1)],b=[typeof process=="object"&&typeof process.stderr=="object"?function(D){process.stderr.write(D)}:function(D){M.warn(D)}],z(o("STDERR"),"write_proc=",T(b)),b[w(b.length,1)],b=[function(D){var G=prompt();return G!==null?G+`
`:A}],z(o("STDIN"),"read_proc=",T(b)),b[w(b.length,1)]};Opal.modules["opal/regexp_anchors"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.const_set;return function(C,I){var h=r(C,"Opal"),v=[h].concat(I),z=e.$r(v);return q(h,"REGEXP_START","^"),q(h,"REGEXP_END","$"),q(h,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),q(h,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),q(h,"INLINE_IDENTIFIER_REGEXP",z("Regexp").$new("[^"+t(h,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+t(h,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),q(h,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),q(h,"CONST_NAME_REGEXP",z("Regexp").$new(""+t(h,"REGEXP_START")+"(::)?[A-Z][^"+t(h,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+t(h,"REGEXP_END")))}(A[0],A)};Opal.modules["opal/mini"]=function(e){var A=e.nil,o=e.Object;return o.$require("opal/base"),o.$require("corelib/nil"),o.$require("corelib/boolean"),o.$require("corelib/string"),o.$require("corelib/comparable"),o.$require("corelib/enumerable"),o.$require("corelib/enumerator"),o.$require("corelib/array"),o.$require("corelib/hash"),o.$require("corelib/number"),o.$require("corelib/range"),o.$require("corelib/proc"),o.$require("corelib/method"),o.$require("corelib/regexp"),o.$require("corelib/variables"),o.$require("corelib/io"),o.$require("opal/regexp_anchors")};Opal.modules["corelib/kernel/format"]=function(e){var A=e.nil,o=e.$$$,t=e.coerce_to,r=e.module,q=e.truthy,C=e.eqeq,I=e.Opal,h=e.Kernel,v=e.gvars,z=e.def,T=e.alias;return function(U){var J=r(U,"Kernel");return z(J,"$format",function(S,F){var B,X,L=A;v.DEBUG==null&&(v.DEBUG=A),B=e.slice.call(arguments,1),X=B,C(X.$length(),1)&&q(X["$[]"](0)["$respond_to?"]("to_ary"))&&(L=I["$coerce_to?"](X["$[]"](0),o("Array"),"to_ary"),q(L["$nil?"]())||(X=L.$to_a()));var w="",b=0,M,D,G=S.length,R,f,E,g,_,u,c,s,i,n,$,l,d,m=1,k=0,x,Y=0,a=1,N=2,p=4,H=8,Q=16,ee=32,ne=64,V=128;function Z(){x&ee&&h.$raise(o("ArgumentError"),"flag after width"),x&V&&h.$raise(o("ArgumentError"),"flag after precision")}function y(){x&ee&&h.$raise(o("ArgumentError"),"width given twice"),x&V&&h.$raise(o("ArgumentError"),"width after precision")}function K(ie){return ie>=X.length&&h.$raise(o("ArgumentError"),"too few arguments"),X[ie]}function P(){switch(k){case-1:h.$raise(o("ArgumentError"),"unnumbered("+m+") mixed with numbered");case-2:h.$raise(o("ArgumentError"),"unnumbered("+m+") mixed with named")}return k=m++,K(k-1)}function j(ie){return k>0&&h.$raise(o("ArgumentError"),"numbered("+ie+") after unnumbered("+k+")"),k===-2&&h.$raise(o("ArgumentError"),"numbered("+ie+") after named"),ie<1&&h.$raise(o("ArgumentError"),"invalid index - "+ie+"$"),k=-1,K(ie-1)}function O(){return d===void 0?P():d}function re(ie){for(var $e,se="";;D++){if(D===G&&h.$raise(o("ArgumentError"),"malformed format string - %*[0-9]"),S.charCodeAt(D)<48||S.charCodeAt(D)>57)return D--,$e=parseInt(se,10)||0,$e>2147483647&&h.$raise(o("ArgumentError"),""+ie+" too big"),$e;se+=S.charAt(D)}}function te(ie){var $e,se=re(ie);return S.charAt(D+1)==="$"?(D++,$e=j(se)):$e=P(),$e.$to_int()}for(D=S.indexOf("%");D!==-1;D=S.indexOf("%",D)){switch(f=void 0,x=Y,g=-1,_=-1,d=void 0,M=D,D++,S.charAt(D)){case"%":b=D;case"":case`
`:case"\0":D++;continue}e:for(;D<G;D++)switch(S.charAt(D)){case" ":Z(),x|=Q;continue e;case"#":Z(),x|=a;continue e;case"+":Z(),x|=p;continue e;case"-":Z(),x|=N;continue e;case"0":Z(),x|=H;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(u=re("width"),S.charAt(D+1)==="$"){if(D+2===G){f="%",D++;break e}d!==void 0&&h.$raise(o("ArgumentError"),"value given twice - %"+u+"$"),d=j(u),D++}else y(),x|=ee,g=u;continue e;case"<":case"{":for(s=S.charAt(D)==="<"?">":"}",c="",D++;;D++){if(D===G&&h.$raise(o("ArgumentError"),"malformed name - unmatched parenthesis"),S.charAt(D)===s){if(k>0&&h.$raise(o("ArgumentError"),"named "+c+" after unnumbered("+k+")"),k===-1&&h.$raise(o("ArgumentError"),"named "+c+" after numbered"),k=-2,(X[0]===void 0||!X[0].$$is_hash)&&h.$raise(o("ArgumentError"),"one hash required"),d=X[0].$fetch(c),s===">")continue e;if(f=d.toString(),_!==-1&&(f=f.slice(0,_)),x&N)for(;f.length<g;)f=f+" ";else for(;f.length<g;)f=" "+f;break e}c+=S.charAt(D)}case"*":D++,y(),x|=ee,g=te("width"),g<0&&(x|=N,g=-g);continue e;case".":if(x&V&&h.$raise(o("ArgumentError"),"precision given twice"),x|=ne|V,_=0,D++,S.charAt(D)==="*"){D++,_=te("precision"),_<0&&(x&=~ne);continue e}_=re("precision");continue e;case"d":case"i":case"u":if(R=h.$Integer(O()),R>=0){for(f=R.toString();f.length<_;)f="0"+f;if(x&N)for((x&p||x&Q)&&(f=(x&p?"+":" ")+f);f.length<g;)f=f+" ";else if(x&H&&_===-1){for(;f.length<g-(x&p||x&Q?1:0);)f="0"+f;(x&p||x&Q)&&(f=(x&p?"+":" ")+f)}else for((x&p||x&Q)&&(f=(x&p?"+":" ")+f);f.length<g;)f=" "+f}else{for(f=(-R).toString();f.length<_;)f="0"+f;if(x&N)for(f="-"+f;f.length<g;)f=f+" ";else if(x&H&&_===-1){for(;f.length<g-1;)f="0"+f;f="-"+f}else for(f="-"+f;f.length<g;)f=" "+f}break e;case"b":case"B":case"o":case"x":case"X":switch(S.charAt(D)){case"b":case"B":i=2,n="0b",$=/^1+/,l="1";break;case"o":i=8,n="0",$=/^3?7+/,l="7";break;case"x":case"X":i=16,n="0x",$=/^f+/,l="f";break}if(R=h.$Integer(O()),R>=0){for(f=R.toString(i);f.length<_;)f="0"+f;if(x&N)for((x&p||x&Q)&&(f=(x&p?"+":" ")+f),x&a&&R!==0&&(f=n+f);f.length<g;)f=f+" ";else if(x&H&&_===-1){for(;f.length<g-(x&p||x&Q?1:0)-(x&a&&R!==0?n.length:0);)f="0"+f;x&a&&R!==0&&(f=n+f),(x&p||x&Q)&&(f=(x&p?"+":" ")+f)}else for(x&a&&R!==0&&(f=n+f),(x&p||x&Q)&&(f=(x&p?"+":" ")+f);f.length<g;)f=" "+f}else if(x&p||x&Q){for(f=(-R).toString(i);f.length<_;)f="0"+f;if(x&N)for(x&a&&(f=n+f),f="-"+f;f.length<g;)f=f+" ";else if(x&H&&_===-1){for(;f.length<g-1-(x&a?2:0);)f="0"+f;x&a&&(f=n+f),f="-"+f}else for(x&a&&(f=n+f),f="-"+f;f.length<g;)f=" "+f}else{for(f=(R>>>0).toString(i).replace($,l);f.length<_-2;)f=l+f;if(x&N)for(f=".."+f,x&a&&(f=n+f);f.length<g;)f=f+" ";else if(x&H&&_===-1){for(;f.length<g-2-(x&a?n.length:0);)f=l+f;f=".."+f,x&a&&(f=n+f)}else for(f=".."+f,x&a&&(f=n+f);f.length<g;)f=" "+f}S.charAt(D)===S.charAt(D).toUpperCase()&&(f=f.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if(R=h.$Float(O()),R>=0||isNaN(R)){if(R===1/0)f="Inf";else switch(S.charAt(D)){case"f":f=R.toFixed(_===-1?6:_);break;case"e":case"E":f=R.toExponential(_===-1?6:_);break;case"g":case"G":f=R.toExponential(),E=parseInt(f.split("e")[1],10),E<-4||E>=(_===-1?6:_)||(f=R.toPrecision(_===-1?x&a?6:void 0:_));break}if(x&N)for((x&p||x&Q)&&(f=(x&p?"+":" ")+f);f.length<g;)f=f+" ";else if(x&H&&R!==1/0&&!isNaN(R)){for(;f.length<g-(x&p||x&Q?1:0);)f="0"+f;(x&p||x&Q)&&(f=(x&p?"+":" ")+f)}else for((x&p||x&Q)&&(f=(x&p?"+":" ")+f);f.length<g;)f=" "+f}else{if(R===-1/0)f="Inf";else switch(S.charAt(D)){case"f":f=(-R).toFixed(_===-1?6:_);break;case"e":case"E":f=(-R).toExponential(_===-1?6:_);break;case"g":case"G":f=(-R).toExponential(),E=parseInt(f.split("e")[1],10),E<-4||E>=(_===-1?6:_)||(f=(-R).toPrecision(_===-1?x&a?6:void 0:_));break}if(x&N)for(f="-"+f;f.length<g;)f=f+" ";else if(x&H&&R!==-1/0){for(;f.length<g-1;)f="0"+f;f="-"+f}else for(f="-"+f;f.length<g;)f=" "+f}S.charAt(D)===S.charAt(D).toUpperCase()&&R!==1/0&&R!==-1/0&&!isNaN(R)&&(f=f.toUpperCase()),f=f.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":h.$raise(o("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if(R=O(),R["$respond_to?"]("to_ary")&&(R=R.$to_ary()[0]),R["$respond_to?"]("to_str")?f=R.$to_str():f=String.fromCharCode(t(R,o("Integer"),"to_int")),f.length!==1&&h.$raise(o("ArgumentError"),"%c requires a character"),x&N)for(;f.length<g;)f=f+" ";else for(;f.length<g;)f=" "+f;break e;case"p":if(f=O().$inspect(),_!==-1&&(f=f.slice(0,_)),x&N)for(;f.length<g;)f=f+" ";else for(;f.length<g;)f=" "+f;break e;case"s":if(f=O().$to_s(),_!==-1&&(f=f.slice(0,_)),x&N)for(;f.length<g;)f=f+" ";else for(;f.length<g;)f=" "+f;break e;default:h.$raise(o("ArgumentError"),"malformed format string - %"+S.charAt(D))}f===void 0&&h.$raise(o("ArgumentError"),"malformed format string - %"),w+=S.slice(b,M)+f,b=D+1}return v.DEBUG&&k>=0&&m<X.length&&h.$raise(o("ArgumentError"),"too many arguments for format string"),w+S.slice(b)},-2),T(J,"sprintf","format")}("::")};Opal.modules["corelib/string/encoding"]=function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.klass,I=e.hash2,h=e.rb_plus,v=e.truthy,z=e.send,T=e.defs,U=e.eqeq,J=e.def,W=e.Kernel,S=e.Opal,F=e.rb_lt,B=e.alias,X=e.to_a,L=e.rb_minus,w=r;return A.$require("corelib/string"),function(b,M){var D=C(b,M,"Encoding"),G=D.$$prototype;return G.ascii=G.dummy=G.name=r,T(D,"$register",function R(f,E){var g=R.$$p||r,_=this,u=r,c=r,s=r,i=r,n=r,$=r;return delete R.$$p,E==null&&(E=I([],{})),u=h([f],v(c=E["$[]"]("aliases"))?c:[]),s=v(c=E["$[]"]("ascii"))&&c,i=v(c=E["$[]"]("dummy"))&&c,v(E["$[]"]("inherits"))?(n=E["$[]"]("inherits").$clone(),n.$initialize(f,u,s,i)):n=_.$new(f,u,s,i),g!==r&&z(n,"instance_eval",[],g.$to_proc()),$=e.encodings,z(u,"each",[],function l(d){var m=l.$$s==null?this:l.$$s;return d==null&&(d=r),m.$const_set(d.$tr("-","_"),n),$[d]=n},{$$arity:1,$$s:_})},-2),T(D,"$find",function(f){var E=this;return U(f,"default_external")?E.$default_external():e.find_encoding(f)},1),D.$singleton_class().$attr_accessor("default_external"),D.$attr_reader("name","names"),J(D,"$initialize",function(f,E,g,_){var u=this;return u.name=f,u.names=E,u.ascii=g,u.dummy=_},4),J(D,"$ascii_compatible?",function(){var f=this;return f.ascii},0),J(D,"$dummy?",function(){var f=this;return f.dummy},0),J(D,"$binary?",function(){return!1},0),J(D,"$to_s",function(){var f=this;return f.name},0),J(D,"$inspect",function(){var f=this;return"#<Encoding:"+f.name+(v(f.dummy)?" (dummy)":r)+">"},0),J(D,"$charsize",function(f){for(var E=0,g=0,_=f.length;g<_;g++){var u=f.charCodeAt(g);u>=55296&&u<=56319||E++}return E},1),J(D,"$each_char",function R(f){var E=R.$$p||r;delete R.$$p;for(var g="",_=0,u=f.length;_<u;_++){var c=f.charCodeAt(_),s=f.charAt(_);if(c>=56320&&c<=57343){g=s;continue}else c>=55296&&c<=56319&&(s=g+s);f.encoding.name!="UTF-8"&&(s=new String(s),s.encoding=f.encoding),e.yield1(E,s)}},1),J(D,"$each_byte",function(f){var E,g;return E=e.slice.call(arguments),g=E,W.$raise(q("NotImplementedError"))},-1),J(D,"$bytesize",function(f){var E,g;return E=e.slice.call(arguments),g=E,W.$raise(q("NotImplementedError"))},-1),C("::",q("StandardError"),"EncodingError"),C("::",q("EncodingError"),"CompatibilityError"),r}("::",null),z(q("Encoding"),"register",["UTF-8",I(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=1/0,E,g=G.length,_=null,u=0;u<g;++u){if(E=G.charCodeAt(u),E>55295&&E<57344){if(!_){if(E>56319){(f-=3)>-1&&(e.yield1(R,239),e.yield1(R,191),e.yield1(R,189));continue}else if(u+1===g){(f-=3)>-1&&(e.yield1(R,239),e.yield1(R,191),e.yield1(R,189));continue}_=E;continue}if(E<56320){(f-=3)>-1&&(e.yield1(R,239),e.yield1(R,191),e.yield1(R,189)),_=E;continue}E=(_-55296<<10|E-56320)+65536}else _&&(f-=3)>-1&&(e.yield1(R,239),e.yield1(R,191),e.yield1(R,189));if(_=null,E<128){if((f-=1)<0)break;e.yield1(R,E)}else if(E<2048){if((f-=2)<0)break;e.yield1(R,E>>6|192),e.yield1(R,E&63|128)}else if(E<65536){if((f-=3)<0)break;e.yield1(R,E>>12|224),e.yield1(R,E>>6&63|128),e.yield1(R,E&63|128)}else if(E<1114112){if((f-=4)<0)break;e.yield1(R,E>>18|240),e.yield1(R,E>>12&63|128),e.yield1(R,E>>6&63|128),e.yield1(R,E&63|128)}}},1),J(M,"$bytesize",function(G){return G.$bytes().$length()},1)},{$$arity:0,$$s:A}),z(q("Encoding"),"register",["UTF-16LE"],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=G.charCodeAt(f);e.yield1(R,g&255),e.yield1(R,g>>8)}},1),J(M,"$bytesize",function(G){return G.length*2},1)},{$$arity:0,$$s:A}),z(q("Encoding"),"register",["UTF-16BE",I(["inherits"],{inherits:q(q("Encoding"),"UTF_16LE")})],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=G.charCodeAt(f);e.yield1(R,g>>8),e.yield1(R,g&255)}},1)},{$$arity:0,$$s:A}),z(q("Encoding"),"register",["UTF-32LE"],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=G.charCodeAt(f);e.yield1(R,g&255),e.yield1(R,g>>8),e.yield1(R,0),e.yield1(R,0)}},1),J(M,"$bytesize",function(G){return G.length*4},1)},{$$arity:0,$$s:A}),z(q("Encoding"),"register",["UTF-32BE",I(["inherits"],{inherits:q(q("Encoding"),"UTF_32LE")})],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=G.charCodeAt(f);e.yield1(R,0),e.yield1(R,0),e.yield1(R,g>>8),e.yield1(R,g&255)}},1)},{$$arity:0,$$s:A}),z(q("Encoding"),"register",["ASCII-8BIT",I(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function b(){var M=b.$$s==null?this:b.$$s;return J(M,"$each_char",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=new String(G.charAt(f));g.encoding=G.encoding,e.yield1(R,g)}},1),J(M,"$charsize",function(G){return G.length},1),J(M,"$each_byte",function D(G){var R=D.$$p||r;delete D.$$p;for(var f=0,E=G.length;f<E;f++){var g=G.charCodeAt(f);e.yield1(R,g&255)}},1),J(M,"$bytesize",function(G){return G.length},1),J(M,"$binary?",function(){return!0},0)},{$$arity:0,$$s:A}),q("Encoding").$register("ISO-8859-1",I(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),q("Encoding").$register("US-ASCII",I(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),function(b,M){var D=C(b,M,"String"),G=D.$$prototype;return G.internal_encoding=G.bytes=G.encoding=r,D.$attr_reader("encoding"),D.$attr_reader("internal_encoding"),e.prop(String.prototype,"bytes",r),e.prop(String.prototype,"encoding",q(q("Encoding"),"UTF_8")),e.prop(String.prototype,"internal_encoding",q(q("Encoding"),"UTF_8")),J(D,"$b",function(){var f=this;return f.$dup().$force_encoding("binary")},0),J(D,"$bytesize",function(){var f=this;return f.internal_encoding.$bytesize(f)},0),J(D,"$each_byte",function R(){var f=R.$$p||r,E=this;return delete R.$$p,f===r?z(E,"enum_for",["each_byte"],function g(){var _=g.$$s==null?this:g.$$s;return _.$bytesize()},{$$arity:0,$$s:E}):(z(E.internal_encoding,"each_byte",[E],f.$to_proc()),E)},0),J(D,"$bytes",function(){var f=this,E=r;return typeof f=="string"?new String(f).$each_byte().$to_a():(f.bytes=v(E=f.bytes)?E:f.$each_byte().$to_a(),f.bytes.$dup())},0),J(D,"$each_char",function R(){var f=R.$$p||r,E=this;return delete R.$$p,f===r?z(E,"enum_for",["each_char"],function g(){var _=g.$$s==null?this:g.$$s;return _.$length()},{$$arity:0,$$s:E}):(z(E.encoding,"each_char",[E],f.$to_proc()),E)},0),J(D,"$chars",function R(){var f=R.$$p||r,E=this;return delete R.$$p,v(f)?z(E,"each_char",[],f.$to_proc()):E.$each_char().$to_a()},0),J(D,"$each_codepoint",function R(){var f=R.$$p||r,E=this;if(delete R.$$p,f===r)return E.$enum_for("each_codepoint");for(var g=0,_=E.length;g<_;g++)e.yield1(f,E.codePointAt(g));return E},0),J(D,"$codepoints",function R(){var f=R.$$p||r,E=this;return delete R.$$p,f!==r?z(E,"each_codepoint",[],f.$to_proc()):E.$each_codepoint().$to_a()},0),J(D,"$encode",function(f){var E=this;return e.enc(E,f)},1),J(D,"$force_encoding",function(f){var E=this,g=E;return f===g.encoding||(f=S["$coerce_to!"](f,q("String"),"to_s"),f=q("Encoding").$find(f),f===g.encoding)||(g=e.set_encoding(g,f)),g},1),J(D,"$getbyte",function(f){var E=this,g=r;return g=E.$bytes(),f=S["$coerce_to!"](f,q("Integer"),"to_int"),v(F(g.$length(),f))?r:g["$[]"](f)},1),J(D,"$initialize_copy",function(f){return`
      self.encoding = other.encoding;
      self.internal_encoding = other.internal_encoding;
    `},1),J(D,"$length",function(){var f=this;return f.length},0),B(D,"size","length"),J(D,"$valid_encoding?",function(){return!0},0)}("::",null),w=[q(t("Encoding"),"UTF_8")],z(q("Encoding"),"default_external=",X(w)),w[L(w.length,1)]};Opal.modules["corelib/math"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.type_error,q=e.module,C=e.const_set,I=e.Class,h=e.Kernel,v=e.defs,z=e.def,T=e.truthy,U=e.rb_minus,J=e.eqeqeq,W=e.rb_divide;return function(S,F){var B=q(S,"Math"),X=[B].concat(F),L=e.$r(X);return C(B,"E",Math.E),C(B,"PI",Math.PI),C(B,"DomainError",I.$new(t("StandardError"))),v(B,"$checked",function(b,M){var D,G;if(D=e.slice.call(arguments,1),G=D,isNaN(G[0])||G.length==2&&isNaN(G[1]))return NaN;var R=Math[b].apply(null,G);return isNaN(R)&&h.$raise(L("DomainError"),'Numerical argument is out of domain - "'+b+'"'),R},-2),v(B,"$float!",function(b){try{return h.$Float(b)}catch(M){if(e.rescue(M,[t("ArgumentError")]))try{return h.$raise(r(b,t("Float")))}finally{e.pop_exception()}else throw M}},1),v(B,"$integer!",function(b){try{return h.$Integer(b)}catch(M){if(e.rescue(M,[t("ArgumentError")]))try{return h.$raise(r(b,t("Integer")))}finally{e.pop_exception()}else throw M}},1),B.$module_function(),z(B,"$acos",function(b){return t("Math").$checked("acos",t("Math")["$float!"](b))},1),T(typeof Math.acosh!="undefined")||(Math.acosh=function(w){return Math.log(w+Math.sqrt(w*w-1))}),z(B,"$acosh",function(b){return t("Math").$checked("acosh",t("Math")["$float!"](b))},1),z(B,"$asin",function(b){return t("Math").$checked("asin",t("Math")["$float!"](b))},1),T(typeof Math.asinh!="undefined")||(Math.asinh=function(w){return Math.log(w+Math.sqrt(w*w+1))}),z(B,"$asinh",function(b){return t("Math").$checked("asinh",t("Math")["$float!"](b))},1),z(B,"$atan",function(b){return t("Math").$checked("atan",t("Math")["$float!"](b))},1),z(B,"$atan2",function(b,M){return t("Math").$checked("atan2",t("Math")["$float!"](b),t("Math")["$float!"](M))},2),T(typeof Math.atanh!="undefined")||(Math.atanh=function(w){return .5*Math.log((1+w)/(1-w))}),z(B,"$atanh",function(b){return t("Math").$checked("atanh",t("Math")["$float!"](b))},1),T(typeof Math.cbrt!="undefined")||(Math.cbrt=function(w){if(w==0)return 0;if(w<0)return-Math.cbrt(-w);for(var b=w,M=0;b<.125;)b*=8,M--;for(;b>1;)b*=.125,M++;for(b=(-.46946116*b+1.072302)*b+.3812513;M<0;)b*=.5,M++;for(;M>0;)b*=2,M--;return b=2/3*b+1/3*w/(b*b),b=2/3*b+1/3*w/(b*b),b=2/3*b+1/3*w/(b*b),b=2/3*b+1/3*w/(b*b),b}),z(B,"$cbrt",function(b){return t("Math").$checked("cbrt",t("Math")["$float!"](b))},1),z(B,"$cos",function(b){return t("Math").$checked("cos",t("Math")["$float!"](b))},1),T(typeof Math.cosh!="undefined")||(Math.cosh=function(w){return(Math.exp(w)+Math.exp(-w))/2}),z(B,"$cosh",function(b){return t("Math").$checked("cosh",t("Math")["$float!"](b))},1),T(typeof Math.erf!="undefined")||e.prop(Math,"erf",function(w){var b=.254829592,M=-.284496736,D=1.421413741,G=-1.453152027,R=1.061405429,f=.3275911,E=1;w<0&&(E=-1),w=Math.abs(w);var g=1/(1+f*w),_=1-((((R*g+G)*g+D)*g+M)*g+b)*g*Math.exp(-w*w);return E*_}),z(B,"$erf",function(b){return t("Math").$checked("erf",t("Math")["$float!"](b))},1),T(typeof Math.erfc!="undefined")||e.prop(Math,"erfc",function(w){var b=Math.abs(w),M=1/(.5*b+1),D=M*.17087277+-.82215223,G=M*D+1.48851587,R=M*G+-1.13520398,f=M*R+.27886807,E=M*f+-.18628806,g=M*E+.09678418,_=M*g+.37409196,u=M*_+1.00002368,c=M*u,s=-b*b-1.26551223+c,i=M*Math.exp(s);return w<0?2-i:i}),z(B,"$erfc",function(b){return t("Math").$checked("erfc",t("Math")["$float!"](b))},1),z(B,"$exp",function(b){return t("Math").$checked("exp",t("Math")["$float!"](b))},1),z(B,"$frexp",function(b){if(b=L("Math")["$float!"](b),isNaN(b))return[NaN,0];var M=Math.floor(Math.log(Math.abs(b))/Math.log(2))+1,D=b/Math.pow(2,M);return[D,M]},1),z(B,"$gamma",function(b){b=L("Math")["$float!"](b);var M,D,G,R,f,E,g,_,u,c=4.7421875,s=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(b))return NaN;if(b===0&&1/b<0)return-1/0;if((b===-1||b===-1/0)&&h.$raise(L("DomainError"),'Numerical argument is out of domain - "gamma"'),L("Integer")["$==="](b)){if(b<=0)return isFinite(b)?1/0:NaN;if(b>171)return 1/0;for(R=b-2,f=b-1;R>1;)f*=R,R--;return f==0&&(f=1),f}if(b<.5)return Math.PI/(Math.sin(Math.PI*b)*t("Math").$gamma(U(1,b)));if(b>=171.35)return 1/0;if(b>85)return E=b*b,g=E*b,_=g*b,u=_*b,Math.sqrt(2*Math.PI/b)*Math.pow(b/Math.E,b)*(1+1/(12*b)+1/(288*E)-139/(51840*g)-571/(2488320*_)+163879/(209018880*u)+5246819/(75246796800*u*b));for(b-=1,G=s[0],M=1;M<s.length;++M)G+=s[M]/(b+M);return D=b+c+.5,Math.sqrt(2*Math.PI)*Math.pow(D,b+.5)*Math.exp(-D)*G},1),T(typeof Math.hypot!="undefined")||(Math.hypot=function(w,b){return Math.sqrt(w*w+b*b)}),z(B,"$hypot",function(b,M){return t("Math").$checked("hypot",t("Math")["$float!"](b),t("Math")["$float!"](M))},2),z(B,"$ldexp",function(b,M){return b=L("Math")["$float!"](b),M=L("Math")["$integer!"](M),isNaN(M)&&h.$raise(t("RangeError"),"float NaN out of range of integer"),b*Math.pow(2,M)},2),z(B,"$lgamma",function(b){return b==-1?[1/0,1]:[Math.log(Math.abs(t("Math").$gamma(b))),t("Math").$gamma(b)<0?-1:1]},1),z(B,"$log",function(b,M){return J(t("String"),b)&&h.$raise(r(b,t("Float"))),T(M==null)?t("Math").$checked("log",t("Math")["$float!"](b)):(J(t("String"),M)&&h.$raise(r(M,t("Float"))),W(t("Math").$checked("log",t("Math")["$float!"](b)),t("Math").$checked("log",t("Math")["$float!"](M))))},-2),T(typeof Math.log10!="undefined")||(Math.log10=function(w){return Math.log(w)/Math.LN10}),z(B,"$log10",function(b){return J(t("String"),b)&&h.$raise(r(b,t("Float"))),t("Math").$checked("log10",t("Math")["$float!"](b))},1),T(typeof Math.log2!="undefined")||(Math.log2=function(w){return Math.log(w)/Math.LN2}),z(B,"$log2",function(b){return J(t("String"),b)&&h.$raise(r(b,t("Float"))),t("Math").$checked("log2",t("Math")["$float!"](b))},1),z(B,"$sin",function(b){return t("Math").$checked("sin",t("Math")["$float!"](b))},1),T(typeof Math.sinh!="undefined")||(Math.sinh=function(w){return(Math.exp(w)-Math.exp(-w))/2}),z(B,"$sinh",function(b){return t("Math").$checked("sinh",t("Math")["$float!"](b))},1),z(B,"$sqrt",function(b){return t("Math").$checked("sqrt",t("Math")["$float!"](b))},1),z(B,"$tan",function(b){return b=t("Math")["$float!"](b),T(b["$infinite?"]())?t(t("Float"),"NAN"):t("Math").$checked("tan",t("Math")["$float!"](b))},1),T(typeof Math.tanh!="undefined")||(Math.tanh=function(w){return w==1/0?1:w==-1/0?-1:(Math.exp(w)-Math.exp(-w))/(Math.exp(w)+Math.exp(-w))}),z(B,"$tanh",function(b){return t("Math").$checked("tanh",t("Math")["$float!"](b))},1)}("::",A)};Opal.modules["corelib/complex/base"]=function(e){var A=[],o=e.nil,t=e.module,r=e.truthy,q=e.def,C=e.klass;return function(I,h){var v=t(I,"Kernel"),z=[v].concat(h),T=e.$r(z);return q(v,"$Complex",function(J,W){return W==null&&(W=o),r(W)?T("Complex").$new(J,W):T("Complex").$new(J,0)},-2)}("::",A),function(I,h,v){var z=C(I,h,"String"),T=[z].concat(v),U=e.$r(T);return q(z,"$to_c",function(){var W=this;return U("Complex").$from_string(W)},0)}("::",null,A)};Opal.modules["corelib/complex"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.klass,C=e.truthy,I=e.eqeqeq,h=e.Kernel,v=e.defs,z=e.rb_times,T=e.def,U=e.rb_plus,J=e.rb_minus,W=e.rb_divide,S=e.eqeq,F=e.to_ary,B=e.rb_gt,X=e.neqeq,L=e.const_set,w=e.alias;return A.$require("corelib/numeric"),A.$require("corelib/complex/base"),function(b,M,D){var G=q(b,M,"Complex"),R=[G].concat(D),f=e.$r(R),E=G.$$prototype;return E.real=E.imag=t,v(G,"$rect",function(_,u){var c=this;return u==null&&(u=0),I(r("Numeric"),_)&&C(_["$real?"]())&&I(r("Numeric"),u)&&C(u["$real?"]())||h.$raise(r("TypeError"),"not a real"),c.$new(_,u)},-2),v(G,"$polar",function(_,u){var c=this;return u==null&&(u=0),I(r("Numeric"),_)&&C(_["$real?"]())&&I(r("Numeric"),u)&&C(u["$real?"]())||h.$raise(r("TypeError"),"not a real"),c.$new(z(_,r("Math").$cos(u)),z(_,r("Math").$sin(u)))},-2),G.$attr_reader("real","imag"),T(G,"$initialize",function(_,u){var c=this;return u==null&&(u=0),c.real=_,c.imag=u},-2),T(G,"$coerce",function(_){var u=this;return I(r("Complex"),_)?[_,u]:I(r("Numeric"),_)&&C(_["$real?"]())?[r("Complex").$new(_,0),u]:h.$raise(r("TypeError"),""+_.$class()+" can't be coerced into Complex")},1),T(G,"$==",function(_){var u=this,c=t;return I(r("Complex"),_)?C(c=u.real["$=="](_.$real()))?u.imag["$=="](_.$imag()):c:I(r("Numeric"),_)&&C(_["$real?"]())?C(c=u.real["$=="](_))?u.imag["$=="](0):c:_["$=="](u)},1),T(G,"$-@",function(){var _=this;return h.$Complex(_.real["$-@"](),_.imag["$-@"]())},0),T(G,"$+",function(_){var u=this;return I(r("Complex"),_)?h.$Complex(U(u.real,_.$real()),U(u.imag,_.$imag())):I(r("Numeric"),_)&&C(_["$real?"]())?h.$Complex(U(u.real,_),u.imag):u.$__coerced__("+",_)},1),T(G,"$-",function(_){var u=this;return I(r("Complex"),_)?h.$Complex(J(u.real,_.$real()),J(u.imag,_.$imag())):I(r("Numeric"),_)&&C(_["$real?"]())?h.$Complex(J(u.real,_),u.imag):u.$__coerced__("-",_)},1),T(G,"$*",function(_){var u=this;return I(r("Complex"),_)?h.$Complex(J(z(u.real,_.$real()),z(u.imag,_.$imag())),U(z(u.real,_.$imag()),z(u.imag,_.$real()))):I(r("Numeric"),_)&&C(_["$real?"]())?h.$Complex(z(u.real,_),z(u.imag,_)):u.$__coerced__("*",_)},1),T(G,"$/",function(_){var u=this;return I(r("Complex"),_)?I(r("Number"),u.real)&&C(u.real["$nan?"]())||I(r("Number"),u.imag)&&C(u.imag["$nan?"]())||I(r("Number"),_.$real())&&C(_.$real()["$nan?"]())||I(r("Number"),_.$imag())&&C(_.$imag()["$nan?"]())?r("Complex").$new(r(r("Float"),"NAN"),r(r("Float"),"NAN")):W(z(u,_.$conj()),_.$abs2()):I(r("Numeric"),_)&&C(_["$real?"]())?h.$Complex(u.real.$quo(_),u.imag.$quo(_)):u.$__coerced__("/",_)},1),T(G,"$**",function(_){var u,c,s,i,n=this,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=t;if(S(_,0))return r("Complex").$new(1,0);if(I(r("Complex"),_))return c=n.$polar(),u=F(c),$=u[0]==null?t:u[0],l=u[1]==null?t:u[1],d=_.$real(),m=_.$imag(),k=r("Math").$exp(J(z(d,r("Math").$log($)),z(m,l))),x=U(z(l,d),z(m,r("Math").$log($))),r("Complex").$polar(k,x);if(I(r("Integer"),_))if(C(B(_,0))){for(Y=n,a=Y,N=J(_,1);X(N,0);){for(s=N.$divmod(2),c=F(s),p=c[0]==null?t:c[0],H=c[1]==null?t:c[1];S(H,0);)Y=h.$Complex(J(z(Y.$real(),Y.$real()),z(Y.$imag(),Y.$imag())),z(z(2,Y.$real()),Y.$imag())),N=p,i=N.$divmod(2),s=F(i),p=s[0]==null?t:s[0],H=s[1]==null?t:s[1];a=z(a,Y),N=J(N,1)}return a}else return W(r("Rational").$new(1,1),n)["$**"](_["$-@"]());else return I(r("Float"),_)||I(r("Rational"),_)?(c=n.$polar(),u=F(c),$=u[0]==null?t:u[0],l=u[1]==null?t:u[1],r("Complex").$polar($["$**"](_),z(l,_))):n.$__coerced__("**",_)},1),T(G,"$abs",function(){var _=this;return r("Math").$hypot(_.real,_.imag)},0),T(G,"$abs2",function(){var _=this;return U(z(_.real,_.real),z(_.imag,_.imag))},0),T(G,"$angle",function(){var _=this;return r("Math").$atan2(_.imag,_.real)},0),T(G,"$conj",function(){var _=this;return h.$Complex(_.real,_.imag["$-@"]())},0),T(G,"$denominator",function(){var _=this;return _.real.$denominator().$lcm(_.imag.$denominator())},0),T(G,"$eql?",function(_){var u=this,c=t,s=t;return C(c=C(s=f("Complex")["$==="](_))?u.real.$class()["$=="](u.imag.$class()):s)?u["$=="](_):c},1),T(G,"$fdiv",function(_){var u=this;return I(r("Numeric"),_)||h.$raise(r("TypeError"),""+_.$class()+" can't be coerced into Complex"),W(u,_)},1),T(G,"$finite?",function(){var _=this,u=t;return C(u=_.real["$finite?"]())?_.imag["$finite?"]():u},0),T(G,"$hash",function(){var _=this;return"Complex:"+_.real+":"+_.imag},0),T(G,"$infinite?",function(){var _=this,u=t;return C(u=_.real["$infinite?"]())?u:_.imag["$infinite?"]()},0),T(G,"$inspect",function(){var _=this;return"("+_+")"},0),T(G,"$numerator",function(){var _=this,u=t;return u=_.$denominator(),h.$Complex(z(_.real.$numerator(),W(u,_.real.$denominator())),z(_.imag.$numerator(),W(u,_.imag.$denominator())))},0),T(G,"$polar",function(){var _=this;return[_.$abs(),_.$arg()]},0),T(G,"$rationalize",function(_){var u=this;return arguments.length>1&&h.$raise(r("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),X(u.imag,0)&&h.$raise(r("RangeError"),"can't convert "+u+" into Rational"),u.$real().$rationalize(_)},-1),T(G,"$real?",function(){return!1},0),T(G,"$rect",function(){var _=this;return[_.real,_.imag]},0),T(G,"$to_f",function(){var _=this;return S(_.imag,0)||h.$raise(r("RangeError"),"can't convert "+_+" into Float"),_.real.$to_f()},0),T(G,"$to_i",function(){var _=this;return S(_.imag,0)||h.$raise(r("RangeError"),"can't convert "+_+" into Integer"),_.real.$to_i()},0),T(G,"$to_r",function(){var _=this;return S(_.imag,0)||h.$raise(r("RangeError"),"can't convert "+_+" into Rational"),_.real.$to_r()},0),T(G,"$to_s",function(){var _=this,u=t;return u=_.real.$inspect(),u=U(u,I(r("Number"),_.imag)&&C(_.imag["$nan?"]())||C(_.imag["$positive?"]())||C(_.imag["$zero?"]())?"+":"-"),u=U(u,_.imag.$abs().$inspect()),I(r("Number"),_.imag)&&(C(_.imag["$nan?"]())||C(_.imag["$infinite?"]()))&&(u=U(u,"*")),U(u,"i")},0),L(R[0],"I",G.$new(0,1)),v(G,"$from_string",function(_){var u=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/,c=_.match(u),s,i,n;function $(){return u.test(_)}function l(){var m=_.match(u),k=m[0];return _=_.slice(k.length),k.replace(/_/g,"")}function d(){if($()){var m=parseFloat(l());if(_[0]==="/")if(_=_.slice(1),$()){var k=parseFloat(l());return h.$Rational(m,k)}else return _="/"+_,m;else return m}else return null}return s=d(),s?(i=d(),i?h.$Complex(s,i):_[0]==="i"?h.$Complex(0,s):h.$Complex(s,0)):_[0]==="i"?h.$Complex(0,1):_[0]==="-"&&_[1]==="i"?h.$Complex(0,-1):_[0]==="+"&&_[1]==="i"?h.$Complex(0,1):h.$Complex(0,0)},1),function(g,_){return w(g,"rectangular","rect")}(e.get_singleton_class(G),R),w(G,"arg","angle"),w(G,"conjugate","conj"),w(G,"divide","/"),w(G,"imaginary","imag"),w(G,"magnitude","abs"),w(G,"phase","arg"),w(G,"quo","/"),w(G,"rectangular","rect"),e.udef(G,"$negative?"),e.udef(G,"$positive?"),e.udef(G,"$step"),t}("::",r("Numeric"),o)};Opal.modules["corelib/rational/base"]=function(e){var A=e.nil,o=e.$$$,t=e.module,r=e.def,q=e.klass;return function(C){var I=t(C,"Kernel");return r(I,"$Rational",function(v,z){return z==null&&(z=1),o("Rational").$convert(v,z)},-2)}("::"),function(C,I){var h=q(C,I,"String");return r(h,"$to_r",function(){var z=this;return o("Rational").$from_string(z)},0)}("::",null)};Opal.modules["corelib/rational"]=function(e){var A=e.top,o=e.nil,t=e.$$$,r=e.klass,q=e.eqeq,C=e.Kernel,I=e.truthy,h=e.rb_lt,v=e.rb_divide,z=e.defs,T=e.eqeqeq,U=e.not,J=e.Opal,W=e.def,S=e.rb_minus,F=e.rb_times,B=e.rb_plus,X=e.rb_gt,L=e.rb_le,w=e.alias;return A.$require("corelib/numeric"),A.$require("corelib/rational/base"),function(b,M){var D=r(b,M,"Rational"),G=D.$$prototype;return G.num=G.den=o,z(D,"$reduce",function(f,E){var g=this,_=o;if(f=f.$to_i(),E=E.$to_i(),q(E,0))C.$raise(t("ZeroDivisionError"),"divided by 0");else if(I(h(E,0)))f=f["$-@"](),E=E["$-@"]();else if(q(E,1))return g.$new(f,E);return _=f.$gcd(E),g.$new(v(f,_),v(E,_))},2),z(D,"$convert",function(f,E){var g=this;return(I(f["$nil?"]())||I(E["$nil?"]()))&&C.$raise(t("TypeError"),"cannot convert nil into Rational"),T(t("Integer"),f)&&T(t("Integer"),E)?g.$reduce(f,E):((T(t("Float"),f)||T(t("String"),f)||T(t("Complex"),f))&&(f=f.$to_r()),(T(t("Float"),E)||T(t("String"),E)||T(t("Complex"),E))&&(E=E.$to_r()),I(E["$equal?"](1))&&U(t("Integer")["$==="](f))?J["$coerce_to!"](f,t("Rational"),"to_r"):T(t("Numeric"),f)&&T(t("Numeric"),E)?v(f,E):g.$reduce(f,E))},2),W(D,"$initialize",function(f,E){var g=this;return g.num=f,g.den=E},2),W(D,"$numerator",function(){var f=this;return f.num},0),W(D,"$denominator",function(){var f=this;return f.den},0),W(D,"$coerce",function(f){var E=this,g=o;return T(t("Rational"),g=f)?[f,E]:T(t("Integer"),g)?[f.$to_r(),E]:T(t("Float"),g)?[f,E.$to_f()]:o},1),W(D,"$==",function(f){var E=this,g=o,_=o;return T(t("Rational"),g=f)?I(_=E.num["$=="](f.$numerator()))?E.den["$=="](f.$denominator()):_:T(t("Integer"),g)?I(_=E.num["$=="](f))?E.den["$=="](1):_:T(t("Float"),g)?E.$to_f()["$=="](f):f["$=="](E)},1),W(D,"$<=>",function(f){var E=this,g=o;return T(t("Rational"),g=f)?S(F(E.num,f.$denominator()),F(E.den,f.$numerator()))["$<=>"](0):T(t("Integer"),g)?S(E.num,F(E.den,f))["$<=>"](0):T(t("Float"),g)?E.$to_f()["$<=>"](f):E.$__coerced__("<=>",f)},1),W(D,"$+",function(f){var E=this,g=o,_=o,u=o;return T(t("Rational"),g=f)?(_=B(F(E.num,f.$denominator()),F(E.den,f.$numerator())),u=F(E.den,f.$denominator()),C.$Rational(_,u)):T(t("Integer"),g)?C.$Rational(B(E.num,F(f,E.den)),E.den):T(t("Float"),g)?B(E.$to_f(),f):E.$__coerced__("+",f)},1),W(D,"$-",function(f){var E=this,g=o,_=o,u=o;return T(t("Rational"),g=f)?(_=S(F(E.num,f.$denominator()),F(E.den,f.$numerator())),u=F(E.den,f.$denominator()),C.$Rational(_,u)):T(t("Integer"),g)?C.$Rational(S(E.num,F(f,E.den)),E.den):T(t("Float"),g)?S(E.$to_f(),f):E.$__coerced__("-",f)},1),W(D,"$*",function(f){var E=this,g=o,_=o,u=o;return T(t("Rational"),g=f)?(_=F(E.num,f.$numerator()),u=F(E.den,f.$denominator()),C.$Rational(_,u)):T(t("Integer"),g)?C.$Rational(F(E.num,f),E.den):T(t("Float"),g)?F(E.$to_f(),f):E.$__coerced__("*",f)},1),W(D,"$/",function(f){var E=this,g=o,_=o,u=o;return T(t("Rational"),g=f)?(_=F(E.num,f.$denominator()),u=F(E.den,f.$numerator()),C.$Rational(_,u)):T(t("Integer"),g)?q(f,0)?v(E.$to_f(),0):C.$Rational(E.num,F(E.den,f)):T(t("Float"),g)?v(E.$to_f(),f):E.$__coerced__("/",f)},1),W(D,"$**",function(f){var E=this,g=o;return T(t("Integer"),g=f)?q(E,0)&&I(h(f,0))?t(t("Float"),"INFINITY"):I(X(f,0))?C.$Rational(E.num["$**"](f),E.den["$**"](f)):I(h(f,0))?C.$Rational(E.den["$**"](f["$-@"]()),E.num["$**"](f["$-@"]())):C.$Rational(1,1):T(t("Float"),g)?E.$to_f()["$**"](f):T(t("Rational"),g)?q(f,0)?C.$Rational(1,1):q(f.$denominator(),1)?I(h(f,0))?C.$Rational(E.den["$**"](f.$numerator().$abs()),E.num["$**"](f.$numerator().$abs())):C.$Rational(E.num["$**"](f.$numerator()),E.den["$**"](f.$numerator())):q(E,0)&&I(h(f,0))?C.$raise(t("ZeroDivisionError"),"divided by 0"):E.$to_f()["$**"](f):E.$__coerced__("**",f)},1),W(D,"$abs",function(){var f=this;return C.$Rational(f.num.$abs(),f.den.$abs())},0),W(D,"$ceil",function(f){var E=this;return f==null&&(f=0),q(f,0)?v(E.num["$-@"](),E.den)["$-@"]().$ceil():E.$with_precision("ceil",f)},-1),W(D,"$floor",function(f){var E=this;return f==null&&(f=0),q(f,0)?v(E.num["$-@"](),E.den)["$-@"]().$floor():E.$with_precision("floor",f)},-1),W(D,"$hash",function(){var f=this;return"Rational:"+f.num+":"+f.den},0),W(D,"$inspect",function(){var f=this;return"("+f+")"},0),W(D,"$rationalize",function(f){var E=this;if(arguments.length>1&&C.$raise(t("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),f==null)return E;for(var g=f.$abs(),_=S(E,g),u=B(E,g),c=0,s=1,i=1,n=0,$,l,d,m,k;d=_.$ceil(),!L(d,u);)m=d-1,$=m*s+c,l=m*n+i,k=v(1,S(u,m)),u=v(1,S(_,m)),_=k,c=s,i=n,s=$,n=l;return C.$Rational(d*s+c,d*n+i)},-1),W(D,"$round",function(f){var E=this,g=o,_=o,u=o;return f==null&&(f=0),q(f,0)?q(E.num,0)?0:q(E.den,1)?E.num:(g=B(F(E.num.$abs(),2),E.den),_=F(E.den,2),u=v(g,_).$truncate(),I(h(E.num,0))?u["$-@"]():u):E.$with_precision("round",f)},-1),W(D,"$to_f",function(){var f=this;return v(f.num,f.den)},0),W(D,"$to_i",function(){var f=this;return f.$truncate()},0),W(D,"$to_r",function(){var f=this;return f},0),W(D,"$to_s",function(){var f=this;return""+f.num+"/"+f.den},0),W(D,"$truncate",function(f){var E=this;return f==null&&(f=0),q(f,0)?I(h(E.num,0))?E.$ceil():E.$floor():E.$with_precision("truncate",f)},-1),W(D,"$with_precision",function(f,E){var g=this,_=o,u=o;return T(t("Integer"),E)||C.$raise(t("TypeError"),"not an Integer"),_=10["$**"](E),u=F(g,_),I(h(E,1))?v(u.$send(f),_).$to_i():C.$Rational(u.$send(f),_)},2),z(D,"$from_string",function(f){var E=f.trimLeft(),g=/^[+-]?[\d_]+(\.[\d_]+)?/,_=E.match(g),u,c;function s(){return g.test(E)}function i(){var n=E.match(g),$=n[0];return E=E.slice($.length),$.replace(/_/g,"")}return s()?(u=parseFloat(i()),E[0]==="/"?(E=E.slice(1),s()?(c=parseFloat(i()),C.$Rational(u,c)):C.$Rational(u,1)):C.$Rational(u,1)):C.$Rational(0,1)},1),w(D,"divide","/"),w(D,"quo","/")}("::",t("Numeric"))};Opal.modules["corelib/time"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.slice,C=e.klass,I=e.Kernel,h=e.Opal,v=e.defs,z=e.eqeqeq,T=e.def,U=e.truthy,J=e.rb_gt,W=e.rb_lt,S=e.rb_plus,F=e.rb_divide,B=e.rb_minus,X=e.range,L=e.neqeq,w=e.rb_le,b=e.eqeq,M=e.alias;return A.$require("corelib/comparable"),function(D,G,R){var f=C(D,G,"Time"),E=[f].concat(R),g=e.$r(E);f.$include(r("Comparable"));var _=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=["January","February","March","April","May","June","July","August","September","October","November","December"];v(f,"$at",function($,l){var d;return r("Time")["$==="]($)?(l!==void 0&&I.$raise(r("TypeError"),"can't convert Time into an exact number"),d=new Date($.getTime()),d.is_utc=$.is_utc,d):($.$$is_number||($=h["$coerce_to!"]($,r("Integer"),"to_int")),l===void 0?new Date($*1e3):(l.$$is_number||(l=h["$coerce_to!"](l,r("Integer"),"to_int")),new Date($*1e3+l/1e3)))},-2);function i(n,$,l,d,m,k){if(n.$$is_string?n=parseInt(n,10):n=h["$coerce_to!"](n,r("Integer"),"to_int"),$===t)$=1;else if(!$.$$is_number)if($["$respond_to?"]("to_str"))switch($=$.$to_str(),$.toLowerCase()){case"jan":$=1;break;case"feb":$=2;break;case"mar":$=3;break;case"apr":$=4;break;case"may":$=5;break;case"jun":$=6;break;case"jul":$=7;break;case"aug":$=8;break;case"sep":$=9;break;case"oct":$=10;break;case"nov":$=11;break;case"dec":$=12;break;default:$=$.$to_i()}else $=h["$coerce_to!"]($,r("Integer"),"to_int");return($<1||$>12)&&I.$raise(r("ArgumentError"),"month out of range: "+$),$=$-1,l===t?l=1:l.$$is_string?l=parseInt(l,10):l=h["$coerce_to!"](l,r("Integer"),"to_int"),(l<1||l>31)&&I.$raise(r("ArgumentError"),"day out of range: "+l),d===t?d=0:d.$$is_string?d=parseInt(d,10):d=h["$coerce_to!"](d,r("Integer"),"to_int"),(d<0||d>24)&&I.$raise(r("ArgumentError"),"hour out of range: "+d),m===t?m=0:m.$$is_string?m=parseInt(m,10):m=h["$coerce_to!"](m,r("Integer"),"to_int"),(m<0||m>59)&&I.$raise(r("ArgumentError"),"min out of range: "+m),k===t?k=0:k.$$is_number||(k.$$is_string?k=parseInt(k,10):k=h["$coerce_to!"](k,r("Integer"),"to_int")),(k<0||k>60)&&I.$raise(r("ArgumentError"),"sec out of range: "+k),[n,$,l,d,m,k]}return v(f,"$new",function($,l,d,m,k,x,Y){l==null&&(l=t),d==null&&(d=t),m==null&&(m=t),k==null&&(k=t),x==null&&(x=t),Y==null&&(Y=t);var a,N;return $===void 0?new Date:(Y!==t&&I.$raise(r("ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),a=i($,l,d,m,k,x),$=a[0],l=a[1],d=a[2],m=a[3],k=a[4],x=a[5],N=new Date($,l,d,m,k,0,x*1e3),$<100&&N.setFullYear($),N)},-1),v(f,"$local",function($,l,d,m,k,x,Y,a,N,p){l==null&&(l=t),d==null&&(d=t),m==null&&(m=t),k==null&&(k=t),x==null&&(x=t),Y==null&&(Y=t),a==null&&(a=t),N==null&&(N=t),p==null&&(p=t);var H,Q;return arguments.length===10&&(H=q.call(arguments),$=H[5],l=H[4],d=H[3],m=H[2],k=H[1],x=H[0]),H=i($,l,d,m,k,x),$=H[0],l=H[1],d=H[2],m=H[3],k=H[4],x=H[5],Q=new Date($,l,d,m,k,0,x*1e3),$<100&&Q.setFullYear($),Q},-2),v(f,"$gm",function($,l,d,m,k,x,Y,a,N,p){l==null&&(l=t),d==null&&(d=t),m==null&&(m=t),k==null&&(k=t),x==null&&(x=t),Y==null&&(Y=t),a==null&&(a=t),N==null&&(N=t),p==null&&(p=t);var H,Q;return arguments.length===10&&(H=q.call(arguments),$=H[5],l=H[4],d=H[3],m=H[2],k=H[1],x=H[0]),H=i($,l,d,m,k,x),$=H[0],l=H[1],d=H[2],m=H[3],k=H[4],x=H[5],Q=new Date(Date.UTC($,l,d,m,k,0,x*1e3)),$<100&&Q.setUTCFullYear($),Q.is_utc=!0,Q},-2),v(f,"$now",function(){var $=this;return $.$new()},0),T(f,"$+",function($){var l=this;z(r("Time"),$)&&I.$raise(r("TypeError"),"time + time?"),$.$$is_number||($=h["$coerce_to!"]($,r("Integer"),"to_int"));var d=new Date(l.getTime()+$*1e3);return d.is_utc=l.is_utc,d},1),T(f,"$-",function($){var l=this;if(z(r("Time"),$))return(l.getTime()-$.getTime())/1e3;$.$$is_number||($=h["$coerce_to!"]($,r("Integer"),"to_int"));var d=new Date(l.getTime()-$*1e3);return d.is_utc=l.is_utc,d},1),T(f,"$<=>",function($){var l=this,d=t;return z(r("Time"),$)?l.$to_f()["$<=>"]($.$to_f()):(d=$["$<=>"](l),U(d["$nil?"]())?t:U(J(d,0))?-1:U(W(d,0))?1:0)},1),T(f,"$==",function($){var l=this,d=t;return U(d=r("Time")["$==="]($))?l.$to_f()===$.$to_f():d},1),T(f,"$asctime",function(){var $=this;return $.$strftime("%a %b %e %H:%M:%S %Y")},0),T(f,"$day",function(){var $=this;return $.is_utc?$.getUTCDate():$.getDate()},0),T(f,"$yday",function(){var $=this,l=t,d=t,m=t;return l=g("Time").$new($.$year()).$to_i(),d=g("Time").$new($.$year(),$.$month(),$.$day()).$to_i(),m=86400,S(F(B(d,l),m).$round(),1)},0),T(f,"$isdst",function(){var $=this,l=new Date($.getFullYear(),0,1),d=new Date($.getFullYear(),6,1);return $.getTimezoneOffset()<Math.max(l.getTimezoneOffset(),d.getTimezoneOffset())},0),T(f,"$dup",function(){var $=this,l=t;return l=new Date($.getTime()),l.$copy_instance_variables($),l.$initialize_dup($),l},0),T(f,"$eql?",function($){var l=this,d=t;return U(d=$["$is_a?"](r("Time")))?l["$<=>"]($)["$zero?"]():d},1),T(f,"$friday?",function(){var $=this;return $.$wday()==5},0),T(f,"$hash",function(){var $=this;return"Time:"+$.getTime()},0),T(f,"$hour",function(){var $=this;return $.is_utc?$.getUTCHours():$.getHours()},0),T(f,"$inspect",function(){var $=this;return U($["$utc?"]())?$.$strftime("%Y-%m-%d %H:%M:%S UTC"):$.$strftime("%Y-%m-%d %H:%M:%S %z")},0),T(f,"$min",function(){var $=this;return $.is_utc?$.getUTCMinutes():$.getMinutes()},0),T(f,"$mon",function(){var $=this;return($.is_utc?$.getUTCMonth():$.getMonth())+1},0),T(f,"$monday?",function(){var $=this;return $.$wday()==1},0),T(f,"$saturday?",function(){var $=this;return $.$wday()==6},0),T(f,"$sec",function(){var $=this;return $.is_utc?$.getUTCSeconds():$.getSeconds()},0),T(f,"$succ",function(){var $=this,l=new Date($.getTime()+1e3);return l.is_utc=$.is_utc,l},0),T(f,"$usec",function(){var $=this;return $.getMilliseconds()*1e3},0),T(f,"$zone",function(){var $=this,l=$.toString(),d;return l.indexOf("(")==-1?d=l.match(/[A-Z]{3,4}/)[0]:d=l.match(/\((.+)\)(?:\s|$)/)[1],d=="GMT"&&/(GMT\W*\d{4})/.test(l)?RegExp.$1:d},0),T(f,"$getgm",function(){var $=this,l=new Date($.getTime());return l.is_utc=!0,l},0),T(f,"$gmtime",function(){var $=this;return $.is_utc=!0,$},0),T(f,"$gmt?",function(){var $=this;return $.is_utc===!0},0),T(f,"$gmt_offset",function(){var $=this;return $.is_utc?0:-$.getTimezoneOffset()*60},0),T(f,"$strftime",function($){var l=this;return $.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(d,m,k,x,Y){var a="",N=m.indexOf("0")!==-1,p=m.indexOf("-")===-1,H=m.indexOf("_")!==-1,Q=m.indexOf("^")!==-1,ee=m.indexOf("#")!==-1,ne=(m.match(":")||[]).length;switch(k=parseInt(k,10),N&&H&&(m.indexOf("0")<m.indexOf("_")?N=!1:H=!1),Y){case"Y":a+=l.$year();break;case"C":N=!H,a+=Math.round(l.$year()/100);break;case"y":N=!H,a+=l.$year()%100;break;case"m":N=!H,a+=l.$mon();break;case"B":a+=s[l.$mon()-1];break;case"b":case"h":H=!N,a+=c[l.$mon()-1];break;case"d":N=!H,a+=l.$day();break;case"e":H=!N,a+=l.$day();break;case"j":N=!H,k=isNaN(k)?3:k,a+=l.$yday();break;case"H":N=!H,a+=l.$hour();break;case"k":H=!N,a+=l.$hour();break;case"I":N=!H,a+=l.$hour()%12||12;break;case"l":H=!N,a+=l.$hour()%12||12;break;case"P":a+=l.$hour()>=12?"pm":"am";break;case"p":a+=l.$hour()>=12?"PM":"AM";break;case"M":N=!H,a+=l.$min();break;case"S":N=!H,a+=l.$sec();break;case"L":N=!H,k=isNaN(k)?3:k,a+=l.getMilliseconds();break;case"N":k=isNaN(k)?9:k,a+=l.getMilliseconds().toString().$rjust(3,"0"),a=a.$ljust(k,"0");break;case"z":var V=l.getTimezoneOffset(),Z=Math.floor(Math.abs(V)/60),y=Math.abs(V)%60;a+=V<0?"+":"-",a+=Z<10?"0":"",a+=Z,ne>0&&(a+=":"),a+=y<10?"0":"",a+=y,ne>1&&(a+=":00");break;case"Z":a+=l.$zone();break;case"A":a+=_[l.$wday()];break;case"a":a+=u[l.$wday()];break;case"u":a+=l.$wday()+1;break;case"w":a+=l.$wday();break;case"V":a+=l.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":a+=l.$cweek_cyear()["$[]"](1);break;case"g":a+=l.$cweek_cyear()["$[]"](1)["$[]"](X(-2,-1,!1));break;case"s":a+=l.$to_i();break;case"n":a+=`
`;break;case"t":a+="	";break;case"%":a+="%";break;case"c":a+=l.$strftime("%a %b %e %T %Y");break;case"D":case"x":a+=l.$strftime("%m/%d/%y");break;case"F":a+=l.$strftime("%Y-%m-%d");break;case"v":a+=l.$strftime("%e-%^b-%4Y");break;case"r":a+=l.$strftime("%I:%M:%S %p");break;case"R":a+=l.$strftime("%H:%M");break;case"T":case"X":a+=l.$strftime("%H:%M:%S");break;default:return d}return Q&&(a=a.toUpperCase()),ee&&(a=a.replace(/[A-Z]/,function(K){K.toLowerCase()}).replace(/[a-z]/,function(K){K.toUpperCase()})),p&&(N||H)&&(a=a.$rjust(isNaN(k)?2:k,H?" ":"0")),a})},1),T(f,"$sunday?",function(){var $=this;return $.$wday()==0},0),T(f,"$thursday?",function(){var $=this;return $.$wday()==4},0),T(f,"$to_a",function(){var $=this;return[$.$sec(),$.$min(),$.$hour(),$.$day(),$.$month(),$.$year(),$.$wday(),$.$yday(),$.$isdst(),$.$zone()]},0),T(f,"$to_f",function(){var $=this;return $.getTime()/1e3},0),T(f,"$to_i",function(){var $=this;return parseInt($.getTime()/1e3,10)},0),T(f,"$tuesday?",function(){var $=this;return $.$wday()==2},0),T(f,"$wday",function(){var $=this;return $.is_utc?$.getUTCDay():$.getDay()},0),T(f,"$wednesday?",function(){var $=this;return $.$wday()==3},0),T(f,"$year",function(){var $=this;return $.is_utc?$.getUTCFullYear():$.getFullYear()},0),T(f,"$cweek_cyear",function(){var $=this,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t;return l=r("Time").$new($.$year(),1,1),d=l.$wday(),m=0,k=$.$year(),U(w(d,4))&&L(d,0)?x=B(d,1):(x=B(B(d,7),1),b(x,-8)&&(x=-1)),Y=F(S($.$yday(),x),7).$ceil(),U(w(Y,0))?r("Time").$new(B($.$year(),1),12,31).$cweek_cyear():(b(Y,53)&&(a=r("Time").$new($.$year(),12,31),N=a.$wday(),U(w(N,3))&&L(N,0)&&(Y=1,k=S(k,1))),[Y,k])},0),function(n,$){return M(n,"mktime","local"),M(n,"utc","gm")}(e.get_singleton_class(f),E),M(f,"ctime","asctime"),M(f,"dst?","isdst"),M(f,"getutc","getgm"),M(f,"gmtoff","gmt_offset"),M(f,"mday","day"),M(f,"month","mon"),M(f,"to_s","inspect"),M(f,"tv_sec","to_i"),M(f,"tv_usec","usec"),M(f,"utc","gmtime"),M(f,"utc?","gmt?"),M(f,"utc_offset","gmt_offset")}("::",Date,o)};Opal.modules["corelib/struct"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.klass,C=e.hash2,I=e.truthy,h=e.neqeq,v=e.eqeq,z=e.Opal,T=e.send,U=e.Class,J=e.to_a,W=e.def,S=e.defs,F=e.Kernel,B=e.rb_gt,X=e.rb_minus,L=e.eqeqeq,w=e.rb_lt,b=e.rb_ge,M=e.rb_plus,D=e.alias;return A.$require("corelib/enumerable"),function(G,R,f){var E=q(G,R,"Struct"),g=[E].concat(f),_=e.$r(g);E.$include(r("Enumerable")),S(E,"$new",function c(s,i,n){var $=c.$$p||t,l,d,m,k,x=this,Y=t;if(delete c.$$p,l=e.slice.call(arguments,1),d=e.extract_kwargs(l),d==null)d=C([],{});else if(!d.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(m=l,k=d.$$smap.keyword_init,k==null&&(k=!1),I(s))if(v(s.$class(),r("String"))&&h(s["$[]"](0).$upcase(),s["$[]"](0)))m.$unshift(s),s=t;else try{s=z["$const_name!"](s)}catch(a){if(e.rescue(a,[r("TypeError"),r("NameError")]))try{m.$unshift(s),s=t}finally{e.pop_exception()}else throw a}return T(m,"map",[],function(N){return N==null&&(N=t),z["$coerce_to!"](N,r("String"),"to_str")},1),Y=T(U,"new",[x],function a(){var N=a.$$s==null?this:a.$$s;return T(m,"each",[],function p(H){var Q=p.$$s==null?this:p.$$s;return H==null&&(H=t),Q.$define_struct_attribute(H)},{$$arity:1,$$s:N}),function(p,H){return W(p,"$new",function(ee){var ne,V,Z=this,y=t;return ne=e.slice.call(arguments),V=ne,y=Z.$allocate(),y.$$data={},T(y,"initialize",J(V)),y},-1),p.$alias_method("[]","new")}(e.get_singleton_class(N),g)},{$$arity:0,$$s:x}),I($)&&T(Y,"module_eval",[],$.$to_proc()),Y.$$keyword_init=k,I(s)&&r("Struct").$const_set(s,Y),Y},-2),S(E,"$define_struct_attribute",function(s){var i=this;return v(i,r("Struct"))&&F.$raise(r("ArgumentError"),"you cannot define attributes to the Struct class"),i.$members()["$<<"](s),T(i,"define_method",[s],function n(){var $=n.$$s==null?this:n.$$s;return $.$$data[s]},{$$arity:0,$$s:i}),T(i,"define_method",[""+s+"="],function n($){var l=n.$$s==null?this:n.$$s;return $==null&&($=t),l.$$data[s]=$},{$$arity:1,$$s:i})},1),S(E,"$members",function(){var s=this,i=t;return s.members==null&&(s.members=t),v(s,r("Struct"))&&F.$raise(r("ArgumentError"),"the Struct class has no members"),s.members=I(i=s.members)?i:[]},0),S(E,"$inherited",function(s){var i=this,n=t;return i.members==null&&(i.members=t),n=i.members,T(s,"instance_eval",[],function $(){var l=$.$$s==null?this:$.$$s;return l.members=n},{$$arity:0,$$s:i})},1),W(E,"$initialize",function(s){var i,n,$=this,l=t,d=t,m=t;return i=e.slice.call(arguments),n=i,I($.$class().$$keyword_init)?(l=I(d=n.$last())?d:C([],{}),(I(B(n.$length(),1))||I(n.length===1&&!l.$$is_hash))&&F.$raise(r("ArgumentError"),"wrong number of arguments (given "+n.$length()+", expected 0)"),m=X(l.$keys(),$.$class().$members()),I(m["$any?"]())&&F.$raise(r("ArgumentError"),"unknown keywords: "+m.$join(", ")),T($.$class().$members(),"each",[],function k(x){var Y=k.$$s==null?this:k.$$s,a=t;return x==null&&(x=t),a=[x,l["$[]"](x)],T(Y,"[]=",J(a)),a[X(a.length,1)]},{$$arity:1,$$s:$})):(I(B(n.$length(),$.$class().$members().$length()))&&F.$raise(r("ArgumentError"),"struct size differs"),T($.$class().$members(),"each_with_index",[],function k(x,Y){var a=k.$$s==null?this:k.$$s,N=t;return x==null&&(x=t),Y==null&&(Y=t),N=[x,n["$[]"](Y)],T(a,"[]=",J(N)),N[X(N.length,1)]},{$$arity:2,$$s:$}))},-1),W(E,"$initialize_copy",function(s){var i=this;i.$$data={};var n=Object.keys(s.$$data),$,l,d;for($=0,l=n.length;$<l;$++)d=n[$],i.$$data[d]=s.$$data[d]},1),S(E,"$keyword_init?",function(){var s=this;return s.$$keyword_init},0),W(E,"$members",function(){var s=this;return s.$class().$members()},0),W(E,"$hash",function(){var s=this;return _("Hash").$new(s.$$data).$hash()},0),W(E,"$[]",function(s){var i=this;return L(r("Integer"),s)?(I(w(s,i.$class().$members().$size()["$-@"]()))&&F.$raise(r("IndexError"),"offset "+s+" too small for struct(size:"+i.$class().$members().$size()+")"),I(b(s,i.$class().$members().$size()))&&F.$raise(r("IndexError"),"offset "+s+" too large for struct(size:"+i.$class().$members().$size()+")"),s=i.$class().$members()["$[]"](s)):L(r("String"),s)?i.$$data.hasOwnProperty(s)||F.$raise(r("NameError").$new("no member '"+s+"' in struct",s)):F.$raise(r("TypeError"),"no implicit conversion of "+s.$class()+" into Integer"),s=z["$coerce_to!"](s,r("String"),"to_str"),i.$$data[s]},1),W(E,"$[]=",function(s,i){var n=this;return L(r("Integer"),s)?(I(w(s,n.$class().$members().$size()["$-@"]()))&&F.$raise(r("IndexError"),"offset "+s+" too small for struct(size:"+n.$class().$members().$size()+")"),I(b(s,n.$class().$members().$size()))&&F.$raise(r("IndexError"),"offset "+s+" too large for struct(size:"+n.$class().$members().$size()+")"),s=n.$class().$members()["$[]"](s)):L(r("String"),s)?I(n.$class().$members()["$include?"](s.$to_sym()))||F.$raise(r("NameError").$new("no member '"+s+"' in struct",s)):F.$raise(r("TypeError"),"no implicit conversion of "+s.$class()+" into Integer"),s=z["$coerce_to!"](s,r("String"),"to_str"),n.$$data[s]=i},2),W(E,"$==",function(s){var i=this;if(!I(s["$instance_of?"](i.$class())))return!1;var n={},$={};function l(d,m){var k,x,Y;n[d.$__id__()]=!0,$[m.$__id__()]=!0;for(k in d.$$data)if(x=d.$$data[k],Y=m.$$data[k],r("Struct")["$==="](x)){if((!n.hasOwnProperty(x.$__id__())||!$.hasOwnProperty(Y.$__id__()))&&!l(x,Y))return!1}else if(!x["$=="](Y))return!1;return!0}return l(i,s)},1),W(E,"$eql?",function(s){var i=this;if(!I(s["$instance_of?"](i.$class())))return!1;var n={},$={};function l(d,m){var k,x,Y;n[d.$__id__()]=!0,$[m.$__id__()]=!0;for(k in d.$$data)if(x=d.$$data[k],Y=m.$$data[k],r("Struct")["$==="](x)){if((!n.hasOwnProperty(x.$__id__())||!$.hasOwnProperty(Y.$__id__()))&&!l(x,Y))return!1}else if(!x["$eql?"](Y))return!1;return!0}return l(i,s)},1),W(E,"$each",function c(){var s=c.$$p||t,i=this;return delete c.$$p,s===t?T(i,"enum_for",["each"],function n(){var $=n.$$s==null?this:n.$$s;return $.$size()},{$$arity:0,$$s:i}):(T(i.$class().$members(),"each",[],function n($){var l=n.$$s==null?this:n.$$s;return $==null&&($=t),e.yield1(s,l["$[]"]($))},{$$arity:1,$$s:i}),i)},0),W(E,"$each_pair",function c(){var s=c.$$p||t,i=this;return delete c.$$p,s===t?T(i,"enum_for",["each_pair"],function n(){var $=n.$$s==null?this:n.$$s;return $.$size()},{$$arity:0,$$s:i}):(T(i.$class().$members(),"each",[],function n($){var l=n.$$s==null?this:n.$$s;return $==null&&($=t),e.yield1(s,[$,l["$[]"]($)])},{$$arity:1,$$s:i}),i)},0),W(E,"$length",function(){var s=this;return s.$class().$members().$length()},0),W(E,"$to_a",function(){var s=this;return T(s.$class().$members(),"map",[],function i(n){var $=i.$$s==null?this:i.$$s;return n==null&&(n=t),$["$[]"](n)},{$$arity:1,$$s:s})},0);var u=[];return W(E,"$inspect",function(){var s=this,i=t,n=t;return function(){try{return i="#<struct ",I(u["$include?"](s.$__id__()))?M(i,":...>"):(u["$<<"](s.$__id__()),n=!0,L(r("Struct"),s)&&I(s.$class().$name())&&(i=M(i,""+s.$class()+" ")),i=M(i,T(s.$each_pair(),"map",[],function(l,d){return l==null&&(l=t),d==null&&(d=t),""+l+"="+_("Opal").$inspect(d)},2).$join(", ")),i=M(i,">"),i)}finally{I(n)&&u.pop()}}()},0),W(E,"$to_h",function c(){var s=c.$$p||t,i=this;return delete c.$$p,s!==t?T(T(i,"map",[],s.$to_proc()),"to_h",J(i.$args())):T(i.$class().$members(),"each_with_object",[C([],{})],function n($,l){var d=n.$$s==null?this:n.$$s,m=t;return $==null&&($=t),l==null&&(l=t),m=[$,d["$[]"]($)],T(l,"[]=",J(m)),m[X(m.length,1)]},{$$arity:2,$$s:i})},0),W(E,"$values_at",function(s){var i,n,$=this;i=e.slice.call(arguments),n=i,n=T(n,"map",[],function(x){return x==null&&(x=t),x.$$is_range?x.$to_a():x},1).$flatten();for(var l=[],d=0,m=n.length;d<m;d++)n[d].$$is_number||F.$raise(r("TypeError"),"no implicit conversion of "+n[d].$class()+" into Integer"),l.push($["$[]"](n[d]));return l},-1),W(E,"$dig",function(s,i){var n,$,l=this,d=t;return n=e.slice.call(arguments,1),$=n,d=I(s.$$is_string&&l.$$data.hasOwnProperty(s))&&l.$$data[s]||t,d===t||$.length===0?d:(I(d["$respond_to?"]("dig"))||F.$raise(r("TypeError"),""+d.$class()+" does not have #dig method"),T(d,"dig",J($)))},-2),D(E,"size","length"),D(E,"to_s","inspect"),D(E,"values","to_a")}("::",null,o)};Opal.modules["corelib/dir"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.def,C=e.truthy,I=e.alias;return function(h,v,z){var T=r(h,v,"Dir"),U=[T].concat(z);return function(J,W){return q(J,"$chdir",function S(F){var B=S.$$p||o,X=o;return delete S.$$p,function(){try{return X=e.current_dir,e.current_dir=F,e.yieldX(B,[])}finally{e.current_dir=X}}()},1),q(J,"$pwd",function(){return e.current_dir||"."},0),q(J,"$home",function(){var F=o;return C(F=t("ENV")["$[]"]("HOME"))?F:"."},0),I(J,"getwd","pwd")}(e.get_singleton_class(T),U)}("::",null,A)};Opal.modules["corelib/file"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.truthy,q=e.klass,C=e.const_set,I=e.Opal,h=e.regexp,v=e.rb_plus,z=e.def,T=e.Kernel,U=e.eqeq,J=e.rb_lt,W=e.rb_minus,S=e.range,F=e.send,B=e.alias;return function(X,L,w){var b=q(X,L,"File"),M=[b].concat(w),D=o;return C(M[0],"Separator",C(M[0],"SEPARATOR","/")),C(M[0],"ALT_SEPARATOR",o),C(M[0],"PATH_SEPARATOR",":"),C(M[0],"FNM_SYSCASE",0),D=/^[a-zA-Z]:(?:\\|\/)/,function(G,R){var f=[G].concat(R),E=e.$r(f);z(G,"$absolute_path",function(c,s){var i=o,n=o,$=o,l=o,d=o,m=o,k=o,x=o,Y=o,a=o;s==null&&(s=o),i=E("SEPARATOR"),n=_(),$=[],c=r(c["$respond_to?"]("to_path"))?c.$to_path():c,c=I["$coerce_to!"](c,t("String"),"to_str"),s=r(l=s)?l:t("Dir").$pwd(),d=c.substr(0,i.length)===i||D.test(c),m=s.substr(0,i.length)===i||D.test(s),r(d)?(k=c.$split(h(["[",n,"]"])),x=D.test(c)?"":c.$sub(h(["^([",n,"]+).*$"]),"\\1"),Y=!0):(k=v(s.$split(h(["[",n,"]"])),c.$split(h(["[",n,"]"]))),x=D.test(s)?"":s.$sub(h(["^([",n,"]+).*$"]),"\\1"),Y=m);for(var N,p=0,H=k.length;p<H;p++)N=k[p],!(N===o||N===""&&($.length===0||Y)||N==="."&&($.length===0||Y))&&(N===".."?$.pop():$.push(N));return!Y&&k[0]!=="."&&$.$unshift("."),a=$.$join(i),r(Y)&&(a=v(x,a)),a},-2),z(G,"$expand_path",function(c,s){var i=this,n=o,$=o,l=o,d=o,m=o;return s==null&&(s=o),n=E("SEPARATOR"),$=_(),r(c[0]==="~"||s&&s[0]==="~")&&(l=E("Dir").$home(),r(l)||T.$raise(t("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),d=D.test(l)?"":l.$sub(h(["^([",$,"]+).*$"]),"\\1"),r(l["$start_with?"](d))||T.$raise(t("ArgumentError"),"non-absolute home"),l=v(l,n),m=h(["^\\~(?:",n,"|$)"]),c=c.$sub(m,l),r(s)&&(s=s.$sub(m,l))),i.$absolute_path(c,s)},-2);function g(u){return r(u["$respond_to?"]("to_path"))&&(u=u.$to_path()),u=I["$coerce_to!"](u,t("String"),"to_str"),u}function _(){return E("ALT_SEPARATOR")===o?e.escape_regexp(E("SEPARATOR")):e.escape_regexp(v(E("SEPARATOR"),E("ALT_SEPARATOR")))}return z(G,"$dirname",function(c,s){var i=this,n=o;if(s==null&&(s=1),U(s,0))return c;r(J(s,0))&&T.$raise(t("ArgumentError"),"level can't be negative"),n=_(),c=g(c);var $=c.match(new RegExp("^["+n+"]")),l;return c=c.replace(new RegExp("["+n+"]+$"),""),c=c.replace(new RegExp("[^"+n+"]+$"),""),c=c.replace(new RegExp("["+n+"]+$"),""),c===""?l=$?"/":".":l=c,s==1?l:i.$dirname(l,W(s,1))},-2),z(G,"$basename",function(c,s){var i=o;return s==null&&(s=o),i=_(),c=g(c),c.length==0||(s!==o?s=I["$coerce_to!"](s,t("String"),"to_str"):s=null,c=c.replace(new RegExp("(.)["+i+"]*$"),"$1"),c=c.replace(new RegExp("^(?:.*["+i+"])?([^"+i+"]+)$"),"$1"),s===".*"?c=c.replace(/\.[^\.]+$/,""):s!==null&&(s=e.escape_regexp(s),c=c.replace(new RegExp(""+s+"$"),""))),c},-2),z(G,"$extname",function(c){var s=this,i=o,n=o;return c=g(c),i=s.$basename(c),r(i["$empty?"]())||(n=i["$[]"](S(1,-1,!1)).$rindex("."),r(n["$nil?"]())||U(v(n,1),W(i.$length(),1)))?"":i["$[]"](e.Range.$new(v(n,1),-1,!1))},1),z(G,"$exist?",function(c){return e.modules[c]!=null},1),z(G,"$directory?",function(c){var s=o,i=o;s=[];for(var n in e.modules)s.push(n);return c=c.$gsub(h(["(^.",E("SEPARATOR"),"+|",E("SEPARATOR"),"+$)"])),i=F(s,"find",[],function(l){return l==null&&(l=o),l["$=~"](h(["^",c]))},1),i},1),z(G,"$join",function(c){var s,i,n=o;return s=e.slice.call(arguments),i=s,r(i["$empty?"]())?"":(n="",i=F(i.$flatten().$each_with_index(),"map",[],function(l,d){return l==null&&(l=o),d==null&&(d=o),U(d,0)&&r(l["$empty?"]())||U(i.$length(),v(d,1))&&r(l["$empty?"]())?E("SEPARATOR"):l},2),i=F(i,"reject",[],"empty?".$to_proc()),F(i,"each_with_index",[],function(l,d){var m=o;return l==null&&(l=o),d==null&&(d=o),m=i["$[]"](v(d,1)),r(m["$nil?"]())?n=""+n+l:(r(l["$end_with?"](E("SEPARATOR")))&&r(m["$start_with?"](E("SEPARATOR")))&&(l=l.$sub(h([E("SEPARATOR"),"+$"]),"")),n=r(l["$end_with?"](E("SEPARATOR")))||r(m["$start_with?"](E("SEPARATOR")))?""+n+l:""+n+l+E("SEPARATOR"))},2),n)},-1),z(G,"$split",function(c){return c.$split(E("SEPARATOR"))},1),B(G,"realpath","expand_path"),B(G,"exists?","exist?")}(e.get_singleton_class(b),M)}("::",t("IO"),A)};Opal.modules["corelib/process/base"]=function(e){var A=e.nil,o=e.klass,t=e.defs;return function(r,q){var C=o(r,q,"Signal");return t(C,"$trap",function(h){var v,z;return v=e.slice.call(arguments),z=v,A},-1)}("::",null),function(r,q){var C=o(r,q,"GC");return t(C,"$start",function(){return A},0)}("::",null)};Opal.modules["corelib/process"]=function(e){var A=e.nil,o=e.$$$,t=e.module,r=e.defs,q=e.truthy,C=e.Kernel;return function(I){var h=t(I,"Process"),v=A;if(h.__clocks__=[],r(h,"$__register_clock__",function(U,J){var W=this;return W.__clocks__==null&&(W.__clocks__=A),W.$const_set(U,W.__clocks__.$size()),W.__clocks__["$<<"](J)},2),h.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),v=!1,e.global.performance)v=function(){return performance.now()};else if(e.global.process&&process.hrtime){var z=process.hrtime();v=function(){var T=process.hrtime(z),U=T[1]/1e3|0;return T[0]*1e3+U/1e3}}return q(v)&&h.$__register_clock__("CLOCK_MONOTONIC",v),r(h,"$pid",function(){return 0},0),r(h,"$times",function(){var U=A;return U=o("Time").$now().$to_f(),o(o("Benchmark"),"Tms").$new(U,U,U,U,U)},0),r(h,"$clock_gettime",function(U,J){var W=this,S=A,F=A;W.__clocks__==null&&(W.__clocks__=A),J==null&&(J="float_second"),q(S=F=W.__clocks__["$[]"](U))||C.$raise(o(o("Errno"),"EINVAL"),"clock_gettime("+U+") "+W.__clocks__["$[]"](U));var B=F();switch(J){case"float_second":return B/1e3;case"float_millisecond":return B/1;case"float_microsecond":return B*1e3;case"second":return B/1e3|0;case"millisecond":return B/1|0;case"microsecond":return B*1e3|0;case"nanosecond":return B*1e6|0;default:C.$raise(o("ArgumentError"),"unexpected unit: "+J)}},-2)}("::")};Opal.modules["corelib/random/formatter"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.klass,q=e.module,C=e.def,I=e.send,h=e.to_a,v=e.rb_minus,z=e.range,T=e.rb_divide,U=e.Kernel,J=e.Opal;return function(W,S,F){var B=r(W,S,"Random"),X=[B].concat(F);return function(L,w){var b=q(L,"Formatter"),M=[b].concat(w),D=e.$r(M);return C(b,"$hex",function(R){var f=this;R==null&&(R=o),R=t("Random").$_verify_count(R);for(var E=f.$bytes(R),g="",_=0;_<R;_++)g+=E.charCodeAt(_).toString(16).padStart(2,"0");return g.$encode("US-ASCII")},-1),C(b,"$random_bytes",function(R){var f=this;return R==null&&(R=o),f.$bytes(R)},-1),C(b,"$base64",function(R){var f=this;return R==null&&(R=o),t("Base64").$strict_encode64(f.$random_bytes(R)).$encode("US-ASCII")},-1),C(b,"$urlsafe_base64",function(R,f){var E=this;return R==null&&(R=o),f==null&&(f=!1),t("Base64").$urlsafe_encode64(E.$random_bytes(R),f).$encode("US-ASCII")},-1),C(b,"$uuid",function(){var R=this,f=o,E=o;return f=R.$hex(16).$split(""),E=[12,"4"],I(f,"[]=",h(E)),E[v(E.length,1)],E=[16,(parseInt(f["$[]"](16),16)&3|8).toString(16)],I(f,"[]=",h(E)),E[v(E.length,1)],f=[f["$[]"](z(0,8,!0)),f["$[]"](z(8,12,!0)),f["$[]"](z(12,16,!0)),f["$[]"](z(16,20,!0)),f["$[]"](z(20,32,!0))],f=I(f,"map",[],"join".$to_proc()),f.$join("-")},0),C(b,"$random_float",function(){var R=this,f=o,E=o;return f=R.$bytes(4),E=0,I(4,"times",[],function(_){return _==null&&(_=o),E=E["$<<"](8),E=E["$|"](f["$[]"](_).$ord())},1),T(E.$abs(),2147483647)},0),C(b,"$random_number",function(R){var f=this;function E(){return f.$random_float()}function g(u){return Math.floor(E()*u)}function _(){var u=R.begin,c=R.end;if(u===o||c===o)return o;var s=c-u;return s<0?o:s===0?u:(c%1===0&&u%1===0&&!R.excl&&s++,g(s)+u)}return R==null?E():R.$$is_range?_():R.$$is_number?(R<=0&&U.$raise(t("ArgumentError"),"invalid argument - "+R),R%1===0?g(R):E()*R):(R=J["$coerce_to!"](R,t("Integer"),"to_int"),R<=0&&U.$raise(t("ArgumentError"),"invalid argument - "+R),g(R))},-1),C(b,"$alphanumeric",function(R){var f=this,E=o;return R==null&&(R=o),R=D("Random").$_verify_count(R),E=I([z("0","9",!1),z("a","z",!1),z("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),I(t("Array"),"new",[R],function g(_){var u=g.$$s==null?this:g.$$s;return _==null&&(_=o),E["$[]"](u.$random_number(E.$length()))},{$$arity:1,$$s:f}).$join()},-1)}(B,X),B.$include(t(t("Random"),"Formatter")),B.$extend(t(t("Random"),"Formatter"))}("::",null,A)};Opal.modules["corelib/random/mersenne_twister"]=function(e){var A=e.nil,o=e.$$$,t=e.klass,r=e.const_set,q=e.send,C=e.to_a,I=e.rb_minus,h=A;return h=function(){var v=624,z=397,T=2567483615,U=2147483648,J=2147483647,W=function(M,D){return M&U|D&J},S=function(M,D){return W(M,D)>>>1^(D&1?T:0)};function F(M){var D={left:0,next:v,state:new Array(v)};return B(D,M),D}function B(M,D){var G,R;for(M.state[0]=D>>>0,G=1;G<v;G++)M.state[G]=1812433253*(M.state[G-1]^M.state[G-1]>>30>>>0)+G,M.state[G]&=4294967295;M.left=1,M.next=v}function X(M){var D=0,G=M.state,R;for(M.left=v,M.next=0,R=v-z+1;--R;D++)G[D]=G[D+z]^S(G[D+0],G[D+1]);for(R=z;--R;D++)G[D]=G[D+(z-v)]^S(G[D+0],G[D+1]);G[D]=G[D+(z-v)]^S(G[D+0],G[0])}function L(M){var D;return--M.left<=0&&X(M),D=M.state[M.next++],D^=D>>>11,D^=D<<7&2636928640,D^=D<<15&4022730752,D^=D>>>18,D>>>0}function w(M,D){return M>>>=5,D>>>=6,(M*67108864+D)*(1/9007199254740992)}function b(M){var D=L(M),G=L(M);return w(D,G)}return{genrand_real:b,init:F}}(),function(v,z){var T=t(v,z,"Random"),U=A,J=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;return r(T,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*J)},reseed:function(W){return h.init(W)},rand:function(W){return h.genrand_real(W)}}),U=[o(T,"MERSENNE_TWISTER_GENERATOR")],q(T,"generator=",C(U)),U[I(U.length,1)]}("::",null)};Opal.modules["corelib/random"]=function(e){var A=e.top,o=e.nil,t=e.$$$,r=e.truthy,q=e.klass,C=e.Kernel,I=e.defs,h=e.Opal,v=e.def,z=e.eqeqeq,T=e.send;return A.$require("corelib/random/formatter"),function(U,J){var W=q(U,J,"Random");return W.$attr_reader("seed","state"),I(W,"$_verify_count",function(F){return r(F)||(F=16),typeof F!="number"&&(F=F.$to_int()),F<0&&C.$raise(t("ArgumentError"),"negative string size (or size too big)"),F=Math.floor(F),F},1),v(W,"$initialize",function(F){var B=this;return F==null&&(F=t("Random").$new_seed()),F=h["$coerce_to!"](F,t("Integer"),"to_int"),B.state=F,B.$reseed(F)},-1),v(W,"$reseed",function(F){var B=this;return B.seed=F,B.$rng=e.$$rand.reseed(F)},1),I(W,"$new_seed",function(){return e.$$rand.new_seed()},0),I(W,"$rand",function(F){var B=this;return t(B,"DEFAULT").$rand(F)},-1),I(W,"$srand",function(F){var B=this,X=o;return F==null&&(F=t("Random").$new_seed()),F=h["$coerce_to!"](F,t("Integer"),"to_int"),X=t(B,"DEFAULT").$seed(),t(B,"DEFAULT").$reseed(F),X},-1),I(W,"$urandom",function(F){return t("SecureRandom").$bytes(F)},1),v(W,"$==",function(F){var B=this,X=o;return z(t("Random"),F)?r(X=B.$seed()["$=="](F.$seed()))?B.$state()["$=="](F.$state()):X:!1},1),v(W,"$bytes",function(F){var B=this;return F=t("Random").$_verify_count(F),T(t("Array"),"new",[F],function X(){var L=X.$$s==null?this:X.$$s;return L.$rand(255).$chr()},{$$arity:0,$$s:B}).$join().$encode("ASCII-8BIT")},1),I(W,"$bytes",function(F){var B=this;return t(B,"DEFAULT").$bytes(F)},1),v(W,"$rand",function(F){var B=this;return B.$random_number(F)},-1),v(W,"$random_float",function(){var F=this;return F.state++,e.$$rand.rand(F.$rng)},0),I(W,"$random_float",function(){var F=this;return t(F,"DEFAULT").$random_float()},0),I(W,"$generator=",function(F){var B=this;return e.$$rand=F,r(B["$const_defined?"]("DEFAULT"))?t(B,"DEFAULT").$reseed():B.$const_set("DEFAULT",B.$new(B.$new_seed()))},1)}("::",null),A.$require("corelib/random/mersenne_twister")};Opal.modules["corelib/unsupported"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.Kernel,C=e.klass,I=e.send,h=e.module,v=e.def,z=e.alias,T=e.defs,U={};function J(S){switch(e.config.unsupported_features_severity){case"error":q.$raise(r("NotImplementedError"),S);break;case"warning":W(S);break;default:}}function W(S){U[S]||(U[S]=!0,A.$warn(S))}return function(S,F){var B=C(S,F,"String"),X="String#%s not supported. Mutable String methods are not supported in Opal.";return I(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function L(w){var b=L.$$s==null?this:L.$$s;return w==null&&(w=t),I(b,"define_method",[w],function(D){var G,R;return G=e.slice.call(arguments),R=G,q.$raise(r("NotImplementedError"),X["$%"](w))},-1)},{$$arity:1,$$s:B})}("::",null),function(S){var F=h(S,"Kernel"),B="Object freezing is not supported by Opal";return v(F,"$freeze",function(){var L=this;return J(B),L},0),v(F,"$frozen?",function(){return J(B),!1},0)}("::"),function(S){var F=h(S,"Kernel"),B="Object tainting is not supported by Opal";return v(F,"$taint",function(){var L=this;return J(B),L},0),v(F,"$untaint",function(){var L=this;return J(B),L},0),v(F,"$tainted?",function(){return J(B),!1},0)}("::"),function(S,F){var B=C(S,F,"Module");return v(B,"$public",function(L){var w,b,M=this;return w=e.slice.call(arguments),b=w,b.length===0?(M.$$module_function=!1,t):b.length===1?b[0]:b},-1),v(B,"$private_class_method",function(L){var w,b;return w=e.slice.call(arguments),b=w,b.length===1?b[0]:b},-1),v(B,"$private_method_defined?",function(L){return!1},1),v(B,"$private_constant",function(L){var w,b;return w=e.slice.call(arguments),b=w,t},-1),z(B,"nesting","public"),z(B,"private","public"),z(B,"protected","public"),z(B,"protected_method_defined?","private_method_defined?"),z(B,"public_class_method","private_class_method"),z(B,"public_instance_method","instance_method"),z(B,"public_instance_methods","instance_methods"),z(B,"public_method_defined?","method_defined?")}("::",null),function(S){var F=h(S,"Kernel");return v(F,"$private_methods",function(X){var L,w;return L=e.slice.call(arguments),w=L,[]},-1),z(F,"private_instance_methods","private_methods")}("::"),function(S,F){var B=h(S,"Kernel"),X=[B].concat(F),L=e.$r(X);return v(B,"$eval",function(b){var M,D;return M=e.slice.call(arguments),D=M,q.$raise(r("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. "+("See https://github.com/opal/opal/blob/"+L("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details."))},-1)}("::",o),T(A,"$public",function(F){var B,X;return B=e.slice.call(arguments),X=B,X.length===1?X[0]:X},-1),T(A,"$private",function(F){var B,X;return B=e.slice.call(arguments),X=B,X.length===1?X[0]:X},-1)};Opal.queue(function(e){var A=e.nil,o=e.Object;return o.$require("opal/base"),o.$require("opal/mini"),o.$require("corelib/kernel/format"),o.$require("corelib/string/encoding"),o.$autoload("Math","corelib/math"),o.$require("corelib/complex/base"),o.$autoload("Complex","corelib/complex"),o.$require("corelib/rational/base"),o.$autoload("Rational","corelib/rational"),o.$require("corelib/time"),o.$autoload("Struct","corelib/struct"),o.$require("corelib/dir"),o.$autoload("File","corelib/file"),o.$require("corelib/process/base"),o.$autoload("Process","corelib/process"),o.$autoload("Random","corelib/random"),o.$require("corelib/unsupported")});Opal.queue(function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.defs,h=e.truthy,v=e.send,z=e.Kernel,T=e.hash2,U=e.range,J=e.to_a,W=e.def,S=e.alias,F=e.klass,B=e.rb_minus,X=e.send2,L=e.find_super,w=e.eqeqeq,b=e.rb_ge,M=e.gvars;return function(D,G){var R=C(D,"Native"),f=[R].concat(G),E=e.$r(f);return I(R,"$is_a?",function(_,u){var c=this;try{return _ instanceof c.$try_convert(u)}catch(s){return!1}},2),I(R,"$try_convert",function(_,u){var c=this;return u==null&&(u=r),c["$native?"](_)?_:_["$respond_to?"]("to_n")?_.$to_n():u},-2),I(R,"$convert",function(_){var u=this;if(u["$native?"](_))return _;if(_["$respond_to?"]("to_n"))return _.$to_n();u.$raise(E("ArgumentError"),""+_.$inspect()+" isn't native")},1),I(R,"$call",function g(_,u,c){var s=g.$$p||r,i,n,$=this;delete g.$$p,i=e.slice.call(arguments,2),n=i;var l=_[u];if(l instanceof Function){for(var d=new Array(n.length),m=0,k=n.length;m<k;m++){var x=n[m],Y=$.$try_convert(x);d[m]=Y===r?x:Y}return s!==r&&d.push(s),$.$Native(l.apply(_,d))}else return $.$Native(l)},-3),I(R,"$proc",function g(){var _=g.$$p||r,u=this;return delete g.$$p,h(_)||u.$raise(E("LocalJumpError"),"no block given"),v(z,"proc",[],function c(s){var i,n,$=c.$$s==null?this:c.$$s,l=r;if(i=e.slice.call(arguments),n=i,v(n,"map!",[],function m(k){var x=m.$$s==null?this:m.$$s;return k==null&&(k=r),x.$Native(k)},{$$arity:1,$$s:$}),l=$.$Native(this),this===e.global)return _.apply($,n);var d=_.$$s;_.$$s=null;try{return _.apply(l,n)}finally{_.$$s=d}},{$$arity:-1,$$s:u})},0),function(g,_){var u=C(g,"Helpers"),c=[u].concat(_),s=e.$r(c);return W(u,"$alias_native",function i(n,$,l){var d,m,k,x,Y=i.$$p||r,a=this;if(delete i.$$p,d=e.slice.call(arguments,1),m=e.extract_kwargs(d),m==null)m=T([],{});else if(!m.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return d.length>0&&(k=d.shift()),k==null&&(k=n),x=m.$$smap.as,x==null&&(x=r),h(k["$end_with?"]("="))?v(a,"define_method",[n],function N(p){var H=N.$$s==null?this:N.$$s;return H.native==null&&(H.native=r),p==null&&(p=r),H.native[k["$[]"](U(0,-2,!1))]=s("Native").$convert(p),p},{$$arity:1,$$s:a}):h(x)?v(a,"define_method",[n],function N(p){var H=N.$$p||r,Q,ee,ne=N.$$s==null?this:N.$$s,V=r;return ne.native==null&&(ne.native=r),delete N.$$p,Q=e.slice.call(arguments),ee=Q,V=v(s("Native"),"call",[ne.native,k].concat(J(ee)),H.$to_proc()),h(V)?x.$new(V.$to_n()):r},{$$arity:-1,$$s:a}):v(a,"define_method",[n],function N(p){var H=N.$$p||r,Q,ee,ne=N.$$s==null?this:N.$$s;return ne.native==null&&(ne.native=r),delete N.$$p,Q=e.slice.call(arguments),ee=Q,v(s("Native"),"call",[ne.native,k].concat(J(ee)),H.$to_proc())},{$$arity:-1,$$s:a})},-2),W(u,"$native_reader",function(n){var $,l,d=this;return $=e.slice.call(arguments),l=$,v(l,"each",[],function m(k){var x=m.$$s==null?this:m.$$s;return k==null&&(k=r),v(x,"define_method",[k],function Y(){var a=Y.$$s==null?this:Y.$$s;return a.native==null&&(a.native=r),a.$Native(a.native[k])},{$$arity:0,$$s:x})},{$$arity:1,$$s:d})},-1),W(u,"$native_writer",function(n){var $,l,d=this;return $=e.slice.call(arguments),l=$,v(l,"each",[],function m(k){var x=m.$$s==null?this:m.$$s;return k==null&&(k=r),v(x,"define_method",[""+k+"="],function Y(a){var N=Y.$$s==null?this:Y.$$s;return N.native==null&&(N.native=r),a==null&&(a=r),N.$Native(N.native[k]=a)},{$$arity:1,$$s:x})},{$$arity:1,$$s:d})},-1),W(u,"$native_accessor",function(n){var $,l,d=this;return $=e.slice.call(arguments),l=$,v(d,"native_reader",J(l)),v(d,"native_writer",J(l))},-1)}(f[0],f),function(g,_){var u=C(g,"Wrapper"),c=[u].concat(_),s=e.$r(c);return W(u,"$initialize",function(n){var $=this;return h(z["$native?"](n))||z.$raise(s("ArgumentError"),""+n.$inspect()+" isn't native"),$.native=n},1),W(u,"$to_n",function(){var n=this;return n.native==null&&(n.native=r),n.native},0),I(u,"$included",function(n){return n.$extend(s("Helpers"))},1)}(f[0],f),I(R,"$included",function(_){var u=this;return u.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),_.$include(E("Wrapper"))},1)}(o[0],o),function(D,G){var R=C(D,"Kernel"),f=[R].concat(G),E=e.$r(f);return W(R,"$native?",function(_){return _==null||!_.$$class},1),W(R,"$Native",function g(_){var u=g.$$p||r,c=this;return delete g.$$p,h(_==null)?r:h(c["$native?"](_))?q(E("Native"),"Object").$new(_):h(_["$is_a?"](E("Array")))?v(_,"map",[],function s(i){var n=s.$$s==null?this:s.$$s;return i==null&&(i=r),n.$Native(i)},{$$arity:1,$$s:c}):h(_["$is_a?"](E("Proc")))?v(c,"proc",[],function s(i){var n=s.$$p||r,$,l,d=s.$$s==null?this:s.$$s;return delete s.$$p,$=e.slice.call(arguments),l=$,d.$Native(v(_,"call",J(l),n.$to_proc()))},{$$arity:-1,$$s:c}):_},1),S(R,"_Array","Array"),W(R,"$Array",function g(_,u){var c=g.$$p||r,s,i,n=this;return delete g.$$p,s=e.slice.call(arguments,1),i=s,h(n["$native?"](_))?v(q(E("Native"),"Array"),"new",[_].concat(J(i)),c.$to_proc()).$to_a():n.$_Array(_)},-2)}(o[0],o),function(D,G){var R=F(D,G,"Object"),f=R.$$prototype;return f.native=r,R.$include(q(q("Native"),"Wrapper")),W(R,"$==",function(g){var _=this;return _.native===q("Native").$try_convert(g)},1),W(R,"$has_key?",function(g){var _=this;return e.hasOwnProperty.call(_.native,g)},1),W(R,"$each",function E(g){var _,u,c=E.$$p||r,s=this;if(delete E.$$p,_=e.slice.call(arguments),u=_,c!==r){for(var i in s.native)e.yieldX(c,[i,s.native[i]]);return s}else return v(s,"method_missing",["each"].concat(J(u)))},-1),W(R,"$[]",function(g){var _=this,u=_.native[g];return u instanceof Function?u:q("Native").$call(_.native,g)},1),W(R,"$[]=",function(g,_){var u=this,c=r;return c=q("Native").$try_convert(_),h(c===r)?u.native[g]=_:u.native[g]=c},2),W(R,"$merge!",function(g){var _=this;g=q("Native").$convert(g);for(var u in g)_.native[u]=g[u];return _},1),W(R,"$respond_to?",function(g,_){var u=this;return _==null&&(_=!1),z.$instance_method("respond_to?").$bind(u).$call(g,_)},-2),W(R,"$respond_to_missing?",function(g,_){var u=this;return _==null&&(_=!1),e.hasOwnProperty.call(u.native,g)},-2),W(R,"$method_missing",function E(g,_){var u=E.$$p||r,c,s,i=this,n=r;return delete E.$$p,c=e.slice.call(arguments,1),s=c,g.charAt(g.length-1)==="="?(n=[g.$slice(0,B(g.$length(),1)),s["$[]"](0)],v(i,"[]=",J(n)),n[B(n.length,1)]):v(q("Native"),"call",[i.native,g].concat(J(s)),u.$to_proc())},-2),W(R,"$nil?",function(){return!1},0),W(R,"$is_a?",function(g){var _=this;return e.is_a(_,g)},1),W(R,"$instance_of?",function(g){var _=this;return _.$$class===g},1),W(R,"$class",function(){var g=this;return g.$$class},0),W(R,"$to_a",function E(g){var _=E.$$p||r,u=this;return delete E.$$p,g==null&&(g=T([],{})),v(q(q("Native"),"Array"),"new",[u.native,g],_.$to_proc()).$to_a()},-1),W(R,"$inspect",function(){var g=this;return"#<Native:"+String(g.native)+">"},0),S(R,"include?","has_key?"),S(R,"key?","has_key?"),S(R,"kind_of?","is_a?"),S(R,"member?","has_key?")}(t("Native"),t("BasicObject")),function(D,G,R){var f=F(D,G,"Array"),E=[f].concat(R),g=e.$r(E),_=f.$$prototype;return _.named=_.native=_.get=_.block=_.set=_.length=r,f.$include(q(g("Native"),"Wrapper")),f.$include(g("Enumerable")),W(f,"$initialize",function u(c,s){var i=u.$$p||r,n=this,$=r;return delete u.$$p,s==null&&(s=T([],{})),X(n,L(n,"initialize",u,!1,!0),"initialize",[c],null),n.get=h($=s["$[]"]("get"))?$:s["$[]"]("access"),n.named=s["$[]"]("named"),n.set=h($=s["$[]"]("set"))?$:s["$[]"]("access"),n.length=h($=s["$[]"]("length"))?$:"length",n.block=i,h(n.$length()==null)?n.$raise(g("ArgumentError"),"no length found on the array-like object"):r},-2),W(f,"$each",function u(){var c=u.$$p||r,s=this;if(delete u.$$p,!h(c))return s.$enum_for("each");for(var i=0,n=s.$length();i<n;i++)e.yield1(c,s["$[]"](i));return s},0),W(f,"$[]",function(c){var s=this,i=r,n=r;return i=w(g("String"),n=c)||w(g("Symbol"),n)?h(s.named)?s.native[s.named](c):s.native[c]:w(g("Integer"),n)?h(s.get)?s.native[s.get](c):s.native[c]:r,h(i)?h(s.block)?s.block.$call(i):s.$Native(i):r},1),W(f,"$[]=",function(c,s){var i=this;return h(i.set)?i.native[i.set](c,g("Native").$convert(s)):i.native[c]=g("Native").$convert(s)},2),W(f,"$last",function(c){var s,i=this,n=r,$=r;if(c==null&&(c=r),h(c)){for(n=B(i.$length(),1),$=[];h(b(n,0));)$["$<<"](i["$[]"](n)),n=B(n,1);return $}else return i["$[]"](B(i.$length(),1))},-1),W(f,"$length",function(){var c=this;return c.native[c.length]},0),W(f,"$inspect",function(){var c=this;return c.$to_a().$inspect()},0),S(f,"to_ary","to_a")}(t("Native"),null,o),function(D,G){var R=F(D,G,"Numeric");return W(R,"$to_n",function(){var E=this;return E.valueOf()},0)}(o[0],null),function(D,G){var R=F(D,G,"Proc");return W(R,"$to_n",function(){var E=this;return E},0)}(o[0],null),function(D,G){var R=F(D,G,"String");return W(R,"$to_n",function(){var E=this;return E.valueOf()},0)}(o[0],null),function(D,G){var R=F(D,G,"Regexp");return W(R,"$to_n",function(){var E=this;return E.valueOf()},0)}(o[0],null),function(D,G){var R=F(D,G,"MatchData"),f=R.$$prototype;return f.matches=r,W(R,"$to_n",function(){var g=this;return g.matches},0)}(o[0],null),function(D,G,R){var f=F(D,G,"Struct"),E=[f].concat(R),g=e.$r(E);return W(f,"$to_n",function(){var u=this,c=r;return c={},v(u,"each_pair",[],function(i,n){return i==null&&(i=r),n==null&&(n=r),c[i]=g("Native").$try_convert(n,n)},2),c},0)}(o[0],null,o),function(D,G,R){var f=F(D,G,"Array"),E=[f].concat(R),g=e.$r(E);return W(f,"$to_n",function(){for(var u=this,c=[],s=0,i=u.length;s<i;s++){var n=u[s];c.push(g("Native").$try_convert(n,n))}return c},0)}(o[0],null,o),function(D,G){var R=F(D,G,"Boolean");return W(R,"$to_n",function(){var E=this;return E.valueOf()},0)}(o[0],null),function(D,G){var R=F(D,G,"Time");return W(R,"$to_n",function(){var E=this;return E},0)}(o[0],null),function(D,G){var R=F(D,G,"NilClass");return W(R,"$to_n",function(){return null},0)}(o[0],null),h(t("Hash")["$method_defined?"]("_initialize"))||function(D,G,R){var f=F(D,G,"Hash"),E=[f].concat(R),g=e.$r(E);return S(f,"_initialize","initialize"),W(f,"$initialize",function _(u){var c=_.$$p||r,s=this;if(delete _.$$p,u!=null&&(u.constructor===void 0||u.constructor===Object)){var i=s.$$smap,n=s.$$keys,$,l;for($ in u)l=u[$],l&&(l.constructor===void 0||l.constructor===Object)?i[$]=g("Hash").$new(l):l&&l.$$is_array?(l=l.map(function(d){return d&&(d.constructor===void 0||d.constructor===Object)?g("Hash").$new(d):s.$Native(d)}),i[$]=l):i[$]=s.$Native(l),n.push($);return s}return v(s,"_initialize",[u],c.$to_proc())},-1),W(f,"$to_n",function(){for(var u=this,c={},s=u.$$keys,i=u.$$smap,n,$,l=0,d=s.length;l<d;l++)n=s[l],n.$$is_string?$=i[n]:(n=n.key,$=n.value),c[n]=g("Native").$try_convert($,$);return c},0)}(o[0],null,o),function(D,G){var R=F(D,G,"Module");return W(R,"$native_module",function(){var E=this;return e.global[E.$name()]=E},0)}(o[0],null),function(D,G,R){var f=F(D,G,"Class"),E=[f].concat(R),g=e.$r(E);return W(f,"$native_alias",function(u,c){var s=this,i=s.prototype["$"+c];i||s.$raise(g("NameError").$new("undefined method `"+c+"' for class `"+s.$inspect()+"'",c)),s.prototype[u]=i},2),W(f,"$native_class",function(){var u=this;return u.$native_module(),u.new=u.$new},0)}(o[0],null,o),M.$=M.global=A.$Native(e.global)});Opal.modules.strscan=function(e){var A=[],o=e.nil,t=e.klass,r=e.def,q=e.truthy,C=e.eqeqeq,I=e.Opal,h=e.send,v=e.to_a,z=e.rb_minus,T=e.alias;return function(U,J,W){var S=t(U,J,"StringScanner"),F=[S].concat(W),B=e.$r(F),X=S.$$prototype;return X.pos=X.string=X.working=X.matched=X.prev_pos=X.match=o,S.$attr_reader("pos","matched"),r(S,"$initialize",function(w){var b=this;return b.string=w,b.pos=0,b.matched=o,b.working=w,b.match=[]},1),S.$attr_reader("string"),r(S,"$beginning_of_line?",function(){var w=this;return w.pos===0||w.string.charAt(w.pos-1)===`
`},0),r(S,"$scan",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:typeof M=="object"?(b.prev_pos=b.pos,b.pos+=M[0].length,b.working=b.working.substring(M[0].length),b.matched=M[0],b.match=M,M[0]):typeof M=="string"?(b.pos+=M.length,b.working=b.working.substring(M.length),M):o},1),r(S,"$scan_until",function(w){var b=this;w=b.$anchor(w);for(var M=b.pos,D=b.working,G;;){if(G=w.exec(D),M+=1,D=D.substr(1),G==null){if(D.length===0)return b.match=[],b.matched=o;continue}return b.matched=b.string.substr(b.pos,M-b.pos-1+G[0].length),b.match=G,b.prev_pos=M-1,b.pos=M,b.working=D.substr(G[0].length),b.matched}},1),r(S,"$[]",function(w){var b=this,M=o;if(q(b.match["$empty?"]()))return o;C(B("Symbol"),M=w)?w=w.$to_s():C(B("String"),M)||(w=I["$coerce_to!"](w,B("Integer"),"to_int"));var D=b.match;return w<0&&(w+=D.length),w<0||w>=D.length||D[w]==null?o:D[w]},1),r(S,"$check",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:b.matched=M[0]},1),r(S,"$check_until",function(w){var b=this,M=b.prev_pos,D=b.pos,G=b.$scan_until(w);return G!==o&&(b.matched=G.substr(-1),b.working=b.string.substr(D)),b.prev_pos=M,b.pos=D,G},1),r(S,"$peek",function(w){var b=this;return b.working.substring(0,w)},1),r(S,"$eos?",function(){var w=this;return w.working.length===0},0),r(S,"$exist?",function(w){var b=this,M=w.exec(b.working);return M==null?o:M.index==0?0:M.index+1},1),r(S,"$skip",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);if(M==null)return b.match=[],b.matched=o;var D=M[0],G=D.length;return b.matched=D,b.match=M,b.prev_pos=b.pos,b.pos+=G,b.working=b.working.substring(G),G},1),r(S,"$skip_until",function(w){var b=this,M=b.$scan_until(w);return M===o?o:(b.matched=M.substr(-1),M.length)},1),r(S,"$get_byte",function(){var w=this,b=o;return w.pos<w.string.length?(w.prev_pos=w.pos,w.pos+=1,b=w.matched=w.working.substring(0,1),w.working=w.working.substring(1)):w.matched=o,b},0),r(S,"$match?",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?o:(b.prev_pos=b.pos,M[0].length)},1),r(S,"$pos=",function(w){var b=this;return w<0&&(w+=b.string.$length()),b.pos=w,b.working=b.string.slice(w)},1),r(S,"$matched_size",function(){var w=this;return w.matched===o?o:w.matched.length},0),r(S,"$post_match",function(){var w=this;return w.matched===o?o:w.string.substr(w.pos)},0),r(S,"$pre_match",function(){var w=this;return w.matched===o?o:w.string.substr(0,w.prev_pos)},0),r(S,"$reset",function(){var w=this;return w.working=w.string,w.matched=o,w.pos=0},0),r(S,"$rest",function(){var w=this;return w.working},0),r(S,"$rest?",function(){var w=this;return w.working.length!==0},0),r(S,"$rest_size",function(){var w=this;return w.$rest().$size()},0),r(S,"$terminate",function(){var w=this,b=o;return w.match=o,b=[w.string.$length()],h(w,"pos=",v(b)),b[z(b.length,1)]},0),r(S,"$unscan",function(){var w=this;return w.pos=w.prev_pos,w.prev_pos=o,w.match=o,w},0),T(S,"bol?","beginning_of_line?"),T(S,"getch","get_byte"),S.$private(),r(S,"$anchor",function(w){var b=w.toString().match(/\/([^\/]+)$/);return b=b?b[1]:void 0,new RegExp("^(?:"+w.source+")",b)},1)}(A[0],null,A)};Opal.queue(function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.klass,C=e.def,I=e.module;return A.$require("strscan"),function(h,v,z){var T=q(h,v,"Dir"),U=[T].concat(z);return function(J,W){return C(J,"$[]",function(){return[]},0)}(e.get_singleton_class(T),U)}(o[0],null,o),function(h){var v=I(h,"ObjectFreezeStub");return C(v,"$freeze",function(){var T=this;return T},0)}(o[0]),t("Object").$prepend(t("ObjectFreezeStub")),function(h){var v=I(h,"StringScannerPatch");return C(v,"$scan_until",function(T){var U=this,U=this;T=U.$anchor(T);for(var J=U.pos,W=U.working,S;;){var F=W.length===0;if(S=T.exec(W),J+=1,W=W.substr(1),S==null){if(F)return U.matched=r;continue}return U.matched=U.string.substr(U.pos,J-U.pos-1+S[0].length),U.prev_pos=J-1,U.pos=J,U.working=W.substr(S[0].length-1),U.matched}},1)}(o[0]),t("StringScanner").$prepend(t("StringScannerPatch")),e.top.$__dir__=()=>"/",r})});var Ye=de(()=>{ke();Opal.queue(function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.hash2,C=e.truthy,I=e.def;return function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"ArithmeticEvaluator"),S=[W].concat(J);return function(F,B){var X=[F].concat(B),L=e.$r(X);return I(F,"$eval",function(b,M){var D,G=o;if(M==null)M=q([],{});else if(!M.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return D=M.$$smap.round_type,D==null&&(D=t(L("RoundType"),"FLOOR")),C(b)&&C(G=L("Arithmetic").$eval(b,D))?G:0},-2)}(e.get_singleton_class(W),S)}(T[0],T)}(A[0],A)})});var Xe=de(()=>{ke();Opal.modules["bcdice/normalize"]=function(e){var A=[],o=e.nil,t=e.module,r=e.eqeqeq,q=e.def,C=e.eqeq;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T){var U=t(T,"Normalize");return U.$module_function(),q(U,"$comparison_operator",function(W){var S=o;return r(/<=|=</,S=W)?"<=":r(/>=|=>/,S)?">=":r(/<>|!=|=!/,S)?"!=":r(/</,S)?"<":r(/>/,S)?">":r(/=/,S)?"==":o},1),q(U,"$target_number",function(W){return C(W,"?")?W:W.$to_i()},1)}(z[0])}(A[0],A)};Opal.modules["racc/parser"]=function(e){var A,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.const_set,z=e.defs,T=e.gvars,U=e.rb_lt,J=e.send,W=e.to_a,S=e.rb_minus,F=e.def,B=e.to_ary,X=e.neqeq,L=e.rb_plus,w=e.eqeq,b=e.rb_ge,M=e.rb_gt,D=e.eqeqeq,G=e.rb_le,R=e.rb_times;return function(f,E){var g=C(f,"Racc"),_=[g].concat(E),u=e.$r(_);return I(_[0],u("StandardError"),"ParseError"),r}(o[0],o),h((A=q("::","ParseError","skip_raise"))?"constant":r)||v(o[0],"ParseError",q(t("Racc"),"ParseError")),function(f,E){var g=C(f,"Racc"),_,u=[g].concat(E),c=e.$r(u);return h((_=c("Racc_No_Extensions","skip_raise"))?"constant":r)||v(u[0],"Racc_No_Extensions",!1),function(s,i,n){var $=I(s,i,"Parser"),l=[$].concat(n),d=e.$r(l),m=$.$$prototype;return m.yydebug=m.racc_debug_out=m.racc_error_status=m.racc_t=m.racc_vstack=m.racc_val=m.racc_state=m.racc_tstack=r,v(l[0],"Racc_Runtime_Version","1.4.6"),v(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),v(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),v(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),v(l[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),v(l[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),v(l[0],"Racc_Runtime_Type","ruby"),z(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")},0),F($,"$_racc_setup",function(){var x,Y,a=this,N=r,p=r,H=r;return T.stderr==null&&(T.stderr=r),h(q(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),h((x=a.yydebug,x!=null&&x!==r?"instance-variable":r))||(a.yydebug=!1),h(a.yydebug)&&(h((Y=a.racc_debug_out,Y!=null&&Y!==r?"instance-variable":r))||(a.racc_debug_out=T.stderr),a.racc_debug_out=h(N=a.racc_debug_out)?N:T.stderr),p=q(a.$class(),"Racc_arg"),h(U(p.$size(),14))&&(H=[13,!0],J(p,"[]=",W(H)),H[S(H.length,1)]),p},0),F($,"$_racc_init_sysvars",function(){var x=this;return x.racc_state=[0],x.racc_tstack=[],x.racc_vstack=[],x.racc_t=r,x.racc_val=r,x.racc_read_next=!0,x.racc_user_yyerror=!1,x.racc_error_status=0},0),F($,"$do_parse",function(){var x=this;return x.$__send__(d("Racc_Main_Parsing_Routine"),x.$_racc_setup(),!1)},0),F($,"$next_token",function(){var x=this;return x.$raise(d("NotImplementedError"),""+x.$class()+"#next_token is not defined")},0),F($,"$_racc_do_parse_rb",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;return N=x,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],V=a[4]==null?r:a[4],V=a[5]==null?r:a[5],V=a[6]==null?r:a[6],V=a[7]==null?r:a[7],V=a[8]==null?r:a[8],V=a[9]==null?r:a[9],Z=a[10]==null?r:a[10],V=a[11]==null?r:a[11],V=a[12]==null?r:a[12],V=a[13]==null?r:a[13],p.$_racc_init_sysvars(),y=K=P=r,J(p,"catch",["racc_end_parse"],function j(){var O,re,te,ie=j.$$s==null?this:j.$$s,$e=r;for(ie.racc_state==null&&(ie.racc_state=r),ie.racc_read_next==null&&(ie.racc_read_next=r),ie.racc_t==null&&(ie.racc_t=r),ie.yydebug==null&&(ie.yydebug=r),ie.racc_val==null&&(ie.racc_val=r);h(!0);)for(h(P=ne["$[]"](ie.racc_state["$[]"](-1)))?(h(ie.racc_read_next)&&X(ie.racc_t,0)&&(te=ie.$next_token(),re=B(te),y=re[0]==null?r:re[0],ie.racc_val=re[1]==null?r:re[1],h(y)?ie.racc_t=h($e=Z["$[]"](y))?$e:1:ie.racc_t=0,h(ie.yydebug)&&ie.$racc_read_token(ie.racc_t,y,ie.racc_val),ie.racc_read_next=!1),P=L(P,ie.racc_t),h(b(P,0))&&h(K=H["$[]"](P))&&w(Q["$[]"](P),ie.racc_state["$[]"](-1))||(K=ee["$[]"](ie.racc_state["$[]"](-1)))):K=ee["$[]"](ie.racc_state["$[]"](-1));h(K=ie.$_racc_evalact(K,x)););},{$$arity:0,$$s:p})},2),F($,"$yyparse",function(x,Y){var a=this;return a.$__send__(d("Racc_YY_Parse_Method"),x,Y,a.$_racc_setup(),!0)},2),F($,"$_racc_yyparse_rb",function(x,Y,a,N){var p,H,Q=this,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r;return H=a,p=B(H),ee=p[0]==null?r:p[0],ne=p[1]==null?r:p[1],V=p[2]==null?r:p[2],Z=p[3]==null?r:p[3],y=p[4]==null?r:p[4],y=p[5]==null?r:p[5],y=p[6]==null?r:p[6],y=p[7]==null?r:p[7],y=p[8]==null?r:p[8],y=p[9]==null?r:p[9],K=p[10]==null?r:p[10],y=p[11]==null?r:p[11],y=p[12]==null?r:p[12],y=p[13]==null?r:p[13],Q.$_racc_init_sysvars(),P=r,j=r,J(Q,"catch",["racc_end_parse"],function O(){var re,te,ie=O.$$s==null?this:O.$$s;for(ie.racc_state==null&&(ie.racc_state=r);!h(j=Z["$[]"](ie.racc_state["$[]"](-1)));)for(;h(P=ie.$_racc_evalact(V["$[]"](ie.racc_state["$[]"](-1)),a)););return J(x,"__send__",[Y],function $e(se,oe){var le,ce,ue=$e.$$s==null?this:$e.$$s,ae=r,_e=r;for(ue.racc_t==null&&(ue.racc_t=r),ue.racc_state==null&&(ue.racc_state=r),ue.racc_read_next==null&&(ue.racc_read_next=r),se==null&&(se=r),oe==null&&(oe=r),h(se)?ue.racc_t=h(ae=K["$[]"](se))?ae:1:ue.racc_t=0,ue.racc_val=oe,ue.racc_read_next=!1,j=L(j,ue.racc_t),h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););for(;h(h(ae=h(_e=(j=Z["$[]"](ue.racc_state["$[]"](-1)))["$!"]())?_e:ue.racc_read_next["$!"]())?ae:ue.racc_t["$=="](0));)for(h(j)&&h(j=L(j,ue.racc_t))&&h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););},{$$arity:2,$$s:ie})},{$$arity:0,$$s:Q})},4),F($,"$_racc_evalact",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;if(N=Y,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],ee=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ee=a[6]==null?r:a[6],ee=a[7]==null?r:a[7],ee=a[8]==null?r:a[8],ee=a[9]==null?r:a[9],ee=a[10]==null?r:a[10],V=a[11]==null?r:a[11],Z=a[12]==null?r:a[12],ee=a[13]==null?r:a[13],ee=a[14]==null?r:a[14],h(M(x,0))&&h(U(x,V)))h(M(p.racc_error_status,0))&&(w(p.racc_t,1)||(p.racc_error_status=S(p.racc_error_status,1))),p.racc_vstack.$push(p.racc_val),p.racc_state.$push(x),p.racc_read_next=!0,h(p.yydebug)&&(p.racc_tstack.$push(p.racc_t),p.$racc_shift(p.racc_t,p.racc_tstack,p.racc_vstack));else if(h(U(x,0))&&h(M(x,Z["$-@"]()))){if(y=J(p,"catch",["racc_jump"],function j(){var O=j.$$s==null?this:j.$$s;return O.racc_state==null&&(O.racc_state=r),O.racc_state.$push(O.$_racc_do_reduce(Y,x)),!1},{$$arity:0,$$s:p}),h(y)){if(D(1,K=y))return p.racc_user_yyerror=!0,Z["$-@"]();if(D(2,K))return V;p.$raise("[Racc Bug] unknown jump code")}}else if(w(x,V))h(p.yydebug)&&p.$racc_accept(),p.$throw("racc_end_parse",p.racc_vstack["$[]"](0));else if(w(x,Z["$-@"]())){for(D(0,K=p.racc_error_status)?h(Y["$[]"](21))||p.$on_error(p.racc_t,p.racc_val,p.racc_vstack):D(3,K)&&(w(p.racc_t,0)&&p.$throw("racc_end_parse",r),p.racc_read_next=!0),p.racc_user_yyerror=!1,p.racc_error_status=3;h(!0)&&!(h(P=ne["$[]"](p.racc_state["$[]"](-1)))&&(P=L(P,1),h(b(P,0))&&h(x=H["$[]"](P))&&w(Q["$[]"](P),p.racc_state["$[]"](-1))));)h(G(p.racc_state.$size(),1))&&p.$throw("racc_end_parse",r),p.racc_state.$pop(),p.racc_vstack.$pop(),h(p.yydebug)&&(p.racc_tstack.$pop(),p.$racc_e_pop(p.racc_state,p.racc_tstack,p.racc_vstack));return x}else p.$raise("[Racc Bug] unknown action "+x.$inspect());return h(p.yydebug)&&p.$racc_next_state(p.racc_state["$[]"](-1),p.racc_state),r},2),F($,"$_racc_do_reduce",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r,O=r,re=r,te=r,ie=r,$e=r,se=r,oe=r,le=r,ce=r,ue=r,ae=r;return N=x,a=B(N),H=a[0]==null?r:a[0],H=a[1]==null?r:a[1],H=a[2]==null?r:a[2],H=a[3]==null?r:a[3],Q=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ne=a[6]==null?r:a[6],V=a[7]==null?r:a[7],Z=a[8]==null?r:a[8],y=a[9]==null?r:a[9],H=a[10]==null?r:a[10],H=a[11]==null?r:a[11],H=a[12]==null?r:a[12],K=a[13]==null?r:a[13],P=p.racc_state,j=p.racc_vstack,O=p.racc_tstack,re=R(Y,-3),te=y["$[]"](re),ie=y["$[]"](L(re,1)),$e=y["$[]"](L(re,2)),se=[],h(p.yydebug)&&(oe=O["$[]"](te["$-@"](),te)),le=j["$[]"](te["$-@"](),te),h(p.yydebug)&&(ce=[te["$-@"](),te,se],J(O,"[]=",W(ce)),ce[S(ce.length,1)]),ce=[te["$-@"](),te,se],J(j,"[]=",W(ce)),ce[S(ce.length,1)],ce=[te["$-@"](),te,se],J(P,"[]=",W(ce)),ce[S(ce.length,1)],h(K)?j.$push(p.$__send__($e,le,j,le["$[]"](0))):j.$push(p.$__send__($e,le,j)),O.$push(ie),h(p.yydebug)&&p.$racc_reduce(oe,ie,O,j),ue=S(ie,Z),h(re=V["$[]"](ue))&&(re=L(re,P["$[]"](-1)),h(b(re,0))&&h(ae=Q["$[]"](re))&&w(ee["$[]"](re),ue))?ae:ne["$[]"](ue)},2),F($,"$on_error",function(x,Y,a){var N=this,p=r;return N.$raise(d("ParseError"),N.$sprintf(`
parse error on value %s (%s)`,Y.$inspect(),h(p=N.$token_to_str(x))?p:"?"))},3),F($,"$yyerror",function(){var x=this;return x.$throw("racc_jump",1)},0),F($,"$yyaccept",function(){var x=this;return x.$throw("racc_jump",2)},0),F($,"$yyerrok",function(){var x=this;return x.racc_error_status=0},0),F($,"$racc_read_token",function(x,Y,a){var N=this;return N.racc_debug_out.$print("read    "),N.racc_debug_out.$print(Y.$inspect(),"(",N.$racc_token2str(x),") "),N.racc_debug_out.$puts(a.$inspect()),N.racc_debug_out.$puts()},3),F($,"$racc_shift",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("shift   "+N.$racc_token2str(x)),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_reduce",function(x,Y,a,N){var p=this,H=r;return H=p.racc_debug_out,H.$print("reduce "),h(x["$empty?"]())?H.$print(" <none>"):J(x,"each",[],function Q(ee){var ne=Q.$$s==null?this:Q.$$s;return ee==null&&(ee=r),H.$print(" ",ne.$racc_token2str(ee))},{$$arity:1,$$s:p}),H.$puts(" --> "+p.$racc_token2str(Y)),p.$racc_print_stacks(a,N),p.racc_debug_out.$puts()},4),F($,"$racc_accept",function(){var x=this;return x.racc_debug_out.$puts("accept"),x.racc_debug_out.$puts()},0),F($,"$racc_e_pop",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("error recovering mode: pop token"),N.$racc_print_states(x),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_next_state",function(x,Y){var a=this;return a.racc_debug_out.$puts("goto    "+x),a.$racc_print_states(Y),a.racc_debug_out.$puts()},2),F($,"$racc_print_stacks",function(x,Y){var a=this,N=r;return N=a.racc_debug_out,N.$print("        ["),J(x,"each_index",[],function p(H){var Q=p.$$s==null?this:p.$$s;return H==null&&(H=r),N.$print(" (",Q.$racc_token2str(x["$[]"](H))," ",Y["$[]"](H).$inspect(),")")},{$$arity:1,$$s:a}),N.$puts(" ]")},2),F($,"$racc_print_states",function(x){var Y=this,a=r;return a=Y.racc_debug_out,a.$print("        ["),J(x,"each",[],function(p){return p==null&&(p=r),a.$print(" ",p)},1),a.$puts(" ]")},1),F($,"$racc_token2str",function(x){var Y=this,a=r;return h(a=q(Y.$class(),"Racc_token_to_s_table")["$[]"](x))?a:Y.$raise("[Racc Bug] can't convert token "+x+" to string")},1),F($,"$token_to_str",function(x){var Y=this;return q(Y.$class(),"Racc_token_to_s_table")["$[]"](x)},1)}(u[0],null,u)}(o[0],o)};Opal.modules.strscan=function(e){var A=[],o=e.nil,t=e.klass,r=e.def,q=e.truthy,C=e.eqeqeq,I=e.Opal,h=e.send,v=e.to_a,z=e.rb_minus,T=e.alias;return function(U,J,W){var S=t(U,J,"StringScanner"),F=[S].concat(W),B=e.$r(F),X=S.$$prototype;return X.pos=X.string=X.working=X.matched=X.prev_pos=X.match=o,S.$attr_reader("pos","matched"),r(S,"$initialize",function(w){var b=this;return b.string=w,b.pos=0,b.matched=o,b.working=w,b.match=[]},1),S.$attr_reader("string"),r(S,"$beginning_of_line?",function(){var w=this;return w.pos===0||w.string.charAt(w.pos-1)===`
`},0),r(S,"$scan",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:typeof M=="object"?(b.prev_pos=b.pos,b.pos+=M[0].length,b.working=b.working.substring(M[0].length),b.matched=M[0],b.match=M,M[0]):typeof M=="string"?(b.pos+=M.length,b.working=b.working.substring(M.length),M):o},1),r(S,"$scan_until",function(w){var b=this;w=b.$anchor(w);for(var M=b.pos,D=b.working,G;;){if(G=w.exec(D),M+=1,D=D.substr(1),G==null){if(D.length===0)return b.match=[],b.matched=o;continue}return b.matched=b.string.substr(b.pos,M-b.pos-1+G[0].length),b.match=G,b.prev_pos=M-1,b.pos=M,b.working=D.substr(G[0].length),b.matched}},1),r(S,"$[]",function(w){var b=this,M=o;if(q(b.match["$empty?"]()))return o;C(B("Symbol"),M=w)?w=w.$to_s():C(B("String"),M)||(w=I["$coerce_to!"](w,B("Integer"),"to_int"));var D=b.match;return w<0&&(w+=D.length),w<0||w>=D.length||D[w]==null?o:D[w]},1),r(S,"$check",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:b.matched=M[0]},1),r(S,"$check_until",function(w){var b=this,M=b.prev_pos,D=b.pos,G=b.$scan_until(w);return G!==o&&(b.matched=G.substr(-1),b.working=b.string.substr(D)),b.prev_pos=M,b.pos=D,G},1),r(S,"$peek",function(w){var b=this;return b.working.substring(0,w)},1),r(S,"$eos?",function(){var w=this;return w.working.length===0},0),r(S,"$exist?",function(w){var b=this,M=w.exec(b.working);return M==null?o:M.index==0?0:M.index+1},1),r(S,"$skip",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);if(M==null)return b.match=[],b.matched=o;var D=M[0],G=D.length;return b.matched=D,b.match=M,b.prev_pos=b.pos,b.pos+=G,b.working=b.working.substring(G),G},1),r(S,"$skip_until",function(w){var b=this,M=b.$scan_until(w);return M===o?o:(b.matched=M.substr(-1),M.length)},1),r(S,"$get_byte",function(){var w=this,b=o;return w.pos<w.string.length?(w.prev_pos=w.pos,w.pos+=1,b=w.matched=w.working.substring(0,1),w.working=w.working.substring(1)):w.matched=o,b},0),r(S,"$match?",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?o:(b.prev_pos=b.pos,M[0].length)},1),r(S,"$pos=",function(w){var b=this;return w<0&&(w+=b.string.$length()),b.pos=w,b.working=b.string.slice(w)},1),r(S,"$matched_size",function(){var w=this;return w.matched===o?o:w.matched.length},0),r(S,"$post_match",function(){var w=this;return w.matched===o?o:w.string.substr(w.pos)},0),r(S,"$pre_match",function(){var w=this;return w.matched===o?o:w.string.substr(0,w.prev_pos)},0),r(S,"$reset",function(){var w=this;return w.working=w.string,w.matched=o,w.pos=0},0),r(S,"$rest",function(){var w=this;return w.working},0),r(S,"$rest?",function(){var w=this;return w.working.length!==0},0),r(S,"$rest_size",function(){var w=this;return w.$rest().$size()},0),r(S,"$terminate",function(){var w=this,b=o;return w.match=o,b=[w.string.$length()],h(w,"pos=",v(b)),b[z(b.length,1)]},0),r(S,"$unscan",function(){var w=this;return w.pos=w.prev_pos,w.prev_pos=o,w.match=o,w},0),T(S,"bol?","beginning_of_line?"),T(S,"getch","get_byte"),S.$private(),r(S,"$anchor",function(w){var b=w.toString().match(/\/([^\/]+)$/);return b=b?b[1]:void 0,new RegExp("^(?:"+w.source+")",b)},1)}(A[0],null,A)};Opal.modules["bcdice/common_command/lexer"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.truthy,v=e.def;return A.$require("strscan"),A.$require("bcdice/normalize"),function(z,T){var U=r(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=r(W,"CommonCommand"),B=[F].concat(S);return function(X,L,w){var b=q(X,L,"Lexer"),M=[b].concat(w),D=e.$r(M),G=b.$$prototype;return G.scanner=t,C(M[0],"SYMBOLS",I(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),v(b,"$initialize",function(f){var E=this,g=t;return f=h(g=f.$split(" ",2).$first())?g:"",E.scanner=D("StringScanner").$new(f)},1),v(b,"$next_token",function(){var f=this,E=t,g=t,_=t,u=t,c=t;return h(f.scanner["$eos?"]())?[!1,"$"]:h(E=f.scanner.$scan(/\d+/))?["NUMBER",E.$to_i()]:h(g=f.scanner.$scan(/[<>!=]+/))?["CMP_OP",D("Normalize").$comparison_operator(g)]:(_=f.scanner.$getch().$upcase(),u=h(c=D("SYMBOLS")["$[]"](_))?c:_.$to_sym(),[u,_])},0),v(b,"$source",function(){var f=this;return f.scanner.$string()},0)}(B[0],null,B)}(J[0],J)}(o[0],o)};Opal.modules.singleton=function(e){var A=[],o=e.nil,t=e.module,r=e.def,q=e.send2,C=e.find_super,I=e.send,h=e.truthy,v=e.defs;return function(z,T){var U=t(z,"Singleton"),J=[U].concat(T),W=e.$r(J);return r(U,"$clone",function(){var F=this;return F.$raise(W("TypeError"),"can't clone instance of singleton "+F.$class())},0),r(U,"$dup",function(){var F=this;return F.$raise(W("TypeError"),"can't dup instance of singleton "+F.$class())},0),function(S,F){var B=t(S,"SingletonClassMethods"),X=[B].concat(F),L=e.$r(X);return r(B,"$clone",function w(){var b=w.$$p||o,M=this;return delete w.$$p,L("Singleton").$__init__(q(M,C(M,"clone",w,!1,!0),"clone",[],b))},0),r(B,"$inherited",function w(b){var M=w.$$p||o,D=this;return delete w.$$p,q(D,C(D,"inherited",w,!1,!0),"inherited",[b],M),L("Singleton").$__init__(b)},1)}(J[0],J),function(S,F){var B=[S].concat(F),X=e.$r(B);return r(S,"$__init__",function(w){var b=this;return I(w,"instance_eval",[],function M(){var D=M.$$s==null?this:M.$$s;return D.singleton__instance__=o},{$$arity:0,$$s:b}),v(w,"$instance",function(){var D=this;return D.singleton__instance__==null&&(D.singleton__instance__=o),h(D.singleton__instance__)?D.singleton__instance__:D.singleton__instance__=D.$new()},0),w},1),r(S,"$included",function L(w){var b=L.$$p||o,M=this;return delete L.$$p,q(M,C(M,"included",L,!1,!0),"included",[w],b),w.$extend(X("SingletonClassMethods")),X("Singleton").$__init__(w)},1)}(e.get_singleton_class(W("Singleton")),J)}(A[0],A)};Opal.modules["bcdice/common_command/add_dice/node"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.def,h=e.rb_plus,v=e.send,z=e.truthy,T=e.rb_le,U=e.to_a,J=e.rb_minus,W=e.eqeqeq,S=e.alias,F=e.send2,B=e.find_super,X=e.const_set,L=e.rb_divide,w=e.not,b=e.neqeq;return A.$require("singleton"),function(M,D){var G=q(M,"BCDice"),R=[G].concat(D);return function(f,E){var g=q(f,"CommonCommand"),_=[g].concat(E);return function(u,c){var s=q(u,"AddDice"),i=[s].concat(c);return function(n,$){var l=q(n,"Node"),d=[l].concat($),m=e.$r(d);return function(k,x,Y){var a=C(k,x,"Command"),N=[a].concat(Y),p=e.$r(N),H=a.$$prototype;return H.lhs=H.rhs=H.cmp_op=t,a.$attr_reader("lhs"),a.$attr_reader("cmp_op"),a.$attr_reader("rhs"),I(a,"$initialize",function(ee,ne,V,Z){var y=this;return V==null&&(V=t),Z==null&&(Z=t),y.secret=ee,y.lhs=ne,y.cmp_op=V,y.rhs=Z},-3),I(a,"$expr",function(ee){var ne,V=this;return h(h(V.lhs.$expr(ee),V.$cmp_op_text()),(ne=V.rhs,ne===t||ne==null?t:v(ne,"eval",[ee,t])).$to_s())},1),I(a,"$s_exp",function(){var ee=this;return z(ee.cmp_op)?"(Command ("+ee.cmp_op+" "+ee.lhs.$s_exp()+" "+ee.rhs.$s_exp()+"))":"(Command "+ee.lhs.$s_exp()+")"},0),I(a,"$eval",function(ee,ne){var V,Z=this,y=t,K=t,P=t,j=t,O=t,re=t;return ne=p("Randomizer").$new(ne,ee),y=Z.lhs.$eval(ee,ne),K=z(T(ne.$rand_results().$size(),1))&&z(Z.lhs["$is_a?"](r(p("Node"),"DiceRoll")))?t:Z.lhs.$output(),P=z(Z.cmp_op)?(j=Z.rhs.$eval(ee,t),ee.$check_result(y,ne.$rand_results(),Z.cmp_op,j)):t,P=z(O=P)?O:p("Result").$new(),re=["("+Z.$expr(ee)+")",K,y,(V=P,V===t||V==null?t:v(V,"text",[]))].$compact(),v(P,"tap",[],function te(ie){var $e=te.$$s==null?this:te.$$s,se=t;return $e.secret==null&&($e.secret=t),ie==null&&(ie=t),se=[$e.secret],v(ie,"secret=",U(se)),se[J(se.length,1)],se=[re.$join(" \uFF1E ")],v(ie,"text=",U(se)),se[J(se.length,1)]},{$$arity:1,$$s:Z})},2),a.$private(),I(a,"$cmp_op_text",function(){var ee=this,ne=t;return W("!=",ne=ee.cmp_op)?"<>":W("==",ne)?"=":ee.cmp_op.$to_s()},0)}(d[0],null,d),function(k,x,Y){var a=C(k,x,"UndecidedTarget"),N=[a].concat(Y),p=e.$r(N);return a.$include(p("Singleton")),I(a,"$eval",function(Q,ee){return"?"},2),I(a,"$include_dice?",function(){return!1},0),I(a,"$expr",function(Q){return"?"},1),I(a,"$output",function(){return"?"},0),S(a,"s_exp","output")}(d[0],null,d),function(k,x){var Y=C(k,x,"BinaryOp"),a=Y.$$prototype;return a.lhs=a.rhs=a.op=t,I(Y,"$initialize",function(p,H,Q){var ee=this;return ee.lhs=p,ee.op=H,ee.rhs=Q},3),I(Y,"$eval",function(p,H){var Q=this,ee=t,ne=t;return ee=Q.lhs.$eval(p,H),ne=Q.rhs.$eval(p,H),Q.$calc(ee,ne,p.$round_type()).$to_i()},2),I(Y,"$include_dice?",function(){var p=this,H=t;return z(H=p.lhs["$include_dice?"]())?H:p.rhs["$include_dice?"]()},0),I(Y,"$expr",function(p){var H=this,Q=t,ee=t;return Q=H.lhs.$expr(p),ee=H.rhs.$expr(p),""+Q+H.op+ee},1),I(Y,"$output",function(){var p=this;return""+p.lhs.$output()+p.op+p.rhs.$output()},0),I(Y,"$s_exp",function(){var p=this;return"("+p.$op_for_s_exp()+" "+p.lhs.$s_exp()+" "+p.rhs.$s_exp()+")"},0),Y.$private(),I(Y,"$calc",function(p,H,Q){var ee=this;return p.$send(ee.op,H).$to_i()},3),I(Y,"$op_for_s_exp",function(){var p=this;return p.op},0)}(d[0],null),function(k,x,Y){var a=C(k,x,"DivideBase"),N=[a].concat(Y),p=e.$r(N),H=a.$$prototype;return H.op=t,I(a,"$initialize",function Q(ee,ne){var V=Q.$$p||t,Z=this;return delete Q.$$p,F(Z,B(Z,"initialize",Q,!1,!0),"initialize",[ee,"/",ne],null)},2),I(a,"$expr",function Q(ee){var ne=Q.$$p||t,V=this;return delete Q.$$p,""+F(V,B(V,"expr",Q,!1,!0),"expr",[ee],null)+V.$rounding_method()},1),I(a,"$output",function Q(){var ee=Q.$$p||t,ne=this;return delete Q.$$p,""+F(ne,B(ne,"output",Q,!1,!0),"output",[],ee)+ne.$rounding_method()},0),a.$private(),I(a,"$rounding_method",function(){var ee=this;return r(ee.$class(),"ROUNDING_METHOD")},0),I(a,"$op_for_s_exp",function(){var ee=this;return""+ee.op+ee.$rounding_method()},0),I(a,"$calc",function(ee,ne,V){var Z=this;return z(ne["$zero?"]())?1:Z.$divide_and_round(ee,ne,V).$to_i()},3),I(a,"$divide_and_round",function(ee,ne,V){var Z=this;return Z.$raise(p("NotImplementedError"))},3)}(d[0],m("BinaryOp"),d),function(k,x,Y){var a=C(k,x,"DivideWithGameSystemDefault"),N=[a].concat(Y),p=e.$r(N);return X(N[0],"ROUNDING_METHOD",""),a.$private(),I(a,"$divide_and_round",function(Q,ee,ne){var V=t,Z=t;return W(r(p("RoundType"),"CEIL"),V=ne)?L(Q.$to_f(),ee).$ceil():W(r(p("RoundType"),"ROUND"),V)?(Z=L(Q.$to_f(),ee),z(Z["$negative?"]())?Z.$abs().$round()["$-@"]():Z.$round()):L(Q,ee).$floor()},3)}(d[0],m("DivideBase"),d),function(k,x,Y){var a=C(k,x,"DivideWithRoundingUp"),N=[a].concat(Y);return X(N[0],"ROUNDING_METHOD","U"),a.$private(),I(a,"$divide_and_round",function(H,Q,ee){return L(H.$to_f(),Q).$ceil()},3)}(d[0],m("DivideBase"),d),function(k,x,Y){var a=C(k,x,"DivideWithRoundingOff"),N=[a].concat(Y);return X(N[0],"ROUNDING_METHOD","R"),a.$private(),I(a,"$divide_and_round",function(H,Q,ee){var ne=t;return ne=L(H.$to_f(),Q),z(ne["$negative?"]())?ne.$abs().$round()["$-@"]():ne.$round()},3)}(d[0],m("DivideBase"),d),function(k,x,Y){var a=C(k,x,"DivideWithRoundingDown"),N=[a].concat(Y);return X(N[0],"ROUNDING_METHOD","F"),a.$private(),I(a,"$divide_and_round",function(H,Q,ee){return L(H,Q).$floor()},3)}(d[0],m("DivideBase"),d),function(k,x){var Y=C(k,x,"Negate"),a=Y.$$prototype;return a.body=t,Y.$attr_reader("body"),I(Y,"$initialize",function(p){var H=this;return H.body=p},1),I(Y,"$eval",function(p,H){var Q=this;return Q.body.$eval(p,H).$to_i()["$-@"]()},2),I(Y,"$include_dice?",function(){var p=this;return p.body["$include_dice?"]()},0),I(Y,"$expr",function(p){var H=this;return"-"+H.body.$expr(p)},1),I(Y,"$output",function(){var p=this;return"-"+p.body.$output()},0),I(Y,"$s_exp",function(){var p=this;return"(- "+p.body.$s_exp()+")"},0)}(d[0],null),function(k,x){var Y=C(k,x,"DiceRoll"),a=Y.$$prototype;return a.times=a.text=a.sides=t,I(Y,"$initialize",function(p,H){var Q=this;return Q.times=p,Q.sides=H,Q.text=t},2),I(Y,"$eval",function(p,H){var Q=this,ee=t,ne=t,V=t,Z=t;return ee=Q.times.$eval(p,t),ne=Q.$eval_sides(p),V=H.$roll(ee,ne),Z=V.$sum(),Q.text=""+Z+"["+V.$join(",")+"]",Z.$to_i()},2),I(Y,"$include_dice?",function(){return!0},0),I(Y,"$expr",function(p){var H=this,Q=t,ee=t;return Q=H.times.$eval(p,t),ee=H.$eval_sides(p),""+Q+"D"+ee},1),I(Y,"$output",function(){var p=this;return p.text},0),I(Y,"$s_exp",function(){var p=this;return"(DiceRoll "+p.times.$s_exp()+" "+p.sides.$s_exp()+")"},0),Y.$private(),I(Y,"$eval_sides",function(p){var H=this;return H.sides.$eval(p,t)},1)}(d[0],null),function(k,x){var Y=C(k,x,"ImplicitSidesDiceRoll"),a=Y.$$prototype;return a.times=t,I(Y,"$initialize",function(p){var H=this;return H.times=p,H.text=t},1),I(Y,"$s_exp",function(){var p=this;return"(ImplicitSidesDiceRoll "+p.times.$s_exp()+")"},0),Y.$private(),I(Y,"$eval_sides",function(p){return p.$sides_implicit_d()},1)}(d[0],m("DiceRoll")),function(k,x,Y){var a=C(k,x,"DiceRollWithFilter"),N=[a].concat(Y),p=e.$r(N),H=a.$$prototype;return H.times=H.n_filtering=H.filter=H.sides=H.text=t,X(N[0],"Filter",p("Struct").$new("abbr","apply")),X(N[0],"KEEP_HIGHEST",p("Filter").$new("KH",v(a,"lambda",[],function(ee,ne){return ee==null&&(ee=t),ne==null&&(ne=t),ee.$reverse().$take(ne)},2)).$freeze()),X(N[0],"KEEP_LOWEST",p("Filter").$new("KL",v(a,"lambda",[],function(ee,ne){return ee==null&&(ee=t),ne==null&&(ne=t),ee.$take(ne)},2)).$freeze()),X(N[0],"DROP_HIGHEST",p("Filter").$new("DH",v(a,"lambda",[],function(ee,ne){return ee==null&&(ee=t),ne==null&&(ne=t),ee.$reverse().$drop(ne)},2)).$freeze()),X(N[0],"DROP_LOWEST",p("Filter").$new("DL",v(a,"lambda",[],function(ee,ne){return ee==null&&(ee=t),ne==null&&(ne=t),ee.$drop(ne)},2)).$freeze()),I(a,"$initialize",function(ee,ne,V,Z){var y=this;return b(ne,"implicit")&&w(ne["$respond_to?"]("eval"))&&y.$raise(p("TypeError"),"sides must be a Node or :implicit ("+ne.$inspect()+")"),y.times=ee,y.sides=ne,y.n_filtering=V,y.filter=Z,y.text=t},4),I(a,"$eval",function(ee,ne){var V=this,Z=t,y=t,K=t,P=t,j=t;return Z=V.times.$eval(ee,t),y=V.$eval_sides(ee),K=V.n_filtering.$eval(ee,t),P=ne.$roll(Z,y).$sort(),j=V.filter.$apply()["$[]"](P,K).$sum(),V.text=""+j+"["+P.$join(",")+"]",j.$to_i()},2),I(a,"$include_dice?",function(){return!0},0),I(a,"$implicit_sides?",function(){var ee=this;return ee.sides["$=="]("implicit")},0),I(a,"$expr",function(ee){var ne=this,V=t,Z=t,y=t;return V=ne.times.$eval(ee,t),Z=ne.$eval_sides(ee),y=ne.n_filtering.$eval(ee,t),""+V+"D"+Z+ne.filter.$abbr()+y},1),I(a,"$output",function(){var ee=this;return ee.text},0),I(a,"$s_exp",function(){var ee=this,ne=t;return ne=z(ee["$implicit_sides?"]())?ee.sides.$inspect():ee.sides.$s_exp(),"(DiceRollWithFilter "+ee.times.$s_exp()+" "+ne+" "+ee.filter.$abbr().$inspect()+" "+ee.n_filtering.$s_exp()+")"},0),a.$private(),I(a,"$eval_sides",function(ee){var ne=this;return z(ne["$implicit_sides?"]())?ee.$sides_implicit_d():ne.sides.$eval(ee,t)},1)}(d[0],null,d),function(k,x){var Y=C(k,x,"Parenthesis"),a=Y.$$prototype;return a.expr=t,I(Y,"$initialize",function(p){var H=this;return H.expr=p},1),I(Y,"$eval",function(p,H){var Q=this;return Q.expr.$eval(p,H).$to_i()},2),I(Y,"$include_dice?",function(){var p=this;return p.expr["$include_dice?"]()},0),I(Y,"$expr",function(p){var H=this;return"("+H.expr.$expr(p)+")"},1),I(Y,"$output",function(){var p=this;return"("+p.expr.$output()+")"},0),I(Y,"$s_exp",function(){var p=this;return"(Parenthesis "+p.expr.$s_exp()+")"},0)}(d[0],null),function(k,x,Y){var a=C(k,x,"Number"),N=[a].concat(Y),p=e.$r(N),H=a.$$prototype;return H.literal=t,a.$attr_reader("literal"),I(a,"$initialize",function(ee){var ne=this;return ne.literal=ee.$to_i()},1),I(a,"$negate",function(){var ee=this;return p("Number").$new(ee.literal["$-@"]())},0),I(a,"$eval",function(ee,ne){var V=this;return V.literal.$to_i()},2),I(a,"$include_dice?",function(){return!1},0),I(a,"$expr",function(ee){var ne=this;return ne.literal.$to_s()},1),I(a,"$output",function(){var ee=this;return ee.literal.$to_s()},0),S(a,"s_exp","output")}(d[0],null,d)}(i[0],i)}(_[0],_)}(R[0],R)}(o[0],o)};Opal.modules["bcdice/common_command/add_dice/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.truthy,z=e.eqeq,T=e.hash,U=e.const_set,J=e.to_ary,W=e.not,S=e.neqeq,F=e.hash2;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/add_dice/node"),function(B,X){var L=q(B,"BCDice"),w=[L].concat(X);return function(b,M){var D=q(b,"CommonCommand"),G=[D].concat(M);return function(R,f){var E=q(R,"AddDice"),g=[E].concat(f),_=e.$r(g);return function(u,c,s){var i=C(u,c,"Parser"),n=[i].concat(s),$=e.$r(n),l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=t,ne=t,V=t,Z=i.$$prototype;return Z.lexer=t,I(i,"$parse",function(K){var P=this;return P.$new().$parse(K)},1),h(i,"$parse",function(K){var P=this;try{return P.lexer=$("Lexer").$new(K),P.$do_parse()}catch(j){if(e.rescue(j,[$("ParseError")]))try{return t}finally{e.pop_exception()}else throw j}},1),i.$private(),h(i,"$next_token",function(){var K=this;return K.lexer.$next_token()},0),h(i,"$expand_negate",function(K,P){if(v(P["$is_a?"](r($("Node"),"Negate")))){if(z(K,"+"))return["-",P.$body()];if(z(K,"-"))return["+",P.$body()]}return[K,P]},2),l=[14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,t,13,t,8,9,8,9,13,14,13,t,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,t,42,13,t,17,18,40,39,13,t,38,-28,-28,40,39,-28,t,38,45,47,44,46,52,53,54,55],d=[16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,t,13,t,17,17,18,18,17,20,18,t,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,t,25,20,t,5,5,24,24,23,t,24,33,33,34,34,33,t,34,32,32,32,32,39,39,40,40],m=[7,19,5,t,34,61,-15,t,7,13,t,32,-1,28,t,t,-2,34,36,43,55,t,t,61,76,53,t,-5,t,22,48,t,79,81,83,t,6,t,-8,90,92,t,t,t,t,t,t,t,t,t,29,31,t,t,t,t,t,t],k=[-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32],x=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,t,t,t,t,t,t,49],Y=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,t,t,t,t,t,t,9],a=[t,7,8,-1,-7,-13,-6,-22,t,-12,-6,-18,t,t,t],N=[t,t,t,t,t,6,7,t,10,11,t,t,36,37,41],p=[0,0,"racc_error",2,26,"_reduce_1",4,26,"_reduce_2",0,27,"_reduce_3",1,27,"_reduce_4",1,29,"_reduce_none",1,29,"_reduce_6",3,28,"_reduce_7",3,28,"_reduce_8",1,28,"_reduce_none",3,30,"_reduce_10",4,30,"_reduce_11",1,30,"_reduce_none",0,32,"_reduce_13",1,32,"_reduce_14",1,32,"_reduce_15",1,32,"_reduce_16",1,32,"_reduce_17",2,31,"_reduce_18",2,31,"_reduce_19",1,31,"_reduce_none",3,33,"_reduce_21",2,33,"_reduce_22",4,33,"_reduce_23",2,33,"_reduce_24",3,33,"_reduce_25",1,33,"_reduce_none",0,35,"_reduce_27",1,35,"_reduce_28",2,36,"_reduce_29",1,36,"_reduce_30",3,39,"_reduce_31",3,39,"_reduce_32",2,37,"_reduce_33",2,37,"_reduce_34",2,37,"_reduce_35",2,37,"_reduce_36",1,38,"_reduce_none",1,38,"_reduce_none",3,34,"_reduce_39",1,34,"_reduce_40"],H=41,Q=58,ee=T(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),ne=25,V=!0,U(n[0],"Racc_arg",[l,d,k,m,x,Y,N,a,ne,p,ee,Q,H,V]),U(n[0],"Racc_token_to_s_table",["$end","error","NUMBER","CMP_OP","S","D","K","H","L","M","A","X","I","N","U","R","F","C","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","QUESTION","$start","command","secret","add","target","mul","unary","round_type","dice","term","explicit_or_implicit_sides","filter","filter_type","filter_type_with_shorthand","filter_shorthand"]),U(n[0],"Racc_debug_parser",!1),h(i,"$_reduce_1",function(K,P,j){var O,re,te=this,ie=t,$e=t;return re=K,O=J(re),ie=O[0]==null?t:O[0],$e=O[1]==null?t:O[1],v($e["$include_dice?"]())||te.$raise($("ParseError")),j=r($("Node"),"Command").$new(ie,$e),j},3),h(i,"$_reduce_2",function(K,P,j){var O,re,te=this,ie=t,$e=t,se=t,oe=t;return re=K,O=J(re),ie=O[0]==null?t:O[0],$e=O[1]==null?t:O[1],se=O[2]==null?t:O[2],oe=O[3]==null?t:O[3],(W($e["$include_dice?"]())||v(oe["$include_dice?"]())||v(se["$nil?"]()))&&te.$raise($("ParseError")),j=r($("Node"),"Command").$new(ie,$e,se,oe),j},3),h(i,"$_reduce_3",function(K,P,j){return j=!1,j},3),h(i,"$_reduce_4",function(K,P,j){return j=!0,j},3),h(i,"$_reduce_6",function(K,P,j){return j=r($("Node"),"UndecidedTarget").$instance(),j},3),h(i,"$_reduce_7",function(K,P,j){var O,re,te=this,ie=t,$e=t,se=t;return ie=K["$[]"](0),re=te.$expand_negate("+",K["$[]"](2)),O=J(re),$e=O[0]==null?t:O[0],se=O[1]==null?t:O[1],j=r($("Node"),"BinaryOp").$new(ie,$e,se),j},3),h(i,"$_reduce_8",function(K,P,j){var O,re,te=this,ie=t,$e=t,se=t;return ie=K["$[]"](0),re=te.$expand_negate("-",K["$[]"](2)),O=J(re),$e=O[0]==null?t:O[0],se=O[1]==null?t:O[1],j=r($("Node"),"BinaryOp").$new(ie,$e,se),j},3),h(i,"$_reduce_10",function(K,P,j){var O=t,re=t;return O=K["$[]"](0),re=K["$[]"](2),j=r($("Node"),"BinaryOp").$new(O,"*",re),j},3),h(i,"$_reduce_11",function(K,P,j){var O=t,re=t,te=t;return O=K["$[]"](0),re=K["$[]"](2),te=K["$[]"](3),j=te.$new(O,re),j},3),h(i,"$_reduce_13",function(K,P,j){return j=r($("Node"),"DivideWithGameSystemDefault"),j},3),h(i,"$_reduce_14",function(K,P,j){return j=r($("Node"),"DivideWithRoundingDown"),j},3),h(i,"$_reduce_15",function(K,P,j){return j=r($("Node"),"DivideWithRoundingUp"),j},3),h(i,"$_reduce_16",function(K,P,j){return j=r($("Node"),"DivideWithRoundingUp"),j},3),h(i,"$_reduce_17",function(K,P,j){return j=r($("Node"),"DivideWithRoundingOff"),j},3),h(i,"$_reduce_18",function(K,P,j){return j=K["$[]"](1),j},3),h(i,"$_reduce_19",function(K,P,j){var O=t;return O=K["$[]"](1),j=v(O["$is_a?"](r($("Node"),"Negate")))?O.$body():r($("Node"),"Negate").$new(O),j},3),h(i,"$_reduce_21",function(K,P,j){var O=this,re=t,te=t;return re=K["$[]"](0),te=K["$[]"](2),(v(re["$include_dice?"]())||v(te["$include_dice?"]()))&&O.$raise($("ParseError")),j=r($("Node"),"DiceRoll").$new(re,te),j},3),h(i,"$_reduce_22",function(K,P,j){var O=this,re=t;return re=K["$[]"](0),v(re["$include_dice?"]())&&O.$raise($("ParseError")),j=r($("Node"),"ImplicitSidesDiceRoll").$new(re),j},3),h(i,"$_reduce_23",function(K,P,j){var O=this,re=t,te=t,ie=t,$e=t;return re=K["$[]"](0),te=K["$[]"](2),ie=K["$[]"](3)["$[]"]("filter"),$e=K["$[]"](3)["$[]"]("n_filtering"),S(te,"implicit")&&v(te["$include_dice?"]())&&O.$raise($("ParseError")),(v(re["$include_dice?"]())||v($e["$include_dice?"]()))&&O.$raise($("ParseError")),j=r($("Node"),"DiceRollWithFilter").$new(re,te,$e,ie),j},3),h(i,"$_reduce_24",function(K,P,j){var O=this,re=t,te=t;return re=r($("Node"),"Number").$new(1),te=K["$[]"](1),v(te["$include_dice?"]())&&O.$raise($("ParseError")),v(te["$instance_of?"](r($("Node"),"Number")))&&z(te.$literal(),66)&&O.$raise($("ParseError")),j=r($("Node"),"DiceRoll").$new(re,te),j},3),h(i,"$_reduce_25",function(K,P,j){var O=this,re=t,te=t,ie=t,$e=t;return re=r($("Node"),"Number").$new(1),te=K["$[]"](1),ie=K["$[]"](2)["$[]"]("filter"),$e=K["$[]"](2)["$[]"]("n_filtering"),S(te,"implicit")&&v(te["$include_dice?"]())&&O.$raise($("ParseError")),v($e["$include_dice?"]())&&O.$raise($("ParseError")),v(te["$instance_of?"](r($("Node"),"Number")))&&z(te.$literal(),66)&&O.$raise($("ParseError")),j=r($("Node"),"DiceRollWithFilter").$new(re,te,$e,ie),j},3),h(i,"$_reduce_27",function(K,P,j){return j="implicit",j},3),h(i,"$_reduce_28",function(K,P,j){return j=K["$[]"](0),j},3),h(i,"$_reduce_29",function(K,P,j){return j=F(["filter","n_filtering"],{filter:K["$[]"](0),n_filtering:K["$[]"](1)}),j},3),h(i,"$_reduce_30",function(K,P,j){return j=F(["filter","n_filtering"],{filter:K["$[]"](0),n_filtering:r($("Node"),"Number").$new(1)}),j},3),h(i,"$_reduce_31",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST"),j},3),h(i,"$_reduce_32",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"KEEP_LOWEST"),j},3),h(i,"$_reduce_33",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST"),j},3),h(i,"$_reduce_34",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"KEEP_LOWEST"),j},3),h(i,"$_reduce_35",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"DROP_HIGHEST"),j},3),h(i,"$_reduce_36",function(K,P,j){return j=r(r($("Node"),"DiceRollWithFilter"),"DROP_LOWEST"),j},3),h(i,"$_reduce_39",function(K,P,j){return j=r($("Node"),"Parenthesis").$new(K["$[]"](1)),j},3),h(i,"$_reduce_40",function(K,P,j){return j=r($("Node"),"Number").$new(K["$[]"](0)),j},3),h(i,"$_reduce_none",function(K,P,j){return K["$[]"](0)},3)}(g[0],r(_("Racc"),"Parser"),g)}(G[0],G)}(w[0],w)}(o[0],o)};Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.const_set,C=e.def,I=e.eqeq,h=e.send,v=e.truthy;return function(z,T){var U=t(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=t(W,"CommonCommand"),B=[F].concat(S);return function(X,L){var w=t(X,"AddDice"),b=[w].concat(L);return function(M,D,G){var R=r(M,D,"Randomizer"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.game_system=g.rand_source=g.rand_results=o,R.$attr_reader("rand_results"),q(f[0],"RandResult",E("Struct").$new("sides","value")),C(R,"$initialize",function(u,c){var s=this;return s.rand_source=u,s.game_system=c,s.rand_results=[]},2),C(R,"$roll",function(u,c){var s=this,i=o,n=o;return i=I(c,66)?h(E("Array"),"new",[u],function $(){var l=$.$$s==null?this:$.$$s;return l.rand_source==null&&(l.rand_source=o),l.game_system==null&&(l.game_system=o),l.rand_source.$roll_d66(l.game_system.$d66_sort_type())},{$$arity:0,$$s:s}):I(c,9)&&v(s.game_system["$enabled_d9?"]())?h(E("Array"),"new",[u],function $(){var l=$.$$s==null?this:$.$$s;return l.rand_source==null&&(l.rand_source=o),l.rand_source.$roll_d9()},{$$arity:0,$$s:s}):s.rand_source.$roll_barabara(u,c),v(s.game_system["$sort_add_dice?"]())&&i["$sort!"](),n=h(i,"map",[],function(l){return l==null&&(l=o),E("RandResult").$new(c,l)},1),s.rand_results.$concat(n),i},2)}(b[0],null,b)}(B[0],B)}(J[0],J)}(A[0],A)};Opal.modules["bcdice/common_command/add_dice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/normalize"),A.$require("bcdice/common_command/add_dice/parser"),A.$require("bcdice/common_command/add_dice/randomizer"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"AddDice"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f,E])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/common_command/reroll_dice/node"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.def,I=e.truthy,h=e.send,v=e.rb_lt,z=e.rb_plus,T=e.rb_gt,U=e.eqeq,J=e.to_a,W=e.rb_minus,S=e.eqeqeq,F=e.rb_le,B=e.rb_ge;return function(X,L){var w=t(X,"BCDice"),b=[w].concat(L);return function(M,D){var G=t(M,"CommonCommand"),R=[G].concat(D);return function(f,E){var g=t(f,"RerollDice"),_=[g].concat(E);return function(u,c){var s=t(u,"Node"),i=[s].concat(c);return function(n,$,l){var d=r(n,$,"Command"),m=[d].concat(l),k=e.$r(m),x=d.$$prototype;return x.cmp_op=x.reroll_cmp_op=x.target_number_node=x.reroll_threshold_node=x.notations=x.source=o,C(d,"$initialize",function(a){var N,p,H,Q,ee,ne,V,Z=this;if(a==null)a=q([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(a.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(N=a.$$smap.secret,!e.hasOwnProperty.call(a.$$smap,"notations"))throw e.ArgumentError.$new("missing keyword: notations");if(p=a.$$smap.notations,!e.hasOwnProperty.call(a.$$smap,"source"))throw e.ArgumentError.$new("missing keyword: source");return H=a.$$smap.source,Q=a.$$smap.cmp_op,Q==null&&(Q=o),ee=a.$$smap.target_number,ee==null&&(ee=o),ne=a.$$smap.reroll_cmp_op,ne==null&&(ne=o),V=a.$$smap.reroll_threshold,V==null&&(V=o),Z.secret=N,Z.notations=p,Z.cmp_op=Q,Z.target_number_node=ee,Z.reroll_cmp_op=ne,Z.reroll_threshold_node=V,Z.source=H},1),C(d,"$eval",function(a,N){var p,H,Q=this,ee=o,ne=o,V=o,Z=o,y=o,K=o,P=o,j=o,O=o,re=o,te=o,ie=o,$e=o,se=o;return ee=a.$round_type(),ne=I(V=Q.cmp_op)?V:a.$default_cmp_op(),Z=I(V=I(y=Q.reroll_cmp_op)?y:ne)?V:">=",K=I(V=(p=Q.target_number_node,p===o||p==null?o:h(p,"eval",[ee])))?V:a.$default_target_number(),P=I(V=I(y=(H=Q.reroll_threshold_node,H===o||H==null?o:h(H,"eval",[ee])))?y:a.$reroll_dice_reroll_threshold())?V:K,j=k("RerollCondition").$new(Z,P),O=h(Q.notations,"map",[],function(le){return le==null&&(le=o),le.$to_dice(ee)},1),I(h(O,"all?",[],function(le){return le==null&&(le=o),j["$valid?"](le.$sides())},1))?(re=Q.$roll(O,N,j,a["$sort_barabara_dice?"]()),te=re.$flatten(),ie=re.$take(Q.notations.$size()).$flatten().$count(1),$e=I(ne)?h(te,"count",[],function(le){return le==null&&(le=o),le.$send(ne,K)},1):0,se=[Q.$expr(ee,j,ne,K),h(re,"map",[],function(le){return le==null&&(le=o),le.$join(",")},1).$join(" + "),"\u6210\u529F\u6570"+$e,a.$grich_text(ie,te.$size(),$e)].$compact(),Q.$result_with_text(se.$join(" \uFF1E "))):Q.$result_with_text(""+Q.source+" \uFF1E \u6761\u4EF6\u304C\u9593\u9055\u3063\u3066\u3044\u307E\u3059\u30022R6>=5 \u3042\u308B\u3044\u306F 2R6[5] \u306E\u3088\u3046\u306B\u632F\u308A\u8DB3\u3057\u76EE\u6A19\u5024\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002")},2),d.$private(),C(d,"$roll",function(a,N,p,H){var Q,ee=o,ne=o,V=o,Z=o,y=o,K=o;for(ee=[],ne=0;I(I(V=a["$empty?"]()["$!"]())?v(ne,k("REROLL_LIMIT")):V);)Z=a.$shift(),ne=z(ne,1),y=Z.$roll(N),I(H)&&y["$sort!"](),ee.$push(y),K=h(y,"count",[],function(j){return j==null&&(j=o),p["$reroll?"](j)},1),I(T(K,0))&&a.$push(k("Dice").$new(K,Z.$sides()));return ee},4),C(d,"$expr",function(a,N,p,H){var Q=this,ee=o,ne=o,V=o;return ee=h(Q.notations,"map",[],function(y){return y==null&&(y=o),y.$to_dice(a)},1).$join("+"),ne=U(N.$cmp_op(),p)?"":k("Format").$comparison_operator(N.$cmp_op()),V=k("Format").$comparison_operator(p),"("+ee+"["+ne+N.$threshold()+"]"+V+H+")"},4),C(d,"$result_with_text",function(a){var N=this;return h(k("Result").$new(),"tap",[],function p(H){var Q=p.$$s==null?this:p.$$s,ee=o;return Q.secret==null&&(Q.secret=o),H==null&&(H=o),ee=[Q.secret],h(H,"secret=",J(ee)),ee[W(ee.length,1)],ee=[a],h(H,"text=",J(ee)),ee[W(ee.length,1)]},{$$arity:1,$$s:N})},1)}(i[0],null,i),function(n,$){var l=r(n,$,"RerollCondition"),d=l.$$prototype;return d.threshold=d.cmp_op=o,l.$attr_reader("cmp_op"),l.$attr_reader("threshold"),C(l,"$initialize",function(k,x){var Y=this;return Y.cmp_op=k,Y.threshold=x},2),C(l,"$valid?",function(k){var x=this,Y=o;return I(x.threshold)?S("<=",Y=x.cmp_op)?v(x.threshold,k):S("<",Y)?F(x.threshold,k):S(">=",Y)?T(x.threshold,1):S(">",Y)?B(x.threshold,1):S("!=",Y)?e.Range.$new(1,k,!1)["$include?"](x.threshold):!0:!1},1),C(l,"$reroll?",function(k){var x=this;return k.$send(x.cmp_op,x.threshold)},1)}(i[0],null),function(n,$,l){var d=r(n,$,"Notation"),m=[d].concat(l),k=e.$r(m),x=d.$$prototype;return x.times=x.sides=o,C(d,"$initialize",function(a,N){var p=this;return p.times=a,p.sides=N},2),C(d,"$to_dice",function(a){var N=this,p=o,H=o;return p=N.times.$eval(a),H=N.sides.$eval(a),k("Dice").$new(p,H)},1)}(i[0],null,i),function(n,$){var l=r(n,$,"Dice");return l.$attr_reader("times","sides"),C(l,"$initialize",function(m,k){var x=this;return x.times=m,x.sides=k},2),C(l,"$roll",function(m){var k=this;return m.$roll_barabara(k.$times(),k.$sides())},1),C(l,"$to_s",function(){var m=this;return""+m.$times()+"R"+m.$sides()},0)}(i[0],null)}(_[0],_)}(R[0],R)}(b[0],b)}(A[0],A)};Opal.modules["bcdice/arithmetic/node"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.def,I=e.send2,h=e.find_super,v=e.eqeq,z=e.const_set,T=e.eqeqeq,U=e.rb_divide,J=e.truthy,W=e.alias;return function(S,F){var B=r(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=r(L,"Arithmetic"),M=[b].concat(w);return function(D,G){var R=r(D,"Node"),f=[R].concat(G),E=e.$r(f);return function(g,_){var u=q(g,_,"BinaryOp"),c=u.$$prototype;return c.lhs=c.rhs=c.op=o,C(u,"$initialize",function(i,n,$){var l=this;return l.lhs=i,l.op=n,l.rhs=$},3),C(u,"$eval",function(i){var n=this,$=o,l=o;return $=n.lhs.$eval(i),l=n.rhs.$eval(i),$.$send(n.op,l)},1),C(u,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),C(u,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),C(u,"$op_for_s_exp",function(){var i=this;return i.op},0)}(f[0],null),function(g,_,u){var c=q(g,_,"DivideBase"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.lhs=n.rhs=n.op=o,C(c,"$initialize",function $(l,d){var m=$.$$p||o,k=this;return delete $.$$p,I(k,h(k,"initialize",$,!1,!0),"initialize",[l,"/",d],null)},2),C(c,"$eval",function(l){var d=this,m=o,k=o;return m=d.lhs.$eval(l),k=d.rhs.$eval(l),v(k,0)&&d.$raise(i("ZeroDivisionError")),d.$divide_and_round(m,k,l)},1),C(c,"$output",function $(){var l=$.$$p||o,d=this;return delete $.$$p,""+I(d,h(d,"output",$,!1,!0),"output",[],l)+d.$rounding_method()},0),c.$private(),C(c,"$rounding_method",function(){var l=this;return t(l.$class(),"ROUNDING_METHOD")},0),C(c,"$op_for_s_exp",function(){var l=this;return""+l.op+l.$rounding_method()},0),C(c,"$divide_and_round",function(l,d,m){var k=this;return k.$raise(i("NotImplementedError"))},3)}(f[0],E("BinaryOp"),f),function(g,_,u){var c=q(g,_,"DivideWithGameSystemDefault"),s=[c].concat(u),i=e.$r(s);return z(s[0],"ROUNDING_METHOD",""),c.$private(),C(c,"$divide_and_round",function($,l,d){var m=o,k=o;return T(t(i("RoundType"),"CEIL"),m=d)?U($.$to_f(),l).$ceil():T(t(i("RoundType"),"ROUND"),m)?(k=U($.$to_f(),l),J(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):U($,l).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithCeil"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","C"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n.$to_f(),$).$ceil()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithRound"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","R"),c.$private(),C(c,"$divide_and_round",function(n,$,l){var d=o;return d=U(n.$to_f(),$),J(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithFloor"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","F"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n,$).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_){var u=q(g,_,"Negative"),c=u.$$prototype;return c.body=o,C(u,"$initialize",function(i){var n=this;return n.body=i},1),C(u,"$eval",function(i){var n=this;return n.body.$eval(i)["$-@"]()},1),C(u,"$output",function(){var i=this;return"-"+i.body.$output()},0),C(u,"$s_exp",function(){var i=this;return"(- "+i.body.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Parenthesis"),c=u.$$prototype;return c.expr=o,C(u,"$initialize",function(i){var n=this;return n.expr=i},1),C(u,"$eval",function(i){var n=this;return n.expr.$eval(i)},1),C(u,"$output",function(){var i=this;return"("+i.expr.$output()+")"},0),C(u,"$s_exp",function(){var i=this;return"(Parenthesis "+i.expr.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Number"),c=u.$$prototype;return c.value=o,C(u,"$initialize",function(i){var n=this;return n.value=i},1),C(u,"$eval",function(i){var n=this;return n.value},1),C(u,"$output",function(){var i=this;return i.value.$to_s()},0),W(u,"s_exp","output")}(f[0],null)}(M[0],M)}(X[0],X)}(A[0],A)};Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set,T=e.hash2,U=e.to_ary,J=e.truthy;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/reroll_dice/node"),A.$require("bcdice/arithmetic/node"),function(W,S){var F=q(W,"BCDice"),B=[F].concat(S);return function(X,L){var w=q(X,"CommonCommand"),b=[w].concat(L);return function(M,D){var G=q(M,"BarabaraDice"),R=[G].concat(D),f=e.$r(R);return function(E,g,_){var u=C(E,g,"Parser"),c=[u].concat(_),s=e.$r(c),i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=u.$$prototype;return ee.lexer=t,I(u,"$parse",function(V){var Z=this;return Z.$new().$parse(V)},1),h(u,"$parse",function(V){var Z=this;try{return Z.lexer=s("Lexer").$new(V),Z.$do_parse()}catch(y){if(e.rescue(y,[s("ParseError")]))try{return t}finally{e.pop_exception()}else throw y}},1),u.$private(),h(u,"$next_token",function(){var V=this;return V.lexer.$next_token()},0),i=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],n=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],$=[-6,21,-1,t,56,-9,t,55,1,t,t,t,6,4,5,-5,24,t,18,20,t,28,t,t,30,32,t,42,44,t,t,36,38,t,19,t,t,t,t,t],l=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],d=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],m=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],k=[t,1,4,8,11,-5,0,-2,-16,-13,-17],x=[t,t,t,t,t,t,t,20,16,17,t],Y=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],a=25,N=40,p=v(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),H=23,Q=!0,z(c[0],"Racc_arg",[i,n,l,$,d,m,x,k,H,Y,p,N,a,Q]),z(c[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),z(c[0],"Racc_debug_parser",!1),h(u,"$_reduce_1",function(V,Z,y){return y=r(s("Node"),"Command").$new(T(["secret","notations","cmp_op","target_number"],{secret:V["$[]"](0),notations:V["$[]"](1),cmp_op:V["$[]"](2)["$[]"]("cmp_op"),target_number:V["$[]"](2)["$[]"]("target")})),y},3),h(u,"$_reduce_2",function(V,Z,y){return y=!1,y},3),h(u,"$_reduce_3",function(V,Z,y){return y=!0,y},3),h(u,"$_reduce_4",function(V,Z,y){return y=T([],{}),y},3),h(u,"$_reduce_5",function(V,Z,y){var K,P,j=this,O=t,re=t;return P=V,K=U(P),O=K[0]==null?t:K[0],re=K[1]==null?t:K[1],J(O)||j.$raise(s("ParseError")),y=T(["cmp_op","target"],{cmp_op:O,target:re}),y},3),h(u,"$_reduce_6",function(V,Z,y){var K=t;return K=V["$[]"](0),K.$push(V["$[]"](2)),y=K,y},3),h(u,"$_reduce_7",function(V,Z,y){return y=[V["$[]"](0)],y},3),h(u,"$_reduce_8",function(V,Z,y){var K=t,P=t;return K=V["$[]"](0),P=V["$[]"](2),y=r(s("Node"),"Notation").$new(K,P),y},3),h(u,"$_reduce_9",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"+",V["$[]"](2)),y},3),h(u,"$_reduce_10",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"-",V["$[]"](2)),y},3),h(u,"$_reduce_12",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"*",V["$[]"](2)),y},3),h(u,"$_reduce_13",function(V,Z,y){var K=t;return K=V["$[]"](3),y=K.$new(V["$[]"](0),V["$[]"](2)),y},3),h(u,"$_reduce_15",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),y},3),h(u,"$_reduce_16",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_17",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_18",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithRound"),y},3),h(u,"$_reduce_19",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithFloor"),y},3),h(u,"$_reduce_20",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_21",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Negative").$new(V["$[]"](1)),y},3),h(u,"$_reduce_23",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_24",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Number").$new(V["$[]"](0)),y},3),h(u,"$_reduce_none",function(V,Z,y){return V["$[]"](0)},3)}(R[0],r(f("Racc"),"Parser"),R)}(b[0],b)}(B[0],B)}(o[0],o)};Opal.modules["bcdice/common_command/barabara_dice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/common_command/barabara_dice/parser"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"BarabaraDice"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f,E])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/result"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.send,C=e.to_a,I=e.rb_minus,h=e.def;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W,S){var F=r(J,W,"Result"),B=[F].concat(S),X=F.$$prototype;return X.secret=X.success=X.failure=X.critical=X.fumble=o,function(L,w){return h(L,"$success",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$failure",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$critical",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"critical=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$fumble",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"fumble=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$nothing",function(){return"nothing"},0)}(e.get_singleton_class(F),B),h(F,"$initialize",function(w){var b=this;return w==null&&(w=o),b.text=w,b.rands=o,b.detailed_rands=o,b.secret=!1,b.success=!1,b.failure=!1,b.critical=!1,b.fumble=!1},-1),F.$attr_accessor("text","rands","detailed_rands"),F.$attr_writer("secret","success","failure","critical","fumble"),h(F,"$secret?",function(){var w=this;return w.secret},0),h(F,"$success?",function(){var w=this;return w.success},0),h(F,"$failure?",function(){var w=this;return w.failure},0),h(F,"$critical?",function(){var w=this;return w.critical},0),h(F,"$fumble?",function(){var w=this;return w.fumble},0),h(F,"$condition=",function(w){var b=this;return b.success=w,b.failure=w["$!"]()},1)}(U[0],null,U)}(A[0],A)};Opal.modules["bcdice/common_command/tally_dice/node"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.def,v=e.truthy,z=e.rb_gt,T=e.send,U=e.not,J=e.eqeq,W=e.to_a,S=e.rb_minus,F=e.alias;return A.$require("bcdice/result"),function(B,X){var L=r(B,"BCDice"),w=[L].concat(X);return function(b,M){var D=r(b,"CommonCommand"),G=[D].concat(M);return function(R,f){var E=r(R,"TallyDice"),g=[E].concat(f);return function(_,u){var c=r(_,"Node"),s=[c].concat(u);return function(i,n,$){var l=q(i,n,"Command"),d=[l].concat($),m=e.$r(d),k=l.$$prototype;return k.notation=t,C(d[0],"MAX_SIDES",20),h(l,"$initialize",function(Y){var a,N,p=this;if(Y==null)Y=I([],{});else if(!Y.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(Y.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(a=Y.$$smap.secret,!e.hasOwnProperty.call(Y.$$smap,"notation"))throw e.ArgumentError.$new("missing keyword: notation");return N=Y.$$smap.notation,p.secret=a,p.notation=N},1),h(l,"$eval",function(Y,a){var N=this,p=t,H=t,Q=t,ee=t,ne=t,V=t;return p=N.notation.$to_dice(Y.$round_type()),v(p["$valid?"]())?v(z(p.$sides(),m("MAX_SIDES")))?m("Result").$new("("+p+") \uFF1E \u9762\u6570\u306F1\u4EE5\u4E0A\u3001"+m("MAX_SIDES")+"\u4EE5\u4E0B\u3068\u3057\u3066\u304F\u3060\u3055\u3044"):(H=p.$roll(a),Q=(v(Y["$sort_barabara_dice?"]())?H.$sort():H).$join(","),ee=T(T(H,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),ne=T(e.Range.$new(1,p.$sides(),!1),"map",[],function(y){var K=t;return y==null&&(y=t),K=ee.$fetch(y,0),J(K,0)&&U(p["$show_zeros?"]())?t:"["+y+"]\xD7"+ee.$fetch(y,0)},1),V=["("+p+")",Q,ne.$compact().$join(", ")].$compact(),T(m("Result").$new(),"tap",[],function Z(y){var K=Z.$$s==null?this:Z.$$s,P=t;return K.secret==null&&(K.secret=t),y==null&&(y=t),P=[K.secret],T(y,"secret=",W(P)),P[S(P.length,1)],P=[V.$join(" \uFF1E ")],T(y,"text=",W(P)),P[S(P.length,1)]},{$$arity:1,$$s:N})):t},2)}(s[0],null,s),function(i,n,$){var l=q(i,n,"Notation"),d=[l].concat($),m=e.$r(d),k=l.$$prototype;return k.times=k.sides=k.show_zeros=t,l.$attr_reader("times"),l.$attr_reader("sides"),l.$attr_reader("show_zeros"),h(l,"$initialize",function(Y){var a,N,p,H=this;if(Y==null)Y=I([],{});else if(!Y.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(Y.$$smap,"times"))throw e.ArgumentError.$new("missing keyword: times");if(a=Y.$$smap.times,!e.hasOwnProperty.call(Y.$$smap,"sides"))throw e.ArgumentError.$new("missing keyword: sides");if(N=Y.$$smap.sides,!e.hasOwnProperty.call(Y.$$smap,"show_zeros"))throw e.ArgumentError.$new("missing keyword: show_zeros");return p=Y.$$smap.show_zeros,H.times=a,H.sides=N,H.show_zeros=p},1),h(l,"$to_dice",function(Y){var a=this,N=t,p=t;return N=a.times.$eval(Y),p=a.sides.$eval(Y),m("Dice").$new(I(["times","sides","show_zeros"],{times:N,sides:p,show_zeros:a.show_zeros}))},1)}(s[0],null,s),function(i,n){var $=q(i,n,"Dice"),l=$.$$prototype;return l.times=l.sides=l.show_zeros=t,$.$attr_reader("times"),$.$attr_reader("sides"),$.$attr_reader("show_zeros"),F($,"show_zeros?","show_zeros"),h($,"$initialize",function(m){var k,x,Y,a=this;if(m==null)m=I([],{});else if(!m.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(m.$$smap,"times"))throw e.ArgumentError.$new("missing keyword: times");if(k=m.$$smap.times,!e.hasOwnProperty.call(m.$$smap,"sides"))throw e.ArgumentError.$new("missing keyword: sides");if(x=m.$$smap.sides,!e.hasOwnProperty.call(m.$$smap,"show_zeros"))throw e.ArgumentError.$new("missing keyword: show_zeros");return Y=m.$$smap.show_zeros,a.times=k,a.sides=x,a.show_zeros=Y},1),h($,"$valid?",function(){var m=this,k=t;return v(k=z(m.times,0))?z(m.sides,0):k},0),h($,"$roll",function(m){var k=this;return m.$roll_barabara(k.times,k.sides)},1),h($,"$to_s",function(){var m=this,k=t;return k=v(m.show_zeros)?"Z":"Y",""+m.times+"T"+k+m.sides},0)}(s[0],null)}(g[0],g)}(G[0],G)}(w[0],w)}(o[0],o)};Opal.modules["bcdice/common_command/tally_dice/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set,T=e.hash2;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/tally_dice/node"),A.$require("bcdice/arithmetic/node"),function(U,J){var W=q(U,"BCDice"),S=[W].concat(J);return function(F,B){var X=q(F,"CommonCommand"),L=[X].concat(B);return function(w,b){var M=q(w,"TallyDice"),D=[M].concat(b),G=e.$r(D);return function(R,f,E){var g=C(R,f,"Parser"),_=[g].concat(E),u=e.$r(_),c=t,s=t,i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=g.$$prototype;return H.lexer=t,I(g,"$parse",function(ee){var ne=this;return ne.$new().$parse(ee)},1),h(g,"$parse",function(ee){var ne=this;try{return ne.lexer=u("Lexer").$new(ee),ne.$do_parse()}catch(V){if(e.rescue(V,[u("ParseError")]))try{return t}finally{e.pop_exception()}else throw V}},1),g.$private(),h(g,"$next_token",function(){var ee=this;return ee.lexer.$next_token()},0),c=[8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10],s=[2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6],i=[2,23,-2,t,30,t,47,-1,t,t,-2,-7,27,t,4,6,t,5,t,t,20,22,t,27,34,t,t,t,30,34,t,19,t,t,t,t,t],n=[-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17],$=[6,25,26,12,1,2,5,17,11,32,30,31,t,t,t,27,28,29],l=[4,8,8,7,1,2,3,5,6,9,8,8,t,t,t,4,7,7],d=[t,4,5,4,-2,-3,1,-4,-13,-22],m=[t,t,t,t,16,t,t,t,13,t],k=[0,0,"racc_error",2,18,"_reduce_1",0,19,"_reduce_2",1,19,"_reduce_3",4,20,"_reduce_4",1,22,"_reduce_5",1,22,"_reduce_6",3,23,"_reduce_7",3,23,"_reduce_8",1,23,"_reduce_none",3,24,"_reduce_10",4,24,"_reduce_11",1,24,"_reduce_none",0,26,"_reduce_13",1,26,"_reduce_14",1,26,"_reduce_15",1,26,"_reduce_16",1,26,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",1,25,"_reduce_none",3,21,"_reduce_21",1,21,"_reduce_22"],x=23,Y=37,a=v(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),N=17,p=!0,z(_[0],"Racc_arg",[c,s,n,i,$,l,m,d,N,k,a,Y,x,p]),z(_[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),z(_[0],"Racc_debug_parser",!1),h(g,"$_reduce_1",function(ee,ne,V){return V=r(u("Node"),"Command").$new(T(["secret","notation"],{secret:ee["$[]"](0),notation:ee["$[]"](1)})),V},3),h(g,"$_reduce_2",function(ee,ne,V){return V=!1,V},3),h(g,"$_reduce_3",function(ee,ne,V){return V=!0,V},3),h(g,"$_reduce_4",function(ee,ne,V){return V=r(u("Node"),"Notation").$new(T(["times","sides","show_zeros"],{times:ee["$[]"](0),sides:ee["$[]"](3),show_zeros:ee["$[]"](2)})),V},3),h(g,"$_reduce_5",function(ee,ne,V){return V=!1,V},3),h(g,"$_reduce_6",function(ee,ne,V){return V=!0,V},3),h(g,"$_reduce_7",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"+",ee["$[]"](2)),V},3),h(g,"$_reduce_8",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"-",ee["$[]"](2)),V},3),h(g,"$_reduce_10",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"*",ee["$[]"](2)),V},3),h(g,"$_reduce_11",function(ee,ne,V){var Z=t;return Z=ee["$[]"](3),V=Z.$new(ee["$[]"](0),ee["$[]"](2)),V},3),h(g,"$_reduce_13",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),V},3),h(g,"$_reduce_14",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithCeil"),V},3),h(g,"$_reduce_15",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithCeil"),V},3),h(g,"$_reduce_16",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithRound"),V},3),h(g,"$_reduce_17",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithFloor"),V},3),h(g,"$_reduce_18",function(ee,ne,V){return V=ee["$[]"](1),V},3),h(g,"$_reduce_19",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"Negative").$new(ee["$[]"](1)),V},3),h(g,"$_reduce_21",function(ee,ne,V){return V=ee["$[]"](1),V},3),h(g,"$_reduce_22",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"Number").$new(ee["$[]"](0)),V},3),h(g,"$_reduce_none",function(ee,ne,V){return ee["$[]"](0)},3)}(D[0],r(G("Racc"),"Parser"),D)}(L[0],L)}(S[0],S)}(o[0],o)};Opal.modules["bcdice/common_command/tally_dice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/common_command/tally_dice/parser"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"TallyDice"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f,E])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/common_command/calc/node"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.hash2,h=e.def,v=e.truthy,z=e.send,T=e.to_a,U=e.rb_minus;return A.$require("bcdice/arithmetic/node"),function(J,W){var S=q(J,"BCDice"),F=[S].concat(W);return function(B,X){var L=q(B,"CommonCommand"),w=[L].concat(X);return function(b,M){var D=q(b,"Calc"),G=[D].concat(M);return function(R,f){var E=q(R,"Node"),g=[E].concat(f);return function(_,u,c){var s=C(_,u,"Command"),i=[s].concat(c),n=e.$r(i),$=s.$$prototype;return $.expr=t,h(s,"$initialize",function(d){var m,k,x=this;if(d==null)d=I([],{});else if(!d.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(d.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(m=d.$$smap.secret,!e.hasOwnProperty.call(d.$$smap,"expr"))throw e.ArgumentError.$new("missing keyword: expr");return k=d.$$smap.expr,x.secret=m,x.expr=k},1),h(s,"$eval",function(d){var m=this,k=t,x=t;return k=function(){try{return m.expr.$eval(d).$to_i()}catch(Y){if(e.rescue(Y,[n("ZeroDivisionError")]))try{return"\u30BC\u30ED\u9664\u7B97\u304C\u767A\u751F\u3057\u305F\u305F\u3081\u8A08\u7B97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F"}finally{e.pop_exception()}else throw Y}}(),x=v(m.expr["$is_a?"](r(r(n("Arithmetic"),"Node"),"Parenthesis")))?m.expr.$output():"("+m.expr.$output()+")",z(n("Result").$new(),"tap",[],function Y(a){var N=Y.$$s==null?this:Y.$$s,p=t;return N.secret==null&&(N.secret=t),a==null&&(a=t),p=[N.secret],z(a,"secret=",T(p)),p[U(p.length,1)],p=["c"+x+" \uFF1E "+k],z(a,"text=",T(p)),p[U(p.length,1)]},{$$arity:1,$$s:m})},1)}(g[0],null,g)}(G[0],G)}(w[0],w)}(F[0],F)}(o[0],o)};Opal.modules["bcdice/common_command/calc/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set,T=e.hash2;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/calc/node"),A.$require("bcdice/arithmetic/node"),function(U,J){var W=q(U,"BCDice"),S=[W].concat(J);return function(F,B){var X=q(F,"CommonCommand"),L=[X].concat(B);return function(w,b){var M=q(w,"Calc"),D=[M].concat(b),G=e.$r(D);return function(R,f,E){var g=C(R,f,"Parser"),_=[g].concat(E),u=e.$r(_),c=t,s=t,i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=g.$$prototype;return H.lexer=t,I(g,"$parse",function(ee){var ne=this;return ne.$new().$parse(ee)},1),h(g,"$parse",function(ee){var ne=this;try{return ne.lexer=u("Lexer").$new(ee),ne.$do_parse()}catch(V){if(e.rescue(V,[u("ParseError")]))try{return t}finally{e.pop_exception()}else throw V}},1),g.$private(),h(g,"$next_token",function(){var ee=this;return ee.lexer.$next_token()},0),c=[14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,t,10,11,10,11,13,t,13,15,16,t,t,t,26,30,28,29,31],s=[5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,t,17,17,18,18,17,t,18,21,21,t,t,t,21,25,25,25,25],i=[-6,5,11,t,27,-2,t,-5,4,t,0,9,t,11,t,20,22,31,33,t,t,38,15,26,t,49,t,t,t,t,t,t],n=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],$=[7,1,19,20,22,23,2,27,21,24,25],l=[3,1,5,5,4,4,2,6,3,5,5],d=[t,1,6,-5,-11,-8,-18,t],m=[t,t,t,t,8,9,t,12],k=[0,0,"racc_error",3,15,"_reduce_1",0,16,"_reduce_2",1,16,"_reduce_3",3,17,"_reduce_4",3,17,"_reduce_5",1,17,"_reduce_none",3,18,"_reduce_7",4,18,"_reduce_8",1,18,"_reduce_none",0,20,"_reduce_10",1,20,"_reduce_11",1,20,"_reduce_12",1,20,"_reduce_13",1,20,"_reduce_14",2,19,"_reduce_15",2,19,"_reduce_16",1,19,"_reduce_none",3,21,"_reduce_18",1,21,"_reduce_19"],x=20,Y=32,a=v(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),N=14,p=!0,z(_[0],"Racc_arg",[c,s,n,i,$,l,m,d,N,k,a,Y,x,p]),z(_[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),z(_[0],"Racc_debug_parser",!1),h(g,"$_reduce_1",function(ee,ne,V){return V=r(u("Node"),"Command").$new(T(["secret","expr"],{secret:ee["$[]"](0),expr:ee["$[]"](2)})),V},3),h(g,"$_reduce_2",function(ee,ne,V){return V=!1,V},3),h(g,"$_reduce_3",function(ee,ne,V){return V=!0,V},3),h(g,"$_reduce_4",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"+",ee["$[]"](2)),V},3),h(g,"$_reduce_5",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"-",ee["$[]"](2)),V},3),h(g,"$_reduce_7",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"BinaryOp").$new(ee["$[]"](0),"*",ee["$[]"](2)),V},3),h(g,"$_reduce_8",function(ee,ne,V){var Z=t;return Z=ee["$[]"](3),V=Z.$new(ee["$[]"](0),ee["$[]"](2)),V},3),h(g,"$_reduce_10",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),V},3),h(g,"$_reduce_11",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithCeil"),V},3),h(g,"$_reduce_12",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithCeil"),V},3),h(g,"$_reduce_13",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithRound"),V},3),h(g,"$_reduce_14",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"DivideWithFloor"),V},3),h(g,"$_reduce_15",function(ee,ne,V){return V=ee["$[]"](1),V},3),h(g,"$_reduce_16",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"Negative").$new(ee["$[]"](1)),V},3),h(g,"$_reduce_18",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"Parenthesis").$new(ee["$[]"](1)),V},3),h(g,"$_reduce_19",function(ee,ne,V){return V=r(r(u("Arithmetic"),"Node"),"Number").$new(ee["$[]"](0)),V},3),h(g,"$_reduce_none",function(ee,ne,V){return ee["$[]"](0)},3)}(D[0],r(G("Racc"),"Parser"),D)}(L[0],L)}(S[0],S)}(o[0],o)};Opal.modules["bcdice/common_command/calc"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/common_command/calc/parser"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"Calc"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f.$round_type()])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/common_command/choice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.const_set,h=e.hash2,v=e.send,z=e.def,T=e.truthy,U=e.eqeq,J=e.eqeqeq,W=e.rb_lt,S=e.rb_gt,F=e.to_a,B=e.rb_minus;return A.$require("strscan"),function(X,L){var w=q(X,"BCDice"),b=[w].concat(L);return function(M,D){var G=q(M,"CommonCommand"),R=[G].concat(D);return function(f,E,g){var _=C(f,E,"Choice"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;return s.items=s.takes=s.block_delimiter=t,I(u[0],"PREFIX_PATTERN",/choice/.$freeze()),function(i,n){var $=q(i,"BlockDelimiter"),l=[$].concat(n);return I(l[0],"BRACKET","bracket"),I(l[0],"PAREN","paren"),I(l[0],"SPACE","space")}(u[0],u),I(u[0],"DELIMITER",h(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),I(u[0],"DELIMITER_CHAR",h(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),I(u[0],"TERMINATION",h(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),I(u[0],"SUFFIX",h(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(i,n){var $=[i].concat(n),l=e.$r($);return z(i,"$eval",function(m,k,x){var Y,a=this,N=t;return N=a.$parse(m),Y=N,Y===t||Y==null?t:v(Y,"roll",[x])},3),i.$private(),z(i,"$parse",function(m){var k,x,Y=this,a=t,N=t,p=t,H=t,Q=t,ee=t,ne=t,V=t,Z=t,y=t;if(a=l("StringScanner").$new(m),a.$skip(/\s+/),N=a.$scan(/S/i)["$nil?"]()["$!"](),!T(a.$scan(/choice/i))||(p=T(H=(k=a.$scan(/\d+/),k===t||k==null?t:v(k,"to_i",[])))?H:1,U(p,0)))return t;for(Q=function(){return J("[",H=a.$scan(/\(|\[|\s+/))?r(l("BlockDelimiter"),"BRACKET"):J("(",H)?r(l("BlockDelimiter"),"PAREN"):J(l("String"),H)?r(l("BlockDelimiter"),"SPACE"):t}(),ee=l("DELIMITER")["$[]"](Q),ne=l("TERMINATION")["$[]"](Q),V=[];T(Z=a.$scan_until(ee));)V.$push(Z.$delete_suffix(","));return y=a.$scan_until(ne),!T(y)||(V.$push(y.$delete_suffix(l("SUFFIX")["$[]"](Q))),V=v(v(V,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),U(V.$size(),1)&&(V=Y.$parse_multi_item_shorthand(V.$first())),T(V["$empty?"]())||T(W(V.$size(),p)))?t:Y.$new(h(["secret","block_delimiter","takes","items"],{secret:N,block_delimiter:Q,takes:p,items:V}))},1),z(i,"$parse_multi_item_shorthand",function(m){var k=this,x=t,Y=t;return T(x=T(Y=k.$parse_multi_nums_shorthand(m))?Y:k.$parse_multi_chars_shorthand(m))?x:[]},1),z(i,"$parse_multi_nums_shorthand",function(m){var k=t,x=t,Y=t;return k=/^(\d+)-(\d+)$/.$match(m),!T(k)||(x=k["$[]"](1).$to_i(),Y=k["$[]"](2).$to_i(),T(S(x,Y)))?t:x.$upto(Y).$to_a()},1),z(i,"$parse_multi_chars_shorthand",function(m){var k=t,x=t,Y=t,a=t;return k=T(x=/^([a-z])-([a-z])$/.$match(m))?x:/^([A-Z])-([A-Z])$/.$match(m),!T(k)||(Y=k["$[]"](1),a=k["$[]"](2),T(S(Y,a)))?t:Y.$upto(a).$to_a()},1)}(e.get_singleton_class(_),u),z(_,"$initialize",function(n){var $,l,d,m,k=this;if(n==null)n=h([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(n.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if($=n.$$smap.secret,!e.hasOwnProperty.call(n.$$smap,"block_delimiter"))throw e.ArgumentError.$new("missing keyword: block_delimiter");if(l=n.$$smap.block_delimiter,!e.hasOwnProperty.call(n.$$smap,"takes"))throw e.ArgumentError.$new("missing keyword: takes");if(d=n.$$smap.takes,!e.hasOwnProperty.call(n.$$smap,"items"))throw e.ArgumentError.$new("missing keyword: items");return m=n.$$smap.items,k.secret=$,k.block_delimiter=l,k.takes=d,k.items=m},1),z(_,"$roll",function(n){var $=this,l=t,d=t;return T(S($.items.$size(),100))?c("Result").$new("\u9805\u76EE\u6570\u306F100\u4EE5\u4E0B\u3068\u3057\u3066\u304F\u3060\u3055\u3044"):(l=$.items.$dup(),d=[],v($.takes,"times",[],function(){var k=t;return k=n.$roll_index(l.$size()),d["$<<"](l.$delete_at(k))},0),v(c("Result").$new(),"tap",[],function m(k){var x=m.$$s==null?this:m.$$s,Y=t,a=t;return x.block_delimiter==null&&(x.block_delimiter=t),x.secret==null&&(x.secret=t),k==null&&(k=t),Y=d.$join(c("DELIMITER_CHAR")["$[]"](x.block_delimiter)),a=[x.secret],v(k,"secret=",F(a)),a[B(a.length,1)],a=["("+x.$expr()+") \uFF1E "+Y],v(k,"text=",F(a)),a[B(a.length,1)]},{$$arity:1,$$s:$}))},1),z(_,"$expr",function(){var n=this,$=t,l=t;return $=U(n.takes,1)?t:n.takes,J(r(c("BlockDelimiter"),"SPACE"),l=n.block_delimiter)?"choice"+$+" "+n.items.$join(" "):J(r(c("BlockDelimiter"),"BRACKET"),l)?"choice"+$+"["+n.items.$join(",")+"]":J(r(c("BlockDelimiter"),"PAREN"),l)?"choice"+$+"("+n.items.$join(",")+")":t},0)}(R[0],null,R)}(b[0],b)}(o[0],o)};Opal.modules["bcdice/common_command/d66_dice"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.const_set,I=e.send,h=e.def,v=e.truthy,z=e.hash2,T=e.eqeqeq,U=e.to_a,J=e.rb_minus,W=e.rb_plus,S=e.rb_times;return function(F,B){var X=r(F,"BCDice"),L=[X].concat(B);return function(w,b){var M=r(w,"CommonCommand"),D=[M].concat(b);return function(G,R,f){var E=q(G,R,"D66Dice"),g=[E].concat(f),_=e.$r(g),u=E.$$prototype;return u.sort_type=o,C(g[0],"PREFIX_PATTERN",/D66/.$freeze()),function(c,s){var i=[c].concat(s),n=e.$r(i);return h(c,"$eval",function(l,d,m){var k,x=this,Y=o;return Y=x.$parse(l,d),k=Y,k===o||k==null?o:I(k,"eval",[m])},3),c.$private(),h(c,"$parse",function(l,d){var m=this,k=o,x=o;return l=l.$split(" ",2).$first(),k=/^(S)?D66([ANSD])?$/i.$match(l.$upcase()),v(k)?m.$new(z(["secret","sort_type","suffix"],{secret:k["$[]"](1)["$nil?"]()["$!"](),sort_type:v(x=m.$sort_type_from_suffix(k["$[]"](2)))?x:d.$d66_sort_type(),suffix:k["$[]"](2)})):o},2),h(c,"$sort_type_from_suffix",function(l){var d=o;return T("A",d=l)||T("S",d)?t(n("D66SortType"),"ASC"):T("D",d)?t(n("D66SortType"),"DESC"):T("N",d)?t(n("D66SortType"),"NO_SORT"):o},1)}(e.get_singleton_class(E),g),h(E,"$initialize",function(s){var i,n,$,l=this;if(s==null)s=z([],{});else if(!s.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(s.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(i=s.$$smap.secret,!e.hasOwnProperty.call(s.$$smap,"sort_type"))throw e.ArgumentError.$new("missing keyword: sort_type");if(n=s.$$smap.sort_type,!e.hasOwnProperty.call(s.$$smap,"suffix"))throw e.ArgumentError.$new("missing keyword: suffix");return $=s.$$smap.suffix,l.secret=i,l.sort_type=n,l.suffix=$},1),h(E,"$eval",function(s){var i=this,n=o;return n=i.$roll(s),I(_("Result").$new(),"tap",[],function $(l){var d=$.$$s==null?this:$.$$s,m=o;return d.secret==null&&(d.secret=o),d.suffix==null&&(d.suffix=o),l==null&&(l=o),m=[d.secret],I(l,"secret=",U(m)),m[J(m.length,1)],m=["(D66"+d.suffix+") \uFF1E "+n],I(l,"text=",U(m)),m[J(m.length,1)]},{$$arity:1,$$s:i})},1),E.$private(),h(E,"$roll",function(s){var i=this,n=o,$=o;return n=I(_("Array"),"new",[2],function(){return s.$roll_once(6)},0),T(t(_("D66SortType"),"ASC"),$=i.sort_type)?n["$sort!"]():T(t(_("D66SortType"),"DESC"),$)&&n["$sort!"]()["$reverse!"](),W(S(n["$[]"](0),10),n["$[]"](1))},1)}(D[0],null,D)}(L[0],L)}(A[0],A)};Opal.modules["bcdice/common_command/repeat"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.send,h=e.def,v=e.truthy,z=e.hash2,T=e.to_a,U=e.rb_minus,J=e.eqeq,W=e.rb_lt;return A.$require("strscan"),function(S,F){var B=r(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=r(L,"CommonCommand"),M=[b].concat(w);return function(D,G,R){var f=q(D,G,"Repeat"),E=[f].concat(R),g=e.$r(E),_=f.$$prototype;return _.times=_.trailer=_.secret=t,C(E[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),C(E[0],"REPEAT_LIMIT",100),function(u,c){var s=[u].concat(c),i=e.$r(s);return h(u,"$eval",function($,l,d){var m,k=this,x=t;return x=k.$parse($),m=x,m===t||m==null?t:I(m,"roll",[l,d])},3),u.$private(),h(u,"$parse",function($){var l,d=this,m=t,k=t,x=t,Y=t,a=t,N=t;return m=i("StringScanner").$new($),k=m.$scan(/s/i)["$nil?"]()["$!"](),x=m.$scan(/repeat|rep|x/i),Y=(l=m.$scan(/\d+/),l===t||l==null?t:I(l,"to_i",[])),a=m.$scan(/\s+/),v(x["$nil?"]())||v(Y["$nil?"]())||v(a["$nil?"]())||(N=m.$post_match(),v(N["$nil?"]())||v(N["$empty?"]()))?t:d.$new(z(["secret","times","trailer"],{secret:k,times:Y,trailer:N}))},1)}(e.get_singleton_class(f),E),h(f,"$initialize",function(c){var s,i,n,$=this;if(c==null)c=z([],{});else if(!c.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(c.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(s=c.$$smap.secret,!e.hasOwnProperty.call(c.$$smap,"times"))throw e.ArgumentError.$new("missing keyword: times");if(i=c.$$smap.times,!e.hasOwnProperty.call(c.$$smap,"trailer"))throw e.ArgumentError.$new("missing keyword: trailer");return n=c.$$smap.trailer,$.secret=s,$.times=i,$.trailer=n},1),h(f,"$roll",function(c,s){var i=this,n=t,$=t,l=t,d=t,m=t;return n=i.$validate(),v(n)?n:($=I(g("Array"),"new",[i.times],function k(){var x=k.$$s==null?this:k.$$s,Y=t,a=t;return x.trailer==null&&(x.trailer=t),Y=c.$class().$new(x.trailer),a=[s],I(Y,"randomizer=",T(a)),a[U(a.length,1)],Y.$eval()},{$$arity:0,$$s:i}),J(I($,"count",[],function(x){return x==null&&(x=t),x["$=="](t)},1),i.times)?i.$result_with_text("\u7E70\u308A\u8FD4\u3057\u5BFE\u8C61\u306E\u30B3\u30DE\u30F3\u30C9\u304C\u5B9F\u884C\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F ("+i.trailer+")"):(l=I($.$map(),"with_index",[1],function(x,Y){return x==null&&(x=t),Y==null&&(Y=t),"#"+Y+`
`+x.$text()},2).$join(`

`),d=v(m=i.secret)?m:I($,"any?",[],"secret?".$to_proc()),I(g("Result").$new(),"tap",[],function(x){var Y=t;return x==null&&(x=t),Y=[d],I(x,"secret=",T(Y)),Y[U(Y.length,1)],Y=[l],I(x,"text=",T(Y)),Y[U(Y.length,1)]},1)))},2),f.$private(),h(f,"$validate",function(){var c=this;return v(/^(repeat|rep|x)\d+/["$match?"](c.trailer))?c.$result_with_text("Repeat\u30B3\u30DE\u30F3\u30C9\u306E\u91CD\u8907\u306F\u3067\u304D\u307E\u305B\u3093"):v(W(c.times,1))||v(W(g("REPEAT_LIMIT"),c.times))?c.$result_with_text("\u7E70\u308A\u8FD4\u3057\u56DE\u6570\u306F1\u4EE5\u4E0A\u3001"+g("REPEAT_LIMIT")+"\u4EE5\u4E0B\u3068\u3057\u3066\u304F\u3060\u3055\u3044"):t},0),h(f,"$result_with_text",function(c){var s=this;return I(g("Result").$new(),"tap",[],function i(n){var $=i.$$s==null?this:i.$$s,l=t;return $.secret==null&&($.secret=t),n==null&&(n=t),l=[$.secret],I(n,"secret=",T(l)),l[U(l.length,1)],l=[c],I(n,"text=",T(l)),l[U(l.length,1)]},{$$arity:1,$$s:s})},1)}(M[0],null,M)}(X[0],X)}(o[0],o)};Opal.modules["bcdice/format"]=function(e){var A=[],o=e.nil,t=e.module,r=e.eqeqeq,q=e.def,C=e.truthy,I=e.eqeq,h=e.rb_gt;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=t(J,"Format"),F=[S].concat(W),B=e.$r(F);return S.$module_function(),q(S,"$comparison_operator",function(L){var w=o;return r("==",w=L)?"=":r("!=",w)?"<>":r(B("Symbol"),w)?L.$to_s():o},1),q(S,"$modifier",function(L){return C(L["$nil?"]())?o:I(L,0)?"":C(h(L,0))?"+"+L:L.$to_s()},1)}(U[0],U)}(A[0],A)};Opal.modules["bcdice/common_command/barabara_dice/result"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.send2,h=e.find_super,v=e.def;return A.$require("bcdice/result"),function(z,T){var U=q(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=q(W,"CommonCommand"),B=[F].concat(S);return function(X,L){var w=q(X,"BarabaraDice"),b=[w].concat(L);return function(M,D){var G=C(M,D,"Result");return G.$attr_accessor("last_dice_list_list"),G.$attr_accessor("last_dice_list"),G.$attr_accessor("success_num"),v(G,"$initialize",function R(f){var E=R.$$p||t,g=this;return delete R.$$p,f==null&&(f=t),I(g,h(g,"initialize",R,!1,!0),"initialize",[f],null),g.last_dice_list_list=[],g.last_dice_list=[],g.success_num=0},-1)}(b[0],r(r("BCDice"),"Result"))}(B[0],B)}(J[0],J)}(o[0],o)};Opal.modules["bcdice/common_command/barabara_dice/node"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.def,h=e.send,v=e.truthy,z=e.to_a,T=e.rb_minus;return A.$require("bcdice/format"),A.$require("bcdice/common_command/barabara_dice/result"),function(U,J){var W=r(U,"BCDice"),S=[W].concat(J);return function(F,B){var X=r(F,"CommonCommand"),L=[X].concat(B);return function(w,b){var M=r(w,"BarabaraDice"),D=[M].concat(b);return function(G,R){var f=r(G,"Node"),E=[f].concat(R);return function(g,_,u){var c=q(g,_,"Command"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.notations=n.cmp_op=n.target_number=t,I(c,"$initialize",function(l){var d,m,k,x,Y=this;if(l==null)l=C([],{});else if(!l.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(l.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(d=l.$$smap.secret,!e.hasOwnProperty.call(l.$$smap,"notations"))throw e.ArgumentError.$new("missing keyword: notations");if(m=l.$$smap.notations,!e.hasOwnProperty.call(l.$$smap,"cmp_op"))throw e.ArgumentError.$new("missing keyword: cmp_op");if(k=l.$$smap.cmp_op,!e.hasOwnProperty.call(l.$$smap,"target_number"))throw e.ArgumentError.$new("missing keyword: target_number");return x=l.$$smap.target_number,Y.secret=d,Y.notations=m,Y.cmp_op=k,Y.target_number=x},1),I(c,"$eval",function(l,d){var m,k=this,x=t,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=t,ne=t,V=t,Z=t;return x=l.$round_type(),Y=h(k.notations,"map",[],function(K){return K==null&&(K=t),K.$to_dice(x)},1),a=v(N=k.cmp_op)?N:l.$default_cmp_op(),p=v(N=(m=k.target_number,m===t||m==null?t:h(m,"eval",[x])))?N:l.$default_target_number(),H=h(Y,"map",[],function(K){return K==null&&(K=t),K.$roll(d)},1),v(l["$sort_barabara_dice?"]())&&h(H,"map!",[],"sort".$to_proc()),Q=H.$flatten(),ee=Q.$count(1),ne=v(a)?h(Q,"count",[],function(K){return K==null&&(K=t),K.$send(a,p)},1):0,v(a)&&(V="\u6210\u529F\u6570"+ne),Z=["("+Y.$join("+")+i("Format").$comparison_operator(a)+p+")",Q.$join(","),V,l.$grich_text(ee,Q.$size(),ne)].$compact(),h(i("Result").$new(),"tap",[],function y(K){var P=y.$$s==null?this:y.$$s,j=t;return P.secret==null&&(P.secret=t),K==null&&(K=t),j=[P.secret],h(K,"secret=",z(j)),j[T(j.length,1)],j=[Z.$join(" \uFF1E ")],h(K,"text=",z(j)),j[T(j.length,1)],j=[H],h(K,"last_dice_list_list=",z(j)),j[T(j.length,1)],j=[Q],h(K,"last_dice_list=",z(j)),j[T(j.length,1)],j=[ne],h(K,"success_num=",z(j)),j[T(j.length,1)]},{$$arity:1,$$s:k})},2)}(E[0],null,E),function(g,_,u){var c=q(g,_,"Notation"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.times=n.sides=t,I(c,"$initialize",function(l,d){var m=this;return m.times=l,m.sides=d},2),I(c,"$to_dice",function(l){var d=this,m=t,k=t;return m=d.times.$eval(l),k=d.sides.$eval(l),i("Dice").$new(m,k)},1)}(E[0],null,E),function(g,_){var u=q(g,_,"Dice"),c=u.$$prototype;return c.times=c.sides=t,I(u,"$initialize",function(i,n){var $=this;return $.times=i,$.sides=n},2),I(u,"$roll",function(i){var n=this;return i.$roll_barabara(n.times,n.sides)},1),I(u,"$to_s",function(){var i=this;return""+i.times+"B"+i.sides},0)}(E[0],null)}(D[0],D)}(L[0],L)}(S[0],S)}(o[0],o)};Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set,T=e.hash2,U=e.to_ary,J=e.truthy;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/barabara_dice/node"),A.$require("bcdice/arithmetic/node"),function(W,S){var F=q(W,"BCDice"),B=[F].concat(S);return function(X,L){var w=q(X,"CommonCommand"),b=[w].concat(L);return function(M,D){var G=q(M,"RerollDice"),R=[G].concat(D),f=e.$r(R);return function(E,g,_){var u=C(E,g,"Parser"),c=[u].concat(_),s=e.$r(c),i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=u.$$prototype;return ee.lexer=t,I(u,"$parse",function(V){var Z=this;return Z.$new().$parse(V)},1),h(u,"$parse",function(V){var Z=this;try{return Z.lexer=s("Lexer").$new(V),Z.$do_parse()}catch(y){if(e.rescue(y,[s("ParseError")]))try{return t}finally{e.pop_exception()}else throw y}},1),u.$private(),h(u,"$next_token",function(){var V=this;return V.lexer.$next_token()},0),i=[9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,t,8,34,35,9,20,21,31,32,8,20,21,9,t,8,t,31,32,20,21,31,32,8,40,t,t,t,47,51,49,50,52],n=[14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,t,32,43,43,35,34,34,46,46,34,35,35,39,t,35,t,27,27,39,39,41,41,39,27,t,t,t,41,45,45,45,45],$=[-6,17,1,t,20,-3,t,30,14,t,t,18,30,22,-2,2,13,19,30,t,27,35,t,t,0,t,37,72,40,t,t,48,53,t,61,66,t,t,45,74,t,76,48,56,t,89,63,t,t,t,t,t,t],l=[-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25],d=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,t,t,t,t,t,t,t,46],m=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,t,t,t,t,t,t,t,7],k=[t,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],x=[t,t,t,t,t,t,t,t,t,22,18,19,t],Y=[0,0,"racc_error",3,23,"_reduce_1",4,23,"_reduce_2",4,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",2,26,"_reduce_7",3,27,"_reduce_8",4,27,"_reduce_9",2,28,"_reduce_10",3,28,"_reduce_11",3,25,"_reduce_12",1,25,"_reduce_13",3,30,"_reduce_14",3,29,"_reduce_15",3,29,"_reduce_16",1,29,"_reduce_none",3,32,"_reduce_18",4,32,"_reduce_19",1,32,"_reduce_none",0,34,"_reduce_21",1,34,"_reduce_22",1,34,"_reduce_23",1,34,"_reduce_24",1,34,"_reduce_25",2,33,"_reduce_26",2,33,"_reduce_27",1,33,"_reduce_none",3,31,"_reduce_29",1,31,"_reduce_30"],a=31,N=53,p=v(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),H=22,Q=!0,z(c[0],"Racc_arg",[i,n,l,$,d,m,x,k,H,Y,p,N,a,Q]),z(c[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","bracket","at","add","dice","term","mul","unary","round_type"]),z(c[0],"Racc_debug_parser",!1),h(u,"$_reduce_1",function(V,Z,y){var K=this;return y=r(s("Node"),"Command").$new(T(["secret","notations","cmp_op","target_number","source"],{secret:V["$[]"](0),notations:V["$[]"](1),cmp_op:V["$[]"](2)["$[]"]("cmp_op"),target_number:V["$[]"](2)["$[]"]("target"),source:K.lexer.$source()})),y},3),h(u,"$_reduce_2",function(V,Z,y){var K=this,P=t,j=t;return P=V["$[]"](3),j=V["$[]"](2),y=r(s("Node"),"Command").$new(T(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:V["$[]"](0),notations:V["$[]"](1),cmp_op:P["$[]"]("cmp_op"),target_number:P["$[]"]("target"),reroll_cmp_op:j["$[]"]("cmp_op"),reroll_threshold:j["$[]"]("threshold"),source:K.lexer.$source()})),y},3),h(u,"$_reduce_3",function(V,Z,y){var K=this,P=t,j=t;return P=V["$[]"](2),j=V["$[]"](3),y=r(s("Node"),"Command").$new(T(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:V["$[]"](0),notations:V["$[]"](1),cmp_op:P["$[]"]("cmp_op"),target_number:P["$[]"]("target"),reroll_cmp_op:j["$[]"]("cmp_op"),reroll_threshold:j["$[]"]("threshold"),source:K.lexer.$source()})),y},3),h(u,"$_reduce_4",function(V,Z,y){return y=!1,y},3),h(u,"$_reduce_5",function(V,Z,y){return y=!0,y},3),h(u,"$_reduce_6",function(V,Z,y){return y=T([],{}),y},3),h(u,"$_reduce_7",function(V,Z,y){var K,P,j=this,O=t,re=t;return P=V,K=U(P),O=K[0]==null?t:K[0],re=K[1]==null?t:K[1],J(O)||j.$raise(s("ParseError")),y=T(["cmp_op","target"],{cmp_op:O,target:re}),y},3),h(u,"$_reduce_8",function(V,Z,y){return y=T(["threshold"],{threshold:V["$[]"](1)}),y},3),h(u,"$_reduce_9",function(V,Z,y){var K=this,P=t,j=t;return P=V["$[]"](1),j=V["$[]"](2),J(P)||K.$raise(s("ParseError")),y=T(["cmp_op","threshold"],{cmp_op:P,threshold:j}),y},3),h(u,"$_reduce_10",function(V,Z,y){return y=T(["threshold"],{threshold:V["$[]"](1)}),y},3),h(u,"$_reduce_11",function(V,Z,y){var K=this,P=t,j=t;return P=V["$[]"](1),j=V["$[]"](2),J(P)||K.$raise(s("ParseError")),y=T(["cmp_op","threshold"],{cmp_op:P,threshold:j}),y},3),h(u,"$_reduce_12",function(V,Z,y){var K=t;return K=V["$[]"](0),K.$push(V["$[]"](2)),y=K,y},3),h(u,"$_reduce_13",function(V,Z,y){return y=[V["$[]"](0)],y},3),h(u,"$_reduce_14",function(V,Z,y){var K=t,P=t;return K=V["$[]"](0),P=V["$[]"](2),y=r(s("Node"),"Notation").$new(K,P),y},3),h(u,"$_reduce_15",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"+",V["$[]"](2)),y},3),h(u,"$_reduce_16",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"-",V["$[]"](2)),y},3),h(u,"$_reduce_18",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"*",V["$[]"](2)),y},3),h(u,"$_reduce_19",function(V,Z,y){var K=t;return K=V["$[]"](3),y=K.$new(V["$[]"](0),V["$[]"](2)),y},3),h(u,"$_reduce_21",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),y},3),h(u,"$_reduce_22",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_23",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_24",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithRound"),y},3),h(u,"$_reduce_25",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithFloor"),y},3),h(u,"$_reduce_26",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_27",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Negative").$new(V["$[]"](1)),y},3),h(u,"$_reduce_29",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_30",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Number").$new(V["$[]"](0)),y},3),h(u,"$_reduce_none",function(V,Z,y){return V["$[]"](0)},3)}(R[0],r(f("Racc"),"Parser"),R)}(b[0],b)}(B[0],B)}(o[0],o)};Opal.modules["bcdice/common_command/reroll_dice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/normalize"),A.$require("bcdice/format"),A.$require("bcdice/common_command/reroll_dice/parser"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"RerollDice"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),q(L[0],"REROLL_LIMIT",1e4),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f,E])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/common_command/upper_dice/node"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.def,I=e.send,h=e.truthy,v=e.rb_le,z=e.rb_plus,T=e.eqeq,U=e.to_a,J=e.rb_minus,W=e.rb_lt;return function(S,F){var B=t(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=t(L,"CommonCommand"),M=[b].concat(w);return function(D,G){var R=t(D,"UpperDice"),f=[R].concat(G);return function(E,g){var _=t(E,"Node"),u=[_].concat(g);return function(c,s,i){var n=r(c,s,"Command"),$=[n].concat(i),l=e.$r($),d=n.$$prototype;return d.notations=d.reroll_threshold=d.modifier=d.target_number=d.cmp_op=o,C(n,"$initialize",function(k){var x,Y,a,N,p,H,Q=this;if(k==null)k=q([],{});else if(!k.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(k.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(x=k.$$smap.secret,!e.hasOwnProperty.call(k.$$smap,"notations"))throw e.ArgumentError.$new("missing keyword: notations");if(Y=k.$$smap.notations,!e.hasOwnProperty.call(k.$$smap,"modifier"))throw e.ArgumentError.$new("missing keyword: modifier");if(a=k.$$smap.modifier,!e.hasOwnProperty.call(k.$$smap,"cmp_op"))throw e.ArgumentError.$new("missing keyword: cmp_op");if(N=k.$$smap.cmp_op,!e.hasOwnProperty.call(k.$$smap,"target_number"))throw e.ArgumentError.$new("missing keyword: target_number");return p=k.$$smap.target_number,H=k.$$smap.reroll_threshold,H==null&&(H=o),Q.secret=x,Q.notations=Y,Q.modifier=a,Q.cmp_op=N,Q.target_number=p,Q.reroll_threshold=H},1),C(n,"$eval",function(k,x){var Y,a,N,p=this,H=o,Q=o,ee=o,ne=o,V=o,Z=o,y=o,K=o,P=o,j=o,O=o;return H=k.$round_type(),Q=I(p.notations,"map",[],function(te){return te==null&&(te=o),te.$to_dice(H)},1),ee=h(ne=h(V=(Y=p.reroll_threshold,Y===o||Y==null?o:I(Y,"eval",[H])))?V:k.$upper_dice_reroll_threshold())?ne:0,Z=h(ne=(a=p.modifier,a===o||a==null?o:I(a,"eval",[H])))?ne:0,y=(N=p.target_number,N===o||N==null?o:I(N,"eval",[H])),K=p.$expr(Q,ee,Z,y),h(v(ee,1))?p.$result_with_text("("+K+") \uFF1E \u7121\u9650\u30ED\u30FC\u30EB\u306E\u6761\u4EF6\u304C\u307E\u3061\u304C\u3063\u3066\u3044\u307E\u3059"):(P=I(Q,"map",[],function(te){return te==null&&(te=o),te.$roll(x,ee,k["$sort_barabara_dice?"]())},1).$reduce([],"concat"),j=h(p.cmp_op)?p.$result_success_count(P,Z,y):p.$result_max_sum(P,Z),O=["("+K+")",p.$interlim_expr(P,Z),j],p.$result_with_text(O.$join(" \uFF1E ")))},2),n.$private(),C(n,"$result_success_count",function(k,x,Y){var a=this,N=o;return N=I(k,"count",[],function p(H){var Q=p.$$s==null?this:p.$$s,ee=o;return Q.cmp_op==null&&(Q.cmp_op=o),H==null&&(H=o),ee=z(H["$[]"]("sum"),x),ee.$send(Q.cmp_op,Y)},{$$arity:1,$$s:a}),"\u6210\u529F\u6570"+N},3),C(n,"$result_max_sum",function(k,x){var Y=o,a=o,N=o;return Y=I(k,"map",[],function(H){return H==null&&(H=o),H["$[]"]("sum")},1),a=z(Y.$sum(),x),N=I(Y,"map",[],function(H){return H==null&&(H=o),z(H,x)},1).$max(),""+N+"/"+a+"(\u6700\u5927/\u5408\u8A08)"},2),C(n,"$interlim_expr",function(k,x){var Y=o;return Y=I(k,"map",[],function(N){return N==null&&(N=o),T(N["$[]"]("list").$size(),1)?N["$[]"]("sum"):""+N["$[]"]("sum")+"["+N["$[]"]("list").$join(",")+"]"},1).$join(","),z(Y,l("Format").$modifier(x))},2),C(n,"$expr",function(k,x,Y,a){var N=this,p=o,H=o;return p=l("Format").$comparison_operator(N.cmp_op),H=l("Format").$modifier(Y),""+k.$join("+")+"["+x+"]"+H+p+a},4),C(n,"$result_with_text",function(k){var x=this;return I(l("Result").$new(),"tap",[],function Y(a){var N=Y.$$s==null?this:Y.$$s,p=o;return N.secret==null&&(N.secret=o),a==null&&(a=o),p=[N.secret],I(a,"secret=",U(p)),p[J(p.length,1)],p=[k],I(a,"text=",U(p)),p[J(p.length,1)]},{$$arity:1,$$s:x})},1)}(u[0],null,u),function(c,s,i){var n=r(c,s,"Notation"),$=[n].concat(i),l=e.$r($),d=n.$$prototype;return d.roll_times=d.sides=o,C(n,"$initialize",function(k,x){var Y=this;return Y.roll_times=k,Y.sides=x},2),C(n,"$to_dice",function(k){var x=this,Y=o,a=o;return Y=x.roll_times.$eval(k),a=x.sides.$eval(k),l("Dice").$new(Y,a)},1)}(u[0],null,u),function(c,s,i){var n=r(c,s,"Dice"),$=[n].concat(i),l=e.$r($),d=n.$$prototype;return d.roll_times=d.sides=o,C(n,"$initialize",function(k,x){var Y=this;return Y.roll_times=k,Y.sides=x},2),C(n,"$roll",function(k,x,Y){var a=this,N=o;return N=I(l("Array"),"new",[a.roll_times],function p(){var H=p.$$s==null?this:p.$$s,Q=o;return Q=H.$roll_ones(k,x),q(["sum","list"],{sum:Q.$sum(),list:Q})},{$$arity:0,$$s:a}),h(Y)&&(N=I(N,"sort_by",[],function(H){return H==null&&(H=o),H["$[]"]("sum")},1)),N},3),C(n,"$to_s",function(){var k=this;return""+k.roll_times+"U"+k.sides},0),n.$private(),C(n,"$roll_ones",function(k,x){var Y=this,a=o;return a=[],function(){var N=e.new_brk();try{return I(Y,"loop",[],function p(){var H=p.$$s==null?this:p.$$s,Q=o;if(H.sides==null&&(H.sides=o),Q=k.$roll_once(H.sides),a.$push(Q),h(W(Q,x)))e.brk(o,N);else return o},{$$arity:0,$$s:Y,$$brk:N})}catch(p){if(p===N)return p.$v;throw p}}(),a},2)}(u[0],null,u)}(f[0],f)}(M[0],M)}(X[0],X)}(A[0],A)};Opal.modules["bcdice/common_command/upper_dice/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set,T=e.hash2,U=e.to_ary,J=e.truthy;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/upper_dice/node"),A.$require("bcdice/arithmetic/node"),function(W,S){var F=q(W,"BCDice"),B=[F].concat(S);return function(X,L){var w=q(X,"CommonCommand"),b=[w].concat(L);return function(M,D){var G=q(M,"UpperDice"),R=[G].concat(D),f=e.$r(R);return function(E,g,_){var u=C(E,g,"Parser"),c=[u].concat(_),s=e.$r(c),i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=t,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=u.$$prototype;return ee.lexer=t,I(u,"$parse",function(V){var Z=this;return Z.$new().$parse(V)},1),h(u,"$parse",function(V){var Z=this;try{return Z.lexer=s("Lexer").$new(V),Z.$do_parse()}catch(y){if(e.rescue(y,[s("ParseError")]))try{return t}finally{e.pop_exception()}else throw y}},1),u.$private(),h(u,"$next_token",function(){var V=this;return V.lexer.$next_token()},0),i=[9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,t,8,39,40,t,21,22,39,40,8,58,56,57,59,36,37],n=[2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,t,40,50,50,t,44,44,51,51,44,53,53,53,53,54,54],$=[-3,22,-2,t,28,9,t,32,-1,t,t,20,35,40,4,12,17,3,22,46,t,25,30,t,34,38,46,43,51,56,51,t,76,59,-6,t,64,69,t,77,82,t,t,t,90,66,t,72,77,t,85,90,t,100,99,t,t,t,t,t],l=[-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29],d=[18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,t,t,t,t,t,t,t,54],m=[10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,t,t,t,t,t,t,t,10],k=[t,7,9,8,7,-6,6,2,t,-13,-8,4,11,-18,-26],x=[t,t,t,t,t,t,t,t,13,19,t,t,23,20,t],Y=[0,0,"racc_error",4,23,"_reduce_1",5,23,"_reduce_2",5,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",1,26,"_reduce_7",2,30,"_reduce_8",2,30,"_reduce_9",3,30,"_reduce_10",3,30,"_reduce_11",0,27,"_reduce_12",2,27,"_reduce_13",3,28,"_reduce_14",2,29,"_reduce_15",3,25,"_reduce_16",1,25,"_reduce_17",3,33,"_reduce_18",3,32,"_reduce_19",3,32,"_reduce_20",1,32,"_reduce_none",3,31,"_reduce_22",4,31,"_reduce_23",1,31,"_reduce_none",0,36,"_reduce_25",1,36,"_reduce_26",1,36,"_reduce_27",1,36,"_reduce_28",1,36,"_reduce_29",2,35,"_reduce_30",2,35,"_reduce_31",1,35,"_reduce_none",3,34,"_reduce_33",1,34,"_reduce_34"],a=35,N=60,p=v(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),H=22,Q=!0,z(c[0],"Racc_arg",[i,n,l,$,d,m,x,k,H,Y,p,N,a,Q]),z(c[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","modifier","target","bracket","at","modifier_expr","mul","add","dice","term","unary","round_type"]),z(c[0],"Racc_debug_parser",!1),h(u,"$_reduce_1",function(V,Z,y){return y=r(r(s("UpperDice"),"Node"),"Command").$new(T(["secret","notations","modifier","cmp_op","target_number"],{secret:V["$[]"](0),notations:V["$[]"](1),modifier:V["$[]"](2),cmp_op:V["$[]"](3)["$[]"]("cmp_op"),target_number:V["$[]"](3)["$[]"]("target")})),y},3),h(u,"$_reduce_2",function(V,Z,y){return y=r(r(s("UpperDice"),"Node"),"Command").$new(T(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:V["$[]"](0),notations:V["$[]"](1),modifier:V["$[]"](3),cmp_op:V["$[]"](4)["$[]"]("cmp_op"),target_number:V["$[]"](4)["$[]"]("target"),reroll_threshold:V["$[]"](2)})),y},3),h(u,"$_reduce_3",function(V,Z,y){return y=r(r(s("UpperDice"),"Node"),"Command").$new(T(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:V["$[]"](0),notations:V["$[]"](1),modifier:V["$[]"](2),cmp_op:V["$[]"](3)["$[]"]("cmp_op"),target_number:V["$[]"](3)["$[]"]("target"),reroll_threshold:V["$[]"](4)})),y},3),h(u,"$_reduce_4",function(V,Z,y){return y=!1,y},3),h(u,"$_reduce_5",function(V,Z,y){return y=!0,y},3),h(u,"$_reduce_6",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Number").$new(0),y},3),h(u,"$_reduce_7",function(V,Z,y){return y=V["$[]"](0),y},3),h(u,"$_reduce_8",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_9",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Negative").$new(V["$[]"](1)),y},3),h(u,"$_reduce_10",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"+",V["$[]"](2)),y},3),h(u,"$_reduce_11",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"-",V["$[]"](2)),y},3),h(u,"$_reduce_12",function(V,Z,y){return y=T([],{}),y},3),h(u,"$_reduce_13",function(V,Z,y){var K,P,j=this,O=t,re=t;return P=V,K=U(P),O=K[0]==null?t:K[0],re=K[1]==null?t:K[1],J(O)||j.$raise(s("ParseError")),y=T(["cmp_op","target"],{cmp_op:O,target:re}),y},3),h(u,"$_reduce_14",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_15",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_16",function(V,Z,y){var K=t;return K=V["$[]"](0),K.$push(V["$[]"](2)),y=K,y},3),h(u,"$_reduce_17",function(V,Z,y){return y=[V["$[]"](0)],y},3),h(u,"$_reduce_18",function(V,Z,y){var K=t,P=t;return K=V["$[]"](0),P=V["$[]"](2),y=r(r(s("UpperDice"),"Node"),"Notation").$new(K,P),y},3),h(u,"$_reduce_19",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"+",V["$[]"](2)),y},3),h(u,"$_reduce_20",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"-",V["$[]"](2)),y},3),h(u,"$_reduce_22",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"BinaryOp").$new(V["$[]"](0),"*",V["$[]"](2)),y},3),h(u,"$_reduce_23",function(V,Z,y){var K=t;return K=V["$[]"](3),y=K.$new(V["$[]"](0),V["$[]"](2)),y},3),h(u,"$_reduce_25",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),y},3),h(u,"$_reduce_26",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_27",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithCeil"),y},3),h(u,"$_reduce_28",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithRound"),y},3),h(u,"$_reduce_29",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"DivideWithFloor"),y},3),h(u,"$_reduce_30",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_31",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Negative").$new(V["$[]"](1)),y},3),h(u,"$_reduce_33",function(V,Z,y){return y=V["$[]"](1),y},3),h(u,"$_reduce_34",function(V,Z,y){return y=r(r(s("Arithmetic"),"Node"),"Number").$new(V["$[]"](0)),y},3),h(u,"$_reduce_none",function(V,Z,y){return V["$[]"](0)},3)}(R[0],r(f("Racc"),"Parser"),R)}(b[0],b)}(B[0],B)}(o[0],o)};Opal.modules["bcdice/common_command/upper_dice"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set,C=e.send,I=e.def;return A.$require("bcdice/common_command/upper_dice/parser"),function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"CommonCommand"),S=[W].concat(J);return function(F,B){var X=r(F,"UpperDice"),L=[X].concat(B);return q(L[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),function(w,b){var M=[w].concat(b),D=e.$r(M);return I(w,"$eval",function(R,f,E){var g,_=t;return _=D("Parser").$parse(R),g=_,g===t||g==null?t:C(g,"eval",[f,E])},3)}(e.get_singleton_class(X),L)}(S[0],S)}(T[0],T)}(o[0],o)};Opal.modules["bcdice/common_command/version"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.const_set,C=e.truthy,I=e.send,h=e.to_a,v=e.rb_minus,z=e.def;return function(T,U){var J=r(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=r(S,"CommonCommand"),X=[B].concat(F);return function(L,w){var b=r(L,"Version"),M=[b].concat(w);return q(M[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),function(D,G){var R=[D].concat(G),f=e.$r(R);return z(D,"$eval",function(g,_,u){return g=g.$split(" ",2).$first(),C(g["$match?"](/^BCDiceVersion$/i))?I(f("Result").$new(),"tap",[],function(s){var i=o;return s==null&&(s=o),i=["BCDice "+t(f("BCDice"),"VERSION")],I(s,"text=",h(i)),i[v(i.length,1)]},1):o},3)}(e.get_singleton_class(b),M)}(X[0],X)}(W[0],W)}(A[0],A)};Opal.queue(function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.const_set;return A.$require("bcdice/common_command/add_dice"),A.$require("bcdice/common_command/barabara_dice"),A.$require("bcdice/common_command/tally_dice"),A.$require("bcdice/common_command/calc"),A.$require("bcdice/common_command/choice"),A.$require("bcdice/common_command/d66_dice"),A.$require("bcdice/common_command/repeat"),A.$require("bcdice/common_command/reroll_dice"),A.$require("bcdice/common_command/upper_dice"),A.$require("bcdice/common_command/version"),function(C,I){var h=r(C,"BCDice"),v=[h].concat(I);return function(z,T){var U=r(z,"CommonCommand"),J=[U].concat(T),W=e.$r(J);return q(J[0],"COMMANDS",[W("AddDice"),W("BarabaraDice"),W("TallyDice"),W("Calc"),W("Choice"),W("D66Dice"),W("Repeat"),W("RerollDice"),W("UpperDice"),W("Version")].$freeze())}(v[0],v)}(o[0],o)})});var Ve=de((mt,xr)=>{xr.exports={ja_jp:{success:"\u6210\u529F",failure:"\u5931\u6557",critical:"\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB",fumble:"\u30D5\u30A1\u30F3\u30D6\u30EB"},ko_kr:{success:"\uC131\uACF5",failure:"\uC2E4\uD328",fumble:"\uD38C\uBE14",RTT:{rtt_format:"\uB79C\uB364 \uD2B9\uAE30 \uACB0\uC815\uD45C(%<category_dice>d,%<row_dice>d) \uFF1E %<text>s",rttn_format:"\uC9C0\uC815\uD2B9\uAE30(%<category_name>s)\uD45C(%<row_dice>d) \uFF1E %<text>s"}},zh_hans:{success:"\u6210\u529F",failure:"\u5931\u8D25",fumble:"\u5927\u5931\u8D25",RTT:{rtt_format:"\u968F\u673A\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uFF1E %<text>s",rttn_format:"%<category_name>s\u9886\u57DF\u968F\u673A\u7279\u6280\u8868(%<row_dice>d) \uFF1E %<text>s"}},zh_hant:{success:"\u6210\u529F",failure:"\u5931\u6557"}}});var Ze=de(()=>{ke();Opal.modules.json=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.send,I=e.to_a,h=e.rb_minus,v=e.Object,z=e.hash2,T=e.eqeqeq,U=e.defs,J=e.truthy,W=e.def;return function(S,F){var B=r(S,"JSON"),X=[B].concat(F),L=e.$r(X),w=o;q(X[0],L("StandardError"),"JSONError"),q(X[0],L("JSONError"),"ParserError");var b=e.hasOwnProperty;function M(G){try{return JSON.parse(G)}catch(R){B.$raise(t(L("JSON"),"ParserError"),R.message)}}function D(G,R){var f,E,g,_,u,c;switch(typeof G){case"string":return G;case"number":return G;case"boolean":return!!G;case"undefined":return o;case"object":if(!G)return o;if(G.$$is_array){for(E=R.array_class.$new(),_=0,u=G.length;_<u;_++)E.$push(D(G[_],R));return E}else{g=R.object_class.$new();for(c in G)b.call(G,c)&&(w=[c,D(G[c],R)],C(g,"[]=",I(w)),w[h(w.length,1)]);return!R.parse&&(f=g["$[]"](L("JSON").$create_id()))!=o?v.$const_get(f).$json_create(g):g}}}return function(G,R){return G.$attr_accessor("create_id")}(e.get_singleton_class(B),X),w=["json_class"],C(B,"create_id=",I(w)),w[h(w.length,1)],U(B,"$[]",function(R,f){var E=this;return f==null&&(f=z([],{})),T(L("String"),R)?E.$parse(R,f):E.$generate(R,f)},-2),U(B,"$parse",function(R,f){var E=this;return f==null&&(f=z([],{})),E.$from_object(M(R),f.$merge(z(["parse"],{parse:!0})))},-2),U(B,"$parse!",function(R,f){var E=this;return f==null&&(f=z([],{})),E.$parse(R,f)},-2),U(B,"$load",function(R,f){var E=this;return f==null&&(f=z([],{})),E.$from_object(M(R),f)},-2),U(B,"$from_object",function(R,f){var E=o,g=o;return f==null&&(f=z([],{})),J(E=f["$[]"]("object_class"))||(g=["object_class",L("Hash")],C(f,"[]=",I(g)),g[h(g.length,1)]),J(E=f["$[]"]("array_class"))||(g=["array_class",L("Array")],C(f,"[]=",I(g)),g[h(g.length,1)]),D(R,f.$$smap)},-2),U(B,"$generate",function(R,f){return f==null&&(f=z([],{})),R.$to_json(f)},-2),U(B,"$dump",function(R,f,E){var g=this,_=o;return f==null&&(f=o),E==null&&(E=o),_=g.$generate(R),J(f)?(J(f["$responds_to?"]("to_io"))&&(f=f.$to_io()),f.$write(_),f):_},-2)}(A[0],A),function(S,F){var B=q(S,F,"Object");return W(B,"$to_json",function(){var L=this;return L.$to_s().$to_json()},0)}(A[0],null),function(S){var F=r(S,"Enumerable");return W(F,"$to_json",function(){var X=this;return X.$to_a().$to_json()},0)}(A[0]),function(S,F){var B=q(S,F,"Array");return W(B,"$to_json",function(){for(var L=this,w=[],b=0,M=L.length;b<M;b++)w.push(L[b].$to_json());return"["+w.join(",")+"]"},0)}(A[0],null),function(S,F){var B=q(S,F,"Boolean");return W(B,"$to_json",function(){var L=this;return L==!0?"true":"false"},0)}(A[0],null),function(S,F){var B=q(S,F,"Hash");return W(B,"$to_json",function(){for(var L=this,w=[],b=0,M=L.$$keys,D=M.length,G,R;b<D;b++)G=M[b],G.$$is_string?R=L.$$smap[G]:(R=G.value,G=G.key),w.push(G.$to_s().$to_json()+":"+R.$to_json());return"{"+w.join(",")+"}"},0)}(A[0],null),function(S,F){var B=q(S,F,"NilClass");return W(B,"$to_json",function(){return"null"},0)}(A[0],null),function(S,F){var B=q(S,F,"Numeric");return W(B,"$to_json",function(){var L=this;return L.toString()},0)}(A[0],null),function(S,F){var B=q(S,F,"String");return W(B,"$to_json",function(){var L=this;return JSON.stringify(L)},0)}(A[0],null),function(S,F){var B=q(S,F,"Time");return W(B,"$to_json",function(){var L=this;return L.$strftime("%FT%T%z").$to_json()},0)}(A[0],null),function(S,F){var B=q(S,F,"Date");return W(B,"$to_json",function(){var L=this;return L.$to_s().$to_json()},0),W(B,"$as_json",function(){var L=this;return L.$to_s()},0)}(A[0],null)};Opal.modules.i18n=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.class_variable_set,I=e.class_variable_get,h=e.def,v=e.truthy,z=e.hash2,T=e.send,U=e.to_a,J=e.hash,W=e.alias,S=e.klass;return A.$require("json"),function(F,B){var X=q(F,"I18n"),L=[X].concat(B);return function(w,b){var M=[w].concat(b),D=e.$r(M);return C(M[1],"@@load_path",[]),C(M[1],"@@table",t),h(w,"$load_path",function(){return I(M[1],"@@load_path",!1)},0),h(w,"$default_locale",function(){return I(M[1],"@@default_locale",!1)},0),h(w,"$default_locale=",function(R){return C(M[1],"@@default_locale",R)},1),h(w,"$fallbacks",function(){return r(r(D("I18n"),"Locale"),"Fallbacks").$new()},0),h(w,"$load_default_translation",function(){var R=this;return v(I(M[1],"@@table",!1)["$nil?"]())?(C(M[1],"@@table",z([],{})),R.$load_translation(JSON.stringify(Ve()))):t},0),h(w,"$load_translation",function(R){var f=this,E=t;return f.$load_default_translation(),E=D("JSON").$parse(R,z(["symbolize_names"],{symbolize_names:!0})),C(M[1],"@@table",T(I(M[1],"@@table",!1),"merge",[E],function(_,u,c){return _==null&&(_=t),u==null&&(u=t),c==null&&(c=t),u.$merge(c)},3))},1),h(w,"$clear_translate_table",function(){return C(M[1],"@@table",t)},0),h(w,"$translate",function(R,f){var E,g,_=this,u=t,c=t,s=t,i=t,n=t;if(f==null)f=z([],{});else if(!f.$$is_hash)throw e.ArgumentError.$new("expected kwargs");E=f.$$smap.locale,E==null&&(E=t),g=e.kwrestargs(f,{locale:!0}),_.$load_default_translation(),u=T(R.$split("."),"map",[],"to_sym".$to_proc()),c=I(M[1],"@@table",!1),s=I(M[1],"@@default_locale",!1),i=v(n=T(c,"dig",[E].concat(U(u))))?n:T(c,"dig",[s].concat(U(u)));try{v(i["$is_a?"](D("String")))&&(i=_.$format(i,e.to_hash(g)))}catch($){if(e.rescue($,[D("ArgumentError"),D("KeyError")]))try{}finally{e.pop_exception()}else throw $}return v(n=i)?n:g["$[]"]("default")},-2),W(w,"t","translate")}(e.get_singleton_class(X),L),function(w,b){var M=q(w,"Locale"),D=[M].concat(b),G=e.$r(D);return function(R,f){var E=S(R,f,"Fallbacks");return h(E,"$defaults=",function(_){return t},1)}(D[0],G("Hash"))}(L[0],L),function(w,b){var M=q(w,"Backend"),D=[M].concat(b);return q(D[0],"Simple"),t}(L[0],L),function(w,b){var M=q(w,"Thread"),D=[M].concat(b);return function(G,R){return h(G,"$current",function(){return z(["i18n_fallbacks"],{i18n_fallbacks:t})},0)}(e.get_singleton_class(M),D)}(L[0],L)}(o[0],o)};Opal.modules["i18n/backend/fallbacks"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.class_variable_set,C=e.truthy,I=e.class_variable_get,h=e.def,v=e.send,z=e.to_a,T=e.rb_minus,U=e.send2,J=e.find_super,W=e.hash2,S=e.find_block_super,F=e.neqeq;return function(B,X){var L=r(B,"I18n"),w=[L].concat(X);return q(w[0],"@@fallbacks",o),function(b,M){var D=[b].concat(M),G=e.$r(D);return h(b,"$fallbacks",function(){var f,E=o;return q(D[1],"@@fallbacks",C((f=D[1].$$cvars["@@fallbacks"],f!=null?"class variable":o))&&C(E=I(D[1],"@@fallbacks",!1))?E:t(t(G("I18n"),"Locale"),"Fallbacks").$new()),C(E=G("Thread").$current()["$[]"]("i18n_fallbacks"))?E:I(D[1],"@@fallbacks",!1)},0),h(b,"$fallbacks=",function(f){var E=o;return q(D[1],"@@fallbacks",C(f["$is_a?"](G("Array")))?t(t(G("I18n"),"Locale"),"Fallbacks").$new(f):f),E=["i18n_fallbacks",I(D[1],"@@fallbacks",!1)],v(G("Thread").$current(),"[]=",z(E)),E[T(E.length,1)]},1)}(e.get_singleton_class(L),w),function(b,M){var D=r(b,"Backend"),G=[D].concat(M);return function(R,f){var E=r(R,"Fallbacks"),g=[E].concat(f),_=e.$r(g);return h(E,"$translate",function u(c,s,i){try{var n=u.$$p||o,$=this,l=o,d=o;return delete u.$$p,i==null&&(i=_("EMPTY_HASH")),C(i.$fetch("fallback",!0))?C(i["$[]"]("fallback_in_progress"))?U($,J($,"translate",u,!1,!0),"translate",[c,s,i],n):(C(i["$[]"]("default"))&&(l=$["$extract_non_symbol_default!"](i)),d=i.$merge(W(["fallback_in_progress"],{fallback_in_progress:!0})),v(_("I18n").$fallbacks()["$[]"](c),"each",[],function m(k){var x=m.$$s==null?this:m.$$s;k==null&&(k=o);try{return v(x,"catch",["exception"],function Y(){var a=Y.$$s==null?this:Y.$$s,N=o;if(N=U(a,S(a,"translate",Y.$$def||m.$$def||u,!1,!1),"translate",[k,s,d],null),C(N["$nil?"]()))return o;F(c.$to_s(),k.$to_s())&&a.$on_fallback(c,k,s,i),e.ret(N)},{$$arity:0,$$s:x})}catch(Y){if(e.rescue(Y,[t(_("I18n"),"InvalidLocale")]))try{return o}finally{e.pop_exception()}else throw Y}},{$$arity:1,$$s:$}),C(i["$key?"]("default"))&&C(i["$[]"]("default")["$nil?"]())?o:C(l)?U($,J($,"translate",u,!1,!0),"translate",[c,o,i.$merge(W(["default"],{default:l}))],null):$.$throw("exception",t(_("I18n"),"MissingTranslation").$new(c,s,i))):U($,J($,"translate",u,!1,!0),"translate",[c,s,i],n)}catch(m){if(m===e.returner)return m.$v;throw m}},-3),h(E,"$extract_non_symbol_default!",function(c){var s=o,i=o,n=o;return s=[c["$[]"]("default")].$flatten(),i=v(s,"detect",[],function(l){return l==null&&(l=o),l["$is_a?"](_("Symbol"))["$!"]()},1),C(i)&&(n=["default",s["$[]"](0,s.$index(i))],v(c,"[]=",z(n)),n[T(n.length,1)]),i},1),h(E,"$exists?",function u(c,s,i){try{var n=u.$$p||o,$=this;return delete u.$$p,i==null&&(i=_("EMPTY_HASH")),C(i.$fetch("fallback",!0))?(v(_("I18n").$fallbacks()["$[]"](c),"each",[],function l(d){var m=l.$$s==null?this:l.$$s;d==null&&(d=o);try{if(C(U(m,S(m,"exists?",l.$$def||u,!1,!1),"exists?",[d,s],null)))e.ret(!0);else return o}catch(k){if(e.rescue(k,[t(_("I18n"),"InvalidLocale")]))try{return o}finally{e.pop_exception()}else throw k}},{$$arity:1,$$s:$}),!1):U($,J($,"exists?",u,!1,!0),"exists?",[c,s,i],n)}catch(l){if(l===e.returner)return l.$v;throw l}},-3),E.$private(),h(E,"$on_fallback",function(c,s,i,n){return o},4)}(G[0],G)}(w[0],w)}(A[0],A)};Opal.modules["bcdice/randomizer"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.const_set,I=e.def,h=e.truthy,v=e.rb_gt,z=e.rb_plus,T=e.rb_le,U=e.send,J=e.rb_minus,W=e.eqeq,S=e.rb_times,F=e.eqeqeq,B=e.rb_ge;return function(X,L){var w=r(X,"BCDice"),b=[w].concat(L),M=e.$r(b);return function(D,G,R){var f=q(D,G,"Randomizer"),E=[f].concat(R),g=e.$r(E),_=f.$$prototype;return _.rand_results=_.detailed_rand_results=o,C(E[0],"UPPER_LIMIT_DICE_TIMES",200),C(E[0],"UPPER_LIMIT_DICE_SIDES",1e4),C(E[0],"UPPER_LIMIT_RANDS",1e4),I(f,"$initialize",function(){var c=this;return c.rand_results=[],c.detailed_rand_results=[]},0),f.$attr_reader("rand_results"),f.$attr_reader("detailed_rand_results"),C(E[0],"DetailedRandResult",g("Struct").$new("kind","sides","value")),I(f,"$roll_barabara",function(c,s){var i=this;return h(v(z(i.rand_results.$size(),c),g("UPPER_LIMIT_RANDS")))&&i.$raise(g("TooManyRandsError")),h(T(c,0))||h(v(c,g("UPPER_LIMIT_DICE_TIMES")))?[]:U(g("Array"),"new",[c],function n(){var $=n.$$s==null?this:n.$$s;return $.$roll_once(s)},{$$arity:0,$$s:i})},2),I(f,"$roll_sum",function(c,s){var i=this;return i.$roll_barabara(c,s).$sum()},2),I(f,"$roll_once",function(c){var s=this,i=o;return h(T(c,0))||h(v(c,g("UPPER_LIMIT_DICE_SIDES")))?0:(i=s.$rand_inner(c),s.$push_to_detail("normal",c,i),i)},1),I(f,"$roll_index",function(c){var s=this;return J(s.$roll_once(c),1)},1),I(f,"$roll_tens_d10",function(){var c=this,s=o,i=o;return s=c.$rand_inner(10),W(s,10)&&(s=0),i=S(s,10),c.$push_to_detail("tens_d10",10,i),i},0),I(f,"$roll_d9",function(){var c=this,s=o;return s=J(c.$rand_inner(10),1),c.$push_to_detail("d9",10,s),s},0),I(f,"$roll_d66",function(c){var s=this,i=o,n=o;return i=U(g("Array"),"new",[2],function $(){var l=$.$$s==null?this:$.$$s;return l.$roll_once(6)},{$$arity:0,$$s:s}),F(t(g("D66SortType"),"ASC"),n=c)?i["$sort!"]():F(t(g("D66SortType"),"DESC"),n)&&i["$sort!"]()["$reverse!"](),z(S(i["$[]"](0),10),i["$[]"](1))},1),f.$private(),I(f,"$rand_inner",function(c){var s=this,i=o;return h(B(s.rand_results.$size(),g("UPPER_LIMIT_RANDS")))&&s.$raise(g("TooManyRandsError")),i=s.$random(c),s.rand_results["$<<"]([i,c]),i},1),I(f,"$random",function(c){return z(g("Kernel").$rand(c),1)},1),I(f,"$push_to_detail",function(c,s,i){var n=this,$=o;return $=g("DetailedRandResult").$new(c,s,i),n.detailed_rand_results.$push($)},3)}(b[0],null,b),q(b[0],M("StandardError"),"TooManyRandsError"),o}(A[0],A)};Opal.modules["bcdice/dice_table/roll_result"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.truthy;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"DiceTable"),W=[J].concat(U);return function(S,F,B){var X=r(S,F,"RollResult"),L=[X].concat(B),w=e.$r(L),b=X.$$prototype;return b.table_name=b.value=b.body=o,q(X,"$initialize",function(D,G,R){var f=this;return f.table_name=D,f.value=G,f.body=R},3),X.$attr_reader("table_name"),X.$attr_reader("value"),X.$attr_reader("body"),q(X,"$to_s",function(){var D=this;return""+D.table_name+"("+D.value+") \uFF1E "+D.body},0),q(X,"$last_body",function(){var D=this;return C(D.body["$is_a?"](w("RollResult")))?D.body.$last_body():D.body},0),q(X,"$empty?",function(){return!1},0)}(W[0],null,W)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/dice_table/chain_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.truthy,C=e.def,I=e.rb_minus;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"DiceTable"),S=[W].concat(J);return function(F,B,X){var L=r(F,B,"ChainTable"),w=[L].concat(X),b=e.$r(w),M=L.$$prototype;return M.times=M.sides=M.items=M.name=o,C(L,"$initialize",function(G,R,f){var E=this,g=o;return E.name=G,E.items=f.$freeze(),g=/(\d+)D(\d+)/i.$match(R),q(g)||E.$raise(b("ArgumentError"),"Unexpected table type: "+R),E.times=g["$[]"](1).$to_i(),E.sides=g["$[]"](2).$to_i()},3),C(L,"$roll",function(G){var R=this,f=o,E=o,g=o;return f=G.$roll_sum(R.times,R.sides),E=I(f,R.times),g=R.items["$[]"](E),q(g["$respond_to?"]("roll"))&&(g=g.$roll(G)),b("RollResult").$new(R.name,f,g)},1)}(S[0],null,S)}(T[0],T)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.def,h=e.rb_plus,v=e.rb_times,z=e.rb_minus;return function(T,U){var J=t(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=t(S,"DiceTable"),X=[B].concat(F);return function(L,w,b){var M=r(L,w,"D66GridTable"),D=[M].concat(b),G=e.$r(D),R=M.$$prototype;return R.name=R.items=o,C(M,"$from_i18n",function(E,g){var _=this,u=o;return u=G("I18n").$t(E,q(["locale","raise"],{locale:g,raise:!0})),_.$new(u["$[]"]("name"),u["$[]"]("items"))},2),I(M,"$initialize",function(E,g){var _=this;return _.name=E,_.items=g.$freeze()},2),I(M,"$roll",function(E){var g=this,_=o,u=o,c=o,s=o,i=o;return _=E.$roll_once(6),u=E.$roll_once(6),c=h(v(_,10),u),s=z(_,1),i=z(u,1),G("RollResult").$new(g.name,c,g.items["$[]"](s)["$[]"](i))},1)}(X[0],null,X)}(W[0],W)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def;return A.$require("bcdice/dice_table/d66_grid_table"),function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W),B=e.$r(F);return function(X,L,w){var b=q(X,L,"D66HalfGridTable"),M=[b].concat(w),D=e.$r(M);return I(b,"$from_i18n",function(R,f){var E=this,g=t;return g=D("I18n").$t(R,C(["locale","raise"],{locale:f,raise:!0})),E.$new(g["$[]"]("name"),g["$[]"]("items_1_2_3"),g["$[]"]("items_4_5_6"))},2),h(b,"$initialize",function(R,f,E){var g=this;return g.name=R,g.items=[f,f,f,E,E,E].$freeze()},3)}(F[0],B("D66GridTable"),F)}(U[0],U)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def;return A.$require("bcdice/dice_table/d66_grid_table"),function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W),B=e.$r(F);return function(X,L,w){var b=q(X,L,"D66OneThirdTable"),M=[b].concat(w),D=e.$r(M);return I(b,"$from_i18n",function(R,f){var E=this,g=t;return g=D("I18n").$t(R,C(["locale","raise"],{locale:f,raise:!0})),E.$new(g["$[]"]("name"),g["$[]"]("items_1_2"),g["$[]"]("items_3_4"),g["$[]"]("items_5_6"))},2),h(b,"$initialize",function(R,f,E,g){var _=this;return _.name=R,_.items=[f,f,E,E,g,g].$freeze()},4)}(F[0],B("D66GridTable"),F)}(U[0],U)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_table"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def,v=e.eqeqeq,z=e.rb_plus,T=e.rb_times,U=e.truthy;return function(J,W){var S=r(J,"BCDice"),F=[S].concat(W);return function(B,X){var L=r(B,"DiceTable"),w=[L].concat(X);return function(b,M,D){var G=q(b,M,"D66Table"),R=[G].concat(D),f=e.$r(R),E=G.$$prototype;return E.sort_type=E.items=E.name=o,I(G,"$from_i18n",function(_,u){var c=this,s=o,i=o;return s=f("I18n").$t(_,C(["locale"],{locale:u})),i=f("D66SortType").$const_get(s["$[]"]("d66_sort_type")),c.$new(s["$[]"]("name"),i,s["$[]"]("items"))},2),h(G,"$initialize",function(_,u,c){var s=this;return s.name=_,s.sort_type=u,s.items=c.$freeze()},3),h(G,"$roll",function(_){var u=this,c=o,s=o,i=o,n=o;return c=_.$roll_barabara(2,6),v(t(f("D66SortType"),"ASC"),s=u.sort_type)?c["$sort!"]():v(t(f("D66SortType"),"DESC"),s)&&c["$sort!"]()["$reverse!"](),i=z(T(c["$[]"](0),10),c["$[]"](1)),n=U(s=u.items["$[]"](i))?s:u.items["$[]"](i.$to_s()),U(n["$respond_to?"]("roll"))&&(n=n.$roll(_)),f("RollResult").$new(u.name,i,n)},1),h(G,"$choice",function(_){var u=this;return f("RollResult").$new(u.name,_,u.items["$[]"](_))},1)}(w[0],null,w)}(F[0],F)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.send,h=e.to_ary,v=e.rb_plus,z=e.rb_times,T=e.to_a,U=e.rb_minus,J=e.send2,W=e.find_super,S=e.def;return A.$require("bcdice/dice_table/d66_table"),function(F,B){var X=r(F,"BCDice"),L=[X].concat(B);return function(w,b){var M=r(w,"DiceTable"),D=[M].concat(b),G=e.$r(D);return function(R,f){var E=q(R,f,"D66LeftRangeTable");return S(E,"$initialize",function g(_,u,c){var s=g.$$p||t,i=this,n=t;return delete g.$$p,n=C([],{}),I(c,"each",[],function(l){var d,m,k=t,x=t;return l==null&&(l=t),m=l,d=h(m),k=d[0]==null?t:d[0],x=d[1]==null?t:d[1],I(k,"each",[],function(a){return a==null&&(a=t),I(x,"each_with_index",[],function(p,H){var Q=t,ee=t;return p==null&&(p=t),H==null&&(H=t),Q=v(z(a,10),v(H,1)),ee=[Q,p],I(n,"[]=",T(ee)),ee[U(ee.length,1)]},2)},1)},1),J(i,W(i,"initialize",g,!1,!0),"initialize",[_,u,n],null)},3)}(D[0],G("D66Table"))}(L[0],L)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.def,h=e.truthy,v=e.rb_minus,z=e.rb_plus,T=e.rb_times;return function(U,J){var W=t(U,"BCDice"),S=[W].concat(J);return function(F,B){var X=t(F,"DiceTable"),L=[X].concat(B);return function(w,b,M){var D=r(w,b,"D66ParityTable"),G=[D].concat(M),R=e.$r(G),f=D.$$prototype;return f.odd=f.even=f.name=o,C(D,"$from_i18n",function(g,_){var u=this,c=o;return c=R("I18n").$t(g,q(["locale","raise"],{locale:_,raise:!0})),u.$new(c["$[]"]("name"),c["$[]"]("odd"),c["$[]"]("even"))},2),I(D,"$initialize",function(g,_,u){var c=this;return c.name=g,c.odd=_.$freeze(),c.even=u.$freeze()},3),I(D,"$roll",function(g){var _=this,u=o,c=o,s=o,i=o,n=o;return u=g.$roll_once(6),c=g.$roll_once(6),h(u["$odd?"]())?s=_.odd:s=_.even,i=s["$[]"](v(c,1)),n=z(T(u,10),c),R("RollResult").$new(_.name,n,i)},1)}(L[0],null,L)}(S[0],S)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.rb_plus,I=e.rb_times,h=e.send;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=t(J,"DiceTable"),F=[S].concat(W);return function(B,X,L){var w=r(B,X,"D66RangeTable"),b=[w].concat(L),M=e.$r(b),D=w.$$prototype;return D.items=D.name=o,q(w,"$initialize",function(R,f){var E=this;return E.name=R,E.items=f.$freeze()},2),q(w,"$roll",function(R){var f=this,E=o,g=o,_=o,u=o;return E=R.$roll_once(6),g=R.$roll_once(6),_=C(I(E,10),g),u=h(f.items,"find",[],function(s){return s==null&&(s=o),s["$[]"](0)["$include?"](_)},1),M("RollResult").$new(f.name,_,u["$[]"](1))},1)}(F[0],null,F)}(U[0],U)}(A[0],A)};Opal.modules["bcdice/dice_table/range_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.const_set,C=e.send,I=e.truthy,h=e.def,v=e.to_a,z=e.rb_minus,T=e.eqeqeq,U=e.rb_times,J=e.rb_plus;return function(W,S){var F=t(W,"BCDice"),B=[F].concat(S);return function(X,L){var w=t(X,"DiceTable"),b=[w].concat(L);return function(M,D,G){var R=r(M,D,"RangeTable"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.name=g.items=g.num_of_dice=g.num_of_sides=g.formatter=o,q(f[0],"RollResult",C(E("Struct"),"new",["sum","values","content","formatted"],function _(){var u=_.$$s==null?this:_.$$s;return u.$alias_method("to_s","formatted")},{$$arity:0,$$s:R})),q(f[0],"Item",E("Struct").$new("range","content")),q(f[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),q(f[0],"DEFAULT_FORMATTER",C(R,"lambda",[],function(u,c){return u==null&&(u=o),c==null&&(c=o),""+u.$name()+"("+c.$sum()+") \uFF1E "+c.$content()},2)),R.$attr_reader("name"),R.$attr_reader("num_of_dice"),R.$attr_reader("num_of_sides"),h(R,"$initialize",function _(u,c,s){var i=_.$$p||o,n=this,$=o,l=o;return delete _.$$p,n.name=u.$freeze(),n.formatter=I($=i)?$:E("DEFAULT_FORMATTER"),l=E("DICE_ROLL_METHOD_RE").$match(c),I(l)||n.$raise(E("ArgumentError"),""+n.name+": invalid dice roll method: "+c),n.num_of_dice=l["$[]"](1).$to_i(),n.num_of_sides=l["$[]"](2).$to_i(),n.$store(s)},3),h(R,"$fetch",function(u){var c=this,s=o;return s=C(c.items,"find",[],function(n){return n==null&&(n=o),n.$range()["$include?"](u)},1),I(s)||c.$raise(E("RangeError"),""+c.name+": value is out of range: "+u),s},1),h(R,"$roll",function(u){var c=this,s=o,i=o,n=o,$=o;return s=u.$roll_barabara(c.num_of_dice,c.num_of_sides),i=s.$sum(),n=E("RollResult").$new(i,s,c.$fetch(i).$content()),$=[c.formatter["$[]"](c,n)],C(n,"formatted=",v($)),$[z($.length,1)],n},1),R.$private(),h(R,"$store",function(u){var c=this,s=o,i=o;return s=C(u,"map",[],function n($,l){var d=n.$$s==null?this:n.$$s;return $==null&&($=o),l==null&&(l=o),[d.$coerce_to_int_range($),l]},{$$arity:2,$$s:c}),i=C(s,"sort_by",[],function($,l){return $==null&&($=o),l==null&&(l=o),$.$min()},2),c.$assert_min_sum_is_covered(i),c.$assert_max_sum_is_covered(i),c.$assert_no_gap_or_overlap_in_ranges(i),c.items=C(i,"map",[],function($,l){return $==null&&($=o),l==null&&(l=o),E("Item").$new($,l.$freeze()).$freeze()},2).$freeze(),c},1),h(R,"$coerce_to_int_range",function(u){var c=this,s=o;return T(E("Integer"),s=u)?E("Range").$new(u,u):T(E("Range"),s)&&I(u.$begin()["$is_a?"](E("Integer")))&&I(u.$end()["$is_a?"](E("Integer")))?u:c.$raise(E("TypeError"),""+c.name+": "+u+" ("+u.$class()+") must be an Integer or a Range with Integers ")},1),h(R,"$assert_min_sum_is_covered",function(u){var c=this,s=o,i=o;return s=c.num_of_dice,i=u.$first()["$[]"](0),I(i["$include?"](s))||c.$raise(E("RangeError"),""+c.name+": min value ("+s+") is not covered: "+i),c},1),h(R,"$assert_max_sum_is_covered",function(u){var c=this,s=o,i=o;return s=U(c.num_of_dice,c.num_of_sides),i=u.$last()["$[]"](0),I(i["$include?"](s))||c.$raise(E("RangeError"),""+c.name+": max value ("+s+") is not covered: "+i),c},1),h(R,"$assert_no_gap_or_overlap_in_ranges",function(u){var c=this;return C(u,"each_cons",[2],function s(i,n){var $=s.$$s==null?this:s.$$s,l=o,d=o,m=o,k=o;return $.name==null&&($.name=o),i==null&&(i=o),n==null&&(n=o),l=i["$[]"](0),d=n["$[]"](0),m=l.$max(),k=J(m,1),I(d["$include?"](m))&&$.$raise(E("RangeError"),""+$.name+": Range overlap: "+l+" and "+d),I(d["$include?"](k))?o:$.$raise(E("RangeError"),""+$.name+": Range gap: "+l+" and "+d)},{$$arity:2,$$s:c}),c},1)}(b[0],null,b)}(B[0],B)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.send,I=e.def,h=e.rb_minus;return function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W);return function(B,X,L){var w=q(B,X,"SaiFicSkillTable"),b=[w].concat(L);return function(M,D,G){var R=q(M,D,"Category"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.name=o,I(R,"$initialize",function(u,c,s,i){var n=this;return n.name=u,n.skills=C(c.$map(),"with_index",[2],function(l,d){return l==null&&(l=o),d==null&&(d=o),t(E("SaiFicSkillTable"),"Skill").$new(u,l,s,d,i)},2),n.dice=s},4),I(R,"$roll",function(u){var c=this;return c.$skills()["$[]"](h(u.$roll_sum(2,6),2))},1),I(R,"$to_s",function(){var u=this;return u.name},0),R.$attr_reader("name","dice","skills")}(b[0],null,b)}(F[0],null,F)}(U[0],U)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.hash2;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"DiceTable"),W=[J].concat(U);return function(S,F,B){var X=r(S,F,"SaiFicSkillTable"),L=[X].concat(B);return function(w,b){var M=r(w,b,"Skill"),D=M.$$prototype;return D.s_format=D.category_dice=D.row_dice=D.category_name=D.name=o,q(M,"$initialize",function(R,f,E,g,_){var u=this;return u.category_name=R,u.name=f,u.category_dice=E,u.row_dice=g,u.s_format=_},5),q(M,"$to_s",function(){var R=this;return R.$format(R.s_format,C(["category_dice","row_dice","category_name","skill_name"],{category_dice:R.category_dice,row_dice:R.row_dice,category_name:R.category_name,skill_name:R.name}))},0),M.$attr_reader("category_name","name","category_dice","row_dice")}(L[0],null)}(W[0],null,W)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.hash2,h=e.send,v=e.hash,z=e.defs,T=e.const_set,U=e.to_ary,J=e.def,W=e.truthy,S=e.rb_minus,F=e.rb_plus;return A.$require("bcdice/dice_table/sai_fic_skill_table/category"),A.$require("bcdice/dice_table/sai_fic_skill_table/skill"),function(B,X){var L=q(B,"BCDice"),w=[L].concat(X);return function(b,M){var D=q(b,"DiceTable"),G=[D].concat(M);return function(R,f,E){var g=C(R,f,"SaiFicSkillTable"),_=[g].concat(E),u=e.$r(_),c=g.$$prototype;return c.rtt=c.rtt_format=c.rct=c.rct_format=c.rttn=c.rttn_format=c.categories=t,z(g,"$from_i18n",function(i,n,$){var l,d,m,k=this,x=t,Y=t,a=t;if($==null)$=I([],{});else if(!$.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return l=$.$$smap.rtt,l==null&&(l=t),d=$.$$smap.rct,d==null&&(d=t),m=$.$$smap.rttn,m==null&&(m=t),x=u("I18n").$t("RTT",I(["locale","raise","default"],{locale:n,raise:!1,default:I([],{})})),Y=x.$merge(u("I18n").$t(i,I(["locale","raise"],{locale:n,raise:!0}))),a=Y["$[]"]("items"),Y=h(Y,"select",[],function(p,H){return p==null&&(p=t),H==null&&(H=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](p)},2),k.$new(a,e.to_hash(Y).$merge(I(["rtt","rct","rttn"],{rtt:l,rct:d,rttn:m})))},-3),T(_[0],"DEFAULT_RTT","\u30E9\u30F3\u30C0\u30E0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uFF1E %<text>s"),T(_[0],"DEFAULT_RCT","\u30E9\u30F3\u30C0\u30E0\u5206\u91CE\u8868(%<category_dice>d) \uFF1E %<category_name>s"),T(_[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91CE\u30E9\u30F3\u30C0\u30E0\u7279\u6280\u8868(%<row_dice>d) \uFF1E %<text>s"),T(_[0],"DEFAULT_S","\u300A%<skill_name>s\uFF0F%<category_name>s%<row_dice>d\u300B"),J(g,"$initialize",function(i,n){var $,l,d,m,k,x,Y,a=this;if(n==null)n=I([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return $=n.$$smap.rtt,$==null&&($=t),l=n.$$smap.rct,l==null&&(l=t),d=n.$$smap.rttn,d==null&&(d=t),m=n.$$smap.rtt_format,m==null&&(m=u("DEFAULT_RTT")),k=n.$$smap.rct_format,k==null&&(k=u("DEFAULT_RCT")),x=n.$$smap.rttn_format,x==null&&(x=u("DEFAULT_RTTN")),Y=n.$$smap.s_format,Y==null&&(Y=u("DEFAULT_S")),a.categories=h(i.$map(),"with_index",[1],function(p,H){var Q,ee,ne=t,V=t;return p==null&&(p=t),H==null&&(H=t),ee=p,Q=U(ee),ne=Q[0]==null?t:Q[0],V=Q[1]==null?t:Q[1],r(u("SaiFicSkillTable"),"Category").$new(ne,V,H,Y)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),a.rtt=$,a.rct=l,a.rttn=d.$to_a(),a.rtt_format=m,a.rct_format=k,a.rttn_format=x},-2),T(_[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),g.$attr_reader("categories"),J(g,"$roll_command",function(i,n){var $=this,l=t,d=t,m=t;return l=n,W(["RTT",$.rtt]["$include?"](l))?$.$format_skill($.rtt_format,$.$roll_skill(i)):W(["RCT",$.rct]["$include?"](l))?(d=$.$roll_category(i),$.$format($.rct_format,I(["category_dice","category_name"],{category_dice:d.$dice(),category_name:d.$name()}))):W(m=u("RTTN").$index(l))||W(m=$.rttn.$index(l))?$.$format_skill($.rttn_format,$.categories["$[]"](m).$roll(i)):t},2),J(g,"$roll_category",function(i){var n=this;return n.categories["$[]"](S(i.$roll_once(6),1))},1),J(g,"$roll_skill",function(i){var n=this;return n.$roll_category(i).$roll(i)},1),J(g,"$prefixes",function(){var i=this;return F(["RTT[1-6]?","RCT",i.rtt,i.rct],i.rttn).$compact()},0),g.$private(),J(g,"$format_skill",function(i,n){var $=this;return $.$format(i,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)}(G[0],null,G)}(w[0],w)}(o[0],o)};Opal.modules["bcdice/dice_table/table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.truthy,h=e.def,v=e.rb_minus;return function(z,T){var U=t(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=t(W,"DiceTable"),B=[F].concat(S);return function(X,L,w){var b=r(X,L,"Table"),M=[b].concat(w),D=e.$r(M),G=b.$$prototype;return G.times=G.sides=G.name=G.items=o,C(b,"$from_i18n",function(f,E){var g=this,_=o;return _=D("I18n").$t(f,q(["locale"],{locale:E})),g.$new(_["$[]"]("name"),_["$[]"]("type"),_["$[]"]("items"))},2),h(b,"$initialize",function(f,E,g){var _=this,u=o;return _.name=f,_.items=g.$freeze(),u=/(\d+)D(\d+)/i.$match(E),I(u)||_.$raise(D("ArgumentError"),"Unexpected table type: "+E),_.times=u["$[]"](1).$to_i(),_.sides=u["$[]"](2).$to_i()},3),h(b,"$roll",function(f){var E=this,g=o;return g=f.$roll_sum(E.times,E.sides),E.$choice(g)},1),h(b,"$choice",function(f){var E=this,g=o;return g=v(f,E.times),D("RollResult").$new(E.name,f,E.items["$[]"](g))},1)}(B[0],null,B)}(J[0],J)}(A[0],A)};Opal.modules["bcdice/dice_table"]=function(e){var A=e.top,o=e.nil;return A.$require("bcdice/dice_table/roll_result"),A.$require("bcdice/dice_table/chain_table"),A.$require("bcdice/dice_table/d66_grid_table"),A.$require("bcdice/dice_table/d66_half_grid_table"),A.$require("bcdice/dice_table/d66_one_third_table"),A.$require("bcdice/dice_table/d66_left_range_table"),A.$require("bcdice/dice_table/d66_parity_table"),A.$require("bcdice/dice_table/d66_range_table"),A.$require("bcdice/dice_table/d66_table"),A.$require("bcdice/dice_table/range_table"),A.$require("bcdice/dice_table/sai_fic_skill_table"),A.$require("bcdice/dice_table/table")};Opal.modules["bcdice/enum"]=function(e){var A=[],o=e.nil,t=e.module,r=e.const_set;return function(q,C){var I=t(q,"BCDice"),h=[I].concat(C);return function(v,z){var T=t(v,"D66SortType"),U=[T].concat(z);return r(U[0],"NO_SORT","no_sort"),r(U[0],"ASC","asc"),r(U[0],"DESC","desc")}(h[0],h),function(v,z){var T=t(v,"RoundType"),U=[T].concat(z);return r(U[0],"CEIL","ceil"),r(U[0],"FLOOR","floor"),r(U[0],"ROUND","round")}(h[0],h)}(A[0],A)};Opal.modules["bcdice/translate"]=function(e){var A=[],o=e.nil,t=e.module,r=e.hash2,q=e.hash,C=e.def;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"Translate"),W=[J].concat(U),S=e.$r(W);return C(J,"$translate",function(B,X){var L,w=this;if(w.locale==null&&(w.locale=o),X==null)X=r([],{});else if(!X.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return L=e.kwrestargs(X,{}),S("I18n").$translate(B,r(["locale","raise"],{locale:w.locale,raise:!0}).$merge(e.to_hash(L)))},-2)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/result"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.send,C=e.to_a,I=e.rb_minus,h=e.def;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W,S){var F=r(J,W,"Result"),B=[F].concat(S),X=F.$$prototype;return X.secret=X.success=X.failure=X.critical=X.fumble=o,function(L,w){return h(L,"$success",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$failure",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$critical",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"critical=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$fumble",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"fumble=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$nothing",function(){return"nothing"},0)}(e.get_singleton_class(F),B),h(F,"$initialize",function(w){var b=this;return w==null&&(w=o),b.text=w,b.rands=o,b.detailed_rands=o,b.secret=!1,b.success=!1,b.failure=!1,b.critical=!1,b.fumble=!1},-1),F.$attr_accessor("text","rands","detailed_rands"),F.$attr_writer("secret","success","failure","critical","fumble"),h(F,"$secret?",function(){var w=this;return w.secret},0),h(F,"$success?",function(){var w=this;return w.success},0),h(F,"$failure?",function(){var w=this;return w.failure},0),h(F,"$critical?",function(){var w=this;return w.critical},0),h(F,"$fumble?",function(){var w=this;return w.fumble},0),h(F,"$condition=",function(w){var b=this;return b.success=w,b.failure=w["$!"]()},1)}(U[0],null,U)}(A[0],A)};Opal.modules["racc/parser"]=function(e){var A,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.const_set,z=e.defs,T=e.gvars,U=e.rb_lt,J=e.send,W=e.to_a,S=e.rb_minus,F=e.def,B=e.to_ary,X=e.neqeq,L=e.rb_plus,w=e.eqeq,b=e.rb_ge,M=e.rb_gt,D=e.eqeqeq,G=e.rb_le,R=e.rb_times;return function(f,E){var g=C(f,"Racc"),_=[g].concat(E),u=e.$r(_);return I(_[0],u("StandardError"),"ParseError"),r}(o[0],o),h((A=q("::","ParseError","skip_raise"))?"constant":r)||v(o[0],"ParseError",q(t("Racc"),"ParseError")),function(f,E){var g=C(f,"Racc"),_,u=[g].concat(E),c=e.$r(u);return h((_=c("Racc_No_Extensions","skip_raise"))?"constant":r)||v(u[0],"Racc_No_Extensions",!1),function(s,i,n){var $=I(s,i,"Parser"),l=[$].concat(n),d=e.$r(l),m=$.$$prototype;return m.yydebug=m.racc_debug_out=m.racc_error_status=m.racc_t=m.racc_vstack=m.racc_val=m.racc_state=m.racc_tstack=r,v(l[0],"Racc_Runtime_Version","1.4.6"),v(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),v(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),v(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),v(l[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),v(l[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),v(l[0],"Racc_Runtime_Type","ruby"),z(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")},0),F($,"$_racc_setup",function(){var x,Y,a=this,N=r,p=r,H=r;return T.stderr==null&&(T.stderr=r),h(q(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),h((x=a.yydebug,x!=null&&x!==r?"instance-variable":r))||(a.yydebug=!1),h(a.yydebug)&&(h((Y=a.racc_debug_out,Y!=null&&Y!==r?"instance-variable":r))||(a.racc_debug_out=T.stderr),a.racc_debug_out=h(N=a.racc_debug_out)?N:T.stderr),p=q(a.$class(),"Racc_arg"),h(U(p.$size(),14))&&(H=[13,!0],J(p,"[]=",W(H)),H[S(H.length,1)]),p},0),F($,"$_racc_init_sysvars",function(){var x=this;return x.racc_state=[0],x.racc_tstack=[],x.racc_vstack=[],x.racc_t=r,x.racc_val=r,x.racc_read_next=!0,x.racc_user_yyerror=!1,x.racc_error_status=0},0),F($,"$do_parse",function(){var x=this;return x.$__send__(d("Racc_Main_Parsing_Routine"),x.$_racc_setup(),!1)},0),F($,"$next_token",function(){var x=this;return x.$raise(d("NotImplementedError"),""+x.$class()+"#next_token is not defined")},0),F($,"$_racc_do_parse_rb",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;return N=x,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],V=a[4]==null?r:a[4],V=a[5]==null?r:a[5],V=a[6]==null?r:a[6],V=a[7]==null?r:a[7],V=a[8]==null?r:a[8],V=a[9]==null?r:a[9],Z=a[10]==null?r:a[10],V=a[11]==null?r:a[11],V=a[12]==null?r:a[12],V=a[13]==null?r:a[13],p.$_racc_init_sysvars(),y=K=P=r,J(p,"catch",["racc_end_parse"],function j(){var O,re,te,ie=j.$$s==null?this:j.$$s,$e=r;for(ie.racc_state==null&&(ie.racc_state=r),ie.racc_read_next==null&&(ie.racc_read_next=r),ie.racc_t==null&&(ie.racc_t=r),ie.yydebug==null&&(ie.yydebug=r),ie.racc_val==null&&(ie.racc_val=r);h(!0);)for(h(P=ne["$[]"](ie.racc_state["$[]"](-1)))?(h(ie.racc_read_next)&&X(ie.racc_t,0)&&(te=ie.$next_token(),re=B(te),y=re[0]==null?r:re[0],ie.racc_val=re[1]==null?r:re[1],h(y)?ie.racc_t=h($e=Z["$[]"](y))?$e:1:ie.racc_t=0,h(ie.yydebug)&&ie.$racc_read_token(ie.racc_t,y,ie.racc_val),ie.racc_read_next=!1),P=L(P,ie.racc_t),h(b(P,0))&&h(K=H["$[]"](P))&&w(Q["$[]"](P),ie.racc_state["$[]"](-1))||(K=ee["$[]"](ie.racc_state["$[]"](-1)))):K=ee["$[]"](ie.racc_state["$[]"](-1));h(K=ie.$_racc_evalact(K,x)););},{$$arity:0,$$s:p})},2),F($,"$yyparse",function(x,Y){var a=this;return a.$__send__(d("Racc_YY_Parse_Method"),x,Y,a.$_racc_setup(),!0)},2),F($,"$_racc_yyparse_rb",function(x,Y,a,N){var p,H,Q=this,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r;return H=a,p=B(H),ee=p[0]==null?r:p[0],ne=p[1]==null?r:p[1],V=p[2]==null?r:p[2],Z=p[3]==null?r:p[3],y=p[4]==null?r:p[4],y=p[5]==null?r:p[5],y=p[6]==null?r:p[6],y=p[7]==null?r:p[7],y=p[8]==null?r:p[8],y=p[9]==null?r:p[9],K=p[10]==null?r:p[10],y=p[11]==null?r:p[11],y=p[12]==null?r:p[12],y=p[13]==null?r:p[13],Q.$_racc_init_sysvars(),P=r,j=r,J(Q,"catch",["racc_end_parse"],function O(){var re,te,ie=O.$$s==null?this:O.$$s;for(ie.racc_state==null&&(ie.racc_state=r);!h(j=Z["$[]"](ie.racc_state["$[]"](-1)));)for(;h(P=ie.$_racc_evalact(V["$[]"](ie.racc_state["$[]"](-1)),a)););return J(x,"__send__",[Y],function $e(se,oe){var le,ce,ue=$e.$$s==null?this:$e.$$s,ae=r,_e=r;for(ue.racc_t==null&&(ue.racc_t=r),ue.racc_state==null&&(ue.racc_state=r),ue.racc_read_next==null&&(ue.racc_read_next=r),se==null&&(se=r),oe==null&&(oe=r),h(se)?ue.racc_t=h(ae=K["$[]"](se))?ae:1:ue.racc_t=0,ue.racc_val=oe,ue.racc_read_next=!1,j=L(j,ue.racc_t),h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););for(;h(h(ae=h(_e=(j=Z["$[]"](ue.racc_state["$[]"](-1)))["$!"]())?_e:ue.racc_read_next["$!"]())?ae:ue.racc_t["$=="](0));)for(h(j)&&h(j=L(j,ue.racc_t))&&h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););},{$$arity:2,$$s:ie})},{$$arity:0,$$s:Q})},4),F($,"$_racc_evalact",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;if(N=Y,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],ee=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ee=a[6]==null?r:a[6],ee=a[7]==null?r:a[7],ee=a[8]==null?r:a[8],ee=a[9]==null?r:a[9],ee=a[10]==null?r:a[10],V=a[11]==null?r:a[11],Z=a[12]==null?r:a[12],ee=a[13]==null?r:a[13],ee=a[14]==null?r:a[14],h(M(x,0))&&h(U(x,V)))h(M(p.racc_error_status,0))&&(w(p.racc_t,1)||(p.racc_error_status=S(p.racc_error_status,1))),p.racc_vstack.$push(p.racc_val),p.racc_state.$push(x),p.racc_read_next=!0,h(p.yydebug)&&(p.racc_tstack.$push(p.racc_t),p.$racc_shift(p.racc_t,p.racc_tstack,p.racc_vstack));else if(h(U(x,0))&&h(M(x,Z["$-@"]()))){if(y=J(p,"catch",["racc_jump"],function j(){var O=j.$$s==null?this:j.$$s;return O.racc_state==null&&(O.racc_state=r),O.racc_state.$push(O.$_racc_do_reduce(Y,x)),!1},{$$arity:0,$$s:p}),h(y)){if(D(1,K=y))return p.racc_user_yyerror=!0,Z["$-@"]();if(D(2,K))return V;p.$raise("[Racc Bug] unknown jump code")}}else if(w(x,V))h(p.yydebug)&&p.$racc_accept(),p.$throw("racc_end_parse",p.racc_vstack["$[]"](0));else if(w(x,Z["$-@"]())){for(D(0,K=p.racc_error_status)?h(Y["$[]"](21))||p.$on_error(p.racc_t,p.racc_val,p.racc_vstack):D(3,K)&&(w(p.racc_t,0)&&p.$throw("racc_end_parse",r),p.racc_read_next=!0),p.racc_user_yyerror=!1,p.racc_error_status=3;h(!0)&&!(h(P=ne["$[]"](p.racc_state["$[]"](-1)))&&(P=L(P,1),h(b(P,0))&&h(x=H["$[]"](P))&&w(Q["$[]"](P),p.racc_state["$[]"](-1))));)h(G(p.racc_state.$size(),1))&&p.$throw("racc_end_parse",r),p.racc_state.$pop(),p.racc_vstack.$pop(),h(p.yydebug)&&(p.racc_tstack.$pop(),p.$racc_e_pop(p.racc_state,p.racc_tstack,p.racc_vstack));return x}else p.$raise("[Racc Bug] unknown action "+x.$inspect());return h(p.yydebug)&&p.$racc_next_state(p.racc_state["$[]"](-1),p.racc_state),r},2),F($,"$_racc_do_reduce",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r,O=r,re=r,te=r,ie=r,$e=r,se=r,oe=r,le=r,ce=r,ue=r,ae=r;return N=x,a=B(N),H=a[0]==null?r:a[0],H=a[1]==null?r:a[1],H=a[2]==null?r:a[2],H=a[3]==null?r:a[3],Q=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ne=a[6]==null?r:a[6],V=a[7]==null?r:a[7],Z=a[8]==null?r:a[8],y=a[9]==null?r:a[9],H=a[10]==null?r:a[10],H=a[11]==null?r:a[11],H=a[12]==null?r:a[12],K=a[13]==null?r:a[13],P=p.racc_state,j=p.racc_vstack,O=p.racc_tstack,re=R(Y,-3),te=y["$[]"](re),ie=y["$[]"](L(re,1)),$e=y["$[]"](L(re,2)),se=[],h(p.yydebug)&&(oe=O["$[]"](te["$-@"](),te)),le=j["$[]"](te["$-@"](),te),h(p.yydebug)&&(ce=[te["$-@"](),te,se],J(O,"[]=",W(ce)),ce[S(ce.length,1)]),ce=[te["$-@"](),te,se],J(j,"[]=",W(ce)),ce[S(ce.length,1)],ce=[te["$-@"](),te,se],J(P,"[]=",W(ce)),ce[S(ce.length,1)],h(K)?j.$push(p.$__send__($e,le,j,le["$[]"](0))):j.$push(p.$__send__($e,le,j)),O.$push(ie),h(p.yydebug)&&p.$racc_reduce(oe,ie,O,j),ue=S(ie,Z),h(re=V["$[]"](ue))&&(re=L(re,P["$[]"](-1)),h(b(re,0))&&h(ae=Q["$[]"](re))&&w(ee["$[]"](re),ue))?ae:ne["$[]"](ue)},2),F($,"$on_error",function(x,Y,a){var N=this,p=r;return N.$raise(d("ParseError"),N.$sprintf(`
parse error on value %s (%s)`,Y.$inspect(),h(p=N.$token_to_str(x))?p:"?"))},3),F($,"$yyerror",function(){var x=this;return x.$throw("racc_jump",1)},0),F($,"$yyaccept",function(){var x=this;return x.$throw("racc_jump",2)},0),F($,"$yyerrok",function(){var x=this;return x.racc_error_status=0},0),F($,"$racc_read_token",function(x,Y,a){var N=this;return N.racc_debug_out.$print("read    "),N.racc_debug_out.$print(Y.$inspect(),"(",N.$racc_token2str(x),") "),N.racc_debug_out.$puts(a.$inspect()),N.racc_debug_out.$puts()},3),F($,"$racc_shift",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("shift   "+N.$racc_token2str(x)),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_reduce",function(x,Y,a,N){var p=this,H=r;return H=p.racc_debug_out,H.$print("reduce "),h(x["$empty?"]())?H.$print(" <none>"):J(x,"each",[],function Q(ee){var ne=Q.$$s==null?this:Q.$$s;return ee==null&&(ee=r),H.$print(" ",ne.$racc_token2str(ee))},{$$arity:1,$$s:p}),H.$puts(" --> "+p.$racc_token2str(Y)),p.$racc_print_stacks(a,N),p.racc_debug_out.$puts()},4),F($,"$racc_accept",function(){var x=this;return x.racc_debug_out.$puts("accept"),x.racc_debug_out.$puts()},0),F($,"$racc_e_pop",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("error recovering mode: pop token"),N.$racc_print_states(x),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_next_state",function(x,Y){var a=this;return a.racc_debug_out.$puts("goto    "+x),a.$racc_print_states(Y),a.racc_debug_out.$puts()},2),F($,"$racc_print_stacks",function(x,Y){var a=this,N=r;return N=a.racc_debug_out,N.$print("        ["),J(x,"each_index",[],function p(H){var Q=p.$$s==null?this:p.$$s;return H==null&&(H=r),N.$print(" (",Q.$racc_token2str(x["$[]"](H))," ",Y["$[]"](H).$inspect(),")")},{$$arity:1,$$s:a}),N.$puts(" ]")},2),F($,"$racc_print_states",function(x){var Y=this,a=r;return a=Y.racc_debug_out,a.$print("        ["),J(x,"each",[],function(p){return p==null&&(p=r),a.$print(" ",p)},1),a.$puts(" ]")},1),F($,"$racc_token2str",function(x){var Y=this,a=r;return h(a=q(Y.$class(),"Racc_token_to_s_table")["$[]"](x))?a:Y.$raise("[Racc Bug] can't convert token "+x+" to string")},1),F($,"$token_to_str",function(x){var Y=this;return q(Y.$class(),"Racc_token_to_s_table")["$[]"](x)},1)}(u[0],null,u)}(o[0],o)};Opal.modules["bcdice/arithmetic/node"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.def,I=e.send2,h=e.find_super,v=e.eqeq,z=e.const_set,T=e.eqeqeq,U=e.rb_divide,J=e.truthy,W=e.alias;return function(S,F){var B=r(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=r(L,"Arithmetic"),M=[b].concat(w);return function(D,G){var R=r(D,"Node"),f=[R].concat(G),E=e.$r(f);return function(g,_){var u=q(g,_,"BinaryOp"),c=u.$$prototype;return c.lhs=c.rhs=c.op=o,C(u,"$initialize",function(i,n,$){var l=this;return l.lhs=i,l.op=n,l.rhs=$},3),C(u,"$eval",function(i){var n=this,$=o,l=o;return $=n.lhs.$eval(i),l=n.rhs.$eval(i),$.$send(n.op,l)},1),C(u,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),C(u,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),C(u,"$op_for_s_exp",function(){var i=this;return i.op},0)}(f[0],null),function(g,_,u){var c=q(g,_,"DivideBase"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.lhs=n.rhs=n.op=o,C(c,"$initialize",function $(l,d){var m=$.$$p||o,k=this;return delete $.$$p,I(k,h(k,"initialize",$,!1,!0),"initialize",[l,"/",d],null)},2),C(c,"$eval",function(l){var d=this,m=o,k=o;return m=d.lhs.$eval(l),k=d.rhs.$eval(l),v(k,0)&&d.$raise(i("ZeroDivisionError")),d.$divide_and_round(m,k,l)},1),C(c,"$output",function $(){var l=$.$$p||o,d=this;return delete $.$$p,""+I(d,h(d,"output",$,!1,!0),"output",[],l)+d.$rounding_method()},0),c.$private(),C(c,"$rounding_method",function(){var l=this;return t(l.$class(),"ROUNDING_METHOD")},0),C(c,"$op_for_s_exp",function(){var l=this;return""+l.op+l.$rounding_method()},0),C(c,"$divide_and_round",function(l,d,m){var k=this;return k.$raise(i("NotImplementedError"))},3)}(f[0],E("BinaryOp"),f),function(g,_,u){var c=q(g,_,"DivideWithGameSystemDefault"),s=[c].concat(u),i=e.$r(s);return z(s[0],"ROUNDING_METHOD",""),c.$private(),C(c,"$divide_and_round",function($,l,d){var m=o,k=o;return T(t(i("RoundType"),"CEIL"),m=d)?U($.$to_f(),l).$ceil():T(t(i("RoundType"),"ROUND"),m)?(k=U($.$to_f(),l),J(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):U($,l).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithCeil"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","C"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n.$to_f(),$).$ceil()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithRound"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","R"),c.$private(),C(c,"$divide_and_round",function(n,$,l){var d=o;return d=U(n.$to_f(),$),J(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithFloor"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","F"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n,$).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_){var u=q(g,_,"Negative"),c=u.$$prototype;return c.body=o,C(u,"$initialize",function(i){var n=this;return n.body=i},1),C(u,"$eval",function(i){var n=this;return n.body.$eval(i)["$-@"]()},1),C(u,"$output",function(){var i=this;return"-"+i.body.$output()},0),C(u,"$s_exp",function(){var i=this;return"(- "+i.body.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Parenthesis"),c=u.$$prototype;return c.expr=o,C(u,"$initialize",function(i){var n=this;return n.expr=i},1),C(u,"$eval",function(i){var n=this;return n.expr.$eval(i)},1),C(u,"$output",function(){var i=this;return"("+i.expr.$output()+")"},0),C(u,"$s_exp",function(){var i=this;return"(Parenthesis "+i.expr.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Number"),c=u.$$prototype;return c.value=o,C(u,"$initialize",function(i){var n=this;return n.value=i},1),C(u,"$eval",function(i){var n=this;return n.value},1),C(u,"$output",function(){var i=this;return i.value.$to_s()},0),W(u,"s_exp","output")}(f[0],null)}(M[0],M)}(X[0],X)}(A[0],A)};Opal.modules.strscan=function(e){var A=[],o=e.nil,t=e.klass,r=e.def,q=e.truthy,C=e.eqeqeq,I=e.Opal,h=e.send,v=e.to_a,z=e.rb_minus,T=e.alias;return function(U,J,W){var S=t(U,J,"StringScanner"),F=[S].concat(W),B=e.$r(F),X=S.$$prototype;return X.pos=X.string=X.working=X.matched=X.prev_pos=X.match=o,S.$attr_reader("pos","matched"),r(S,"$initialize",function(w){var b=this;return b.string=w,b.pos=0,b.matched=o,b.working=w,b.match=[]},1),S.$attr_reader("string"),r(S,"$beginning_of_line?",function(){var w=this;return w.pos===0||w.string.charAt(w.pos-1)===`
`},0),r(S,"$scan",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:typeof M=="object"?(b.prev_pos=b.pos,b.pos+=M[0].length,b.working=b.working.substring(M[0].length),b.matched=M[0],b.match=M,M[0]):typeof M=="string"?(b.pos+=M.length,b.working=b.working.substring(M.length),M):o},1),r(S,"$scan_until",function(w){var b=this;w=b.$anchor(w);for(var M=b.pos,D=b.working,G;;){if(G=w.exec(D),M+=1,D=D.substr(1),G==null){if(D.length===0)return b.match=[],b.matched=o;continue}return b.matched=b.string.substr(b.pos,M-b.pos-1+G[0].length),b.match=G,b.prev_pos=M-1,b.pos=M,b.working=D.substr(G[0].length),b.matched}},1),r(S,"$[]",function(w){var b=this,M=o;if(q(b.match["$empty?"]()))return o;C(B("Symbol"),M=w)?w=w.$to_s():C(B("String"),M)||(w=I["$coerce_to!"](w,B("Integer"),"to_int"));var D=b.match;return w<0&&(w+=D.length),w<0||w>=D.length||D[w]==null?o:D[w]},1),r(S,"$check",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:b.matched=M[0]},1),r(S,"$check_until",function(w){var b=this,M=b.prev_pos,D=b.pos,G=b.$scan_until(w);return G!==o&&(b.matched=G.substr(-1),b.working=b.string.substr(D)),b.prev_pos=M,b.pos=D,G},1),r(S,"$peek",function(w){var b=this;return b.working.substring(0,w)},1),r(S,"$eos?",function(){var w=this;return w.working.length===0},0),r(S,"$exist?",function(w){var b=this,M=w.exec(b.working);return M==null?o:M.index==0?0:M.index+1},1),r(S,"$skip",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);if(M==null)return b.match=[],b.matched=o;var D=M[0],G=D.length;return b.matched=D,b.match=M,b.prev_pos=b.pos,b.pos+=G,b.working=b.working.substring(G),G},1),r(S,"$skip_until",function(w){var b=this,M=b.$scan_until(w);return M===o?o:(b.matched=M.substr(-1),M.length)},1),r(S,"$get_byte",function(){var w=this,b=o;return w.pos<w.string.length?(w.prev_pos=w.pos,w.pos+=1,b=w.matched=w.working.substring(0,1),w.working=w.working.substring(1)):w.matched=o,b},0),r(S,"$match?",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?o:(b.prev_pos=b.pos,M[0].length)},1),r(S,"$pos=",function(w){var b=this;return w<0&&(w+=b.string.$length()),b.pos=w,b.working=b.string.slice(w)},1),r(S,"$matched_size",function(){var w=this;return w.matched===o?o:w.matched.length},0),r(S,"$post_match",function(){var w=this;return w.matched===o?o:w.string.substr(w.pos)},0),r(S,"$pre_match",function(){var w=this;return w.matched===o?o:w.string.substr(0,w.prev_pos)},0),r(S,"$reset",function(){var w=this;return w.working=w.string,w.matched=o,w.pos=0},0),r(S,"$rest",function(){var w=this;return w.working},0),r(S,"$rest?",function(){var w=this;return w.working.length!==0},0),r(S,"$rest_size",function(){var w=this;return w.$rest().$size()},0),r(S,"$terminate",function(){var w=this,b=o;return w.match=o,b=[w.string.$length()],h(w,"pos=",v(b)),b[z(b.length,1)]},0),r(S,"$unscan",function(){var w=this;return w.pos=w.prev_pos,w.prev_pos=o,w.match=o,w},0),T(S,"bol?","beginning_of_line?"),T(S,"getch","get_byte"),S.$private(),r(S,"$anchor",function(w){var b=w.toString().match(/\/([^\/]+)$/);return b=b?b[1]:void 0,new RegExp("^(?:"+w.source+")",b)},1)}(A[0],null,A)};Opal.modules["bcdice/normalize"]=function(e){var A=[],o=e.nil,t=e.module,r=e.eqeqeq,q=e.def,C=e.eqeq;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T){var U=t(T,"Normalize");return U.$module_function(),q(U,"$comparison_operator",function(W){var S=o;return r(/<=|=</,S=W)?"<=":r(/>=|=>/,S)?">=":r(/<>|!=|=!/,S)?"!=":r(/</,S)?"<":r(/>/,S)?">":r(/=/,S)?"==":o},1),q(U,"$target_number",function(W){return C(W,"?")?W:W.$to_i()},1)}(z[0])}(A[0],A)};Opal.modules["bcdice/command/lexer"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.truthy,v=e.send,z=e.def;return A.$require("strscan"),A.$require("bcdice/normalize"),function(T,U){var J=r(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=r(S,"Command"),X=[B].concat(F);return function(L,w,b){var M=q(L,w,"Lexer"),D=[M].concat(b),G=e.$r(D),R=M.$$prototype;return R.scanner=R.notations=t,C(D[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),z(M,"$initialize",function(E,g){var _,u,c=this,s=t;return E=h(s=(u=(_=E,_===t||_==null?t:v(_,"split",[" ",2])),u===t||u==null?t:v(u,"first",[])))?s:"",c.scanner=G("StringScanner").$new(E),c.notations=v(g,"map",[],function(n){return n==null&&(n=t),h(n["$is_a?"](G("String")))?G("Regexp").$new(n):n},1)},2),z(M,"$next_token",function(){try{var E=this,g=t,_=t,u=t,c=t,s=t;return h(E.scanner["$eos?"]())?[!1,"$"]:(v(E.notations,"each",[],function i(n){var $=i.$$s==null?this:i.$$s,l=t;if($.scanner==null&&($.scanner=t),n==null&&(n=t),l=$.scanner.$scan(n),h(l))e.ret(["NOTATION",l]);else return t},{$$arity:1,$$s:E}),h(g=E.scanner.$scan(/\d+/))?["NUMBER",g.$to_i()]:h(_=E.scanner.$scan(/[<>!=]+/))?(_=G("Normalize").$comparison_operator(_),u=h(_)?"CMP_OP":"ILLEGAL",[u,_]):(c=E.scanner.$getch().$upcase(),u=h(s=G("SYMBOLS")["$[]"](c))?s:c.$to_sym(),[u,c]))}catch(i){if(i===e.returner)return i.$v;throw i}},0),z(M,"$source",function(){var E=this;return E.scanner.$string()},0)}(X[0],null,X)}(W[0],W)}(o[0],o)};Opal.modules["bcdice/command/parsed"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.truthy,I=e.eqeqeq;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"Command"),S=[W].concat(J);return function(F,B,X){var L=r(F,B,"Parsed"),w=[L].concat(X),b=e.$r(w),M=L.$$prototype;return M.question_target=M.critical=M.fumble=M.dollar=M.modify_number=M.target_number=M.prefix_number=M.command=M.suffix_number=M.cmp_op=o,L.$attr_accessor("command"),L.$attr_accessor("prefix_number"),L.$attr_accessor("suffix_number"),L.$attr_accessor("critical"),L.$attr_accessor("fumble"),L.$attr_accessor("dollar"),L.$attr_accessor("modify_number"),L.$attr_accessor("cmp_op"),L.$attr_accessor("target_number"),L.$attr_writer("question_target"),q(L,"$initialize",function(){var G=this;return G.prefix_number=o,G.suffix_number=o,G.critical=o,G.fumble=o,G.dollar=o,G.cmp_op=o,G.target_number=o,G.question_target=!1},0),q(L,"$question_target?",function(){var G=this;return G.question_target},0),q(L,"$to_s",function(G){var R=this,f=o,E=o,g=o,_=o,u=o,c=o;return G==null&&(G="after_command"),f=C(R.critical)?"@"+R.critical:o,E=C(R.fumble)?"#"+R.fumble:o,g=C(R.dollar)?"$"+R.dollar:o,_=b("Format").$modifier(R.modify_number),u=C(R.question_target)?"?":R.target_number,I("after_command",c=G)?[R.prefix_number,R.command,R.suffix_number,f,E,g,_,R.cmp_op,u].$join():I("after_modify_number",c)?[R.prefix_number,R.command,R.suffix_number,_,f,E,g,R.cmp_op,u].$join():I("after_target_number",c)?[R.prefix_number,R.command,R.suffix_number,_,R.cmp_op,u,f,E,g].$join():o},-1)}(S[0],null,S)}(T[0],T)}(A[0],A)};Opal.modules["bcdice/command/parser"]=function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.klass,I=e.module,h=e.hash2,v=e.send2,z=e.find_super,T=e.def,U=e.send,J=e.to_a,W=e.rb_minus,S=e.eqeq,F=e.hash,B=e.const_set,X=e.truthy,L=e.to_ary;return A.$require("racc/parser.rb"),A.$require("bcdice/arithmetic/node"),A.$require("bcdice/command/lexer"),A.$require("bcdice/command/parsed"),C(q(t("BCDice"),"Command"),q(t("Racc"),"Parser"),"Parser"),function(w,b){var M=I(w,"BCDice"),D=[M].concat(b);return function(G,R){var f=I(G,"Command"),E=[f].concat(R),g=e.$r(E);return function(_,u,c){var s=C(_,u,"Parser"),i=[s].concat(c),n=e.$r(i),$=r,l=r,d=r,m=r,k=r,x=r,Y=r,a=r,N=r,p=r,H=r,Q=r,ee=r,ne=r,V=s.$$prototype;return V.notations=V.lexer=V.modifier=V.suffix_number=V.prefix_number=V.need_suffix_number=V.need_prefix_number=V.critical=V.fumble=V.dollar=V.allowed_cmp_op=V.question_target=r,T(s,"$initialize",function Z(y,K){var P,j,O,re,te=Z.$$p||r,ie=this;if(delete Z.$$p,P=e.slice.call(arguments),j=e.extract_kwargs(P),j==null)j=h([],{});else if(!j.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(O=P,!e.hasOwnProperty.call(j.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return re=j.$$smap.round_type,v(ie,z(ie,"initialize",Z,!1,!0),"initialize",[],null),ie.notations=O,ie.round_type=re,ie.prefix_number=!1,ie.suffix_number=!1,ie.need_prefix_number=!1,ie.need_suffix_number=!1,ie.modifier=!0,ie.critical=!1,ie.fumble=!1,ie.dollar=!1,ie.allowed_cmp_op=[r,">=",">","<=","<","==","!="],ie.question_target=!1},-2),T(s,"$disable_modifier",function(){var y=this;return y.modifier=!1,y},0),T(s,"$enable_prefix_number",function(){var y=this;return y.prefix_number=!0,y},0),T(s,"$enable_suffix_number",function(){var y=this;return y.suffix_number=!0,y},0),T(s,"$has_prefix_number",function(){var y=this;return y.prefix_number=!0,y.need_prefix_number=!0,y},0),T(s,"$has_suffix_number",function(){var y=this;return y.suffix_number=!0,y.need_suffix_number=!0,y},0),T(s,"$enable_critical",function(){var y=this;return y.critical=!0,y},0),T(s,"$enable_fumble",function(){var y=this;return y.fumble=!0,y},0),T(s,"$enable_dollar",function(){var y=this;return y.dollar=!0,y},0),T(s,"$restrict_cmp_op_to",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,j.allowed_cmp_op=P,j},-1),T(s,"$enable_question_target",function(){var y=this;return y.question_target=!0,y},0),T(s,"$parse",function(y){var K=this;try{return K.lexer=n("Lexer").$new(y,K.notations),K.$do_parse()}catch(P){if(e.rescue(P,[n("ParseError"),n("ZeroDivisionError")]))try{return r}finally{e.pop_exception()}else throw P}},1),s.$private(),T(s,"$parsed",function(y,K,P,j){var O=this;return U(n("Parsed").$new(),"tap",[],function re(te){var ie,$e,se,oe,le,ce,ue=re.$$s==null?this:re.$$s,ae=r;return ue.round_type==null&&(ue.round_type=r),te==null&&(te=r),ae=[y["$[]"]("command")],U(te,"command=",J(ae)),ae[W(ae.length,1)],ae=[(ie=y["$[]"]("prefix"),ie===r||ie==null?r:U(ie,"eval",[ue.round_type]))],U(te,"prefix_number=",J(ae)),ae[W(ae.length,1)],ae=[($e=y["$[]"]("suffix"),$e===r||$e==null?r:U($e,"eval",[ue.round_type]))],U(te,"suffix_number=",J(ae)),ae[W(ae.length,1)],ae=[(se=K["$[]"]("critical"),se===r||se==null?r:U(se,"eval",[ue.round_type]))],U(te,"critical=",J(ae)),ae[W(ae.length,1)],ae=[(oe=K["$[]"]("fumble"),oe===r||oe==null?r:U(oe,"eval",[ue.round_type]))],U(te,"fumble=",J(ae)),ae[W(ae.length,1)],ae=[(le=K["$[]"]("dollar"),le===r||le==null?r:U(le,"eval",[ue.round_type]))],U(te,"dollar=",J(ae)),ae[W(ae.length,1)],ae=[P.$eval(ue.round_type)],U(te,"modify_number=",J(ae)),ae[W(ae.length,1)],ae=[j["$[]"]("cmp_op")],U(te,"cmp_op=",J(ae)),ae[W(ae.length,1)],S(j["$[]"]("target"),"?")?(ae=[!0],U(te,"question_target=",J(ae)),ae[W(ae.length,1)],ae=[0],U(te,"target_number=",J(ae)),ae[W(ae.length,1)]):(ae=[!1],U(te,"question_target=",J(ae)),ae[W(ae.length,1)],ae=[(ce=j["$[]"]("target"),ce===r||ce==null?r:U(ce,"eval",[ue.round_type]))],U(te,"target_number=",J(ae)),ae[W(ae.length,1)])},{$$arity:1,$$s:O})},4),T(s,"$next_token",function(){var y=this;return y.lexer.$next_token()},0),$=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],l=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],d=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],m=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],k=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],x=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Y=[r,6,13,3,9,-1,27,-15,-10,-1,-38],a=[r,r,r,r,r,r,19,16,15,r,r],N=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],p=35,H=58,Q=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),ee=19,ne=!0,B(i[0],"Racc_arg",[$,l,m,d,k,x,a,Y,ee,N,Q,H,p,ne]),B(i[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),B(i[0],"Racc_debug_parser",!1),T(s,"$_reduce_1",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return X(re.modifier)||re.$raise(n("ParseError")),O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],se=j[3]==null?r:j[3],P=re.$parsed(te,ie,$e,se),P},3),T(s,"$_reduce_2",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return X(re.modifier)||re.$raise(n("ParseError")),O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],se=j[3]==null?r:j[3],P=re.$parsed(te,$e,ie,se),P},3),T(s,"$_reduce_3",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],P=re.$parsed(te,ie,q(q(n("Arithmetic"),"Node"),"Number").$new(0),$e),P},3),T(s,"$_reduce_4",function(y,K,P){var j=this;return X(j.prefix_number)&&X(j.suffix_number)||j.$raise(n("ParseError")),P=h(["command","prefix","suffix"],{command:y["$[]"](1),prefix:y["$[]"](0),suffix:y["$[]"](2)}),P},3),T(s,"$_reduce_5",function(y,K,P){var j=this;return X(j.prefix_number)||j.$raise(n("ParseError")),X(j.need_suffix_number)&&j.$raise(n("ParseError")),P=h(["command","prefix"],{command:y["$[]"](1),prefix:y["$[]"](0)}),P},3),T(s,"$_reduce_6",function(y,K,P){var j=this;return X(j.suffix_number)||j.$raise(n("ParseError")),X(j.need_prefix_number)&&j.$raise(n("ParseError")),P=h(["command","suffix"],{command:y["$[]"](0),suffix:y["$[]"](1)}),P},3),T(s,"$_reduce_7",function(y,K,P){var j=this;return(X(j.need_prefix_number)||X(j.need_suffix_number))&&j.$raise(n("ParseError")),P=h(["command"],{command:y["$[]"](0)}),P},3),T(s,"$_reduce_8",function(y,K,P){return P=h([],{}),P},3),T(s,"$_reduce_9",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.critical)&&X(te["$[]"]("critical")["$nil?"]())||re.$raise(n("ParseError")),se=["critical",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_10",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.fumble)&&X(te["$[]"]("fumble")["$nil?"]())||re.$raise(n("ParseError")),se=["fumble",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_11",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.dollar)&&X(te["$[]"]("dollar")["$nil?"]())||re.$raise(n("ParseError")),se=["dollar",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_12",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_13",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1)),P},3),T(s,"$_reduce_14",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2)),P},3),T(s,"$_reduce_15",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2)),P},3),T(s,"$_reduce_16",function(y,K,P){var j=this;return X(j.allowed_cmp_op["$include?"](r))||j.$raise(n("ParseError")),P=h([],{}),P},3),T(s,"$_reduce_17",function(y,K,P){var j,O,re=this,te=r,ie=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],X(re.allowed_cmp_op["$include?"](te))||re.$raise(n("ParseError")),P=h(["cmp_op","target"],{cmp_op:te,target:ie}),P},3),T(s,"$_reduce_18",function(y,K,P){var j=this,O=r;return O=y["$[]"](0),X(j.question_target)||j.$raise(n("ParseError")),X(j.allowed_cmp_op["$include?"](O))||j.$raise(n("ParseError")),P=h(["cmp_op","target"],{cmp_op:O,target:"?"}),P},3),T(s,"$_reduce_19",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2)),P},3),T(s,"$_reduce_20",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2)),P},3),T(s,"$_reduce_22",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"*",y["$[]"](2)),P},3),T(s,"$_reduce_23",function(y,K,P){var j=r;return j=y["$[]"](3),P=j.$new(y["$[]"](0),y["$[]"](2)),P},3),T(s,"$_reduce_25",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),P},3),T(s,"$_reduce_26",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithCeil"),P},3),T(s,"$_reduce_27",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithCeil"),P},3),T(s,"$_reduce_28",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithRound"),P},3),T(s,"$_reduce_29",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithFloor"),P},3),T(s,"$_reduce_30",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_31",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1)),P},3),T(s,"$_reduce_33",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_34",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Number").$new(y["$[]"](0)),P},3),T(s,"$_reduce_none",function(y,K,P){return y["$[]"](0)},3)}(E[0],q(g("Racc"),"Parser"),E)}(D[0],D)}(o[0],o)};Opal.modules["bcdice/deprecated/checker"]=function(e){var A=[],o=e.nil,t=e.module,r=e.send,q=e.eqeqeq,C=e.truthy,I=e.def;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"Deprecated"),S=[W].concat(J);return function(F,B){var X=t(F,"Checker"),L=[X].concat(B),w=e.$r(L);return X.$private(),I(X,"$check_result_legacy",function(M,D,G,R){var f=this,E=o,g=o,_=o,u=o,c=o;return E=r(D,"map",[],"sides".$to_proc()),g=r(D,"map",[],"value".$to_proc()),_=g.$sum(),u=q([100],c=E)?f.$check_1D100(M,_,G,R):q([20],c)?f.$check_1D20(M,_,G,R):q([6,6],c)?f.$check_2D6(M,_,g,G,R):o,!(C(u["$nil?"]())||C(u["$empty?"]()))||(u=q([10],c=E.$uniq())?f.$check_nD10(M,_,g,G,R):q([6],c)?f.$check_nD6(M,_,g,G,R):o,!(C(u["$nil?"]())||C(u["$empty?"]())))?w("Result").$new(u.$delete_prefix(" \uFF1E ")):o},4),I(X,"$check_1D100",function(M,D,G,R){return o},4),I(X,"$check_1D20",function(M,D,G,R){return o},4),I(X,"$check_nD10",function(M,D,G,R,f){return o},5),I(X,"$check_2D6",function(M,D,G,R,f){return o},5),I(X,"$check_nD6",function(M,D,G,R,f){return o},5)}(S[0],S)}(T[0],T)}(A[0],A)};Opal.queue(function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.def,z=e.regexp,T=e.rb_plus,U=e.send,J=e.to_a,W=e.rb_minus,S=e.eqeqeq,F=e.eqeq,B=e.range,X=e.rb_divide,L=e.rb_times,w=e.rb_ge,b=r;return A.$require("i18n"),A.$require("i18n/backend/fallbacks"),A.$require("bcdice/randomizer"),A.$require("bcdice/dice_table"),A.$require("bcdice/enum"),A.$require("bcdice/translate"),A.$require("bcdice/result"),A.$require("bcdice/command/parser"),A.$require("bcdice/deprecated/checker"),function(M,D){var G=C(M,"BCDice"),R=[G].concat(D);return function(f,E,g){var _=I(f,E,"Base"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;return s.sort_add_dice=s.sort_barabara_dice=s.enabled_d9=s.raw_input=s.randomizer=s.enabled_upcase_input=s.debug=r,function(i,n){var $=[i].concat(n),l=e.$r($);return i.$attr_reader("prefixes"),v(i,"$register_prefix",function(m){var k,x,Y=this,a=r;return Y.prefixes==null&&(Y.prefixes=r),k=e.slice.call(arguments),x=k,Y.prefixes=h(a=Y.prefixes)?a:[],Y.prefixes.$concat(x.$flatten())},-1),v(i,"$register_prefix_from_super_class",function(){var m=this;return m.$register_prefix(m.$superclass().$prefixes())},0),v(i,"$prefixes_pattern",function(){var m=this,k=r;return m.prefixes_pattern==null&&(m.prefixes_pattern=r),m.prefixes==null&&(m.prefixes=r),m.prefixes_pattern=h(k=m.prefixes_pattern)?k:r,h(m.prefixes_pattern)?m.prefixes_pattern:(m.prefixes=h(k=m.prefixes)?k:[],m.prefixes.$freeze(),m.prefixes_pattern=(h(m.prefixes["$empty?"]())?/(?!)/:z(["^(S)?(",m.prefixes.$join("|"),")"],"i")).$freeze())},0),v(i,"$command_pattern",function(){var m=this,k=r,x=r;return m.command_pattern==null&&(m.command_pattern=r),m.prefixes==null&&(m.prefixes=r),m.command_pattern=h(k=m.command_pattern)?k:r,h(m.command_pattern)?m.command_pattern:(m.prefixes=h(k=m.prefixes)?k:[],m.prefixes.$freeze(),x=T(U(q(l("CommonCommand"),"COMMANDS"),"map",[],function(a){return a==null&&(a=r),q(a,"PREFIX_PATTERN").$source()},1),m.prefixes),m.command_pattern=z(["^S?(",x.$join("|"),")"],"i").$freeze())},0),v(i,"$eval",function(m){var k=this;return k.$new(m).$eval()},1)}(e.get_singleton_class(_),u),_.$include(c("Translate")),_.$include(q(c("Deprecated"),"Checker")),v(_,"$initialize",function(n){var $=this;return $.raw_input=n,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=q(c("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=q(c("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=r,$.reroll_dice_reroll_threshold=r,$.default_cmp_op=r,$.default_target_number=r,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=q(c("BCDice"),"Randomizer").$new(),$.debug=!1},1),_.$attr_accessor("randomizer"),_.$attr_reader("d66_sort_type"),_.$attr_reader("round_type"),_.$attr_reader("sides_implicit_d"),_.$attr_reader("upper_dice_reroll_threshold"),_.$attr_reader("reroll_dice_reroll_threshold"),_.$attr_reader("default_cmp_op"),_.$attr_reader("default_target_number"),v(_,"$sort_add_dice?",function(){var n=this;return n.sort_add_dice},0),v(_,"$sort_barabara_dice?",function(){var n=this;return n.sort_barabara_dice},0),v(_,"$enabled_d9?",function(){var n=this;return n.enabled_d9},0),v(_,"$enable_debug",function(){var n=this;return n.debug=!0},0),v(_,"$eval",function(){var n=this,$=r,l=r,d=r,m=r;return $=q(c("BCDice"),"Preprocessor").$process(n.raw_input,n),l=h(d=n.$dice_command($))?d:n.$eval_common_command(n.raw_input),h(l)?(m=[n.randomizer.$rand_results()],U(l,"rands=",J(m)),m[W(m.length,1)],m=[n.randomizer.$detailed_rand_results()],U(l,"detailed_rands=",J(m)),m[W(m.length,1)],l):r},0),v(_,"$change_text",function(n){return n},1),v(_,"$check_result",function(n,$,l,d){var m=this,k=r,x=r,Y=r,a=r,N=r;return k=m.$check_result_legacy(n,$,l,d),h(k)?k:(x=U($,"map",[],"sides".$to_proc()),Y=U($,"map",[],"value".$to_proc()),a=Y.$sum(),k=S([100],N=x)?m.$result_1d100(n,a,l,d):S([20],N)?m.$result_1d20(n,a,l,d):S([6,6],N)?m.$result_2d6(n,a,Y,l,d):r,F(k,c("Result").$nothing())?r:h(k)?k:(k=S([10],N=x.$uniq())?m.$result_nd10(n,a,Y,l,d):S([6],N)?m.$result_nd6(n,a,Y,l,d):r,F(k,c("Result").$nothing())?r:h(k)?k:m.$result_ndx(n,l,d)))},4),v(_,"$grich_text",function(n,$,l){return r},3),_.$private(),v(_,"$eval_common_command",function(n){try{var $=this;return n=$.$change_text(n),U(q(c("CommonCommand"),"COMMANDS"),"each",[],function l(d){var m=l.$$s==null?this:l.$$s,k=r;if(m.randomizer==null&&(m.randomizer=r),d==null&&(d=r),k=d.$eval(n,m,m.randomizer),h(k))e.ret(k);else return r},{$$arity:1,$$s:$}),r}catch(l){if(l===e.returner)return l.$v;throw l}},1),v(_,"$dice_command",function(n){var $=this,l=r,d=r,m=r,k=r,x=r;return h($.enabled_upcase_input)&&(n=n.$upcase()),l=$.$class().$prefixes_pattern().$match(n),h(l)?(d=l["$[]"](1)["$nil?"]()["$!"](),h(d)&&(n=n["$[]"](B(1,-1,!1))),m=$.$eval_game_system_specific_command(n),h(m["$is_a?"](c("Result")))?(k=[h(x=m["$secret?"]())?x:d],U(m,"secret=",J(k)),k[W(k.length,1)],m):h(m["$nil?"]())||h(m["$empty?"]())||F(m,"1")?r:U(c("Result").$new(),"tap",[],function(a){return a==null&&(a=r),k=[m.$to_s()],U(a,"text=",J(k)),k[W(k.length,1)],k=[d],U(a,"secret=",J(k)),k[W(k.length,1)]},1)):r},1),v(_,"$eval_game_system_specific_command",function(n){return r},1),v(_,"$result_ndx",function(n,$,l){var d=this;return h(l["$is_a?"](c("String")))?r:h(n.$send($,l))?c("Result").$success(d.$translate("success")):c("Result").$failure(d.$translate("failure"))},3),v(_,"$result_1d100",function(n,$,l,d){return r},4),v(_,"$result_1d20",function(n,$,l,d){return r},4),v(_,"$result_nd10",function(n,$,l,d,m){return r},5),v(_,"$result_2d6",function(n,$,l,d,m){return r},5),v(_,"$result_nd6",function(n,$,l,d,m){return r},5),v(_,"$get_table_by_2d6",function(n){var $=this;return $.$get_table_by_nD6(n,2)},1),v(_,"$get_table_by_1d6",function(n){var $=this;return $.$get_table_by_nD6(n,1)},1),v(_,"$get_table_by_nD6",function(n,$){var l=this;return l.$get_table_by_nDx(n,$,6)},2),v(_,"$get_table_by_nDx",function(n,$,l){var d=this,m=r,k=r;return m=d.randomizer.$roll_sum($,l),k=d.$get_table_value(n["$[]"](W(m,$))),h(k["$nil?"]())?["1",0]:[k,m]},3),v(_,"$get_table_by_1d3",function(n){var $=this,l=r,d=r,m=r,k=r;return $.$debug("get_table_by_1d3"),l=1,d=$.randomizer.$roll_sum(l,6),$.$debug("num",d),m=X(W(d,1),2).$to_i(),$.$debug("index",m),k=n["$[]"](m),h(k["$nil?"]())?["1",0]:[k,d]},1),v(_,"$get_table_by_d66_swap",function(n){var $=this,l=r;return l=$.randomizer.$roll_d66(q(c("D66SortType"),"ASC")),[$.$get_table_by_number(l,n),l]},1),v(_,"$get_table_by_d66",function(n){var $=this,l=r,d=r,m=r,k=r,x=r;return l=$.randomizer.$roll_once(6),d=$.randomizer.$roll_once(6),m=T(L(W(l,1),6),W(d,1)),k=n["$[]"](m),x=""+l+d,h(k["$nil?"]())?["1",x]:[k,x]},1),v(_,"$get_table_by_number",function(n,$,l){try{var d=this;return l==null&&(l="1"),U($,"each",[],function m(k){var x=m.$$s==null?this:m.$$s,Y=r;if(k==null&&(k=r),Y=k["$[]"](0),h(w(Y,n)))e.ret(x.$get_table_value(k["$[]"](1)));else return r},{$$arity:1,$$s:d}),d.$get_table_value(l)}catch(m){if(m===e.returner)return m.$v;throw m}},-3),v(_,"$get_table_value",function(n){return h(n["$is_a?"](c("Proc")))?n.$call():n},1),v(_,"$roll_tables",function(n,$){var l=this,d=r;return d=$["$[]"](n),h(d)?d.$roll(l.randomizer).$to_s():r},2),v(_,"$debug",function(n,$){var l,d,m=this,k=r,x=r;return l=e.slice.call(arguments,1),d=l,h(m.debug)?(k=h(n["$is_a?"](c("String")))?n:n.$inspect(),h(d["$empty?"]())?m.$warn(k):(x=U(d,"map",[],function(a){return a==null&&(a=r),h(a["$is_a?"](c("String")))?'"'+a+'"':a.$inspect()},1),m.$warn(""+k+": "+x.$join(", ")))):r},-2)}(R[0],null,R)}(o[0],o),q(q(t("I18n"),"Backend"),"Simple").$include(q(q(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),b=["ja_jp"],U(t("I18n"),"default_locale=",J(b)),b[W(b.length,1)],b=[["ja_jp"]],U(t("I18n").$fallbacks(),"defaults=",J(b)),b[W(b.length,1)]})});var Je=de(()=>{ke();Opal.modules["bcdice/arithmetic/node"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.def,I=e.send2,h=e.find_super,v=e.eqeq,z=e.const_set,T=e.eqeqeq,U=e.rb_divide,J=e.truthy,W=e.alias;return function(S,F){var B=r(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=r(L,"Arithmetic"),M=[b].concat(w);return function(D,G){var R=r(D,"Node"),f=[R].concat(G),E=e.$r(f);return function(g,_){var u=q(g,_,"BinaryOp"),c=u.$$prototype;return c.lhs=c.rhs=c.op=o,C(u,"$initialize",function(i,n,$){var l=this;return l.lhs=i,l.op=n,l.rhs=$},3),C(u,"$eval",function(i){var n=this,$=o,l=o;return $=n.lhs.$eval(i),l=n.rhs.$eval(i),$.$send(n.op,l)},1),C(u,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),C(u,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),C(u,"$op_for_s_exp",function(){var i=this;return i.op},0)}(f[0],null),function(g,_,u){var c=q(g,_,"DivideBase"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.lhs=n.rhs=n.op=o,C(c,"$initialize",function $(l,d){var m=$.$$p||o,k=this;return delete $.$$p,I(k,h(k,"initialize",$,!1,!0),"initialize",[l,"/",d],null)},2),C(c,"$eval",function(l){var d=this,m=o,k=o;return m=d.lhs.$eval(l),k=d.rhs.$eval(l),v(k,0)&&d.$raise(i("ZeroDivisionError")),d.$divide_and_round(m,k,l)},1),C(c,"$output",function $(){var l=$.$$p||o,d=this;return delete $.$$p,""+I(d,h(d,"output",$,!1,!0),"output",[],l)+d.$rounding_method()},0),c.$private(),C(c,"$rounding_method",function(){var l=this;return t(l.$class(),"ROUNDING_METHOD")},0),C(c,"$op_for_s_exp",function(){var l=this;return""+l.op+l.$rounding_method()},0),C(c,"$divide_and_round",function(l,d,m){var k=this;return k.$raise(i("NotImplementedError"))},3)}(f[0],E("BinaryOp"),f),function(g,_,u){var c=q(g,_,"DivideWithGameSystemDefault"),s=[c].concat(u),i=e.$r(s);return z(s[0],"ROUNDING_METHOD",""),c.$private(),C(c,"$divide_and_round",function($,l,d){var m=o,k=o;return T(t(i("RoundType"),"CEIL"),m=d)?U($.$to_f(),l).$ceil():T(t(i("RoundType"),"ROUND"),m)?(k=U($.$to_f(),l),J(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):U($,l).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithCeil"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","C"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n.$to_f(),$).$ceil()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithRound"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","R"),c.$private(),C(c,"$divide_and_round",function(n,$,l){var d=o;return d=U(n.$to_f(),$),J(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithFloor"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","F"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n,$).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_){var u=q(g,_,"Negative"),c=u.$$prototype;return c.body=o,C(u,"$initialize",function(i){var n=this;return n.body=i},1),C(u,"$eval",function(i){var n=this;return n.body.$eval(i)["$-@"]()},1),C(u,"$output",function(){var i=this;return"-"+i.body.$output()},0),C(u,"$s_exp",function(){var i=this;return"(- "+i.body.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Parenthesis"),c=u.$$prototype;return c.expr=o,C(u,"$initialize",function(i){var n=this;return n.expr=i},1),C(u,"$eval",function(i){var n=this;return n.expr.$eval(i)},1),C(u,"$output",function(){var i=this;return"("+i.expr.$output()+")"},0),C(u,"$s_exp",function(){var i=this;return"(Parenthesis "+i.expr.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Number"),c=u.$$prototype;return c.value=o,C(u,"$initialize",function(i){var n=this;return n.value=i},1),C(u,"$eval",function(i){var n=this;return n.value},1),C(u,"$output",function(){var i=this;return i.value.$to_s()},0),W(u,"s_exp","output")}(f[0],null)}(M[0],M)}(X[0],X)}(A[0],A)};Opal.modules["racc/parser"]=function(e){var A,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.const_set,z=e.defs,T=e.gvars,U=e.rb_lt,J=e.send,W=e.to_a,S=e.rb_minus,F=e.def,B=e.to_ary,X=e.neqeq,L=e.rb_plus,w=e.eqeq,b=e.rb_ge,M=e.rb_gt,D=e.eqeqeq,G=e.rb_le,R=e.rb_times;return function(f,E){var g=C(f,"Racc"),_=[g].concat(E),u=e.$r(_);return I(_[0],u("StandardError"),"ParseError"),r}(o[0],o),h((A=q("::","ParseError","skip_raise"))?"constant":r)||v(o[0],"ParseError",q(t("Racc"),"ParseError")),function(f,E){var g=C(f,"Racc"),_,u=[g].concat(E),c=e.$r(u);return h((_=c("Racc_No_Extensions","skip_raise"))?"constant":r)||v(u[0],"Racc_No_Extensions",!1),function(s,i,n){var $=I(s,i,"Parser"),l=[$].concat(n),d=e.$r(l),m=$.$$prototype;return m.yydebug=m.racc_debug_out=m.racc_error_status=m.racc_t=m.racc_vstack=m.racc_val=m.racc_state=m.racc_tstack=r,v(l[0],"Racc_Runtime_Version","1.4.6"),v(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),v(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),v(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),v(l[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),v(l[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),v(l[0],"Racc_Runtime_Type","ruby"),z(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")},0),F($,"$_racc_setup",function(){var x,Y,a=this,N=r,p=r,H=r;return T.stderr==null&&(T.stderr=r),h(q(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),h((x=a.yydebug,x!=null&&x!==r?"instance-variable":r))||(a.yydebug=!1),h(a.yydebug)&&(h((Y=a.racc_debug_out,Y!=null&&Y!==r?"instance-variable":r))||(a.racc_debug_out=T.stderr),a.racc_debug_out=h(N=a.racc_debug_out)?N:T.stderr),p=q(a.$class(),"Racc_arg"),h(U(p.$size(),14))&&(H=[13,!0],J(p,"[]=",W(H)),H[S(H.length,1)]),p},0),F($,"$_racc_init_sysvars",function(){var x=this;return x.racc_state=[0],x.racc_tstack=[],x.racc_vstack=[],x.racc_t=r,x.racc_val=r,x.racc_read_next=!0,x.racc_user_yyerror=!1,x.racc_error_status=0},0),F($,"$do_parse",function(){var x=this;return x.$__send__(d("Racc_Main_Parsing_Routine"),x.$_racc_setup(),!1)},0),F($,"$next_token",function(){var x=this;return x.$raise(d("NotImplementedError"),""+x.$class()+"#next_token is not defined")},0),F($,"$_racc_do_parse_rb",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;return N=x,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],V=a[4]==null?r:a[4],V=a[5]==null?r:a[5],V=a[6]==null?r:a[6],V=a[7]==null?r:a[7],V=a[8]==null?r:a[8],V=a[9]==null?r:a[9],Z=a[10]==null?r:a[10],V=a[11]==null?r:a[11],V=a[12]==null?r:a[12],V=a[13]==null?r:a[13],p.$_racc_init_sysvars(),y=K=P=r,J(p,"catch",["racc_end_parse"],function j(){var O,re,te,ie=j.$$s==null?this:j.$$s,$e=r;for(ie.racc_state==null&&(ie.racc_state=r),ie.racc_read_next==null&&(ie.racc_read_next=r),ie.racc_t==null&&(ie.racc_t=r),ie.yydebug==null&&(ie.yydebug=r),ie.racc_val==null&&(ie.racc_val=r);h(!0);)for(h(P=ne["$[]"](ie.racc_state["$[]"](-1)))?(h(ie.racc_read_next)&&X(ie.racc_t,0)&&(te=ie.$next_token(),re=B(te),y=re[0]==null?r:re[0],ie.racc_val=re[1]==null?r:re[1],h(y)?ie.racc_t=h($e=Z["$[]"](y))?$e:1:ie.racc_t=0,h(ie.yydebug)&&ie.$racc_read_token(ie.racc_t,y,ie.racc_val),ie.racc_read_next=!1),P=L(P,ie.racc_t),h(b(P,0))&&h(K=H["$[]"](P))&&w(Q["$[]"](P),ie.racc_state["$[]"](-1))||(K=ee["$[]"](ie.racc_state["$[]"](-1)))):K=ee["$[]"](ie.racc_state["$[]"](-1));h(K=ie.$_racc_evalact(K,x)););},{$$arity:0,$$s:p})},2),F($,"$yyparse",function(x,Y){var a=this;return a.$__send__(d("Racc_YY_Parse_Method"),x,Y,a.$_racc_setup(),!0)},2),F($,"$_racc_yyparse_rb",function(x,Y,a,N){var p,H,Q=this,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r;return H=a,p=B(H),ee=p[0]==null?r:p[0],ne=p[1]==null?r:p[1],V=p[2]==null?r:p[2],Z=p[3]==null?r:p[3],y=p[4]==null?r:p[4],y=p[5]==null?r:p[5],y=p[6]==null?r:p[6],y=p[7]==null?r:p[7],y=p[8]==null?r:p[8],y=p[9]==null?r:p[9],K=p[10]==null?r:p[10],y=p[11]==null?r:p[11],y=p[12]==null?r:p[12],y=p[13]==null?r:p[13],Q.$_racc_init_sysvars(),P=r,j=r,J(Q,"catch",["racc_end_parse"],function O(){var re,te,ie=O.$$s==null?this:O.$$s;for(ie.racc_state==null&&(ie.racc_state=r);!h(j=Z["$[]"](ie.racc_state["$[]"](-1)));)for(;h(P=ie.$_racc_evalact(V["$[]"](ie.racc_state["$[]"](-1)),a)););return J(x,"__send__",[Y],function $e(se,oe){var le,ce,ue=$e.$$s==null?this:$e.$$s,ae=r,_e=r;for(ue.racc_t==null&&(ue.racc_t=r),ue.racc_state==null&&(ue.racc_state=r),ue.racc_read_next==null&&(ue.racc_read_next=r),se==null&&(se=r),oe==null&&(oe=r),h(se)?ue.racc_t=h(ae=K["$[]"](se))?ae:1:ue.racc_t=0,ue.racc_val=oe,ue.racc_read_next=!1,j=L(j,ue.racc_t),h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););for(;h(h(ae=h(_e=(j=Z["$[]"](ue.racc_state["$[]"](-1)))["$!"]())?_e:ue.racc_read_next["$!"]())?ae:ue.racc_t["$=="](0));)for(h(j)&&h(j=L(j,ue.racc_t))&&h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););},{$$arity:2,$$s:ie})},{$$arity:0,$$s:Q})},4),F($,"$_racc_evalact",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;if(N=Y,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],ee=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ee=a[6]==null?r:a[6],ee=a[7]==null?r:a[7],ee=a[8]==null?r:a[8],ee=a[9]==null?r:a[9],ee=a[10]==null?r:a[10],V=a[11]==null?r:a[11],Z=a[12]==null?r:a[12],ee=a[13]==null?r:a[13],ee=a[14]==null?r:a[14],h(M(x,0))&&h(U(x,V)))h(M(p.racc_error_status,0))&&(w(p.racc_t,1)||(p.racc_error_status=S(p.racc_error_status,1))),p.racc_vstack.$push(p.racc_val),p.racc_state.$push(x),p.racc_read_next=!0,h(p.yydebug)&&(p.racc_tstack.$push(p.racc_t),p.$racc_shift(p.racc_t,p.racc_tstack,p.racc_vstack));else if(h(U(x,0))&&h(M(x,Z["$-@"]()))){if(y=J(p,"catch",["racc_jump"],function j(){var O=j.$$s==null?this:j.$$s;return O.racc_state==null&&(O.racc_state=r),O.racc_state.$push(O.$_racc_do_reduce(Y,x)),!1},{$$arity:0,$$s:p}),h(y)){if(D(1,K=y))return p.racc_user_yyerror=!0,Z["$-@"]();if(D(2,K))return V;p.$raise("[Racc Bug] unknown jump code")}}else if(w(x,V))h(p.yydebug)&&p.$racc_accept(),p.$throw("racc_end_parse",p.racc_vstack["$[]"](0));else if(w(x,Z["$-@"]())){for(D(0,K=p.racc_error_status)?h(Y["$[]"](21))||p.$on_error(p.racc_t,p.racc_val,p.racc_vstack):D(3,K)&&(w(p.racc_t,0)&&p.$throw("racc_end_parse",r),p.racc_read_next=!0),p.racc_user_yyerror=!1,p.racc_error_status=3;h(!0)&&!(h(P=ne["$[]"](p.racc_state["$[]"](-1)))&&(P=L(P,1),h(b(P,0))&&h(x=H["$[]"](P))&&w(Q["$[]"](P),p.racc_state["$[]"](-1))));)h(G(p.racc_state.$size(),1))&&p.$throw("racc_end_parse",r),p.racc_state.$pop(),p.racc_vstack.$pop(),h(p.yydebug)&&(p.racc_tstack.$pop(),p.$racc_e_pop(p.racc_state,p.racc_tstack,p.racc_vstack));return x}else p.$raise("[Racc Bug] unknown action "+x.$inspect());return h(p.yydebug)&&p.$racc_next_state(p.racc_state["$[]"](-1),p.racc_state),r},2),F($,"$_racc_do_reduce",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r,O=r,re=r,te=r,ie=r,$e=r,se=r,oe=r,le=r,ce=r,ue=r,ae=r;return N=x,a=B(N),H=a[0]==null?r:a[0],H=a[1]==null?r:a[1],H=a[2]==null?r:a[2],H=a[3]==null?r:a[3],Q=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ne=a[6]==null?r:a[6],V=a[7]==null?r:a[7],Z=a[8]==null?r:a[8],y=a[9]==null?r:a[9],H=a[10]==null?r:a[10],H=a[11]==null?r:a[11],H=a[12]==null?r:a[12],K=a[13]==null?r:a[13],P=p.racc_state,j=p.racc_vstack,O=p.racc_tstack,re=R(Y,-3),te=y["$[]"](re),ie=y["$[]"](L(re,1)),$e=y["$[]"](L(re,2)),se=[],h(p.yydebug)&&(oe=O["$[]"](te["$-@"](),te)),le=j["$[]"](te["$-@"](),te),h(p.yydebug)&&(ce=[te["$-@"](),te,se],J(O,"[]=",W(ce)),ce[S(ce.length,1)]),ce=[te["$-@"](),te,se],J(j,"[]=",W(ce)),ce[S(ce.length,1)],ce=[te["$-@"](),te,se],J(P,"[]=",W(ce)),ce[S(ce.length,1)],h(K)?j.$push(p.$__send__($e,le,j,le["$[]"](0))):j.$push(p.$__send__($e,le,j)),O.$push(ie),h(p.yydebug)&&p.$racc_reduce(oe,ie,O,j),ue=S(ie,Z),h(re=V["$[]"](ue))&&(re=L(re,P["$[]"](-1)),h(b(re,0))&&h(ae=Q["$[]"](re))&&w(ee["$[]"](re),ue))?ae:ne["$[]"](ue)},2),F($,"$on_error",function(x,Y,a){var N=this,p=r;return N.$raise(d("ParseError"),N.$sprintf(`
parse error on value %s (%s)`,Y.$inspect(),h(p=N.$token_to_str(x))?p:"?"))},3),F($,"$yyerror",function(){var x=this;return x.$throw("racc_jump",1)},0),F($,"$yyaccept",function(){var x=this;return x.$throw("racc_jump",2)},0),F($,"$yyerrok",function(){var x=this;return x.racc_error_status=0},0),F($,"$racc_read_token",function(x,Y,a){var N=this;return N.racc_debug_out.$print("read    "),N.racc_debug_out.$print(Y.$inspect(),"(",N.$racc_token2str(x),") "),N.racc_debug_out.$puts(a.$inspect()),N.racc_debug_out.$puts()},3),F($,"$racc_shift",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("shift   "+N.$racc_token2str(x)),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_reduce",function(x,Y,a,N){var p=this,H=r;return H=p.racc_debug_out,H.$print("reduce "),h(x["$empty?"]())?H.$print(" <none>"):J(x,"each",[],function Q(ee){var ne=Q.$$s==null?this:Q.$$s;return ee==null&&(ee=r),H.$print(" ",ne.$racc_token2str(ee))},{$$arity:1,$$s:p}),H.$puts(" --> "+p.$racc_token2str(Y)),p.$racc_print_stacks(a,N),p.racc_debug_out.$puts()},4),F($,"$racc_accept",function(){var x=this;return x.racc_debug_out.$puts("accept"),x.racc_debug_out.$puts()},0),F($,"$racc_e_pop",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("error recovering mode: pop token"),N.$racc_print_states(x),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_next_state",function(x,Y){var a=this;return a.racc_debug_out.$puts("goto    "+x),a.$racc_print_states(Y),a.racc_debug_out.$puts()},2),F($,"$racc_print_stacks",function(x,Y){var a=this,N=r;return N=a.racc_debug_out,N.$print("        ["),J(x,"each_index",[],function p(H){var Q=p.$$s==null?this:p.$$s;return H==null&&(H=r),N.$print(" (",Q.$racc_token2str(x["$[]"](H))," ",Y["$[]"](H).$inspect(),")")},{$$arity:1,$$s:a}),N.$puts(" ]")},2),F($,"$racc_print_states",function(x){var Y=this,a=r;return a=Y.racc_debug_out,a.$print("        ["),J(x,"each",[],function(p){return p==null&&(p=r),a.$print(" ",p)},1),a.$puts(" ]")},1),F($,"$racc_token2str",function(x){var Y=this,a=r;return h(a=q(Y.$class(),"Racc_token_to_s_table")["$[]"](x))?a:Y.$raise("[Racc Bug] can't convert token "+x+" to string")},1),F($,"$token_to_str",function(x){var Y=this;return q(Y.$class(),"Racc_token_to_s_table")["$[]"](x)},1)}(u[0],null,u)}(o[0],o)};Opal.modules.strscan=function(e){var A=[],o=e.nil,t=e.klass,r=e.def,q=e.truthy,C=e.eqeqeq,I=e.Opal,h=e.send,v=e.to_a,z=e.rb_minus,T=e.alias;return function(U,J,W){var S=t(U,J,"StringScanner"),F=[S].concat(W),B=e.$r(F),X=S.$$prototype;return X.pos=X.string=X.working=X.matched=X.prev_pos=X.match=o,S.$attr_reader("pos","matched"),r(S,"$initialize",function(w){var b=this;return b.string=w,b.pos=0,b.matched=o,b.working=w,b.match=[]},1),S.$attr_reader("string"),r(S,"$beginning_of_line?",function(){var w=this;return w.pos===0||w.string.charAt(w.pos-1)===`
`},0),r(S,"$scan",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:typeof M=="object"?(b.prev_pos=b.pos,b.pos+=M[0].length,b.working=b.working.substring(M[0].length),b.matched=M[0],b.match=M,M[0]):typeof M=="string"?(b.pos+=M.length,b.working=b.working.substring(M.length),M):o},1),r(S,"$scan_until",function(w){var b=this;w=b.$anchor(w);for(var M=b.pos,D=b.working,G;;){if(G=w.exec(D),M+=1,D=D.substr(1),G==null){if(D.length===0)return b.match=[],b.matched=o;continue}return b.matched=b.string.substr(b.pos,M-b.pos-1+G[0].length),b.match=G,b.prev_pos=M-1,b.pos=M,b.working=D.substr(G[0].length),b.matched}},1),r(S,"$[]",function(w){var b=this,M=o;if(q(b.match["$empty?"]()))return o;C(B("Symbol"),M=w)?w=w.$to_s():C(B("String"),M)||(w=I["$coerce_to!"](w,B("Integer"),"to_int"));var D=b.match;return w<0&&(w+=D.length),w<0||w>=D.length||D[w]==null?o:D[w]},1),r(S,"$check",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:b.matched=M[0]},1),r(S,"$check_until",function(w){var b=this,M=b.prev_pos,D=b.pos,G=b.$scan_until(w);return G!==o&&(b.matched=G.substr(-1),b.working=b.string.substr(D)),b.prev_pos=M,b.pos=D,G},1),r(S,"$peek",function(w){var b=this;return b.working.substring(0,w)},1),r(S,"$eos?",function(){var w=this;return w.working.length===0},0),r(S,"$exist?",function(w){var b=this,M=w.exec(b.working);return M==null?o:M.index==0?0:M.index+1},1),r(S,"$skip",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);if(M==null)return b.match=[],b.matched=o;var D=M[0],G=D.length;return b.matched=D,b.match=M,b.prev_pos=b.pos,b.pos+=G,b.working=b.working.substring(G),G},1),r(S,"$skip_until",function(w){var b=this,M=b.$scan_until(w);return M===o?o:(b.matched=M.substr(-1),M.length)},1),r(S,"$get_byte",function(){var w=this,b=o;return w.pos<w.string.length?(w.prev_pos=w.pos,w.pos+=1,b=w.matched=w.working.substring(0,1),w.working=w.working.substring(1)):w.matched=o,b},0),r(S,"$match?",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?o:(b.prev_pos=b.pos,M[0].length)},1),r(S,"$pos=",function(w){var b=this;return w<0&&(w+=b.string.$length()),b.pos=w,b.working=b.string.slice(w)},1),r(S,"$matched_size",function(){var w=this;return w.matched===o?o:w.matched.length},0),r(S,"$post_match",function(){var w=this;return w.matched===o?o:w.string.substr(w.pos)},0),r(S,"$pre_match",function(){var w=this;return w.matched===o?o:w.string.substr(0,w.prev_pos)},0),r(S,"$reset",function(){var w=this;return w.working=w.string,w.matched=o,w.pos=0},0),r(S,"$rest",function(){var w=this;return w.working},0),r(S,"$rest?",function(){var w=this;return w.working.length!==0},0),r(S,"$rest_size",function(){var w=this;return w.$rest().$size()},0),r(S,"$terminate",function(){var w=this,b=o;return w.match=o,b=[w.string.$length()],h(w,"pos=",v(b)),b[z(b.length,1)]},0),r(S,"$unscan",function(){var w=this;return w.pos=w.prev_pos,w.prev_pos=o,w.match=o,w},0),T(S,"bol?","beginning_of_line?"),T(S,"getch","get_byte"),S.$private(),r(S,"$anchor",function(w){var b=w.toString().match(/\/([^\/]+)$/);return b=b?b[1]:void 0,new RegExp("^(?:"+w.source+")",b)},1)}(A[0],null,A)};Opal.modules["bcdice/normalize"]=function(e){var A=[],o=e.nil,t=e.module,r=e.eqeqeq,q=e.def,C=e.eqeq;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T){var U=t(T,"Normalize");return U.$module_function(),q(U,"$comparison_operator",function(W){var S=o;return r(/<=|=</,S=W)?"<=":r(/>=|=>/,S)?">=":r(/<>|!=|=!/,S)?"!=":r(/</,S)?"<":r(/>/,S)?">":r(/=/,S)?"==":o},1),q(U,"$target_number",function(W){return C(W,"?")?W:W.$to_i()},1)}(z[0])}(A[0],A)};Opal.modules["bcdice/common_command/lexer"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.truthy,v=e.def;return A.$require("strscan"),A.$require("bcdice/normalize"),function(z,T){var U=r(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=r(W,"CommonCommand"),B=[F].concat(S);return function(X,L,w){var b=q(X,L,"Lexer"),M=[b].concat(w),D=e.$r(M),G=b.$$prototype;return G.scanner=t,C(M[0],"SYMBOLS",I(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),v(b,"$initialize",function(f){var E=this,g=t;return f=h(g=f.$split(" ",2).$first())?g:"",E.scanner=D("StringScanner").$new(f)},1),v(b,"$next_token",function(){var f=this,E=t,g=t,_=t,u=t,c=t;return h(f.scanner["$eos?"]())?[!1,"$"]:h(E=f.scanner.$scan(/\d+/))?["NUMBER",E.$to_i()]:h(g=f.scanner.$scan(/[<>!=]+/))?["CMP_OP",D("Normalize").$comparison_operator(g)]:(_=f.scanner.$getch().$upcase(),u=h(c=D("SYMBOLS")["$[]"](_))?c:_.$to_sym(),[u,_])},0),v(b,"$source",function(){var f=this;return f.scanner.$string()},0)}(B[0],null,B)}(J[0],J)}(o[0],o)};Opal.modules["bcdice/arithmetic/parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.defs,h=e.def,v=e.hash,z=e.const_set;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/arithmetic/node"),function(T,U){var J=q(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=q(S,"Arithmetic"),X=[B].concat(F),L=e.$r(X);return function(w,b,M){var D=C(w,b,"Parser"),G=[D].concat(M),R=e.$r(G),f=t,E=t,g=t,_=t,u=t,c=t,s=t,i=t,n=t,$=t,l=t,d=t,m=t,k=t,x=D.$$prototype;return x.lexer=t,I(D,"$parse",function(a){var N=this;return N.$new().$parse(a)},1),h(D,"$parse",function(a){var N=this;try{return N.lexer=r(r(R("BCDice"),"CommonCommand"),"Lexer").$new(a),N.$do_parse()}catch(p){if(e.rescue(p,[R("ParseError")]))try{return t}finally{e.pop_exception()}else throw p}},1),D.$private(),h(D,"$next_token",function(){var a=this;return a.lexer.$next_token()},0),f=[8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,t,t,4,5,4,5,7,9,7,t,t,10,11,t,10,11,22,26,24,25,27],E=[0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,t,t,12,12,13,13,12,1,13,t,t,16,16,t,1,1,16,21,21,21,21],g=[-2,40,-6,t,0,8,t,10,t,1,18,20,28,30,t,t,37,t,4,14,t,47,t,t,t,t,t,t],_=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],u=[14,15,23,1,18,19,t,t,20,21,16],c=[3,3,4,1,2,2,t,t,3,3,1],s=[t,3,-6,-4,-19,t],i=[t,t,2,3,t,6],n=[0,0,"racc_error",3,14,"_reduce_1",3,14,"_reduce_2",1,14,"_reduce_none",3,15,"_reduce_4",4,15,"_reduce_5",1,15,"_reduce_none",0,17,"_reduce_7",1,17,"_reduce_8",1,17,"_reduce_9",1,17,"_reduce_10",1,17,"_reduce_11",2,16,"_reduce_12",2,16,"_reduce_13",1,16,"_reduce_none",3,18,"_reduce_15",1,18,"_reduce_16"],$=17,l=28,d=v(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),m=13,k=!0,z(G[0],"Racc_arg",[f,E,_,g,u,c,i,s,m,n,d,l,$,k]),z(G[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),z(G[0],"Racc_debug_parser",!1),h(D,"$_reduce_1",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"BinaryOp").$new(a["$[]"](0),"+",a["$[]"](2)),p},3),h(D,"$_reduce_2",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"BinaryOp").$new(a["$[]"](0),"-",a["$[]"](2)),p},3),h(D,"$_reduce_4",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"BinaryOp").$new(a["$[]"](0),"*",a["$[]"](2)),p},3),h(D,"$_reduce_5",function(a,N,p){var H=t;return H=a["$[]"](3),p=H.$new(a["$[]"](0),a["$[]"](2)),p},3),h(D,"$_reduce_7",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),p},3),h(D,"$_reduce_8",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"DivideWithCeil"),p},3),h(D,"$_reduce_9",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"DivideWithCeil"),p},3),h(D,"$_reduce_10",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"DivideWithRound"),p},3),h(D,"$_reduce_11",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"DivideWithFloor"),p},3),h(D,"$_reduce_12",function(a,N,p){return p=a["$[]"](1),p},3),h(D,"$_reduce_13",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"Negative").$new(a["$[]"](1)),p},3),h(D,"$_reduce_15",function(a,N,p){return p=a["$[]"](1),p},3),h(D,"$_reduce_16",function(a,N,p){return p=r(r(R("Arithmetic"),"Node"),"Number").$new(a["$[]"](0)),p},3),h(D,"$_reduce_none",function(a,N,p){return a["$[]"](0)},3)}(X[0],r(L("Racc"),"Parser"),X)}(W[0],W)}(o[0],o)};Opal.modules["bcdice/arithmetic"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.send,C=e.def;return A.$require("bcdice/arithmetic/node"),A.$require("bcdice/arithmetic/parser"),function(I,h){var v=r(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=r(T,"Arithmetic"),W=[J].concat(U);return function(S,F){var B=[S].concat(F),X=e.$r(B);return C(S,"$eval",function(w,b){var M,D=t;try{return D=X("Parser").$parse(w),M=D,M===t||M==null?t:q(M,"eval",[b])}catch(G){if(e.rescue(G,[X("ZeroDivisionError")]))try{return t}finally{e.pop_exception()}else throw G}},2)}(e.get_singleton_class(J),W)}(z[0],z)}(o[0],o)};Opal.queue(function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.defs,I=e.def,h=e.send,v=e.truthy,z=e.eqeq;return A.$require("bcdice/arithmetic"),function(T,U){var J=r(T,"BCDice"),W=[J].concat(U);return function(S,F,B){var X=q(S,F,"Preprocessor"),L=[X].concat(B),w=e.$r(L),b=X.$$prototype;return b.game_system=b.text=t,C(X,"$process",function(D,G){return w("Preprocessor").$new(D,G).$process()},2),I(X,"$initialize",function(D,G){var R=this;return R.text=D,R.game_system=G},2),I(X,"$process",function(){var D=this;return D.$trim_after_whitespace(),D.$replace_parentheses(),D.text=D.game_system.$change_text(D.text),D.$replace_implicit_d(),D.text},0),X.$private(),I(X,"$trim_after_whitespace",function(){var D=this;return D.text=D.text.$strip().$split(/\s/,2).$first()},0),I(X,"$replace_parentheses",function(){var D=this;return function(){var G=e.new_brk();try{return h(D,"loop",[],function R(){var f=R.$$s==null?this:R.$$s,E=t;if(f.text==null&&(f.text=t),E=f.text,f.text=h(f.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function g(_){var u=g.$$s==null?this:g.$$s,c=t;return u.game_system==null&&(u.game_system=t),_==null&&(_=t),v(c=w("Arithmetic").$eval(_,u.game_system.$round_type()))?c:_},{$$arity:1,$$s:f}),z(E,f.text))e.brk(t,G);else return t},{$$arity:0,$$s:D,$$brk:G})}catch(R){if(R===G)return R.$v;throw R}}()},0),I(X,"$replace_implicit_d",function(){var D=this;return D.text=h(D.text,"gsub",[/(\d+)D([^\w]|$)/i],function G(){var R=G.$$s==null?this:G.$$s,f=t,E=t,g=t;return R.game_system==null&&(R.game_system=t),f=w("Regexp").$last_match(1),E=R.game_system.$sides_implicit_d(),g=w("Regexp").$last_match(2),""+f+"D"+E+g},{$$arity:0,$$s:D})},0)}(W[0],null,W)}(o[0],o)})});var Qe=de(()=>{ke();Opal.queue(function(e){var A=[],o=e.nil,t=e.module,r=e.const_set;return function(q,C){var I=t(q,"BCDice"),h=[I].concat(C);return r(h[0],"VERSION","3.7.0")}(A[0],A)})});var Pe=de(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.nilToNull=void 0;ke();Opal.config.unsupported_features_severity="ignore";Re.default=Opal;function Rr(e){return e===Opal.nil?null:e}Re.nilToNull=Rr});var xe=de(we=>{"use strict";var Oe=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(we,"__esModule",{value:!0});we.Opal=we.I18n=we.BCDice=void 0;Qe();var er=Oe(Pe());we.BCDice=er.default.module(null,"BCDice");we.I18n=er.default.module(null,"I18n");var qr=Pe();Object.defineProperty(we,"Opal",{enumerable:!0,get:function(){return Oe(qr).default}})});var Ce=de(Ne=>{"use strict";var Ae=Ne&&Ne.__assign||function(){return Ae=Object.assign||function(e){for(var A,o=1,t=arguments.length;o<t;o++){A=arguments[o];for(var r in A)Object.prototype.hasOwnProperty.call(A,r)&&(e[r]=A[r])}return e},Ae.apply(this,arguments)},Sr=Ne&&Ne.__rest||function(e,A){var o={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&A.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(e);r<t.length;r++)A.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(o[t[r]]=e[t[r]]);return o};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.parseResult=void 0;var Ar=xe();function Cr(e){if(e===Ar.Opal.nil)return null;var A=e.detailed_rands,o=Sr(e,["detailed_rands"]);return Ae(Ae({},o),{detailedRands:A.map(function(t){return t.$to_n()})})}Ne.parseResult=Cr});var Be=de(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});Ye();Xe();Ze();Je();var rr=xe(),tr=Ce(),Tr=function(){function e(A,o){this.internal=o!=null?o:rr.BCDice.Base.$new(A)}return e.eval=function(A){var o=rr.BCDice.Base.$eval(A);return tr.parseResult(o)},Object.defineProperty(e.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),e.prototype.eval=function(){var A=this.internal.$eval();return tr.parseResult(A)},e}();je.default=Tr});var nr=de((Rt,Dr)=>{Dr.exports={gameSystems:[{id:"Villaciel",name:"\u84BC\u5929\u306E\u30F4\u30A3\u30E9\u30B7\u30A8\u30EB",className:"Villaciel",superClassName:"Base",sortKey:"\u305D\u3046\u3066\u3093\u306E\u3046\u3044\u3089\u3057\u3048\u308B",locale:"ja_jp"},{id:"SamsaraBallad",name:"\u30B5\u30F3\u30B5\u30FC\u30E9\u30FB\u30D0\u30E9\u30C3\u30C9",className:"SamsaraBallad",superClassName:"Base",sortKey:"\u3055\u3093\u3055\u3042\u3089\u306F\u3089\u3064\u3068",locale:"ja_jp"},{id:"Satasupe",name:"\u30B5\u30BF\u30B9\u30DA",className:"Satasupe",superClassName:"Base",sortKey:"\u3055\u305F\u3059\u3078",locale:"ja_jp"},{id:"MagicaLogia:Korean",name:"\uB9C8\uAE30\uCE74\uB85C\uAE30\uC544",className:"MagicaLogia_Korean",superClassName:"MagicaLogia",sortKey:"\u56FD\u969B\u5316:Korean:\uB9C8\uAE30\uCE74\uB85C\uAE30\uC544",locale:"ko_kr"},{id:"MagicaLogia:SimplifiedChinese",name:"\u9B54\u5BFC\u4E66\u5927\u6218",className:"MagicaLogia_SimplifiedChinese",superClassName:"MagicaLogia",sortKey:"\u56FD\u969B\u5316:Simplified Chinese:\u9B54\u5BFC\u4E66\u5927\u6218",locale:"zh_hans"},{id:"MeikyuDays",name:"\u8FF7\u5BAE\u30C7\u30A4\u30BA",className:"MeikyuDays",superClassName:"Base",sortKey:"\u3081\u3044\u304D\u3086\u3046\u3066\u3044\u3059",locale:"ja_jp"},{id:"MeikyuKingdom",name:"\u8FF7\u5BAE\u30AD\u30F3\u30B0\u30C0\u30E0",className:"MeikyuKingdom",superClassName:"Base",sortKey:"\u3081\u3044\u304D\u3086\u3046\u304D\u3093\u304F\u305F\u3080",locale:"ja_jp"},{id:"BloodCrusade",name:"\u30D6\u30E9\u30C3\u30C9\u30FB\u30AF\u30EB\u30BB\u30A4\u30C9",className:"BloodCrusade",superClassName:"Base",sortKey:"\u3075\u3089\u3064\u3068\u304F\u308B\u305B\u3044\u3068",locale:"ja_jp"},{id:"BloodMoon",name:"\u30D6\u30E9\u30C3\u30C9\u30E0\u30FC\u30F3",className:"BloodMoon",superClassName:"Base",sortKey:"\u3075\u3089\u3064\u3068\u3080\u3046\u3093",locale:"ja_jp"},{id:"AFF2e",name:"ADVANCED FIGHTING FANTASY 2nd Edition",className:"AFF2e",superClassName:"Base",sortKey:"\u3042\u3068\u306F\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304F\u3075\u3042\u3093\u305F\u3057\u30442",locale:"ja_jp"},{id:"CardRanker",name:"\u30AB\u30FC\u30C9\u30E9\u30F3\u30AB\u30FC",className:"CardRanker",superClassName:"Base",sortKey:"\u304B\u3042\u3068\u3089\u3093\u304B\u3042",locale:"ja_jp"},{id:"CastleInGray",name:"\u7070\u8272\u57CE\u7DBA\u8B5A",className:"CastleInGray",superClassName:"Base",sortKey:"\u306F\u3044\u3044\u308D\u3057\u3088\u3046\u304D\u305F\u3093",locale:"ja_jp"},{id:"ChaosFlare",name:"\u30AB\u30AA\u30B9\u30D5\u30EC\u30A2",className:"ChaosFlare",superClassName:"Base",sortKey:"\u304B\u304A\u3059\u3075\u308C\u3042",locale:"ja_jp"},{id:"EmbryoMachine",name:"\u30A8\u30E0\u30D6\u30EA\u30AA\u30DE\u30B7\u30F3RPG",className:"EmbryoMachine",superClassName:"Base",sortKey:"\u3048\u3080\u3075\u308A\u304A\u307E\u3057\u3093RPG",locale:"ja_jp"},{id:"AceKillerGene",name:"\u30A8\u30FC\u30B9\u30AD\u30E9\u30FC\u30B8\u30FC\u30F3",className:"AceKillerGene",superClassName:"GardenOrder",sortKey:"\u3048\u3048\u3059\u304D\u3089\u3042\u3057\u3044\u3093",locale:"ja_jp"},{id:"GardenOrder",name:"\u30AC\u30FC\u30C7\u30F3\u30AA\u30FC\u30C0\u30FC",className:"GardenOrder",superClassName:"Base",sortKey:"\u304B\u3042\u3066\u3093\u304A\u304A\u305F\u3042",locale:"ja_jp"},{id:"Chill",name:"Chill",className:"Chill",superClassName:"Base",sortKey:"\u3061\u308B",locale:"ja_jp"},{id:"VisionConnect",name:"\u30F4\u30A3\u30B8\u30E7\u30F3\u30B3\u30CD\u30AF\u30C8",className:"VisionConnect",superClassName:"Base",sortKey:"\u3046\u3044\u3057\u3088\u3093\u3053\u306D\u304F\u3068",locale:"ja_jp"},{id:"Emoklore",name:"\u30A8\u30E2\u30AF\u30ED\u30A2TRPG",className:"Emoklore",superClassName:"Base",sortKey:"\u3048\u3082\u304F\u308D\u3042TRPG",locale:"ja_jp"},{id:"ScreamHighSchool",name:"\u30B9\u30AF\u30EA\u30FC\u30E0\u30CF\u30A4\u30B9\u30AF\u30FC\u30EB",className:"ScreamHighSchool",superClassName:"GardenOrder",sortKey:"\u3059\u304F\u308A\u3044\u3080\u306F\u3044\u3059\u304F\u3046\u308B",locale:"ja_jp"},{id:"WARPS",name:"\u30EF\u30FC\u30D7\u30B9",className:"WARPS",superClassName:"Base",sortKey:"\u308F\u3042\u3075\u3059",locale:"ja_jp"},{id:"Sengensyou",name:"\u5343\u5E7B\u6284",className:"Sengensyou",superClassName:"Base",sortKey:"\u305B\u3093\u3051\u3093\u3057\u3088\u3046",locale:"ja_jp"},{id:"Chill3",name:"Chill 3rd Edition",className:"Chill3",superClassName:"Base",sortKey:"\u3061\u308B3",locale:"ja_jp"},{id:"EndBreaker",name:"\u30A8\u30F3\u30C9\u30D6\u30EC\u30A4\u30AB\u30FC\uFF01",className:"EndBreaker",superClassName:"Base",sortKey:"\u3048\u3093\u3068\u3075\u308C\u3044\u304B\u3042",locale:"ja_jp"},{id:"Ainecadette",name:"\u30A8\u30CD\u30AB\u30C7\u30C3\u30C8",className:"Ainecadette",superClassName:"Base",sortKey:"\u3048\u306D\u304B\u3066\u3064\u3068",locale:"ja_jp"},{id:"CodeLayerd",name:"\u30B3\u30FC\u30C9\uFF1A\u30EC\u30A4\u30E4\u30FC\u30C9",className:"CodeLayerd",superClassName:"Base",sortKey:"\u3053\u304A\u3068\u308C\u3044\u3084\u3042\u3068",locale:"ja_jp"},{id:"ShadowRun",name:"\u30B7\u30E3\u30C9\u30A6\u30E9\u30F3",className:"ShadowRun",superClassName:"Base",sortKey:"\u3057\u3084\u3068\u3046\u3089\u3093",locale:"ja_jp"},{id:"EtrianOdysseySRS",name:"\u4E16\u754C\u6A39\u306E\u8FF7\u5BAESRS",className:"EtrianOdysseySRS",superClassName:"SRS",sortKey:"\u305B\u304B\u3044\u3057\u3086\u306E\u3081\u3044\u304D\u3086\u3046SRS",locale:"ja_jp"},{id:"FateCoreSystem",name:"Fate Core System",className:"FateCoreSystem",superClassName:"Base",sortKey:"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080",locale:"ja_jp"},{id:"ShadowRun4",name:"\u30B7\u30E3\u30C9\u30A6\u30E9\u30F3 4th Edition",className:"ShadowRun4",superClassName:"Base",sortKey:"\u3057\u3084\u3068\u3046\u3089\u30934",locale:"ja_jp"},{id:"Airgetlamh",name:"\u6731\u306E\u5B64\u5854\u306E\u30A8\u30A2\u30B2\u30C8\u30E9\u30E0",className:"Airgetlamh",superClassName:"Base",sortKey:"\u3042\u3051\u306E\u3053\u3068\u3046\u306E\u3048\u3042\u3051\u3068\u3089\u3080",locale:"ja_jp"},{id:"ColossalHunter",name:"\u30B3\u30ED\u30C3\u30B5\u30EB\u30CF\u30F3\u30BF\u30FC",className:"ColossalHunter",superClassName:"Base",sortKey:"\u3053\u308D\u3064\u3055\u308B\u306F\u3093\u305F\u3042",locale:"ja_jp"},{id:"Warhammer",name:"\u30A6\u30A9\u30FC\u30CF\u30F3\u30DE\u30FC",className:"Warhammer",superClassName:"Base",sortKey:"\u3046\u304A\u304A\u306F\u3093\u307E\u3042",locale:"ja_jp"},{id:"ShadowRun5",name:"\u30B7\u30E3\u30C9\u30A6\u30E9\u30F3 5th Edition",className:"ShadowRun5",superClassName:"ShadowRun4",sortKey:"\u3057\u3084\u3068\u3046\u3089\u30935",locale:"ja_jp"},{id:"SevenFortressMobius",name:"\u30BB\u30D6\u30F3\uFF1D\u30D5\u30A9\u30FC\u30C8\u30EC\u30B9 \u30E1\u30D3\u30A6\u30B9",className:"SevenFortressMobius",superClassName:"NightWizard",sortKey:"\u305B\u3075\u3093\u3075\u304A\u304A\u3068\u308C\u3059\u3081\u3072\u3046\u3059",locale:"ja_jp"},{id:"Fiasco",name:"\u30D5\u30A3\u30A2\u30B9\u30B3",className:"Fiasco",superClassName:"Base",sortKey:"\u3075\u3044\u3042\u3059\u3053",locale:"ja_jp"},{id:"WaresBlade",name:"\u30EF\u30FC\u30B9\u30D6\u30EC\u30A4\u30C9",className:"WaresBlade",superClassName:"Base",sortKey:"\u308F\u3042\u3059\u3075\u308C\u3044\u3068",locale:"ja_jp"},{id:"SharedFantasia",name:"Shared\u2020Fantasia",className:"SharedFantasia",superClassName:"Base",sortKey:"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305F\u3057\u3042",locale:"ja_jp"},{id:"ShinMegamiTenseiKakuseihen",name:"\u771F\u30FB\u5973\u795E\u8EE2\u751FTRPG \u899A\u9192\u7BC7",className:"ShinMegamiTenseiKakuseihen",superClassName:"Base",sortKey:"\u3057\u3093\u3081\u304B\u307F\u3066\u3093\u305B\u3044TRPG\u304B\u304F\u305B\u3044\u3078\u3093",locale:"ja_jp"},{id:"AlchemiaStruggle",name:"\u30A2\u30EB\u30B1\u30DF\u30A2\u30FB\u30B9\u30C8\u30E9\u30B0\u30EB",className:"AlchemiaStruggle",superClassName:"Base",sortKey:"\u3042\u308B\u3051\u307F\u3042\u3059\u3068\u3089\u304F\u308B",locale:"ja_jp"},{id:"Fiasco:Korean",name:"\uD53C\uC544\uC2A4\uCF54",className:"Fiasco_Korean",superClassName:"Fiasco",sortKey:"\u56FD\u969B\u5316:Korean:\uD53C\uC544\uC2A4\uCF54",locale:"ko_kr"},{id:"FilledWith",name:"\u30D5\u30A3\u30EB\u30C8\u30A6\u30A3\u30BA",className:"FilledWith",superClassName:"Base",sortKey:"\u3075\u3044\u308B\u3068\u3046\u3044\u3059",locale:"ja_jp"},{id:"ShinkuuGakuen",name:"\u771F\u7A7A\u5B66\u5712",className:"ShinkuuGakuen",superClassName:"Base",sortKey:"\u3057\u3093\u304F\u3046\u304B\u304F\u3048\u3093",locale:"ja_jp"},{id:"Comes",name:"\u30AB\u30E0\u30BA",className:"Comes",superClassName:"Base",sortKey:"\u304B\u3080\u3059",locale:"ja_jp"},{id:"CrashWorld",name:"\u589C\u843D\u4E16\u754C",className:"CrashWorld",superClassName:"Base",sortKey:"\u3064\u3044\u3089\u304F\u305B\u304B\u3044",locale:"ja_jp"},{id:"Warhammer4",name:"\u30A6\u30A9\u30FC\u30CF\u30F3\u30DE\u30FCRPG\u7B2C4\u7248",className:"Warhammer4",superClassName:"Base",sortKey:"\u3046\u304A\u304A\u306F\u3093\u307E\u30424",locale:"ja_jp"},{id:"Cthulhu",name:"\u30AF\u30C8\u30A5\u30EB\u30D5\u795E\u8A71TRPG",className:"Cthulhu",superClassName:"Base",sortKey:"\u304F\u3068\u3046\u308B\u3075\u3057\u3093\u308FTRPG",locale:"ja_jp"},{id:"WitchQuest",name:"\u30A6\u30A3\u30C3\u30C1\u30AF\u30A8\u30B9\u30C8",className:"WitchQuest",superClassName:"Base",sortKey:"\u3046\u3044\u3064\u3061\u304F\u3048\u3059\u3068",locale:"ja_jp"},{id:"Alsetto",name:"\u8A69\u7247\u306E\u30A2\u30EB\u30BB\u30C3\u30C8",className:"Alsetto",superClassName:"Base",sortKey:"\u3046\u305F\u304B\u305F\u306E\u3042\u308B\u305B\u3064\u3068",locale:"ja_jp"},{id:"Alshard",name:"\u30A2\u30EB\u30B7\u30E3\u30FC\u30C9",className:"Alshard",superClassName:"SRS",sortKey:"\u3042\u308B\u3057\u3084\u3042\u3068",locale:"ja_jp"},{id:"SRS",name:"\u30B9\u30BF\u30F3\u30C0\u30FC\u30C9RPG\u30B7\u30B9\u30C6\u30E0",className:"SRS",superClassName:"Base",sortKey:"\u3059\u305F\u3093\u305F\u3042\u3068RPG\u3057\u3059\u3066\u3080",locale:"ja_jp"},{id:"WorldOfDarkness",name:"\u30EF\u30FC\u30EB\u30C9\u30FB\u30AA\u30D6\u30FB\u30C0\u30FC\u30AF\u30CD\u30B9",className:"WorldOfDarkness",superClassName:"Base",sortKey:"\u308F\u3042\u308B\u3068\u304A\u3075\u305F\u3042\u304F\u306D\u3059",locale:"ja_jp"},{id:"MeikyuKingdomBasic",name:"\u8FF7\u5BAE\u30AD\u30F3\u30B0\u30C0\u30E0 \u57FA\u672C\u30EB\u30FC\u30EB\u30D6\u30C3\u30AF",className:"MeikyuKingdomBasic",superClassName:"MeikyuKingdom",sortKey:"\u3081\u3044\u304D\u3086\u3046\u304D\u3093\u304F\u305F\u3080\u304D\u307B\u3093\u308B\u3046\u308B\u3075\u3064\u304F",locale:"ja_jp"},{id:"Cthulhu7th",name:"\u65B0\u30AF\u30C8\u30A5\u30EB\u30D5\u795E\u8A71TRPG",className:"Cthulhu7th",superClassName:"Base",sortKey:"\u3057\u3093\u304F\u3068\u3046\u308B\u3075\u3057\u3093\u308FTRPG",locale:"ja_jp"},{id:"YankeeYogSothoth",name:"\u30E4\u30F3\u30AD\u30FC\uFF06\u30E8\u30B0\uFF1D\u30BD\u30C8\u30FC\u30B9",className:"YankeeYogSothoth",superClassName:"Base",sortKey:"\u3084\u3093\u304D\u3044\u3042\u3093\u3068\u3088\u304F\u305D\u3068\u304A\u3059",locale:"ja_jp"},{id:"ShinobiGami",name:"\u30B7\u30CE\u30D3\u30AC\u30DF",className:"ShinobiGami",superClassName:"Base",sortKey:"\u3057\u306E\u3072\u304B\u307F",locale:"ja_jp"},{id:"YearZeroEngine",name:"YearZeroEngine",className:"YearZeroEngine",superClassName:"Base",sortKey:"\u3044\u3084\u3042\u305B\u308D\u3048\u3093\u3057\u3093",locale:"ja_jp"},{id:"FullMetalPanic",name:"\u30D5\u30EB\u30E1\u30BF\u30EB\u30FB\u30D1\u30CB\u30C3\u30AF\uFF01RPG",className:"FullMetalPanic",superClassName:"SRS",sortKey:"\u3075\u308B\u3081\u305F\u308B\u306F\u306B\u3064\u304FRPG",locale:"ja_jp"},{id:"FutariSousa",name:"\u30D5\u30BF\u30EA\u30BD\u30A6\u30B5",className:"FutariSousa",superClassName:"Base",sortKey:"\u3075\u305F\u308A\u305D\u3046\u3055",locale:"ja_jp"},{id:"FutariSousa:Korean",name:"\uB458\uC774\uC11C \uC218\uC0AC(\uD6C4\uD0C0\uB9AC\uC18C\uC6B0\uC0AC)",className:"FutariSousa_Korean",superClassName:"FutariSousa",sortKey:"\u56FD\u969B\u5316:Korean:\uB458\uC774\uC11C \uC218\uC0AC",locale:"ko_kr"},{id:"Garako",name:"\u30AC\u30E9\u30B3\u3068\u7834\u754C\u306E\u5854",className:"Garako",superClassName:"Base",sortKey:"\u304B\u3089\u3053\u3068\u306F\u304B\u3044\u306E\u3068\u3046",locale:"ja_jp"},{id:"Shiranui",name:"\u4E0D\u77E5\u706B",className:"Shiranui",superClassName:"Base",sortKey:"\u3057\u3089\u306C\u3044",locale:"ja_jp"},{id:"GehennaAn",name:"\u30B2\u30D8\u30CA\u30FB\u30A2\u30CA\u30B9\u30BF\u30B7\u30B9",className:"GehennaAn",superClassName:"Base",sortKey:"\u3051\u3078\u306A\u3042\u306A\u3059\u305F\u3057\u3059",locale:"ja_jp"},{id:"ShuumatsuKikou",name:"\u7D42\u672B\u7D00\u884C\uFF32\uFF30\uFF27",className:"ShuumatsuKikou",superClassName:"Base",sortKey:"\u3057\u3086\u3046\u307E\u3064\u304D\u3053\u3046",locale:"ja_jp"},{id:"Yggdrasill",name:"\u92FC\u9244\u306E\u30E6\u30B0\u30C9\u30E9\u30B7\u30EB",className:"Yggdrasill",superClassName:"Base",sortKey:"\u3053\u3046\u3066\u3064\u306E\u3086\u304F\u3068\u3089\u3057\u308B",locale:"ja_jp"},{id:"Skynauts",name:"\u6B6F\u8ECA\u306E\u5854\u306E\u63A2\u7A7A\u58EB\uFF08\u516D\u7573\u9593\u5E7B\u60F3\u7A7A\u9593\uFF09",className:"Skynauts",superClassName:"Base",sortKey:"\u306F\u304F\u308B\u307E\u306E\u3068\u3046\u306E\u3059\u304B\u3044\u306E\u304A\u3064",locale:"ja_jp"},{id:"GeishaGirlwithKatana",name:"\u30B2\u30A4\u30B7\u30E3\u30FB\u30AC\u30FC\u30EB\u30FB\u30A6\u30A3\u30BA\u30FB\u30AB\u30BF\u30CA",className:"GeishaGirlwithKatana",superClassName:"Base",sortKey:"\u3051\u3044\u3057\u3084\u304B\u3042\u308B\u3046\u3044\u3059\u304B\u305F\u306A",locale:"ja_jp"},{id:"AlterRaise",name:"\u30A2\u30EB\u30C8\u30EC\u30A4\u30BA",className:"AlterRaise",superClassName:"Base",sortKey:"\u3042\u308B\u3068\u308C\u3044\u3059",locale:"ja_jp"},{id:"GhostLive",name:"\u5B9F\u6CC1\u30B4\u30FC\u30B9\u30C8\u30E9\u30A4\u30F4",className:"GhostLive",superClassName:"Base",sortKey:"\u3057\u3064\u304D\u3088\u3046\u3053\u304A\u3059\u3068\u3089\u3044\u3075",locale:"ja_jp"},{id:"GoblinSlayer",name:"\u30B4\u30D6\u30EA\u30F3\u30B9\u30EC\u30A4\u30E4\u30FCTRPG",className:"GoblinSlayer",superClassName:"Base",sortKey:"\u3053\u3075\u308A\u3093\u3059\u308C\u3044\u3084\u3042TRPG",locale:"ja_jp"},{id:"Amadeus",name:"\u30A2\u30DE\u30C7\u30A6\u30B9",className:"Amadeus",superClassName:"Base",sortKey:"\u3042\u307E\u3066\u3046\u3059",locale:"ja_jp"},{id:"SkynautsBouken",name:"\u6B6F\u8ECA\u306E\u5854\u306E\u63A2\u7A7A\u58EB\uFF08\u5192\u967A\u4F01\u753B\u5C40\uFF09",className:"SkynautsBouken",superClassName:"Base",sortKey:"\u306F\u304F\u308B\u307E\u306E\u3068\u3046\u306E\u3059\u304B\u3044\u306E\u304A\u30642",locale:"ja_jp"},{id:"Amadeus:Korean",name:"\uC544\uB9C8\uB370\uC6B0\uC2A4",className:"Amadeus_Korean",superClassName:"Amadeus",sortKey:"\u56FD\u969B\u5316:Korean:\uC544\uB9C8\uB370\uC6B0\uC2A4",locale:"ko_kr"},{id:"AngelGear",name:"\u30A8\u30F3\u30BC\u30EB\u30AE\u30A2 \u5929\u4F7F\u5927\u6226TRPG The 2nd Editon",className:"AngelGear",superClassName:"Base",sortKey:"\u3048\u3093\u305B\u308B\u304D\u30422",locale:"ja_jp"},{id:"MetalHead",name:"\u30E1\u30BF\u30EB\u30D8\u30C3\u30C9",className:"MetalHead",superClassName:"Base",sortKey:"\u3081\u305F\u308B\u3078\u3064\u3068",locale:"ja_jp"},{id:"GoldenSkyStories",name:"\u3086\u3046\u3084\u3051\u3053\u3084\u3051",className:"GoldenSkyStories",superClassName:"Base",sortKey:"\u3086\u3046\u3084\u3051\u3053\u3084\u3051",locale:"ja_jp"},{id:"AnimaAnimus",name:"\u30A2\u30CB\u30DE\u30A2\u30CB\u30E0\u30B9",className:"AnimaAnimus",superClassName:"Base",sortKey:"\u3042\u306B\u307E\u3042\u306B\u3080\u3059",locale:"ja_jp"},{id:"Cthulhu7th:ChineseTraditional",name:"\u514B\u8607\u9B6F\u795E\u8A71\u7B2C7\u7248",className:"Cthulhu7th_ChineseTraditional",superClassName:"Base",sortKey:"\u56FD\u969B\u5316:Chinese Traditional:\u514B\u8607\u9B6F\u795E\u8A71\u7B2C7\u7248",locale:"ja_jp"},{id:"GranCrest",name:"\u30B0\u30E9\u30F3\u30AF\u30EC\u30B9\u30C8RPG",className:"GranCrest",superClassName:"Base",sortKey:"\u304F\u3089\u3093\u304F\u308C\u3059\u3068RPG",locale:"ja_jp"},{id:"Gorilla",name:"\u30B4\u30EA\u30E9TRPG",className:"Gorilla",superClassName:"Base",sortKey:"\u3053\u308A\u3089TRPG",locale:"ja_jp"},{id:"Gundog",name:"\u30AC\u30F3\u30C9\u30C3\u30B0",className:"Gundog",superClassName:"Base",sortKey:"\u304B\u3093\u3068\u3064\u304F",locale:"ja_jp"},{id:"ZettaiReido",name:"\u7D76\u5BFE\u96B7\u5974",className:"ZettaiReido",superClassName:"Base",sortKey:"\u305B\u3064\u305F\u3044\u308C\u3044\u3068",locale:"ja_jp"},{id:"Aoharubaan",name:"\u3042\u304A\u306F\u308B\u3070\u30FC\u3093\u3063",className:"Aoharubaan",superClassName:"Base",sortKey:"\u3042\u304A\u306F\u308B\u306F\u3042\u3093\u3064",locale:"ja_jp"},{id:"GundogRevised",name:"\u30AC\u30F3\u30C9\u30C3\u30B0\u30FB\u30EA\u30F4\u30A1\u30A4\u30BA\u30C9",className:"GundogRevised",superClassName:"Base",sortKey:"\u304B\u3093\u3068\u3064\u304F\u308A\u3046\u3042\u3044\u3059\u3068",locale:"ja_jp"},{id:"MetalHeadExtream",name:"\u30E1\u30BF\u30EB\u30D8\u30C3\u30C9\u30A8\u30AF\u30B9\u30C8\u30EA\u30FC\u30E0",className:"MetalHeadExtream",superClassName:"Base",sortKey:"\u3081\u305F\u308B\u3078\u3064\u3068\u3048\u304F\u3059\u3068\u308A\u3044\u3080",locale:"ja_jp"},{id:"SteamPunkers",name:"\u30B9\u30C1\u30FC\u30E0\u30D1\u30F3\u30AB\u30FC\u30BA",className:"SteamPunkers",superClassName:"Base",sortKey:"\u3059\u3061\u3044\u3080\u306F\u3093\u304B\u3042\u3059",locale:"ja_jp"},{id:"GundogZero",name:"\u30AC\u30F3\u30C9\u30C3\u30B0\u30BC\u30ED",className:"GundogZero",superClassName:"Gundog",sortKey:"\u304B\u3093\u3068\u3064\u304F\u305B\u308D",locale:"ja_jp"},{id:"GURPS",name:"\u30AC\u30FC\u30D7\u30B9",className:"GURPS",superClassName:"Base",sortKey:"\u304B\u3042\u3075\u3059",locale:"ja_jp"},{id:"Cthulhu7th:Korean",name:"\uD06C\uD234\uB8E8\uC758 \uBD80\uB984 7\uD310",className:"Cthulhu7th_Korean",superClassName:"Base",sortKey:"\u56FD\u969B\u5316:Korean:\uD06C\uD234\uB8E8\uC758 \uBD80\uB984 7\uD310",locale:"ja_jp"},{id:"CthulhuTech",name:"\u30AF\u30C8\u30A5\u30EB\u30D5\u30C6\u30C3\u30AF",className:"CthulhuTech",superClassName:"Base",sortKey:"\u304F\u3068\u3046\u308B\u3075\u3066\u3064\u304F",locale:"ja_jp"},{id:"StellarKnights",name:"\u9280\u5263\u306E\u30B9\u30C6\u30E9\u30CA\u30A4\u30C4",className:"StellarKnights",superClassName:"Base",sortKey:"\u304D\u3093\u3051\u3093\u306E\u3059\u3066\u3089\u306A\u3044\u3064",locale:"ja_jp"},{id:"StarryDolls",name:"\u30B9\u30BF\u30EA\u30A3\u30C9\u30FC\u30EB",className:"StarryDolls",superClassName:"Base",sortKey:"\u3059\u305F\u308A\u3044\u3068\u304A\u308B",locale:"ja_jp"},{id:"Arianrhod",name:"\u30A2\u30EA\u30A2\u30F3\u30ED\u30C3\u30C9RPG",className:"Arianrhod",superClassName:"Base",sortKey:"\u3042\u308A\u3042\u3093\u308D\u3064\u3068RPG",locale:"ja_jp"},{id:"GurpsFW",name:"\u30AC\u30FC\u30D7\u30B9\u30D5\u30A3\u30EB\u30C8\u30A6\u30A3\u30BA",className:"GurpsFW",superClassName:"Base",sortKey:"\u304B\u3042\u3075\u3059\u3075\u3044\u308B\u3068\u3046\u3044\u3059",locale:"ja_jp"},{id:"ArsMagica",name:"\u30A2\u30EB\u30B9\u30DE\u30AE\u30AB",className:"ArsMagica",superClassName:"Base",sortKey:"\u3042\u308B\u3059\u307E\u304D\u304B",locale:"ja_jp"},{id:"StellarKnights:Korean",name:"\uC740\uAC80\uC758 \uC2A4\uD154\uB77C\uB098\uC774\uCE20",className:"StellarKnights_Korean",superClassName:"StellarKnights",sortKey:"\u56FD\u969B\u5316:Korean:\uC740\uAC80\uC758 \uC2A4\uD154\uB77C\uB098\uC774\uCE20",locale:"ko_kr"},{id:"StellarLife",name:"\u30B9\u30C6\u30E9\u30FC\u30E9\u30A4\u30D5TRPG",className:"StellarLife",superClassName:"Base",sortKey:"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG",locale:"ja_jp"},{id:"Cthulhu:ChineseTraditional",name:"\u514B\u8607\u9B6F\u795E\u8A71",className:"Cthulhu_ChineseTraditional",superClassName:"Cthulhu",sortKey:"\u56FD\u969B\u5316:Chinese Traditional:\u514B\u8607\u9B6F\u795E\u8A71",locale:"zh_hant"},{id:"AssaultEngine",name:"\u30A2\u30B5\u30EB\u30C8\u30A8\u30F3\u30B8\u30F3",className:"AssaultEngine",superClassName:"Base",sortKey:"\u3042\u3055\u308B\u3068\u3048\u3093\u3057\u3093",locale:"ja_jp"},{id:"Cthulhu:Korean",name:"\uD06C\uD234\uB8E8",className:"Cthulhu_Korean",superClassName:"Cthulhu",sortKey:"\u56FD\u969B\u5316:Korean:\uD06C\uD234\uB8E8",locale:"ko_kr"},{id:"Cthulhu:SimplifiedChinese",name:"\u514B\u82CF\u9C81\u7684\u547C\u5524 \u7B2C\u516D\u7248",className:"Cthulhu_SimplifiedChinese",superClassName:"Cthulhu",sortKey:"\u56FD\u969B\u5316:Simplified Chinese:\u514B\u82CF\u9C81\u7684\u547C\u5524 \u7B2C\u516D\u7248",locale:"zh_hans"},{id:"StratoShout",name:"\u30B9\u30C8\u30E9\u30C8\u30B7\u30E3\u30A6\u30C8",className:"StratoShout",superClassName:"Base",sortKey:"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068",locale:"ja_jp"},{id:"CyberpunkRed",name:"\u30B5\u30A4\u30D0\u30FC\u30D1\u30F3\u30AFRED",className:"CyberpunkRed",superClassName:"Base",sortKey:"\u3055\u3044\u306F\u3042\u306F\u3093\u304F\u308C\u3064\u3068",locale:"ja_jp"},{id:"StrangerOfSwordCity",name:"\u5263\u306E\u8857\u306E\u7570\u90A6\u4EBATRPG",className:"StrangerOfSwordCity",superClassName:"Base",sortKey:"\u3064\u308B\u304D\u306E\u307E\u3061\u306E\u3044\u307B\u3046\u3057\u3093TRPG",locale:"ja_jp"},{id:"StratoShout:Korean",name:"\uC2A4\uD2B8\uB77C\uD1A0 \uC0E4\uC6B0\uD2B8",className:"StratoShout_Korean",superClassName:"StratoShout",sortKey:"\u56FD\u969B\u5316:Korean:\uC2A4\uD2B8\uB77C\uD1A0 \uC0E4\uC6B0\uD2B8",locale:"ko_kr"},{id:"HarnMaster",name:"\u30CF\u30FC\u30F3\u30DE\u30B9\u30BF\u30FC",className:"HarnMaster",superClassName:"Base",sortKey:"\u306F\u3042\u3093\u307E\u3059\u305F\u3042",locale:"ja_jp"},{id:"Avandner",name:"\u9ED2\u7D62\u306E\u30A2\u30F4\u30A1\u30F3\u30C9\u30CA\u30FC",className:"Avandner",superClassName:"Base",sortKey:"\u3053\u3064\u3051\u3093\u306E\u3042\u3046\u3042\u3093\u3068\u306A\u3042",locale:"ja_jp"},{id:"Ayabito",name:"\u3042\u3084\u3073\u3068",className:"Ayabito",superClassName:"Base",sortKey:"\u3042\u3084\u3072\u3068",locale:"ja_jp"},{id:"MetallicGuardian",name:"\u30E1\u30BF\u30EA\u30C3\u30AF\u30AC\u30FC\u30C7\u30A3\u30A2\u30F3RPG",className:"MetallicGuardian",superClassName:"SRS",sortKey:"\u3081\u305F\u308A\u3064\u304F\u304B\u3042\u3066\u3044\u3042\u3093RPG",locale:"ja_jp"},{id:"MonotoneMuseum",name:"\u30E2\u30CE\u30C8\u30FC\u30F3\u30DF\u30E5\u30FC\u30B8\u30A2\u30E0RPG",className:"MonotoneMuseum",superClassName:"Base",sortKey:"\u3082\u306E\u3068\u304A\u3093\u307F\u3086\u3046\u3057\u3042\u3080RPG",locale:"ja_jp"},{id:"SwordWorld",name:"\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C9RPG",className:"SwordWorld",superClassName:"Base",sortKey:"\u305D\u304A\u3068\u308F\u3042\u308B\u3068",locale:"ja_jp"},{id:"MonotoneMuseum:Korean",name:"\uBAA8\uB178\uD1A4 \uBBA4\uC9C0\uC5C4",className:"MonotoneMuseum_Korean",superClassName:"MonotoneMuseum",sortKey:"\u56FD\u969B\u5316:Korean:\uBAA8\uB178\uD1A4 \uBBA4\uC9C0\uC5C4",locale:"ko_kr"},{id:"Bakenokawa",name:"\u30D0\u30B1\u30CE\u30AB\u30EF",className:"Bakenokawa",superClassName:"Base",sortKey:"\u306F\u3051\u306E\u304B\u308F",locale:"ja_jp"},{id:"Nechronica",name:"\u30CD\u30AF\u30ED\u30CB\u30AB",className:"Nechronica",superClassName:"Base",sortKey:"\u306D\u304F\u308D\u306B\u304B",locale:"ja_jp"},{id:"HatsuneMiku",name:"\u521D\u97F3\u30DF\u30AFTRPG \u30B3\u30B3\u30ED\u30C0\u30F3\u30B8\u30E7\u30F3",className:"HatsuneMiku",superClassName:"Base",sortKey:"\u306F\u3064\u306D\u307F\u304FTRPG\u3053\u3053\u308D\u305F\u3093\u3057\u3088\u3093",locale:"ja_jp"},{id:"Strave",name:"\u78A7\u7A7A\u306E\u30B9\u30C8\u30EC\u30A4\u30F4",className:"Strave",superClassName:"Base",sortKey:"\u3078\u304D\u304F\u3046\u306E\u3059\u3068\u308C\u3044\u3075",locale:"ja_jp"},{id:"BBN",name:"BBNTRPG",className:"BBN",superClassName:"Base",sortKey:"\u3072\u3044\u3072\u3044\u3048\u306CTRPG",locale:"ja_jp"},{id:"Nechronica:Korean",name:"\uB124\uD06C\uB85C\uB2C8\uCE74",className:"Nechronica_Korean",superClassName:"Nechronica",sortKey:"\u56FD\u969B\u5316:Korean:\uB124\uD06C\uB85C\uB2C8\uCE74",locale:"ko_kr"},{id:"NeverCloud",name:"\u30CD\u30D0\u30FC\u30AF\u30E9\u30A6\u30C9TRPG",className:"NeverCloud",superClassName:"Base",sortKey:"\u306D\u306F\u3042\u304F\u3089\u3046\u3068TRPG",locale:"ja_jp"},{id:"BadLife",name:"\u30D0\u30C3\u30C9\u30E9\u30A4\u30D5",className:"BadLife",superClassName:"Base",sortKey:"\u306F\u3064\u3068\u3089\u3044\u3075",locale:"ja_jp"},{id:"Hieizan",name:"\u6BD4\u53E1\u5C71\u708E\u4E0A",className:"Hieizan",superClassName:"Base",sortKey:"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046",locale:"ja_jp"},{id:"HouraiGakuen",name:"\u84EC\u83B1\u5B66\u5712\u306E\u5192\u967A!!",className:"HouraiGakuen",superClassName:"Base",sortKey:"\u307B\u3046\u3089\u3044\u304B\u304F\u3048\u3093\u306E\u307B\u3046\u3051\u3093",locale:"ja_jp"},{id:"NightWizard",name:"\u30CA\u30A4\u30C8\u30A6\u30A3\u30B6\u30FC\u30C9 The 2nd Edition",className:"NightWizard",superClassName:"Base",sortKey:"\u306A\u3044\u3068\u3046\u3044\u3055\u3042\u30682",locale:"ja_jp"},{id:"DarkBlaze",name:"\u30C0\u30FC\u30AF\u30D6\u30EC\u30A4\u30BA",className:"DarkBlaze",superClassName:"Base",sortKey:"\u305F\u3042\u304F\u3075\u308C\u3044\u3059",locale:"ja_jp"},{id:"BarnaKronika",name:"\u30D0\u30EB\u30CA\u30FB\u30AF\u30ED\u30CB\u30AB",className:"BarnaKronika",superClassName:"Base",sortKey:"\u306F\u308B\u306A\u304F\u308D\u306B\u304B",locale:"ja_jp"},{id:"DarkDaysDrive",name:"\u30C0\u30FC\u30AF\u30C7\u30A4\u30BA\u30C9\u30E9\u30A4\u30D6",className:"DarkDaysDrive",superClassName:"Base",sortKey:"\u305F\u3042\u304F\u3066\u3044\u3059\u3068\u3089\u3044\u3075",locale:"ja_jp"},{id:"DarkSouls",name:"\u30C0\u30FC\u30AF\u30BD\u30A6\u30EBTRPG",className:"DarkSouls",superClassName:"Base",sortKey:"\u305F\u3042\u304F\u305D\u3046\u308BTRPG",locale:"ja_jp"},{id:"NightWizard3rd",name:"\u30CA\u30A4\u30C8\u30A6\u30A3\u30B6\u30FC\u30C9 The 3rd Edition",className:"NightWizard3rd",superClassName:"NightWizard",sortKey:"\u306A\u3044\u3068\u3046\u3044\u3055\u3042\u30683",locale:"ja_jp"},{id:"NightmareHunterDeep",name:"\u30CA\u30A4\u30C8\u30E1\u30A2\u30CF\u30F3\u30BF\u30FC=\u30C7\u30A3\u30FC\u30D7",className:"NightmareHunterDeep",superClassName:"Base",sortKey:"\u306A\u3044\u3068\u3081\u3042\u306F\u3093\u305F\u3042\u3066\u3044\u3044\u3075",locale:"ja_jp"},{id:"BattleTech",name:"\u30D0\u30C8\u30EB\u30C6\u30C3\u30AF",className:"BattleTech",superClassName:"Base",sortKey:"\u306F\u3068\u308B\u3066\u3064\u304F",locale:"ja_jp"},{id:"HuntersMoon",name:"\u30CF\u30F3\u30BF\u30FC\u30BA\u30FB\u30E0\u30FC\u30F3",className:"HuntersMoon",superClassName:"Base",sortKey:"\u306F\u3093\u305F\u3042\u3059\u3080\u3046\u3093",locale:"ja_jp"},{id:"DeadlineHeroes",name:"\u30C7\u30C3\u30C9\u30E9\u30A4\u30F3\u30D2\u30FC\u30ED\u30FC\u30BARPG",className:"DeadlineHeroes",superClassName:"Base",sortKey:"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308D\u304A\u3059RPG",locale:"ja_jp"},{id:"NinjaSlayer",name:"\u30CB\u30F3\u30B8\u30E3\u30B9\u30EC\u30A4\u30E4\u30FCTRPG",className:"NinjaSlayer",superClassName:"Base",sortKey:"\u306B\u3093\u3057\u3084\u3059\u308C\u3044\u3084\u3042RPG",locale:"ja_jp"},{id:"IfIfIf",name:"\u30A4\u30D5\u30FB\u30A4\u30D5\u30FB\u30A4\u30D5",className:"IfIfIf",superClassName:"Base",sortKey:"\u3044\u3075\u3044\u3075\u3044\u3075",locale:"ja_jp"},{id:"SwordWorld2.0",name:"\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C92.0",className:"SwordWorld2_0",superClassName:"SwordWorld",sortKey:"\u305D\u304A\u3068\u308F\u3042\u308B\u30682.0",locale:"ja_jp"},{id:"NjslyrBattle",name:"NJSLYRBATTLE",className:"NjslyrBattle",superClassName:"Base",sortKey:"\u306B\u3093\u3057\u3084\u3059\u308C\u3044\u3084\u3042\u306F\u3068\u308B",locale:"ja_jp"},{id:"NSSQ",name:"SRS\u3058\u3083\u306A\u3044\u4E16\u754C\u6A39\u306E\u8FF7\u5BAETRPG",className:"NSSQ",superClassName:"Base",sortKey:"\u3048\u3059\u3042\u3042\u308B\u3048\u3059\u3057\u3084\u306A\u3044\u305B\u304B\u3044\u3057\u3086\u306E\u3081\u3044\u304D\u3086\u3046TRPG",locale:"ja_jp"},{id:"DemonParasite",name:"\u30C7\u30E2\u30F3\u30D1\u30E9\u30B5\u30A4\u30C8",className:"DemonParasite",superClassName:"Base",sortKey:"\u3066\u3082\u3093\u306F\u3089\u3055\u3044\u3068",locale:"ja_jp"},{id:"SwordWorld2.5",name:"\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C92.5",className:"SwordWorld2_5",superClassName:"SwordWorld2_0",sortKey:"\u305D\u304A\u3068\u308F\u3042\u308B\u30682.5",locale:"ja_jp"},{id:"Illusio",name:"\u6643\u5929\u306E\u30A4\u30EB\u30FC\u30B8\u30AA",className:"Illusio",superClassName:"Base",sortKey:"\u3053\u3046\u3066\u3093\u306E\u3044\u308B\u3046\u3057\u304A",locale:"ja_jp"},{id:"TalesFromTheLoop",name:"\u30B6\u30FB\u30EB\u30FC\u30D7TRPG",className:"TalesFromTheLoop",superClassName:"Base",sortKey:"\u3055\u308B\u3046\u3075TRPG",locale:"ja_jp"},{id:"Nuekagami",name:"\u9D7A\u93E1",className:"Nuekagami",superClassName:"Base",sortKey:"\u306C\u3048\u304B\u304B\u307F",locale:"ja_jp"},{id:"OneWayHeroics",name:"\u7247\u9053\u52C7\u8005TRPG",className:"OneWayHeroics",superClassName:"Base",sortKey:"\u304B\u305F\u307F\u3061\u3086\u3046\u3057\u3084TRPG",locale:"ja_jp"},{id:"InfiniteBabeL",name:"\u5C11\u5E74\u306E\u305F\u3081\u306E\u5C11\u5973\u5C55\u721B\u4F1A\u7570\u805E Infinite BabeL",className:"InfiniteBabeL",superClassName:"ShoujoTenrankai",sortKey:"\u3057\u3088\u3046\u306D\u3093\u306E\u305F\u3081\u306E\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304B\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306B\u3064\u3068\u306F\u3078\u308B",locale:"ja_jp"},{id:"DesperateRun",name:"Desperate Run TRPG",className:"DesperateRun",superClassName:"Base",sortKey:"\u3066\u3059\u3078\u308C\u3044\u3068\u3089\u3093TRPG",locale:"ja_jp"},{id:"ShoujoTenrankai",name:"\u5C11\u5973\u5C55\u721B\u4F1ATRPG",className:"ShoujoTenrankai",superClassName:"Base",sortKey:"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304B\u3044TRPG",locale:"ja_jp"},{id:"TherapieSein",name:"\u30BB\u30E9\u30D5\u30A3\u30B6\u30A4\u30F3",className:"TherapieSein",superClassName:"Base",sortKey:"\u305B\u3089\u3075\u3044\u3055\u3044\u3093",locale:"ja_jp"},{id:"TokumeiTenkousei",name:"\u7279\u547D\u8EE2\u653B\u751F",className:"TokumeiTenkousei",superClassName:"Base",sortKey:"\u3068\u304F\u3081\u3044\u3066\u3093\u3053\u3046\u305B\u3044",locale:"ja_jp"},{id:"DetatokoSaga",name:"\u3067\u305F\u3068\u3053\u30B5\u30FC\u30AC",className:"DetatokoSaga",superClassName:"Base",sortKey:"\u3066\u305F\u3068\u3053\u3055\u3042\u304B",locale:"ja_jp"},{id:"InfiniteFantasia",name:"\u7121\u9650\u306E\u30D5\u30A1\u30F3\u30BF\u30B8\u30A2",className:"InfiniteFantasia",superClassName:"Base",sortKey:"\u3080\u3051\u3093\u306E\u3075\u3042\u3093\u305F\u3057\u3042",locale:"ja_jp"},{id:"Insane",name:"\u30A4\u30F3\u30BB\u30A4\u30F3",className:"Insane",superClassName:"Base",sortKey:"\u3044\u3093\u305B\u3044\u3093",locale:"ja_jp"},{id:"TokyoGhostResearch",name:"\u6771\u4EAC\u30B4\u30FC\u30B9\u30C8\u30EA\u30B5\u30FC\u30C1",className:"TokyoGhostResearch",superClassName:"Base",sortKey:"\u3068\u3046\u304D\u3088\u3046\u3053\u304A\u3059\u3068\u308A\u3055\u3042\u3061",locale:"ja_jp"},{id:"Insane:Korean",name:"\uC778\uC138\uC778",className:"Insane_Korean",superClassName:"Insane",sortKey:"\u56FD\u969B\u5316:Korean:\uC778\uC138\uC778",locale:"ko_kr"},{id:"Irisbane",name:"\u77B3\u9038\u3089\u3055\u306C\u30A4\u30EA\u30B9\u30D9\u30A4\u30F3",className:"Irisbane",superClassName:"Base",sortKey:"\u3072\u3068\u307F\u305D\u3089\u3055\u306C\u3044\u308A\u3059\u3078\u3044\u3093",locale:"ja_jp"},{id:"BeastBindTrinity",name:"\u30D3\u30FC\u30B9\u30C8\u30D0\u30A4\u30F3\u30C9 \u30C8\u30EA\u30CB\u30C6\u30A3",className:"BeastBindTrinity",superClassName:"Base",sortKey:"\u3072\u3044\u3059\u3068\u306F\u3044\u3093\u3068\u3068\u308A\u306B\u3066\u3044",locale:"ja_jp"},{id:"TokyoNova",name:"\u30C8\u30FC\u30AD\u30E7\u30FCN\u25CEVA",className:"TokyoNova",superClassName:"Base",sortKey:"\u3068\u304A\u304D\u3088\u304A\u306E\u306F",locale:"ja_jp"},{id:"Torg",name:"\u30C8\u30FC\u30B0",className:"Torg",superClassName:"Base",sortKey:"\u3068\u304A\u304F",locale:"ja_jp"},{id:"DetatokoSaga:Korean",name:"\uB370\uD0C0\uD1A0\uCF54 \uC0AC\uAC00",className:"DetatokoSaga_Korean",superClassName:"DetatokoSaga",sortKey:"\u56FD\u969B\u5316:Korean:\uB370\uD0C0\uD1A0\uCF54 \uC0AC\uAC00",locale:"ko_kr"},{id:"DiceOfTheDead",name:"\u30C0\u30A4\u30B9\u30FB\u30AA\u30D6\u30FB\u30B6\u30FB\u30C7\u30C3\u30C9",className:"DiceOfTheDead",superClassName:"Base",sortKey:"\u305F\u3044\u3059\u304A\u3075\u3055\u3066\u3064\u3068",locale:"ja_jp"},{id:"IthaWenUa",name:"\u30A4\u30B5\u30FC\u30FB\u30A6\u30A7\u30F3\uFF1D\u30A2\u30FC",className:"IthaWenUa",superClassName:"Base",sortKey:"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042",locale:"ja_jp"},{id:"JamesBond",name:"\u30B8\u30A7\u30FC\u30E0\u30BA\u30FB\u30DC\u30F3\u30C9007",className:"JamesBond",superClassName:"Base",sortKey:"\u3057\u3048\u3048\u3080\u3059\u307B\u3093\u3068007",locale:"ja_jp"},{id:"JekyllAndHyde",name:"\u30B8\u30AD\u30EB\u3068\u30CF\u30A4\u30C9\u3068\u30B0\u30EA\u30C8\u30B0\u30E9",className:"JekyllAndHyde",superClassName:"DesperateRun",sortKey:"\u3057\u304D\u308B\u3068\u306F\u3044\u3068\u3068\u304F\u308A\u3068\u304F\u3089",locale:"ja_jp"},{id:"JuinKansen",name:"\u546A\u5370\u611F\u67D3",className:"JuinKansen",superClassName:"Base",sortKey:"\u3057\u3086\u3044\u3093\u304B\u3093\u305B\u3093",locale:"ja_jp"},{id:"DoubleCross",name:"\u30C0\u30D6\u30EB\u30AF\u30ED\u30B92nd,3rd",className:"DoubleCross",superClassName:"Base",sortKey:"\u305F\u3075\u308B\u304F\u308D\u30592",locale:"ja_jp"},{id:"Kamigakari",name:"\u795E\u6211\u72E9",className:"Kamigakari",superClassName:"Base",sortKey:"\u304B\u307F\u304B\u304B\u308A",locale:"ja_jp"},{id:"OracleEngine",name:"\u30AA\u30E9\u30AF\u30EB\u30A8\u30F3\u30B8\u30F3",className:"OracleEngine",superClassName:"Base",sortKey:"\u304A\u3089\u304F\u308B\u3048\u3093\u3057\u3093",locale:"ja_jp"},{id:"Kamigakari:Korean",name:"\uCE74\uBBF8\uAC00\uCE74\uB9AC",className:"Kamigakari_Korean",superClassName:"Kamigakari",sortKey:"\u56FD\u969B\u5316:Korean:\uCE74\uBBF8\uAC00\uCE74\uB9AC",locale:"ko_kr"},{id:"KanColle",name:"\u8266\u3053\u308CRPG",className:"KanColle",superClassName:"Base",sortKey:"\u304B\u3093\u3053\u308CRPG",locale:"ja_jp"},{id:"BeginningIdol",name:"\u30D3\u30AE\u30CB\u30F3\u30B0\u30A2\u30A4\u30C9\u30EB",className:"BeginningIdol",superClassName:"Base",sortKey:"\u3072\u304D\u306B\u3093\u304F\u3042\u3044\u3068\u308B",locale:"ja_jp"},{id:"OrgaRain",name:"\u5728\u308A\u3066\u904D\u304F\u30AA\u30EB\u30AC\u30EC\u30A4\u30F3",className:"OrgaRain",superClassName:"Base",sortKey:"\u3042\u308A\u3066\u3042\u307E\u306D\u304F\u304A\u308B\u304B\u308C\u3044\u3093",locale:"ja_jp"},{id:"Oukahoushin3rd",name:"\u592E\u83EF\u5C01\u795ERPG \u7B2C\u4E09\u7248",className:"Oukahoushin3rd",superClassName:"Base",sortKey:"\u304A\u3046\u304B\u307B\u3046\u3057\u3093RPG3",locale:"ja_jp"},{id:"Torg1.5",name:"\u30C8\u30FC\u30B01.5\u7248",className:"Torg1_5",superClassName:"Torg",sortKey:"\u3068\u304A\u304F1.5",locale:"ja_jp"},{id:"Karukami",name:"\u30AB\u30EB\u30AB\u30DF",className:"Karukami",superClassName:"Base",sortKey:"\u304B\u308B\u304B\u307F",locale:"ja_jp"},{id:"Paradiso",name:"\u30C1\u30A7\u30EC\u30B9\u30C6\u8272\u306E\u30D1\u30E9\u30C7\u30A3\u30FC\u30BE",className:"Paradiso",superClassName:"Base",sortKey:"\u3061\u3048\u308C\u3059\u3066\u3044\u308D\u306E\u306F\u3089\u3066\u3044\u3044\u305D",locale:"ja_jp"},{id:"KemonoNoMori",name:"\u7378\u30CE\u68EE",className:"KemonoNoMori",superClassName:"Base",sortKey:"\u3051\u3082\u306E\u306E\u3082\u308A",locale:"ja_jp"},{id:"DoubleCross:Korean",name:"\uB354\uBE14\uD06C\uB85C\uC2A42nd,3rd",className:"DoubleCross_Korean",superClassName:"DoubleCross",sortKey:"\u56FD\u969B\u5316:Korean:\uB354\uBE14\uD06C\uB85C\uC2A4",locale:"ko_kr"},{id:"Dracurouge",name:"\u30C9\u30E9\u30AF\u30EB\u30FC\u30B8\u30E5",className:"Dracurouge",superClassName:"Base",sortKey:"\u3068\u3089\u304F\u308B\u3046\u3057\u3086",locale:"ja_jp"},{id:"TorgEternity",name:"\u30C8\u30FC\u30B0 \u30A8\u30BF\u30CB\u30C6\u30A3",className:"TorgEternity",superClassName:"Base",sortKey:"\u3068\u304A\u304F\u3048\u305F\u306B\u3066\u3044",locale:"ja_jp"},{id:"DiceBot",name:"DiceBot",className:"DiceBot",superClassName:"Base",sortKey:"*\u305F\u3044\u3059\u307B\u3064\u3068",locale:"ja_jp"},{id:"KillDeathBusiness",name:"\u30AD\u30EB\u30C7\u30B9\u30D3\u30B8\u30CD\u30B9",className:"KillDeathBusiness",superClassName:"Base",sortKey:"\u304D\u308B\u3066\u3059\u3072\u3057\u306D\u3059",locale:"ja_jp"},{id:"Paranoia",name:"\u30D1\u30E9\u30CE\u30A4\u30A2",className:"Paranoia",superClassName:"Base",sortKey:"\u306F\u3089\u306E\u3044\u3042",locale:"ja_jp"},{id:"ParanoiaRebooted",name:"\u30D1\u30E9\u30CE\u30A4\u30A2 \u30EA\u30D6\u30FC\u30C6\u30C3\u30C9",className:"ParanoiaRebooted",superClassName:"Base",sortKey:"\u306F\u3089\u306E\u3044\u3042\u308A\u3075\u3046\u3066\u3064\u3068",locale:"ja_jp"},{id:"ParasiteBlood",name:"\u30D1\u30E9\u30B5\u30A4\u30C8\u30D6\u30E9\u30C3\u30C9RPG",className:"ParasiteBlood",superClassName:"DemonParasite",sortKey:"\u306F\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG",locale:"ja_jp"},{id:"Pathfinder",name:"Pathfinder",className:"Pathfinder",superClassName:"DungeonsAndDragons",sortKey:"\u306F\u3059\u3075\u3042\u3044\u3093\u305F\u3042",locale:"ja_jp"},{id:"Peekaboo",name:"\u30D4\u30FC\u30AB\u30FC\u30D6\u30FC",className:"Peekaboo",superClassName:"Base",sortKey:"\u3072\u3044\u304B\u3042\u3075\u3046",locale:"ja_jp"},{id:"Pendragon",name:"\u30DA\u30F3\u30C9\u30E9\u30B4\u30F3",className:"Pendragon",superClassName:"Base",sortKey:"\u3078\u3093\u3068\u3089\u3053\u3093",locale:"ja_jp"},{id:"PersonaO",name:"\u30DA\u30EB\u30BD\u30CATRPG-O",className:"PersonaO",superClassName:"Base",sortKey:"\u3078\u308B\u305D\u306ATRPGO",locale:"ja_jp"},{id:"PhantasmAdventure",name:"\u30D5\u30A1\u30F3\u30BF\u30BA\u30E0\u30FB\u30A2\u30C9\u30D9\u30F3\u30C1\u30E3\u30FC",className:"PhantasmAdventure",superClassName:"Base",sortKey:"\u3075\u3042\u3093\u305F\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042",locale:"ja_jp"},{id:"Dracurouge:Korean",name:"\uB4DC\uB77C\uD06C\uB8E8\uC8FC",className:"Dracurouge_Korean",superClassName:"Dracurouge",sortKey:"\u56FD\u969B\u5316:Korean:\uB4DC\uB77C\uD06C\uB8E8\uC8FC",locale:"ko_kr"},{id:"DungeonsAndDragons",name:"\u30C0\u30F3\u30B8\u30E7\u30F3\u30BA\uFF06\u30C9\u30E9\u30B4\u30F3\u30BA",className:"DungeonsAndDragons",superClassName:"Base",sortKey:"\u305F\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059",locale:"ja_jp"},{id:"EarthDawn",name:"\u30A2\u30FC\u30B9\u30C9\u30FC\u30F3",className:"EarthDawn",superClassName:"Base",sortKey:"\u3042\u3042\u3059\u3068\u304A\u3093",locale:"ja_jp"},{id:"KurayamiCrying",name:"\u30AF\u30E9\u30E4\u30DF\u30AF\u30E9\u30A4\u30F3",className:"KurayamiCrying",superClassName:"Base",sortKey:"\u304F\u3089\u3084\u307F\u304F\u3089\u3044\u3093",locale:"ja_jp"},{id:"KillDeathBusiness:Korean",name:"Kill Death Business (\uD55C\uAD6D\uC5B4)",className:"KillDeathBusiness_Korean",superClassName:"KillDeathBusiness",sortKey:"\u56FD\u969B\u5316:Korean:Kill Death Business",locale:"ko_kr"},{id:"Kutulu",name:"Kutulu",className:"Kutulu",superClassName:"Base",sortKey:"\u304F\u3068\u3046\u308B\u3046",locale:"ja_jp"},{id:"TrinitySeven",name:"\u30C8\u30EA\u30CB\u30C6\u30A3\u30BB\u30D6\u30F3RPG",className:"TrinitySeven",superClassName:"Base",sortKey:"\u3068\u308A\u306B\u3066\u3044\u305B\u3075\u3093RPG",locale:"ja_jp"},{id:"Postman",name:"\u58CA\u308C\u305F\u4E16\u754C\u306E\u30DD\u30B9\u30C8\u30DE\u30F3",className:"Postman",superClassName:"Base",sortKey:"\u3053\u308F\u308C\u305F\u305B\u304B\u3044\u306E\u307B\u3059\u3068\u307E\u3093",locale:"ja_jp"},{id:"LiveraDoll",name:"\u7D2B\u7E1E\u306E\u30EA\u30F4\u30E9\u30C9\u30FC\u30EB",className:"LiveraDoll",superClassName:"Base",sortKey:"\u3057\u3057\u307E\u306E\u308A\u3046\u3089\u3068\u304A\u308B",locale:"ja_jp"},{id:"PulpCthulhu",name:"\u30D1\u30EB\u30D7\u30FB\u30AF\u30C8\u30A5\u30EB\u30D5",className:"PulpCthulhu",superClassName:"Cthulhu7th",sortKey:"\u306F\u308B\u3075\u304F\u3068\u3046\u308B\u3075",locale:"ja_jp"},{id:"Raisondetre",name:"\u53DB\u9006\u30EC\u30BE\u30F3\u30C7\u30FC\u30C8\u30EB",className:"Raisondetre",superClassName:"Base",sortKey:"\u306F\u3093\u304D\u3084\u304F\u308C\u305D\u3093\u3066\u3068\u304A\u308B",locale:"ja_jp"},{id:"LogHorizon",name:"\u30ED\u30B0\u30FB\u30DB\u30E9\u30A4\u30BA\u30F3TRPG",className:"LogHorizon",superClassName:"Base",sortKey:"\u308D\u304F\u307B\u3089\u3044\u3059\u3093TRPG",locale:"ja_jp"},{id:"TunnelsAndTrolls",name:"\u30C8\u30F3\u30CD\u30EB\u30BA\uFF06\u30C8\u30ED\u30FC\u30EB\u30BA",className:"TunnelsAndTrolls",superClassName:"Base",sortKey:"\u3068\u3093\u306D\u308B\u3059\u3042\u3093\u3068\u3068\u308D\u304A\u308B\u3059",locale:"ja_jp"},{id:"ToshiakiHolyGrailWar",name:"\u3068\u3057\u3042\u304D\u306E\u8056\u676F\u6226\u4E89TRPG",className:"ToshiakiHolyGrailWar",superClassName:"Base",sortKey:"\u3068\u3057\u3042\u304D\u306E\u305B\u3044\u306F\u3044\u305B\u3093\u305D\u3046TRPG",locale:"ja_jp"},{id:"RecordOfLodossWar",name:"\u30ED\u30FC\u30C9\u30B9\u5CF6\u6226\u8A18RPG",className:"RecordOfLodossWar",superClassName:"Base",sortKey:"\u308D\u304A\u3068\u3059\u3068\u3046\u305B\u3093\u304DRPG",locale:"ja_jp"},{id:"RecordOfSteam",name:"Record of Steam",className:"RecordOfSteam",superClassName:"Base",sortKey:"\u308C\u3053\u304A\u3068\u304A\u3075\u3059\u3061\u3044\u3080",locale:"ja_jp"},{id:"EarthDawn3",name:"\u30A2\u30FC\u30B9\u30C9\u30FC\u30F33\u7248",className:"EarthDawn3",superClassName:"EarthDawn",sortKey:"\u3042\u3042\u3059\u3068\u304A\u30933",locale:"ja_jp"},{id:"TwilightGunsmoke",name:"\u30C8\u30EF\u30A4\u30E9\u30A4\u30C8\u30AC\u30F3\u30B9\u30E2\u30FC\u30AF",className:"TwilightGunsmoke",superClassName:"Base",sortKey:"\u3068\u308F\u3044\u3089\u3044\u3068\u304B\u3093\u3059\u3082\u304A\u304F",locale:"ja_jp"},{id:"UnsungDuet",name:"\u30A2\u30F3\u30B5\u30F3\u30B0\u30FB\u30C7\u30E5\u30A8\u30C3\u30C8",className:"UnsungDuet",superClassName:"Base",sortKey:"\u3042\u3093\u3055\u3093\u304F\u3066\u3086\u3048\u3064\u3068",locale:"ja_jp"},{id:"Revulture",name:"\u5149\u7815\u306E\u30EA\u30F4\u30A1\u30EB\u30C1\u30E3\u30FC",className:"Revulture",superClassName:"Base",sortKey:"\u3053\u3046\u3055\u3044\u306E\u308A\u3046\u3042\u308B\u3061\u3084\u3042",locale:"ja_jp"},{id:"Utakaze",name:"\u30A6\u30BF\u30AB\u30BC",className:"Utakaze",superClassName:"Base",sortKey:"\u3046\u305F\u304B\u305B",locale:"ja_jp"},{id:"LogHorizon:Korean",name:"\uB85C\uADF8 \uD638\uB77C\uC774\uC98C",className:"LogHorizon_Korean",superClassName:"LogHorizon",sortKey:"\u56FD\u969B\u5316:Korean:\uB85C\uADF8 \uD638\uB77C\uC774\uC98C",locale:"ko_kr"},{id:"LostRecord",name:"\u30ED\u30B9\u30C8\u30EC\u30B3\u30FC\u30C9",className:"LostRecord",superClassName:"Base",sortKey:"\u308D\u3059\u3068\u308C\u3053\u304A\u3068",locale:"ja_jp"},{id:"LostRoyal",name:"\u30ED\u30B9\u30C8\u30ED\u30A4\u30E4\u30EB",className:"LostRoyal",superClassName:"Base",sortKey:"\u308D\u3059\u3068\u308D\u3044\u3084\u308B",locale:"ja_jp"},{id:"BeginningIdol:Korean",name:"\uBE44\uAE30\uB2DD \uC544\uC774\uB3CC",className:"BeginningIdol_Korean",superClassName:"BeginningIdol",sortKey:"\u56FD\u969B\u5316:Korean:\uBE44\uAE30\uB2DD \uC544\uC774\uB3CC",locale:"ko_kr"},{id:"BeginningIdol2022",name:"\u30D3\u30AE\u30CB\u30F3\u30B0\u30A2\u30A4\u30C9\u30EB\uFF082022\u5E74\u6539\u8A02\u7248\uFF09",className:"BeginningIdol2022",superClassName:"Base",sortKey:"\u3072\u304D\u306B\u3093\u304F\u3042\u3044\u3068\u308B2022",locale:"ja_jp"},{id:"RokumonSekai2",name:"\u516D\u9580\u4E16\u754CRPG \u30BB\u30AB\u30F3\u30C9\u30A8\u30C7\u30A3\u30B7\u30E7\u30F3",className:"RokumonSekai2",superClassName:"Base",sortKey:"\u308D\u304F\u3082\u3093\u305B\u304B\u3044RPG2",locale:"ja_jp"},{id:"VampireTheMasquerade5th",name:"Vampire: The Masquerade 5th Edition",className:"VampireTheMasquerade5th",superClassName:"Base",sortKey:"\u3046\u3042\u3093\u306F\u3044\u3042\u3055\u307E\u3059\u304B\u308C\u3048\u30685",locale:"ja_jp"},{id:"EarthDawn4",name:"\u30A2\u30FC\u30B9\u30C9\u30FC\u30F34\u7248",className:"EarthDawn4",superClassName:"EarthDawn",sortKey:"\u3042\u3042\u3059\u3068\u304A\u30934",locale:"ja_jp"},{id:"RoleMaster",name:"\u30ED\u30FC\u30EB\u30DE\u30B9\u30BF\u30FC",className:"RoleMaster",superClassName:"Base",sortKey:"\u308D\u304A\u308B\u307E\u3059\u305F\u3042",locale:"ja_jp"},{id:"RuinBreakers",name:"\u30EB\u30FC\u30A4\u30F3\u30D6\u30EC\u30A4\u30AB\u30FC\u30BA",className:"RuinBreakers",superClassName:"Base",sortKey:"\u308B\u3046\u3044\u3093\u3075\u308C\u3044\u304B\u3042\u3059",locale:"ja_jp"},{id:"RuneQuest",name:"\u30EB\u30FC\u30F3\u30AF\u30A8\u30B9\u30C8",className:"RuneQuest",superClassName:"Base",sortKey:"\u308B\u3046\u3093\u304F\u3048\u3059\u3068",locale:"ja_jp"},{id:"BladeOfArcana",name:"\u30D6\u30EC\u30A4\u30C9\u30FB\u30AA\u30D6\u30FB\u30A2\u30EB\u30AB\u30CA",className:"BladeOfArcana",superClassName:"Base",sortKey:"\u3075\u308C\u3044\u3068\u304A\u3075\u3042\u308B\u304B\u306A",locale:"ja_jp"},{id:"RyuTuber",name:"\u30EA\u30E5\u30FC\u30C1\u30E5\u30FC\u30D0\u30FC\u3068\u3061\u3044\u3055\u306A\u5947\u8DE1",className:"RyuTuber",superClassName:"Base",sortKey:"\u308A\u3086\u3046\u3061\u3086\u3046\u306F\u3042\u3068\u3061\u3044\u3055\u306A\u304D\u305B\u304D",locale:"ja_jp"},{id:"MagicaLogia",name:"\u30DE\u30AE\u30AB\u30ED\u30AE\u30A2",className:"MagicaLogia",superClassName:"Base",sortKey:"\u307E\u304D\u304B\u308D\u304D\u3042",locale:"ja_jp"},{id:"EclipsePhase",name:"\u30A8\u30AF\u30EA\u30D7\u30B9\u30FB\u30D5\u30A7\u30A4\u30BA",className:"EclipsePhase",superClassName:"Base",sortKey:"\u3048\u304F\u308A\u3075\u3059\u3075\u3048\u3044\u3059",locale:"ja_jp"},{id:"Ryutama",name:"\u308A\u3085\u3046\u305F\u307E",className:"Ryutama",superClassName:"Base",sortKey:"\u308A\u3086\u3046\u305F\u307E",locale:"ja_jp"},{id:"BlindMythos",name:"\u30D6\u30E9\u30A4\u30F3\u30C9\u30FB\u30DF\u30C8\u30B9RPG",className:"BlindMythos",superClassName:"Base",sortKey:"\u3075\u3089\u3044\u3093\u3068\u307F\u3068\u3059RPG",locale:"ja_jp"},{id:"Elric",name:"\u30A8\u30EB\u30EA\u30C3\u30AF\uFF01",className:"Elric",superClassName:"Base",sortKey:"\u3048\u308B\u308A\u3064\u304F",locale:"ja_jp"},{id:"Elysion",name:"\u30A8\u30EA\u30E5\u30B7\u30AA\u30F3",className:"Elysion",superClassName:"Base",sortKey:"\u3048\u308A\u3086\u3057\u304A\u3093",locale:"ja_jp"}]}});var ir=de((qt,zr)=>{zr.exports={i18nList:[{baseClassName:"Amadeus",locales:["ja_jp","ko_kr"]},{baseClassName:"BeginningIdol",locales:["ja_jp","ko_kr"]},{baseClassName:"Cthulhu",locales:["ja_jp","ko_kr","zh_hans","zh_hant"]},{baseClassName:"DetatokoSaga",locales:["ja_jp","ko_kr"]},{baseClassName:"DoubleCross",locales:["ja_jp","ko_kr"]},{baseClassName:"Dracurouge",locales:["ja_jp","ko_kr"]},{baseClassName:"Fiasco",locales:["ja_jp","ko_kr"]},{baseClassName:"FutariSousa",locales:["ja_jp","ko_kr"]},{baseClassName:"Insane",locales:["ja_jp","ko_kr"]},{baseClassName:"Kamigakari",locales:["ja_jp","ko_kr"]},{baseClassName:"KillDeathBusiness",locales:["ja_jp","ko_kr"]},{baseClassName:"LogHorizon",locales:["ja_jp","ko_kr"]},{baseClassName:"MagicaLogia",locales:["ja_jp","ko_kr","zh_hans"]},{baseClassName:"MonotoneMuseum",locales:["ja_jp","ko_kr"]},{baseClassName:"Nechronica",locales:["ja_jp","ko_kr"]},{baseClassName:"StellarKnights",locales:["ja_jp","ko_kr"]},{baseClassName:"StratoShout",locales:["ja_jp","ko_kr"]},{baseClassName:"SwordWorld",locales:["ja_jp"]},{baseClassName:"SwordWorld2_0",locales:["ja_jp"]},{baseClassName:"SwordWorld2_5",locales:["ja_jp"]}]}});var Fe=de(pe=>{"use strict";var Ir=pe&&pe.__extends||function(){var e=function(A,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var q in r)Object.prototype.hasOwnProperty.call(r,q)&&(t[q]=r[q])},e(A,o)};return function(A,o){e(A,o);function t(){this.constructor=A}A.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}}(),Pr=pe&&pe.__awaiter||function(e,A,o,t){function r(q){return q instanceof o?q:new o(function(C){C(q)})}return new(o||(o=Promise))(function(q,C){function I(z){try{v(t.next(z))}catch(T){C(T)}}function h(z){try{v(t.throw(z))}catch(T){C(T)}}function v(z){z.done?q(z.value):r(z.value).then(I,h)}v((t=t.apply(e,A||[])).next())})},jr=pe&&pe.__generator||function(e,A){var o={label:0,sent:function(){if(q[0]&1)throw q[1];return q[1]},trys:[],ops:[]},t,r,q,C;return C={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function I(v){return function(z){return h([v,z])}}function h(v){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(q=v[0]&2?r.return:v[0]?r.throw||((q=r.return)&&q.call(r),0):r.next)&&!(q=q.call(r,v[1])).done)return q;switch(r=0,q&&(v=[v[0]&2,q.value]),v[0]){case 0:case 1:q=v;break;case 4:return o.label++,{value:v[1],done:!1};case 5:o.label++,r=v[1],v=[0];continue;case 7:v=o.ops.pop(),o.trys.pop();continue;default:if(q=o.trys,!(q=q.length>0&&q[q.length-1])&&(v[0]===6||v[0]===2)){o=0;continue}if(v[0]===3&&(!q||v[1]>q[0]&&v[1]<q[3])){o.label=v[1];break}if(v[0]===6&&o.label<q[1]){o.label=q[1],q=v;break}if(q&&o.label<q[2]){o.label=q[2],o.ops.push(v);break}q[2]&&o.ops.pop(),o.trys.pop();continue}v=A.call(e,o)}catch(z){v=[6,z],r=0}finally{t=q=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},Ke=pe&&pe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pe,"__esModule",{value:!0});pe.getGameSystemClass=void 0;var Br=Ke(Be()),qe=xe(),Mr=Ce(),Kr=Ke(nr()),Fr=Ke(ir());function Me(e){var A;return A=function(o){Ir(t,o);function t(r,q){return o.call(this,r,q!=null?q:e.$new(r))||this}return t.eval=function(r){return Mr.parseResult(e.$eval(r))},t}(Br.default),A.ID=e.$const_get("ID"),A.NAME=e.$const_get("NAME"),A.SORT_KEY=e.$const_get("SORT_KEY"),A.HELP_MESSAGE=e.$const_get("HELP_MESSAGE"),A.COMMAND_PATTERN=e.$command_pattern(),A}pe.getGameSystemClass=Me;var Lr=function(){function e(){}return e.prototype.getGameSystemIdByName=function(A){var o,t=(o=this.listAvailableGameSystems().find(function(r){return r.name===A}))===null||o===void 0?void 0:o.id;if(!t)throw new Error("GameSystem named "+A+" does not exists");return t},e.prototype.getGameSystemInfo=function(A){var o=this.listAvailableGameSystems().find(function(t){return t.id===A});if(!o)throw new Error("GameSystem is not found");return o},e.prototype.getGameSystemClass=function(A){var o=this.listLoadedGameSystems().find(function(t){return t.ID===A});if(!o)throw new Error("GameSystem "+A+" is not loaded");return o},e.prototype.getI18nInfos=function(A){var o=A.replace(/_[^0-9].*$/g,""),t=this.listAvailabletI18nInfoList().find(function(C){return C.baseClassName===o||C.baseClassName===A}),r=t?[t]:[],q=this.listAvailableGameSystems().find(function(C){return C.className===A});return q?Array.from(new Set(this.getI18nInfos(q.superClassName).concat(r))):r},e.prototype.listLoadedGameSystems=function(){var A,o,t;return(t=(o=(A=qe.BCDice.GameSystem)===null||A===void 0?void 0:A.$constants())===null||o===void 0?void 0:o.map(function(r){return Me(qe.BCDice.GameSystem[r])}))!==null&&t!==void 0?t:[]},e.prototype.listAvailableGameSystems=function(){return Kr.default.gameSystems},e.prototype.listAvailabletI18nInfoList=function(){return Fr.default.i18nList},e.prototype.dynamicLoad=function(A){var o;return Pr(this,void 0,void 0,function(){var t,r,q,C,I,h,v,z,T,U,J,W,S,F;return jr(this,function(B){switch(B.label){case 0:if(t=this.getGameSystemInfo(A),r=(o=t==null?void 0:t.className)!==null&&o!==void 0?o:A,!r.match(/^[A-Z]\w*$/))throw new Error("Invalid id");q=this.getI18nInfos(r),C=0,I=q,B.label=1;case 1:if(!(C<I.length))return[3,6];h=I[C],v=h.locales.filter(function(X){return X===t.locale||X===qe.I18n.$default_locale()}),z=0,T=v,B.label=2;case 2:return z<T.length?(U=T[z],S=(W=JSON).stringify,[4,this.dynamicImportI18n(h.baseClassName,U)]):[3,5];case 3:J=S.apply(W,[B.sent()]),qe.I18n.$load_translation(J),B.label=4;case 4:return z++,[3,2];case 5:return C++,[3,1];case 6:return[4,this.dynamicImport(r)];case 7:if(B.sent(),F=qe.BCDice.GameSystem.$const_get(r),!F)throw new Error("Failed to load game system");return[2,Me(F)]}})})},e.prototype.dynamicImportI18n=function(A,o){throw new Error("Not implemented")},e.prototype.dynamicImport=function(A){throw new Error("Not implemented")},e}();pe.default=Lr});var ur=de(he=>{"use strict";var Ur=he&&he.__extends||function(){var e=function(A,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var q in r)Object.prototype.hasOwnProperty.call(r,q)&&(t[q]=r[q])},e(A,o)};return function(A,o){e(A,o);function t(){this.constructor=A}A.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}}(),Gr=he&&he.__createBinding||(Object.create?function(e,A,o,t){t===void 0&&(t=o),Object.defineProperty(e,t,{enumerable:!0,get:function(){return A[o]}})}:function(e,A,o,t){t===void 0&&(t=o),e[t]=A[o]}),Hr=he&&he.__setModuleDefault||(Object.create?function(e,A){Object.defineProperty(e,"default",{enumerable:!0,value:A})}:function(e,A){e.default=A}),$r=he&&he.__importStar||function(e){if(e&&e.__esModule)return e;var A={};if(e!=null)for(var o in e)o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)&&Gr(A,e,o);return Hr(A,e),A},sr=he&&he.__awaiter||function(e,A,o,t){function r(q){return q instanceof o?q:new o(function(C){C(q)})}return new(o||(o=Promise))(function(q,C){function I(z){try{v(t.next(z))}catch(T){C(T)}}function h(z){try{v(t.throw(z))}catch(T){C(T)}}function v(z){z.done?q(z.value):r(z.value).then(I,h)}v((t=t.apply(e,A||[])).next())})},ar=he&&he.__generator||function(e,A){var o={label:0,sent:function(){if(q[0]&1)throw q[1];return q[1]},trys:[],ops:[]},t,r,q,C;return C={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function I(v){return function(z){return h([v,z])}}function h(v){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(q=v[0]&2?r.return:v[0]?r.throw||((q=r.return)&&q.call(r),0):r.next)&&!(q=q.call(r,v[1])).done)return q;switch(r=0,q&&(v=[v[0]&2,q.value]),v[0]){case 0:case 1:q=v;break;case 4:return o.label++,{value:v[1],done:!1};case 5:o.label++,r=v[1],v=[0];continue;case 7:v=o.ops.pop(),o.trys.pop();continue;default:if(q=o.trys,!(q=q.length>0&&q[q.length-1])&&(v[0]===6||v[0]===2)){o=0;continue}if(v[0]===3&&(!q||v[1]>q[0]&&v[1]<q[3])){o.label=v[1];break}if(v[0]===6&&o.label<q[1]){o.label=q[1],q=v;break}if(q&&o.label<q[2]){o.label=q[2],o.ops.push(v);break}q[2]&&o.ops.pop(),o.trys.pop();continue}v=A.call(e,o)}catch(z){v=[6,z],r=0}finally{t=q=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},Wr=he&&he.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(he,"__esModule",{value:!0});var Yr=Wr(Fe()),Xr=function(e){Ur(A,e);function A(){return e!==null&&e.apply(this,arguments)||this}return A.prototype.dynamicImportI18n=function(o,t){return sr(this,void 0,void 0,function(){return ar(this,function(r){switch(r.label){case 0:return[4,Promise.resolve().then(function(){return $r(ze("../../lib/bcdice/i18n/"+o+"."+t+".json"))})];case 1:return[2,r.sent().default]}})})},A.prototype.dynamicImport=function(o){return sr(this,void 0,void 0,function(){return ar(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return $r(ze("../../lib/bcdice/game_system/"+o))})];case 1:return t.sent(),[2]}})})},A}(Yr.default);he.default=Xr});var or=de(()=>{ke();Opal.queue(function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.def,I=e.hash2,h=e.truthy,v=e.send,z=e.to_a,T=e.rb_minus,U=e.eqeqeq,J=e.rb_plus,W=e.rb_times,S=e.neqeq,F=e.range;return function(B,X){var L=r(B,"BCDice"),w=[L].concat(X);return function(b,M,D){var G=q(b,M,"UserDefinedDiceTable"),R=[G].concat(D),f=e.$r(R),E=G.$$prototype;return E.rows=E.type=E.text=o,function(g,_){return C(g,"$roll",function(c){var s=this;return s.$new(c).$roll()},1)}(e.get_singleton_class(G),R),C(G,"$initialize",function(_){var u=this;return u.text=_,u.rows=o},1),C(G,"$roll",function(_){var u,c=this,s=o,i=o,n=o,$=o;if(_==null)_=I([],{});else if(!_.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return u=_.$$smap.randomizer,u==null&&(u=f("Randomizer").$new()),c.$parse(),s=c.$roll_index(u),!(h(c["$valid?"]())&&h(s))||(i=""+s+":",n=v(c.rows,"find",[],function(d){return d==null&&(d=o),d["$start_with?"](i)},1),!h(n))?o:($=n.$delete_prefix(i).$gsub("\\n",`
`).$strip(),v(f("Result").$new(),"tap",[],function l(d){var m=l.$$s==null?this:l.$$s,k=o;return m.name==null&&(m.name=o),d==null&&(d=o),k=[""+m.name+"("+s+") \uFF1E "+$],v(d,"text=",z(k)),k[T(k.length,1)],k=[u.$rand_results()],v(d,"rands=",z(k)),k[T(k.length,1)],k=[u.$detailed_rand_results()],v(d,"detailed_rands=",z(k)),k[T(k.length,1)]},{$$arity:1,$$s:c}))},-1),C(G,"$valid?",function(){var _=this,u=o,c=o,s=o;return _.$parse(),u=v(_.rows,"all?",[],function(n){return n==null&&(n=o),/^\d+:/["$match?"](n)},1),h(u)?(c=v(_.rows,"map",[],"to_i".$to_proc()).$uniq().$sort(),U(/^\d+D\d+$/,s=_.type)?_["$valid_d?"](c):U("D66",s)||U("D66N",s)?_["$valid_d66?"](c):U("D66A",s)||U("D66S",s)?_["$valid_d66_asc_sort?"](c):U("D66D",s)?_["$valid_d66_desc_sort?"](c):!1):!1},0),G.$private(),C(G,"$roll_index",function(_){var u=this,c=o,s=o,i=o,n=o;return h(c=/^(\d+)D(\d+)$/.$match(u.type))?(s=c["$[]"](1).$to_i(),i=c["$[]"](2).$to_i(),_.$roll_sum(s,i)):U("D66",n=u.type)||U("D66N",n)?_.$roll_d66(t(f("D66SortType"),"NO_SORT")):U("D66A",n)||U("D66S",n)?_.$roll_d66(t(f("D66SortType"),"ASC")):U("D66D",n)?_.$roll_d66(t(f("D66SortType"),"DESC")):o},1),C(G,"$parse",function(){var _=this,u=o;return h(_.rows)?o:(u=v(v(_.text.$split(/\r?\n/),"map",[],"rstrip".$to_proc()),"reject",[],"empty?".$to_proc()),_.name=u.$shift(),_.type=u.$shift().$upcase(),_.rows=u)},0),C(G,"$valid_d?",function(_){var u=this,c=o,s=o,i=o,n=o,$=o;return c=/^(\d+)D(\d+)$/.$match(u.type),s=c["$[]"](1).$to_i(),i=c["$[]"](2).$to_i(),n=J(T(W(s,i),s),1),S(_.$size(),n)?!1:h($=_.$first()["$=="](s))?_.$last()["$=="](W(s,i)):$},1),C(G,"$valid_d66?",function(_){var u=o;return S(_.$size(),36)?!1:(u=v(F(1,6,!1),"map",[],function(s){return s==null&&(s=o),v(F(1,6,!1),"map",[],function(n){return n==null&&(n=o),J(W(s,10),n)},1)},1).$flatten(),_["$=="](u))},1),C(G,"$valid_d66_asc_sort?",function(_){var u=o;return S(_.$size(),21)?!1:(u=v(F(1,6,!1),"map",[],function(s){return s==null&&(s=o),v(e.Range.$new(s,6,!1),"map",[],function(n){return n==null&&(n=o),J(W(s,10),n)},1)},1).$flatten(),_["$=="](u))},1),C(G,"$valid_d66_desc_sort?",function(_){var u=o;return S(_.$size(),21)?!1:(u=v(F(1,6,!1),"map",[],function(s){return s==null&&(s=o),v(e.Range.$new(s,6,!1),"map",[],function(n){return n==null&&(n=o),J(W(n,10),s)},1)},1).$flatten().$sort(),_["$=="](u))},1)}(w[0],null,w)}(A[0],A)})});var lr=de(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});or();var cr=xe(),Vr=Ce(),Zr=function(){function e(A,o){this.internal=o!=null?o:cr.BCDice.UserDefinedDiceTable.$new(A)}return e.prototype.roll=function(A){var o=this.internal.$roll(A&&cr.Opal.hash({randomizer:A}));return Vr.parseResult(o)},e.prototype.validate=function(){return this.internal["$valid?"]()},e}();Le.default=Zr});var _r=de(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});var Jr=xe(),Qr=Jr.BCDice.VERSION;Ue.default=Qr});var fr=de(be=>{"use strict";var Te=be&&be.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(be,"__esModule",{value:!0});be.Version=be.UserDefinedDiceTable=be.DynamicLoader=be.Base=void 0;var Or=Be();Object.defineProperty(be,"Base",{enumerable:!0,get:function(){return Te(Or).default}});var et=ur();Object.defineProperty(be,"DynamicLoader",{enumerable:!0,get:function(){return Te(et).default}});var rt=lr();Object.defineProperty(be,"UserDefinedDiceTable",{enumerable:!0,get:function(){return Te(rt).default}});var tt=_r();Object.defineProperty(be,"Version",{enumerable:!0,get:function(){return Te(tt).default}})});var pr=Ie(fr());var De=Ie(xe());var dr={ja_jp:{SwordWorld:{critical:"\u81EA\u52D5\u7684\u6210\u529F",fumble:"\u81EA\u52D5\u7684\u5931\u6557",keynumber_exceeds:"\u30AD\u30FC\u30CA\u30F3\u30D0\u30FC\u306F%{keyMax}\u307E\u3067\u3067\u3059",infinite_critical:"C\u5024\u3092%{min_critical}\u4EE5\u4E0A\u306B\u3057\u3066\u304F\u3060\u3055\u3044"}}};var hr={ja_jp:{SwordWorld2_0:{transcendent_critical_too_small:"(%{expression}) \uFF1E \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u304C\u5C0F\u3055\u3059\u304E\u307E\u3059\u30023\u4EE5\u4E0A\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",super_success:"\u8D85\u6210\u529F",GrowthTable:{name:"\u6210\u9577\u8868",type:"1D6",items:["\u5668\u7528\u5EA6","\u654F\u6377\u5EA6","\u7B4B\u529B","\u751F\u547D\u529B","\u77E5\u529B","\u7CBE\u795E\u529B"]},FumbleTable:{name:"\u9632\u5FA1\u30D5\u30A1\u30F3\u30D6\u30EB\u8868",type:"1D6",items:["\u3053\u306E\u8868\u30922\u56DE\u632F\u308A\u3001\u305D\u306E\u4E21\u65B9\u3092\u9069\u7528\u3059\u308B\u3002\uFF08\u540C\u3058\u51FA\u76EE\u306B\u3088\u308B\u5F71\u97FF\u306F\u7D2F\u7A4D\u3057\u306A\u3044\uFF09\u3002\u3053\u306E\u81EA\u52D5\u5931\u6557\u306B\u3088\u308A\u5F97\u3089\u308C\u308B\u7D4C\u9A13\u70B9\u306F\u3001+50\u70B9\u3055\u308C\u308B","\u30C0\u30E1\u30FC\u30B8\u306B\u3001\u653B\u6483\u8005\u3092\u5F37\u5316\u3057\u3066\u3044\u308B\u300C\u5263\u306E\u304B\u3051\u3089\u300D\u306E\u6570\u304C\u8FFD\u52A0\u3055\u308C\u308B","\u30C0\u30E1\u30FC\u30B8\u306B\u3001\u653B\u6483\u8005\u306E\u300C\u30EC\u30D9\u30EB\u300D\u304C\u8FFD\u52A0\u3055\u308C\u308B","\u30C0\u30E1\u30FC\u30B8\u6C7A\u5B9A\u30922\u56DE\u884C\u3044\u3001\u3088\u308A\u9AD8\u3044\u65B9\u3092\u63A1\u7528\u3059\u308B","\u5408\u7B97\u30C0\u30E1\u30FC\u30B8\u30922\u500D\u3059\u308B","\u9632\u8B77\u70B9\u7121\u52B9"]},TangleTable:{name:"\u7D61\u307F\u52B9\u679C\u8868",type:"1D6",items:["\u982D\u3084\u9854\uFF1A\u7259\u3084\u565B\u307F\u3064\u304D\u306A\u3069\u306B\u304A\u3051\u308B\u547D\u4E2D\u529B\u5224\u5B9A\u53CA\u3073\u3001\u9B54\u6CD5\u306E\u884C\u4F7F\u3084\u30D6\u30EC\u30B9\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B","\u6B66\u5668\u3084\u76FE\uFF1A\u6B66\u5668\u306E\u4F7F\u7528\u4E0D\u53EF\u3001\u53C8\u306F\u76FE\u306E\u56DE\u907F\u529B\u4FEE\u6B63\u53CA\u3073\u9632\u8B77\u70B9\u3092\u7121\u52B9\u5316\u3059\u308B","\u8155\u3084\u624B\uFF1A\u6B66\u5668\u3084\u722A\u306A\u3069\u306B\u304A\u3051\u308B\u547D\u4E2D\u529B\u5224\u5B9A\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3001\u76FE\u3092\u6301\u3064\u8155\u65B9\u306E\u8155\u306A\u3089\u305D\u306E\u76FE\u306E\u56DE\u907F\u529B\u4FEE\u6B63\u53CA\u3073\u9632\u8B77\u70B9\u3092\u7121\u52B9\u5316\u3059\u308B","\u811A\u3084\u8DB3\uFF1A\u79FB\u52D5\u4E0D\u53EF\u3001\u66F4\u306B\u56DE\u907F\u529B\u5224\u5B9A\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B \u203B\u4E21\u8DB3\u306B\u7D61\u3093\u3067\u3082\u7D2F\u7A4D\u3057\u306A\u3044","\u80F4\u4F53\uFF1A\u751F\u547D\u30FB\u7CBE\u795E\u62B5\u6297\u529B\u3092\u57FA\u6E96\u5024\u306B\u7528\u3044\u308B\u5224\u5B9A\u3092\u9664\u304D\u3001\u3042\u3089\u3086\u308B\u884C\u70BA\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B","\u7279\u6B8A\uFF1A\u5C3B\u5C3E\u3084\u7FFC\u306A\u3069\u306B\u547D\u4E2D\u3002\u7D61\u3081\u3089\u308C\u305F\u90E8\u4F4D\u3092\u4F7F\u7528\u3059\u308B\u5224\u5B9A\u306B\u304A\u3044\u3066-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3001\u307E\u305F\u306F\u305D\u3053\u304C\u4F7F\u3048\u3066\u3044\u305F\u3053\u3068\u306B\u3088\u308B\u30DC\u30FC\u30CA\u30B9\u4FEE\u6B63\u3092\u5931\u3046 \u203B\u5B58\u5728\u3057\u306A\u3044\u5834\u5408\u306F\u6C7A\u3081\u76F4\u3057"]}}}};var mr={ja_jp:{SwordWorld2_5:{AbyssCurseTable:{name:"\u30A2\u30D3\u30B9\u30AB\u30FC\u30B9\u8868",items:[["\u300C\u81EA\u50B7\u306E\u300D\u3000\u88C5\u5099\u6642\u3000\u3053\u306E\u6B66\u5177\u3092\u88C5\u5099\u4E2D\u306B\u88C5\u5099\u8005\u304C\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u3092\u767A\u751F\u3055\u305B\u305F\u6642\u3001\u88C5\u5099\u8005\u306EHP\u304C5\u70B9\u6E1B\u5C11\u3059\u308B\u3002","\u300C\u5606\u304D\u306E\u300D\u3000\u88C5\u5099\u6642\u3000\u8FD1\u304F\u306B\u6575\u304C\u3044\u305F\u308A\u3001\u9577\u3044\u7DCA\u5F35\u72B6\u614B\u304C\u7D9A\u304F\u3068\u6D99\u304C\u6B62\u307E\u3089\u306A\u304F\u306A\u308B\u3002\u6226\u95D8\u4E2D\u306A\u3089\u300C\u5C04\u7A0B\uFF1A\u8853\u8005\uFF08\u81EA\u8EAB\uFF09\u300D\u300C\u5C04\u7A0B\uFF1A\u63A5\u89E6\u300D\u4EE5\u5916\u306E\u52B9\u679C\u3067\u5BFE\u8C61\u3092\u9078\u3079\u306A\u304F\u306A\u308B\u3002","\u300C\u512A\u3057\u304D\u300D\u3000\u88C5\u5099\u6642\u3000\u6575\u306B\u540C\u60C5\u3057\u3066\u3057\u307E\u3046\u3002\u6575\u5BFE\u3059\u308B\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\u3092\u5BFE\u8C61\u306B\u3059\u308B\u5834\u5408\u3001\u5BFE\u8C61\u306EHP\u304C1\u70B9\u4EE5\u4E0A\u6E1B\u5C11\u3057\u3066\u3044\u308B\u306A\u3089\u547D\u4E2D\u529B\u5224\u5B9A\u3001\u9B54\u6CD5\u884C\u4F7F\u5224\u5B9A\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u5DEE\u5225\u306E\u300D\u3000\u88C5\u5099\u6642\u3000\u7279\u5B9A\u306E\u5206\u985E\u306B\u5BFE\u3057\u3066\u4E0E\u3048\u308B\u7269\u7406\u30C0\u30E1\u30FC\u30B8\u30FB\u9B54\u6CD5\u30C0\u30E1\u30FC\u30B8\u304C2\u70B9\u6E1B\u5C11\u3059\u308B\u3002\u5206\u985E\u306F\u300C\u5206\u985E\u6C7A\u5B9A\u8868\u300D\u3067\u7121\u4F5C\u70BA\u306B\u6C7A\u5B9A\u3059\u308B\u3002","\u300C\u8106\u5F31\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u9B54\u6CD5\u30C0\u30E1\u30FC\u30B8\u3092\u53D7\u3051\u308B\u305F\u3073\u3001\u305D\u306E\u30C0\u30E1\u30FC\u30B8\u304C+1\u70B9\u3055\u308C\u308B\u3002","\u300C\u7121\u8B00\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u9632\u8B77\u70B9\u304C2\u70B9\u6E1B\u5C11\u3059\u308B\uFF08\u6700\u4F4E0\uFF09\u3002"],["\u300C\u91CD\u3044\u300D\u3000\u88C5\u5099\u6642\u3000\u5F37\u5316\u3057\u305F\u6B66\u5177\u306E\u5FC5\u8981\u7B4B\u529B\u304C+2\u3055\u308C\u308B\u3002\u5A01\u529B\u3001\u9632\u8B77\u70B9\u306A\u3069\u306F\u5909\u5316\u306A\u3057\u3002","\u300C\u96E3\u3057\u3044\u300D\u3000\u88C5\u5099\u6642\u3000\u3044\u304B\u306A\u308B\u5A01\u529B\u8868\u4F7F\u7528\u6642\u3067\u3082\u3001\u2462\u2463\u6B04\u306E\u6570\u5024\u304C\u5A01\u529B\u306B\u95A2\u4FC2\u306A\u304F\u300C0\u300D\u306B\u306A\u308B\uFF08\u81EA\u52D5\u5931\u6557\u3067\u306F\u306A\u3044\uFF09\u3002","\u300C\u8EDF\u5F31\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u7CBE\u795E\u62B5\u6297\u529B\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u75C5\u5F31\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u751F\u547D\u62B5\u6297\u529B\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u904E\u654F\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u7279\u5B9A\u306E\u5C5E\u6027\u304B\u3089\u53D7\u3051\u308B\u7269\u7406\u30C0\u30E1\u30FC\u30B8\u3001\u9B54\u6CD5\u30C0\u30E1\u30FC\u30B8\u304C2\u70B9\u4E0A\u6607\u3059\u308B\u3002\u5C5E\u6027\u306F\u300C\u5C5E\u6027\u6C7A\u5B9A\u8868\u300D\u3067\u7121\u4F5C\u70BA\u306B\u6C7A\u5B9A\u3059\u308B\u3002","\u300C\u967D\u6C17\u306A\u300D\u3000\u88C5\u5099\u6642\u3000\u7CBE\u795E\u62B5\u6297\u5224\u5B9A\u306B\u5931\u6557\u3059\u308B\u305F\u3073\u3001\u7B11\u3044\u304C\u6B62\u307E\u3089\u306A\u304F\u306A\u308B\u3002\u6B21\u306E\u624B\u756A\u7D42\u4E86\u6642\u307E\u3067\u884C\u52D5\u5224\u5B9A\uFF08\u300E\u2160\u300F123\u9801\uFF09\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002\u3053\u306E\u52B9\u679C\u306F\u7D2F\u7A4D\u3059\u308B\u3002"],["\u300C\u305F\u3069\u305F\u3069\u3057\u3044\u300D\u3000\u88C5\u5099\u6642\u3000\u8A71\u3092\u3059\u308B\u6642\u306B\u8A00\u8449\u306B\u8A70\u307E\u3063\u305F\u308A\u3001\u8A00\u3044\u9593\u9055\u3048\u305F\u308A\u3057\u3084\u3059\u304F\u306A\u308B\u3002\u9B54\u6CD5\u884C\u4F7F\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u4EE3\u5F01\u3059\u308B\u300D\u3000\u88C5\u5099\u6642\u3000\u81EA\u8EAB\u306E\u4F1A\u8A71\u306F\u3001\u305D\u306E\u307E\u307E\u6B66\u5177\u304C\u9B54\u6CD5\u6587\u660E\u8A9E\u306E\u805E\u304D\u53D6\u308A\u3065\u3089\u3044\u58F0\u3067\u8A71\u3059\u3002\u88C5\u5099\u4E2D\u306F\u9B54\u6CD5\u6587\u660E\u8A9E\u4EE5\u5916\u306E\u8A00\u8A9E\u3067\u4F1A\u8A71\u306F\u884C\u3048\u305A\u3001\u5996\u7CBE\u9B54\u6CD5\u3001\u9B54\u52D5\u6A5F\u8853\u3092\u884C\u4F7F\u3067\u304D\u306A\u304F\u306A\u308B\u3002","\u300C\u65BD\u3057\u306F\u53D7\u3051\u306A\u3044\u300D\u3000\u88C5\u5099\u6642\u3000\u6226\u95D8\u4E2D\u3001\u300C\u62B5\u6297\uFF1A\u4EFB\u610F\u300D\u306E\u52B9\u679C\u3092\u53D7\u3051\u5165\u308C\u305F\u5834\u5408\u3001\u6B21\u306E\u624B\u756A\u7D42\u4E86\u6642\u307E\u3067\u751F\u547D\u62B5\u6297\u529B\u3001\u7CBE\u795E\u62B5\u6297\u529B\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u6B7B\u306B\u8FD1\u3044\u300D\u3000\u643A\u884C\u6642\u3000\u5E38\u306B\u751F\u6B7B\u5224\u5B9A\u306B\u300C\u5192\u967A\u8005\u30EC\u30D9\u30EB\u300D\u3068\u540C\u3058\u5024\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u304A\u3057\u3083\u308C\u306A\u300D\u3000\u643A\u884C\u6642\u3000\u305D\u306E\u6B66\u5177\u3092\u5E38\u306B\u83EF\u7F8E\u306B\u98FE\u308A\u305F\u304F\u306A\u308B\u3002\u53CE\u5165\u3092\u5F97\u308B\u305F\u3073\u3001\u305D\u306E1\u5272\u4EE5\u4E0A\u3092\u3053\u306E\u6B66\u5177\u306E\u88C5\u98FE\u306B\u8CBB\u3084\u3055\u306A\u3051\u308C\u3070\u306A\u3089\u306A\u3044\uFF08\u52B9\u679C\u306A\u3069\u306B\u5909\u5316\u306F\u306A\u3044\uFF09\u3002","\u300C\u30DE\u30CA\u3092\u5438\u3046\u300D\u3000\u643A\u884C\u6642\u3000\u9B54\u6CD5\u3084\u7DF4\u6280\u306A\u3069\u3001\u81EA\u8EAB\u306E\u610F\u601D\u3067MP\u3092\u6D88\u8CBB\u3059\u308B\u52B9\u679C\u3092\u4F7F\u7528\u3059\u308B\u5834\u5408\u3001\u3059\u3079\u3066\u306EMP\u6D88\u8CBB\u304C1\u70B9\u4E0A\u6607\u3059\u308B\u3002"],["\u300C\u920D\u91CD\u306A\u300D\u3000\u643A\u884C\u6642\u3000\u79FB\u52D5\u529B\u304C\u534A\u5206\uFF08\u7AEF\u6570\u5207\u308A\u4E0A\u3052\uFF09\u306B\u306A\u308B\u3002","\u300C\u5B9A\u307E\u3089\u306A\u3044\u300D\u3000\u643A\u884C\u6642\u3000\u6226\u95D8\u4E2D\u306E\u624B\u756A\u958B\u59CB\u6642\u306B1d\u3057\u3001\u51FA\u76EE\u304C\u300C1\u300D\u306A\u3089\u300A\u30BF\u30FC\u30B2\u30C3\u30C6\u30A3\u30F3\u30B0\u300B\u3068\u305D\u308C\u3092\u524D\u63D0\u3068\u3057\u305F\u6226\u95D8\u7279\u6280\u3092\u7FD2\u5F97\u3057\u3066\u3044\u306A\u3044\u3082\u306E\u3068\u3057\u3066\u6271\u3046\u3002","\u300C\u932F\u4E71\u306E\u300D\u3000\u643A\u884C\u6642\u3000\u6226\u95D8\u4E2D\u306E\u624B\u756A\u958B\u59CB\u6642\u306B1d\u3057\u3001\u51FA\u76EE\u304C\u300C1\u300D\u306A\u3089\u8FD1\u63A5\u653B\u6483\u3092\u542B\u3080\u300C\u5C04\u7A0B\uFF1A\u63A5\u89E6\u300D\u306E\u5BFE\u8C61\u306B\u52B9\u679C\u3092\u4F7F\u7528\u3059\u308B\u969B\u3001\u5BFE\u8C61\u306F\u540C\u3058\u4F4D\u7F6E\uFF08\u30A8\u30EA\u30A2\u3001\u5EA7\u6A19\uFF09\u306E\u5168\u3066\u306E\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\uFF08\u6575\u5473\u65B9\u542B\u3080\uFF09\u304B\u3089\u7121\u4F5C\u70BA\u306B\u9078\u3070\u308C\u308B\u3002","\u300C\u8DB3\u7D61\u307F\u306E\u300D\u3000\u643A\u884C\u6642\u3000\u6226\u95D8\u4E2D\u306E\u624B\u756A\u958B\u59CB\u6642\u306B1d\u3057\u3001\u51FA\u76EE\u304C\u300C1\u300D\u306A\u3089\u305D\u306E\u5834\u3067\u5373\u5EA7\u306B\u8EE2\u5012\u3059\u308B\u3002\u624B\u756A\u4E2D\u306B\u306F\u8D77\u304D\u4E0A\u304C\u308C\u306A\u3044\u3002","\u300C\u6ED1\u308A\u843D\u3061\u308B\u300D\u3000\u643A\u884C\u6642\u3000\u6226\u95D8\u4E2D\u306E\u624B\u756A\u958B\u59CB\u6642\u306B1d\u3057\u3001\u51FA\u76EE\u304C\u300C1\u300D\u306A\u3089\u624B\u306B\u88C5\u5099\u307E\u305F\u306F\u4FDD\u6301\u3057\u3066\u3044\u308B\u3082\u306E\u3092\u3059\u3079\u3066\u305D\u306E\u5834\u306B\u843D\u3068\u3059\uFF08\u305D\u306E\u624B\u756A\u306E\u4E3B\u52D5\u4F5C\u3067\u62FE\u3046\u4E8B\u306F\u53EF\u80FD\uFF09\u3002","\u300C\u60AA\u81ED\u653E\u3064\u300D\u3000\u643A\u884C\u6642\u3000\u5F37\u3044\u60AA\u81ED\u3092\u653E\u3064\u3002\u6240\u6301\u3057\u3066\u3044\u308B\u3060\u3051\u3067\u4ED6\u306E\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\u306B\u4E0D\u5FEB\u611F\u3092\u4E0E\u3048\u3001\u96A0\u5BC6\u5224\u5B9A\u306B-2\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002\u3055\u3089\u306B\u5192\u967A\u8005\u30E9\u30F3\u30AF\uFF08\u300E\u2161\u300F137\u9801\uFF09\u304C1\u6BB5\u968E\u4F4E\u3044\u3082\u306E\u3068\u3057\u3066\u6271\u308F\u308C\u308B\u3002"],["\u300C\u919C\u60AA\u306A\u300D\u3000\u643A\u884C\u6642\u3000\u6B66\u5177\u306E\u898B\u305F\u76EE\u304C\u60AA\u304F\u3001\u9B45\u529B\u304C\u306A\u3044\u3002\u58F2\u5374\u3059\u308B\u969B\u3001\u57FA\u672C\u53D6\u5F15\u4FA1\u683C\u306E4\u5206\u306E1\u306E\u4FA1\u683C\u3067\u58F2\u5374\u3059\u308B\u3002\u3055\u3089\u306B\u5192\u967A\u8005\u30E9\u30F3\u30AF\uFF08\u300E\u2161\u300F137\u9801\uFF09\u304C1\u6BB5\u968E\u4F4E\u3044\u3082\u306E\u3068\u3057\u3066\u6271\u308F\u308C\u308B\u3002","\u300C\u5538\u308B\u300D\u3000\u643A\u884C\u6642\u3000\u305D\u306E\u6B66\u5177\u304B\u3089\u5E38\u306B\u7FBD\u866B\u304C\u98DB\u3073\u4EA4\u3046\u3088\u3046\u306A\u97F3\u304C\u97FF\u304F\u3002\u96A0\u5BC6\u5224\u5B9A\u3001\u5371\u967A\u611F\u77E5\u5224\u5B9A\u306B-4\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u3075\u3084\u3051\u305F\u300D\u3000\u643A\u884C\u6642\u3000\u6C34\u3092\u5438\u3063\u305F\u3088\u3046\u306B\u3075\u3084\u3051\u305F\u8CEA\u611F\u3092\u3057\u3066\u3044\u308B\u3002\u8FFD\u52A0\u30C0\u30E1\u30FC\u30B8-1\uFF08\u6B66\u5668\uFF09\u3001\u9632\u8B77\u70B9-1\uFF08\u93A7\u3001\u76FE\uFF09\u3002\u75C5\u6C17\u5C5E\u6027\u306E\u52B9\u679C\u306B\u5BFE\u3059\u308B\u751F\u547D\u62B5\u6297\u529B\u3001\u7CBE\u795E\u62B5\u6297\u529B\u5224\u5B9A\u306B-4\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u53E4\u50B7\u306E\u300D\u3000\u643A\u884C\u6642\u3000HP\u3092\u56DE\u5FA9\u3059\u308B\u52B9\u679C\uFF08\u4F11\u606F\u306B\u3088\u308B\u56DE\u5FA9\u3092\u542B\u3080\uFF09\u3092\u53D7\u3051\u305F\u5834\u5408\u3001\u305D\u306E\u56DE\u5FA9\u91CF\u304C1\u70B9\u6E1B\u5C11\u3059\u308B\u3002","\u300C\u307E\u3070\u3086\u3044\u300D\u3000\u643A\u884C\u6642\u3000\u5149\u306A\u3069\u3092\u5F3E\u3044\u3066\u5F37\u304F\u8F1D\u304F\u3002\u81EA\u8EAB\u306F\u5E38\u306B\u8996\u754C\u304C\u60AA\u3044\u4E8B\u306B\u3088\u308B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u6804\u5149\u306A\u304D\u300D\u3000\u643A\u884C\u6642\u3000\u884C\u70BA\u5224\u5B9A\u3067\u81EA\u52D5\u6210\u529F\u3057\u305F\u969B\u3001\u81EA\u52D5\u6210\u529F\u3068\u306F\u6271\u308F\u305A\u30012d\u3092\u632F\u308A\u76F4\u3057\u3001\u305D\u306E\u5F8C\u306E\u51FA\u76EE\u306B\u5F93\u3046\u3002\u3053\u306E\u52B9\u679C\u306F1\u65E5\u306B1\u56DE\u306E\u307F\u767A\u63EE\u3055\u308C\u308B\u3002"],["\u300C\u6B63\u76F4\u8005\u306E\u300D\u3000\u643A\u884C\u6642\u3000\u5618\u3001\u65B9\u4FBF\u304C\u3059\u3050\u3070\u308C\u308B\u3088\u3046\u306B\u306A\u308B\u3002\u771F\u507D\u5224\u5B9A\u306E\u5BFE\u8C61\u3068\u306A\u308B\u5834\u5408\u3001-4\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u4E57\u308A\u7269\u9154\u3044\u306E\u300D\u3000\u643A\u884C\u6642\u3000\u63FA\u308C\u306B\u5F31\u304F\u306A\u308B\u3002\u81EA\u8EAB\u306E\u8DB3\u4EE5\u5916\u306E\u624B\u6BB5\u306710\u5206\u4EE5\u4E0A\u79FB\u52D5\u3057\u305F\u5F8C\u30011\u6642\u9593\u3001\u884C\u52D5\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u78A7\u3092\u53AD\u3046\u300D\u3000\u643A\u884C\u6642\u3000\u81EA\u7136\u306E\u4E2D\u3067\u306F\u843D\u3061\u7740\u304B\u306A\u304F\u306A\u308B\u3002\u81EA\u7136\u74B0\u5883\uFF08\u300E\u2160\u300F108\u9801\uFF09\u3067\u306F\u884C\u52D5\u5224\u5B9A\u306B-1\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u6211\u6162\u3067\u304D\u306A\u3044\u300D\u3000\u643A\u884C\u6642\u3000\u30BB\u30C3\u30B7\u30E7\u30F3\u4E2D\u306B1\u65E5\u306E\u59CB\u307E\u308A\u3092\u8FCE\u3048\u308B\u305F\u3073\u3001\u8DA3\u5473\u3084\u55DC\u597D\u54C1\u306A\u3069\u306B\u300C\u5192\u967A\u8005\u30EC\u30D9\u30EB\xD710\u300D\u30AC\u30E1\u30EB\u3092\u51FA\u8CBB\u3057\u306A\u3051\u308C\u3070\u306A\u3089\u306A\u3044\u3002\u8DA3\u5473\u3084\u55DC\u597D\u54C1\u304C\u6D88\u8CBB\u3067\u304D\u306A\u3044\u74B0\u5883\u3067\u3042\u308C\u3070\u3001\u7FCC\u65E5\u306E\u671D\u307E\u3067\u6700\u5927HP\u3001\u6700\u5927MP\u304C\u300C\u5192\u967A\u8005\u30EC\u30D9\u30EB\u300D\u70B9\u6E1B\u5C11\u3059\u308B\u3002","\u300C\u3064\u304D\u307E\u3068\u3046\u300D\u3000\u643A\u884C\u6642\u3000\u3053\u306E\u6B66\u5177\u304C\u6C17\u304C\u3064\u3051\u3070\u8EAB\u306E\u56DE\u308A\u306B\u3042\u308B\u3002\u3053\u306E\u6B66\u5177\u4EE5\u5916\u3067\u306E\u547D\u4E2D\u529B\u5224\u5B9A\u3001\u9B54\u6CD5\u884C\u4F7F\u5224\u5B9A\uFF08\u6B66\u5668\uFF09\u3001\u56DE\u907F\u529B\u5224\u5B9A\uFF08\u93A7\u3001\u76FE\uFF09\u306B-4\u306E\u30DA\u30CA\u30EB\u30C6\u30A3\u4FEE\u6B63\u3092\u53D7\u3051\u308B\u3002","\u300C\u306E\u308D\u307E\u306A\u300D\u3000\u643A\u884C\u6642\u3000\u6226\u95D8\u958B\u59CB\u51E6\u7406\u306E\u300C\u6226\u95D8\u6E96\u5099\u300D\u3092\u3044\u3063\u3055\u3044\u884C\u3048\u306A\u304F\u306A\u308B\u3002"]]},AbyssCurseCategoryTable:{name:"\u30A2\u30D3\u30B9\u30AB\u30FC\u30B9\u5206\u985E\u6C7A\u5B9A\u8868",odd:["\u86EE\u65CF","\u52D5\u7269","\u690D\u7269","\u30A2\u30F3\u30C7\u30C3\u30C9","\u9B54\u6CD5\u751F\u7269","\u300C\u86EE\u65CF\u300D\u300C\u52D5\u7269\u300D\u300C\u690D\u7269\u300D\u300C\u30A2\u30F3\u30C7\u30C3\u30C9\u300D\u300C\u9B54\u6CD5\u751F\u7269\u300D\u304B\u3089\u4EFB\u610F"],even:["\u9B54\u52D5\u6A5F","\u5E7B\u7363","\u5996\u7CBE","\u9B54\u795E","\u4EBA\u65CF","\u300C\u9B54\u52D5\u6A5F\u300D\u300C\u5E7B\u7363\u300D\u300C\u5996\u7CBE\u300D\u300C\u9B54\u795E\u300D\u300C\u4EBA\u65CF\u300D\u304B\u3089\u4EFB\u610F"]},AbyssCurseAttrTable:{name:"\u30A2\u30D3\u30B9\u30AB\u30FC\u30B9\u5C5E\u6027\u6C7A\u5B9A\u8868",odd:["\u571F","\u6C34\u30FB\u6C37","\u708E","\u98A8","\u96F7","\u7D14\u7C8B\u30A8\u30CD\u30EB\u30AE\u30FC"],even:["\u65AD\u7A7A","\u885D\u6483","\u6BD2","\u75C5\u6C17","\u546A\u3044","\u7CBE\u795E\u52B9\u679C"]}}}};De.I18n.$load_translation(JSON.stringify(dr));De.I18n.$load_translation(JSON.stringify(hr));De.I18n.$load_translation(JSON.stringify(mr));ke();Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.hash2,C=e.truthy,I=e.def;return function(h,v){var z=r(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=r(U,"ArithmeticEvaluator"),S=[W].concat(J);return function(F,B){var X=[F].concat(B),L=e.$r(X);return I(F,"$eval",function(b,M){var D,G=o;if(M==null)M=q([],{});else if(!M.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return D=M.$$smap.round_type,D==null&&(D=t(L("RoundType"),"FLOOR")),C(b)&&C(G=L("Arithmetic").$eval(b,D))?G:0},-2)}(e.get_singleton_class(W),S)}(T[0],T)}(A[0],A)};Opal.modules["i18n/backend/fallbacks"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.class_variable_set,C=e.truthy,I=e.class_variable_get,h=e.def,v=e.send,z=e.to_a,T=e.rb_minus,U=e.send2,J=e.find_super,W=e.hash2,S=e.find_block_super,F=e.neqeq;return function(B,X){var L=r(B,"I18n"),w=[L].concat(X);return q(w[0],"@@fallbacks",o),function(b,M){var D=[b].concat(M),G=e.$r(D);return h(b,"$fallbacks",function(){var f,E=o;return q(D[1],"@@fallbacks",C((f=D[1].$$cvars["@@fallbacks"],f!=null?"class variable":o))&&C(E=I(D[1],"@@fallbacks",!1))?E:t(t(G("I18n"),"Locale"),"Fallbacks").$new()),C(E=G("Thread").$current()["$[]"]("i18n_fallbacks"))?E:I(D[1],"@@fallbacks",!1)},0),h(b,"$fallbacks=",function(f){var E=o;return q(D[1],"@@fallbacks",C(f["$is_a?"](G("Array")))?t(t(G("I18n"),"Locale"),"Fallbacks").$new(f):f),E=["i18n_fallbacks",I(D[1],"@@fallbacks",!1)],v(G("Thread").$current(),"[]=",z(E)),E[T(E.length,1)]},1)}(e.get_singleton_class(L),w),function(b,M){var D=r(b,"Backend"),G=[D].concat(M);return function(R,f){var E=r(R,"Fallbacks"),g=[E].concat(f),_=e.$r(g);return h(E,"$translate",function u(c,s,i){try{var n=u.$$p||o,$=this,l=o,d=o;return delete u.$$p,i==null&&(i=_("EMPTY_HASH")),C(i.$fetch("fallback",!0))?C(i["$[]"]("fallback_in_progress"))?U($,J($,"translate",u,!1,!0),"translate",[c,s,i],n):(C(i["$[]"]("default"))&&(l=$["$extract_non_symbol_default!"](i)),d=i.$merge(W(["fallback_in_progress"],{fallback_in_progress:!0})),v(_("I18n").$fallbacks()["$[]"](c),"each",[],function m(k){var x=m.$$s==null?this:m.$$s;k==null&&(k=o);try{return v(x,"catch",["exception"],function Y(){var a=Y.$$s==null?this:Y.$$s,N=o;if(N=U(a,S(a,"translate",Y.$$def||m.$$def||u,!1,!1),"translate",[k,s,d],null),C(N["$nil?"]()))return o;F(c.$to_s(),k.$to_s())&&a.$on_fallback(c,k,s,i),e.ret(N)},{$$arity:0,$$s:x})}catch(Y){if(e.rescue(Y,[t(_("I18n"),"InvalidLocale")]))try{return o}finally{e.pop_exception()}else throw Y}},{$$arity:1,$$s:$}),C(i["$key?"]("default"))&&C(i["$[]"]("default")["$nil?"]())?o:C(l)?U($,J($,"translate",u,!1,!0),"translate",[c,o,i.$merge(W(["default"],{default:l}))],null):$.$throw("exception",t(_("I18n"),"MissingTranslation").$new(c,s,i))):U($,J($,"translate",u,!1,!0),"translate",[c,s,i],n)}catch(m){if(m===e.returner)return m.$v;throw m}},-3),h(E,"$extract_non_symbol_default!",function(c){var s=o,i=o,n=o;return s=[c["$[]"]("default")].$flatten(),i=v(s,"detect",[],function(l){return l==null&&(l=o),l["$is_a?"](_("Symbol"))["$!"]()},1),C(i)&&(n=["default",s["$[]"](0,s.$index(i))],v(c,"[]=",z(n)),n[T(n.length,1)]),i},1),h(E,"$exists?",function u(c,s,i){try{var n=u.$$p||o,$=this;return delete u.$$p,i==null&&(i=_("EMPTY_HASH")),C(i.$fetch("fallback",!0))?(v(_("I18n").$fallbacks()["$[]"](c),"each",[],function l(d){var m=l.$$s==null?this:l.$$s;d==null&&(d=o);try{if(C(U(m,S(m,"exists?",l.$$def||u,!1,!1),"exists?",[d,s],null)))e.ret(!0);else return o}catch(k){if(e.rescue(k,[t(_("I18n"),"InvalidLocale")]))try{return o}finally{e.pop_exception()}else throw k}},{$$arity:1,$$s:$}),!1):U($,J($,"exists?",u,!1,!0),"exists?",[c,s,i],n)}catch(l){if(l===e.returner)return l.$v;throw l}},-3),E.$private(),h(E,"$on_fallback",function(c,s,i,n){return o},4)}(G[0],G)}(w[0],w)}(A[0],A)};Opal.modules["bcdice/randomizer"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.const_set,I=e.def,h=e.truthy,v=e.rb_gt,z=e.rb_plus,T=e.rb_le,U=e.send,J=e.rb_minus,W=e.eqeq,S=e.rb_times,F=e.eqeqeq,B=e.rb_ge;return function(X,L){var w=r(X,"BCDice"),b=[w].concat(L),M=e.$r(b);return function(D,G,R){var f=q(D,G,"Randomizer"),E=[f].concat(R),g=e.$r(E),_=f.$$prototype;return _.rand_results=_.detailed_rand_results=o,C(E[0],"UPPER_LIMIT_DICE_TIMES",200),C(E[0],"UPPER_LIMIT_DICE_SIDES",1e4),C(E[0],"UPPER_LIMIT_RANDS",1e4),I(f,"$initialize",function(){var c=this;return c.rand_results=[],c.detailed_rand_results=[]},0),f.$attr_reader("rand_results"),f.$attr_reader("detailed_rand_results"),C(E[0],"DetailedRandResult",g("Struct").$new("kind","sides","value")),I(f,"$roll_barabara",function(c,s){var i=this;return h(v(z(i.rand_results.$size(),c),g("UPPER_LIMIT_RANDS")))&&i.$raise(g("TooManyRandsError")),h(T(c,0))||h(v(c,g("UPPER_LIMIT_DICE_TIMES")))?[]:U(g("Array"),"new",[c],function n(){var $=n.$$s==null?this:n.$$s;return $.$roll_once(s)},{$$arity:0,$$s:i})},2),I(f,"$roll_sum",function(c,s){var i=this;return i.$roll_barabara(c,s).$sum()},2),I(f,"$roll_once",function(c){var s=this,i=o;return h(T(c,0))||h(v(c,g("UPPER_LIMIT_DICE_SIDES")))?0:(i=s.$rand_inner(c),s.$push_to_detail("normal",c,i),i)},1),I(f,"$roll_index",function(c){var s=this;return J(s.$roll_once(c),1)},1),I(f,"$roll_tens_d10",function(){var c=this,s=o,i=o;return s=c.$rand_inner(10),W(s,10)&&(s=0),i=S(s,10),c.$push_to_detail("tens_d10",10,i),i},0),I(f,"$roll_d9",function(){var c=this,s=o;return s=J(c.$rand_inner(10),1),c.$push_to_detail("d9",10,s),s},0),I(f,"$roll_d66",function(c){var s=this,i=o,n=o;return i=U(g("Array"),"new",[2],function $(){var l=$.$$s==null?this:$.$$s;return l.$roll_once(6)},{$$arity:0,$$s:s}),F(t(g("D66SortType"),"ASC"),n=c)?i["$sort!"]():F(t(g("D66SortType"),"DESC"),n)&&i["$sort!"]()["$reverse!"](),z(S(i["$[]"](0),10),i["$[]"](1))},1),f.$private(),I(f,"$rand_inner",function(c){var s=this,i=o;return h(B(s.rand_results.$size(),g("UPPER_LIMIT_RANDS")))&&s.$raise(g("TooManyRandsError")),i=s.$random(c),s.rand_results["$<<"]([i,c]),i},1),I(f,"$random",function(c){return z(g("Kernel").$rand(c),1)},1),I(f,"$push_to_detail",function(c,s,i){var n=this,$=o;return $=g("DetailedRandResult").$new(c,s,i),n.detailed_rand_results.$push($)},3)}(b[0],null,b),q(b[0],M("StandardError"),"TooManyRandsError"),o}(A[0],A)};Opal.modules["bcdice/dice_table/roll_result"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.truthy;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"DiceTable"),W=[J].concat(U);return function(S,F,B){var X=r(S,F,"RollResult"),L=[X].concat(B),w=e.$r(L),b=X.$$prototype;return b.table_name=b.value=b.body=o,q(X,"$initialize",function(D,G,R){var f=this;return f.table_name=D,f.value=G,f.body=R},3),X.$attr_reader("table_name"),X.$attr_reader("value"),X.$attr_reader("body"),q(X,"$to_s",function(){var D=this;return""+D.table_name+"("+D.value+") \uFF1E "+D.body},0),q(X,"$last_body",function(){var D=this;return C(D.body["$is_a?"](w("RollResult")))?D.body.$last_body():D.body},0),q(X,"$empty?",function(){return!1},0)}(W[0],null,W)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/dice_table/chain_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.truthy,C=e.def,I=e.rb_minus;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"DiceTable"),S=[W].concat(J);return function(F,B,X){var L=r(F,B,"ChainTable"),w=[L].concat(X),b=e.$r(w),M=L.$$prototype;return M.times=M.sides=M.items=M.name=o,C(L,"$initialize",function(G,R,f){var E=this,g=o;return E.name=G,E.items=f.$freeze(),g=/(\d+)D(\d+)/i.$match(R),q(g)||E.$raise(b("ArgumentError"),"Unexpected table type: "+R),E.times=g["$[]"](1).$to_i(),E.sides=g["$[]"](2).$to_i()},3),C(L,"$roll",function(G){var R=this,f=o,E=o,g=o;return f=G.$roll_sum(R.times,R.sides),E=I(f,R.times),g=R.items["$[]"](E),q(g["$respond_to?"]("roll"))&&(g=g.$roll(G)),b("RollResult").$new(R.name,f,g)},1)}(S[0],null,S)}(T[0],T)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.def,h=e.rb_plus,v=e.rb_times,z=e.rb_minus;return function(T,U){var J=t(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=t(S,"DiceTable"),X=[B].concat(F);return function(L,w,b){var M=r(L,w,"D66GridTable"),D=[M].concat(b),G=e.$r(D),R=M.$$prototype;return R.name=R.items=o,C(M,"$from_i18n",function(E,g){var _=this,u=o;return u=G("I18n").$t(E,q(["locale","raise"],{locale:g,raise:!0})),_.$new(u["$[]"]("name"),u["$[]"]("items"))},2),I(M,"$initialize",function(E,g){var _=this;return _.name=E,_.items=g.$freeze()},2),I(M,"$roll",function(E){var g=this,_=o,u=o,c=o,s=o,i=o;return _=E.$roll_once(6),u=E.$roll_once(6),c=h(v(_,10),u),s=z(_,1),i=z(u,1),G("RollResult").$new(g.name,c,g.items["$[]"](s)["$[]"](i))},1)}(X[0],null,X)}(W[0],W)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def;return A.$require("bcdice/dice_table/d66_grid_table"),function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W),B=e.$r(F);return function(X,L,w){var b=q(X,L,"D66HalfGridTable"),M=[b].concat(w),D=e.$r(M);return I(b,"$from_i18n",function(R,f){var E=this,g=t;return g=D("I18n").$t(R,C(["locale","raise"],{locale:f,raise:!0})),E.$new(g["$[]"]("name"),g["$[]"]("items_1_2_3"),g["$[]"]("items_4_5_6"))},2),h(b,"$initialize",function(R,f,E){var g=this;return g.name=R,g.items=[f,f,f,E,E,E].$freeze()},3)}(F[0],B("D66GridTable"),F)}(U[0],U)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def;return A.$require("bcdice/dice_table/d66_grid_table"),function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W),B=e.$r(F);return function(X,L,w){var b=q(X,L,"D66OneThirdTable"),M=[b].concat(w),D=e.$r(M);return I(b,"$from_i18n",function(R,f){var E=this,g=t;return g=D("I18n").$t(R,C(["locale","raise"],{locale:f,raise:!0})),E.$new(g["$[]"]("name"),g["$[]"]("items_1_2"),g["$[]"]("items_3_4"),g["$[]"]("items_5_6"))},2),h(b,"$initialize",function(R,f,E,g){var _=this;return _.name=R,_.items=[f,f,E,E,g,g].$freeze()},4)}(F[0],B("D66GridTable"),F)}(U[0],U)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_table"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.hash2,I=e.defs,h=e.def,v=e.eqeqeq,z=e.rb_plus,T=e.rb_times,U=e.truthy;return function(J,W){var S=r(J,"BCDice"),F=[S].concat(W);return function(B,X){var L=r(B,"DiceTable"),w=[L].concat(X);return function(b,M,D){var G=q(b,M,"D66Table"),R=[G].concat(D),f=e.$r(R),E=G.$$prototype;return E.sort_type=E.items=E.name=o,I(G,"$from_i18n",function(_,u){var c=this,s=o,i=o;return s=f("I18n").$t(_,C(["locale"],{locale:u})),i=f("D66SortType").$const_get(s["$[]"]("d66_sort_type")),c.$new(s["$[]"]("name"),i,s["$[]"]("items"))},2),h(G,"$initialize",function(_,u,c){var s=this;return s.name=_,s.sort_type=u,s.items=c.$freeze()},3),h(G,"$roll",function(_){var u=this,c=o,s=o,i=o,n=o;return c=_.$roll_barabara(2,6),v(t(f("D66SortType"),"ASC"),s=u.sort_type)?c["$sort!"]():v(t(f("D66SortType"),"DESC"),s)&&c["$sort!"]()["$reverse!"](),i=z(T(c["$[]"](0),10),c["$[]"](1)),n=U(s=u.items["$[]"](i))?s:u.items["$[]"](i.$to_s()),U(n["$respond_to?"]("roll"))&&(n=n.$roll(_)),f("RollResult").$new(u.name,i,n)},1),h(G,"$choice",function(_){var u=this;return f("RollResult").$new(u.name,_,u.items["$[]"](_))},1)}(w[0],null,w)}(F[0],F)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.hash2,I=e.send,h=e.to_ary,v=e.rb_plus,z=e.rb_times,T=e.to_a,U=e.rb_minus,J=e.send2,W=e.find_super,S=e.def;return A.$require("bcdice/dice_table/d66_table"),function(F,B){var X=r(F,"BCDice"),L=[X].concat(B);return function(w,b){var M=r(w,"DiceTable"),D=[M].concat(b),G=e.$r(D);return function(R,f){var E=q(R,f,"D66LeftRangeTable");return S(E,"$initialize",function g(_,u,c){var s=g.$$p||t,i=this,n=t;return delete g.$$p,n=C([],{}),I(c,"each",[],function(l){var d,m,k=t,x=t;return l==null&&(l=t),m=l,d=h(m),k=d[0]==null?t:d[0],x=d[1]==null?t:d[1],I(k,"each",[],function(a){return a==null&&(a=t),I(x,"each_with_index",[],function(p,H){var Q=t,ee=t;return p==null&&(p=t),H==null&&(H=t),Q=v(z(a,10),v(H,1)),ee=[Q,p],I(n,"[]=",T(ee)),ee[U(ee.length,1)]},2)},1)},1),J(i,W(i,"initialize",g,!1,!0),"initialize",[_,u,n],null)},3)}(D[0],G("D66Table"))}(L[0],L)}(o[0],o)};Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.def,h=e.truthy,v=e.rb_minus,z=e.rb_plus,T=e.rb_times;return function(U,J){var W=t(U,"BCDice"),S=[W].concat(J);return function(F,B){var X=t(F,"DiceTable"),L=[X].concat(B);return function(w,b,M){var D=r(w,b,"D66ParityTable"),G=[D].concat(M),R=e.$r(G),f=D.$$prototype;return f.odd=f.even=f.name=o,C(D,"$from_i18n",function(g,_){var u=this,c=o;return c=R("I18n").$t(g,q(["locale","raise"],{locale:_,raise:!0})),u.$new(c["$[]"]("name"),c["$[]"]("odd"),c["$[]"]("even"))},2),I(D,"$initialize",function(g,_,u){var c=this;return c.name=g,c.odd=_.$freeze(),c.even=u.$freeze()},3),I(D,"$roll",function(g){var _=this,u=o,c=o,s=o,i=o,n=o;return u=g.$roll_once(6),c=g.$roll_once(6),h(u["$odd?"]())?s=_.odd:s=_.even,i=s["$[]"](v(c,1)),n=z(T(u,10),c),R("RollResult").$new(_.name,n,i)},1)}(L[0],null,L)}(S[0],S)}(A[0],A)};Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.rb_plus,I=e.rb_times,h=e.send;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=t(J,"DiceTable"),F=[S].concat(W);return function(B,X,L){var w=r(B,X,"D66RangeTable"),b=[w].concat(L),M=e.$r(b),D=w.$$prototype;return D.items=D.name=o,q(w,"$initialize",function(R,f){var E=this;return E.name=R,E.items=f.$freeze()},2),q(w,"$roll",function(R){var f=this,E=o,g=o,_=o,u=o;return E=R.$roll_once(6),g=R.$roll_once(6),_=C(I(E,10),g),u=h(f.items,"find",[],function(s){return s==null&&(s=o),s["$[]"](0)["$include?"](_)},1),M("RollResult").$new(f.name,_,u["$[]"](1))},1)}(F[0],null,F)}(U[0],U)}(A[0],A)};Opal.modules["bcdice/dice_table/range_table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.const_set,C=e.send,I=e.truthy,h=e.def,v=e.to_a,z=e.rb_minus,T=e.eqeqeq,U=e.rb_times,J=e.rb_plus;return function(W,S){var F=t(W,"BCDice"),B=[F].concat(S);return function(X,L){var w=t(X,"DiceTable"),b=[w].concat(L);return function(M,D,G){var R=r(M,D,"RangeTable"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.name=g.items=g.num_of_dice=g.num_of_sides=g.formatter=o,q(f[0],"RollResult",C(E("Struct"),"new",["sum","values","content","formatted"],function _(){var u=_.$$s==null?this:_.$$s;return u.$alias_method("to_s","formatted")},{$$arity:0,$$s:R})),q(f[0],"Item",E("Struct").$new("range","content")),q(f[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),q(f[0],"DEFAULT_FORMATTER",C(R,"lambda",[],function(u,c){return u==null&&(u=o),c==null&&(c=o),""+u.$name()+"("+c.$sum()+") \uFF1E "+c.$content()},2)),R.$attr_reader("name"),R.$attr_reader("num_of_dice"),R.$attr_reader("num_of_sides"),h(R,"$initialize",function _(u,c,s){var i=_.$$p||o,n=this,$=o,l=o;return delete _.$$p,n.name=u.$freeze(),n.formatter=I($=i)?$:E("DEFAULT_FORMATTER"),l=E("DICE_ROLL_METHOD_RE").$match(c),I(l)||n.$raise(E("ArgumentError"),""+n.name+": invalid dice roll method: "+c),n.num_of_dice=l["$[]"](1).$to_i(),n.num_of_sides=l["$[]"](2).$to_i(),n.$store(s)},3),h(R,"$fetch",function(u){var c=this,s=o;return s=C(c.items,"find",[],function(n){return n==null&&(n=o),n.$range()["$include?"](u)},1),I(s)||c.$raise(E("RangeError"),""+c.name+": value is out of range: "+u),s},1),h(R,"$roll",function(u){var c=this,s=o,i=o,n=o,$=o;return s=u.$roll_barabara(c.num_of_dice,c.num_of_sides),i=s.$sum(),n=E("RollResult").$new(i,s,c.$fetch(i).$content()),$=[c.formatter["$[]"](c,n)],C(n,"formatted=",v($)),$[z($.length,1)],n},1),R.$private(),h(R,"$store",function(u){var c=this,s=o,i=o;return s=C(u,"map",[],function n($,l){var d=n.$$s==null?this:n.$$s;return $==null&&($=o),l==null&&(l=o),[d.$coerce_to_int_range($),l]},{$$arity:2,$$s:c}),i=C(s,"sort_by",[],function($,l){return $==null&&($=o),l==null&&(l=o),$.$min()},2),c.$assert_min_sum_is_covered(i),c.$assert_max_sum_is_covered(i),c.$assert_no_gap_or_overlap_in_ranges(i),c.items=C(i,"map",[],function($,l){return $==null&&($=o),l==null&&(l=o),E("Item").$new($,l.$freeze()).$freeze()},2).$freeze(),c},1),h(R,"$coerce_to_int_range",function(u){var c=this,s=o;return T(E("Integer"),s=u)?E("Range").$new(u,u):T(E("Range"),s)&&I(u.$begin()["$is_a?"](E("Integer")))&&I(u.$end()["$is_a?"](E("Integer")))?u:c.$raise(E("TypeError"),""+c.name+": "+u+" ("+u.$class()+") must be an Integer or a Range with Integers ")},1),h(R,"$assert_min_sum_is_covered",function(u){var c=this,s=o,i=o;return s=c.num_of_dice,i=u.$first()["$[]"](0),I(i["$include?"](s))||c.$raise(E("RangeError"),""+c.name+": min value ("+s+") is not covered: "+i),c},1),h(R,"$assert_max_sum_is_covered",function(u){var c=this,s=o,i=o;return s=U(c.num_of_dice,c.num_of_sides),i=u.$last()["$[]"](0),I(i["$include?"](s))||c.$raise(E("RangeError"),""+c.name+": max value ("+s+") is not covered: "+i),c},1),h(R,"$assert_no_gap_or_overlap_in_ranges",function(u){var c=this;return C(u,"each_cons",[2],function s(i,n){var $=s.$$s==null?this:s.$$s,l=o,d=o,m=o,k=o;return $.name==null&&($.name=o),i==null&&(i=o),n==null&&(n=o),l=i["$[]"](0),d=n["$[]"](0),m=l.$max(),k=J(m,1),I(d["$include?"](m))&&$.$raise(E("RangeError"),""+$.name+": Range overlap: "+l+" and "+d),I(d["$include?"](k))?o:$.$raise(E("RangeError"),""+$.name+": Range gap: "+l+" and "+d)},{$$arity:2,$$s:c}),c},1)}(b[0],null,b)}(B[0],B)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.send,I=e.def,h=e.rb_minus;return function(v,z){var T=r(v,"BCDice"),U=[T].concat(z);return function(J,W){var S=r(J,"DiceTable"),F=[S].concat(W);return function(B,X,L){var w=q(B,X,"SaiFicSkillTable"),b=[w].concat(L);return function(M,D,G){var R=q(M,D,"Category"),f=[R].concat(G),E=e.$r(f),g=R.$$prototype;return g.name=o,I(R,"$initialize",function(u,c,s,i){var n=this;return n.name=u,n.skills=C(c.$map(),"with_index",[2],function(l,d){return l==null&&(l=o),d==null&&(d=o),t(E("SaiFicSkillTable"),"Skill").$new(u,l,s,d,i)},2),n.dice=s},4),I(R,"$roll",function(u){var c=this;return c.$skills()["$[]"](h(u.$roll_sum(2,6),2))},1),I(R,"$to_s",function(){var u=this;return u.name},0),R.$attr_reader("name","dice","skills")}(b[0],null,b)}(F[0],null,F)}(U[0],U)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.hash2;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"DiceTable"),W=[J].concat(U);return function(S,F,B){var X=r(S,F,"SaiFicSkillTable"),L=[X].concat(B);return function(w,b){var M=r(w,b,"Skill"),D=M.$$prototype;return D.s_format=D.category_dice=D.row_dice=D.category_name=D.name=o,q(M,"$initialize",function(R,f,E,g,_){var u=this;return u.category_name=R,u.name=f,u.category_dice=E,u.row_dice=g,u.s_format=_},5),q(M,"$to_s",function(){var R=this;return R.$format(R.s_format,C(["category_dice","row_dice","category_name","skill_name"],{category_dice:R.category_dice,row_dice:R.row_dice,category_name:R.category_name,skill_name:R.name}))},0),M.$attr_reader("category_name","name","category_dice","row_dice")}(L[0],null)}(W[0],null,W)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.hash2,h=e.send,v=e.hash,z=e.defs,T=e.const_set,U=e.to_ary,J=e.def,W=e.truthy,S=e.rb_minus,F=e.rb_plus;return A.$require("bcdice/dice_table/sai_fic_skill_table/category"),A.$require("bcdice/dice_table/sai_fic_skill_table/skill"),function(B,X){var L=q(B,"BCDice"),w=[L].concat(X);return function(b,M){var D=q(b,"DiceTable"),G=[D].concat(M);return function(R,f,E){var g=C(R,f,"SaiFicSkillTable"),_=[g].concat(E),u=e.$r(_),c=g.$$prototype;return c.rtt=c.rtt_format=c.rct=c.rct_format=c.rttn=c.rttn_format=c.categories=t,z(g,"$from_i18n",function(i,n,$){var l,d,m,k=this,x=t,Y=t,a=t;if($==null)$=I([],{});else if(!$.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return l=$.$$smap.rtt,l==null&&(l=t),d=$.$$smap.rct,d==null&&(d=t),m=$.$$smap.rttn,m==null&&(m=t),x=u("I18n").$t("RTT",I(["locale","raise","default"],{locale:n,raise:!1,default:I([],{})})),Y=x.$merge(u("I18n").$t(i,I(["locale","raise"],{locale:n,raise:!0}))),a=Y["$[]"]("items"),Y=h(Y,"select",[],function(p,H){return p==null&&(p=t),H==null&&(H=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](p)},2),k.$new(a,e.to_hash(Y).$merge(I(["rtt","rct","rttn"],{rtt:l,rct:d,rttn:m})))},-3),T(_[0],"DEFAULT_RTT","\u30E9\u30F3\u30C0\u30E0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uFF1E %<text>s"),T(_[0],"DEFAULT_RCT","\u30E9\u30F3\u30C0\u30E0\u5206\u91CE\u8868(%<category_dice>d) \uFF1E %<category_name>s"),T(_[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91CE\u30E9\u30F3\u30C0\u30E0\u7279\u6280\u8868(%<row_dice>d) \uFF1E %<text>s"),T(_[0],"DEFAULT_S","\u300A%<skill_name>s\uFF0F%<category_name>s%<row_dice>d\u300B"),J(g,"$initialize",function(i,n){var $,l,d,m,k,x,Y,a=this;if(n==null)n=I([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return $=n.$$smap.rtt,$==null&&($=t),l=n.$$smap.rct,l==null&&(l=t),d=n.$$smap.rttn,d==null&&(d=t),m=n.$$smap.rtt_format,m==null&&(m=u("DEFAULT_RTT")),k=n.$$smap.rct_format,k==null&&(k=u("DEFAULT_RCT")),x=n.$$smap.rttn_format,x==null&&(x=u("DEFAULT_RTTN")),Y=n.$$smap.s_format,Y==null&&(Y=u("DEFAULT_S")),a.categories=h(i.$map(),"with_index",[1],function(p,H){var Q,ee,ne=t,V=t;return p==null&&(p=t),H==null&&(H=t),ee=p,Q=U(ee),ne=Q[0]==null?t:Q[0],V=Q[1]==null?t:Q[1],r(u("SaiFicSkillTable"),"Category").$new(ne,V,H,Y)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),a.rtt=$,a.rct=l,a.rttn=d.$to_a(),a.rtt_format=m,a.rct_format=k,a.rttn_format=x},-2),T(_[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),g.$attr_reader("categories"),J(g,"$roll_command",function(i,n){var $=this,l=t,d=t,m=t;return l=n,W(["RTT",$.rtt]["$include?"](l))?$.$format_skill($.rtt_format,$.$roll_skill(i)):W(["RCT",$.rct]["$include?"](l))?(d=$.$roll_category(i),$.$format($.rct_format,I(["category_dice","category_name"],{category_dice:d.$dice(),category_name:d.$name()}))):W(m=u("RTTN").$index(l))||W(m=$.rttn.$index(l))?$.$format_skill($.rttn_format,$.categories["$[]"](m).$roll(i)):t},2),J(g,"$roll_category",function(i){var n=this;return n.categories["$[]"](S(i.$roll_once(6),1))},1),J(g,"$roll_skill",function(i){var n=this;return n.$roll_category(i).$roll(i)},1),J(g,"$prefixes",function(){var i=this;return F(["RTT[1-6]?","RCT",i.rtt,i.rct],i.rttn).$compact()},0),g.$private(),J(g,"$format_skill",function(i,n){var $=this;return $.$format(i,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)}(G[0],null,G)}(w[0],w)}(o[0],o)};Opal.modules["bcdice/dice_table/table"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.hash2,C=e.defs,I=e.truthy,h=e.def,v=e.rb_minus;return function(z,T){var U=t(z,"BCDice"),J=[U].concat(T);return function(W,S){var F=t(W,"DiceTable"),B=[F].concat(S);return function(X,L,w){var b=r(X,L,"Table"),M=[b].concat(w),D=e.$r(M),G=b.$$prototype;return G.times=G.sides=G.name=G.items=o,C(b,"$from_i18n",function(f,E){var g=this,_=o;return _=D("I18n").$t(f,q(["locale"],{locale:E})),g.$new(_["$[]"]("name"),_["$[]"]("type"),_["$[]"]("items"))},2),h(b,"$initialize",function(f,E,g){var _=this,u=o;return _.name=f,_.items=g.$freeze(),u=/(\d+)D(\d+)/i.$match(E),I(u)||_.$raise(D("ArgumentError"),"Unexpected table type: "+E),_.times=u["$[]"](1).$to_i(),_.sides=u["$[]"](2).$to_i()},3),h(b,"$roll",function(f){var E=this,g=o;return g=f.$roll_sum(E.times,E.sides),E.$choice(g)},1),h(b,"$choice",function(f){var E=this,g=o;return g=v(f,E.times),D("RollResult").$new(E.name,f,E.items["$[]"](g))},1)}(B[0],null,B)}(J[0],J)}(A[0],A)};Opal.modules["bcdice/dice_table"]=function(e){var A=e.top,o=e.nil;return A.$require("bcdice/dice_table/roll_result"),A.$require("bcdice/dice_table/chain_table"),A.$require("bcdice/dice_table/d66_grid_table"),A.$require("bcdice/dice_table/d66_half_grid_table"),A.$require("bcdice/dice_table/d66_one_third_table"),A.$require("bcdice/dice_table/d66_left_range_table"),A.$require("bcdice/dice_table/d66_parity_table"),A.$require("bcdice/dice_table/d66_range_table"),A.$require("bcdice/dice_table/d66_table"),A.$require("bcdice/dice_table/range_table"),A.$require("bcdice/dice_table/sai_fic_skill_table"),A.$require("bcdice/dice_table/table")};Opal.modules["bcdice/enum"]=function(e){var A=[],o=e.nil,t=e.module,r=e.const_set;return function(q,C){var I=t(q,"BCDice"),h=[I].concat(C);return function(v,z){var T=t(v,"D66SortType"),U=[T].concat(z);return r(U[0],"NO_SORT","no_sort"),r(U[0],"ASC","asc"),r(U[0],"DESC","desc")}(h[0],h),function(v,z){var T=t(v,"RoundType"),U=[T].concat(z);return r(U[0],"CEIL","ceil"),r(U[0],"FLOOR","floor"),r(U[0],"ROUND","round")}(h[0],h)}(A[0],A)};Opal.modules["bcdice/translate"]=function(e){var A=[],o=e.nil,t=e.module,r=e.hash2,q=e.hash,C=e.def;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"Translate"),W=[J].concat(U),S=e.$r(W);return C(J,"$translate",function(B,X){var L,w=this;if(w.locale==null&&(w.locale=o),X==null)X=r([],{});else if(!X.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return L=e.kwrestargs(X,{}),S("I18n").$translate(B,r(["locale","raise"],{locale:w.locale,raise:!0}).$merge(e.to_hash(L)))},-2)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/result"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.send,C=e.to_a,I=e.rb_minus,h=e.def;return function(v,z){var T=t(v,"BCDice"),U=[T].concat(z);return function(J,W,S){var F=r(J,W,"Result"),B=[F].concat(S),X=F.$$prototype;return X.secret=X.success=X.failure=X.critical=X.fumble=o,function(L,w){return h(L,"$success",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$failure",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$critical",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"critical=",C(f)),f[I(f.length,1)],f=[!0],q(R,"success=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$fumble",function(M){var D=this;return q(D.$new(),"tap",[],function(R){var f=o;return R==null&&(R=o),f=[M],q(R,"text=",C(f)),f[I(f.length,1)],f=[!0],q(R,"fumble=",C(f)),f[I(f.length,1)],f=[!0],q(R,"failure=",C(f)),f[I(f.length,1)]},1)},1),h(L,"$nothing",function(){return"nothing"},0)}(e.get_singleton_class(F),B),h(F,"$initialize",function(w){var b=this;return w==null&&(w=o),b.text=w,b.rands=o,b.detailed_rands=o,b.secret=!1,b.success=!1,b.failure=!1,b.critical=!1,b.fumble=!1},-1),F.$attr_accessor("text","rands","detailed_rands"),F.$attr_writer("secret","success","failure","critical","fumble"),h(F,"$secret?",function(){var w=this;return w.secret},0),h(F,"$success?",function(){var w=this;return w.success},0),h(F,"$failure?",function(){var w=this;return w.failure},0),h(F,"$critical?",function(){var w=this;return w.critical},0),h(F,"$fumble?",function(){var w=this;return w.fumble},0),h(F,"$condition=",function(w){var b=this;return b.success=w,b.failure=w["$!"]()},1)}(U[0],null,U)}(A[0],A)};Opal.modules["racc/parser"]=function(e){var A,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.const_set,z=e.defs,T=e.gvars,U=e.rb_lt,J=e.send,W=e.to_a,S=e.rb_minus,F=e.def,B=e.to_ary,X=e.neqeq,L=e.rb_plus,w=e.eqeq,b=e.rb_ge,M=e.rb_gt,D=e.eqeqeq,G=e.rb_le,R=e.rb_times;return function(f,E){var g=C(f,"Racc"),_=[g].concat(E),u=e.$r(_);return I(_[0],u("StandardError"),"ParseError"),r}(o[0],o),h((A=q("::","ParseError","skip_raise"))?"constant":r)||v(o[0],"ParseError",q(t("Racc"),"ParseError")),function(f,E){var g=C(f,"Racc"),_,u=[g].concat(E),c=e.$r(u);return h((_=c("Racc_No_Extensions","skip_raise"))?"constant":r)||v(u[0],"Racc_No_Extensions",!1),function(s,i,n){var $=I(s,i,"Parser"),l=[$].concat(n),d=e.$r(l),m=$.$$prototype;return m.yydebug=m.racc_debug_out=m.racc_error_status=m.racc_t=m.racc_vstack=m.racc_val=m.racc_state=m.racc_tstack=r,v(l[0],"Racc_Runtime_Version","1.4.6"),v(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),v(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),v(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),v(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),v(l[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),v(l[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),v(l[0],"Racc_Runtime_Type","ruby"),z(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")},0),F($,"$_racc_setup",function(){var x,Y,a=this,N=r,p=r,H=r;return T.stderr==null&&(T.stderr=r),h(q(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),h((x=a.yydebug,x!=null&&x!==r?"instance-variable":r))||(a.yydebug=!1),h(a.yydebug)&&(h((Y=a.racc_debug_out,Y!=null&&Y!==r?"instance-variable":r))||(a.racc_debug_out=T.stderr),a.racc_debug_out=h(N=a.racc_debug_out)?N:T.stderr),p=q(a.$class(),"Racc_arg"),h(U(p.$size(),14))&&(H=[13,!0],J(p,"[]=",W(H)),H[S(H.length,1)]),p},0),F($,"$_racc_init_sysvars",function(){var x=this;return x.racc_state=[0],x.racc_tstack=[],x.racc_vstack=[],x.racc_t=r,x.racc_val=r,x.racc_read_next=!0,x.racc_user_yyerror=!1,x.racc_error_status=0},0),F($,"$do_parse",function(){var x=this;return x.$__send__(d("Racc_Main_Parsing_Routine"),x.$_racc_setup(),!1)},0),F($,"$next_token",function(){var x=this;return x.$raise(d("NotImplementedError"),""+x.$class()+"#next_token is not defined")},0),F($,"$_racc_do_parse_rb",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;return N=x,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],V=a[4]==null?r:a[4],V=a[5]==null?r:a[5],V=a[6]==null?r:a[6],V=a[7]==null?r:a[7],V=a[8]==null?r:a[8],V=a[9]==null?r:a[9],Z=a[10]==null?r:a[10],V=a[11]==null?r:a[11],V=a[12]==null?r:a[12],V=a[13]==null?r:a[13],p.$_racc_init_sysvars(),y=K=P=r,J(p,"catch",["racc_end_parse"],function j(){var O,re,te,ie=j.$$s==null?this:j.$$s,$e=r;for(ie.racc_state==null&&(ie.racc_state=r),ie.racc_read_next==null&&(ie.racc_read_next=r),ie.racc_t==null&&(ie.racc_t=r),ie.yydebug==null&&(ie.yydebug=r),ie.racc_val==null&&(ie.racc_val=r);h(!0);)for(h(P=ne["$[]"](ie.racc_state["$[]"](-1)))?(h(ie.racc_read_next)&&X(ie.racc_t,0)&&(te=ie.$next_token(),re=B(te),y=re[0]==null?r:re[0],ie.racc_val=re[1]==null?r:re[1],h(y)?ie.racc_t=h($e=Z["$[]"](y))?$e:1:ie.racc_t=0,h(ie.yydebug)&&ie.$racc_read_token(ie.racc_t,y,ie.racc_val),ie.racc_read_next=!1),P=L(P,ie.racc_t),h(b(P,0))&&h(K=H["$[]"](P))&&w(Q["$[]"](P),ie.racc_state["$[]"](-1))||(K=ee["$[]"](ie.racc_state["$[]"](-1)))):K=ee["$[]"](ie.racc_state["$[]"](-1));h(K=ie.$_racc_evalact(K,x)););},{$$arity:0,$$s:p})},2),F($,"$yyparse",function(x,Y){var a=this;return a.$__send__(d("Racc_YY_Parse_Method"),x,Y,a.$_racc_setup(),!0)},2),F($,"$_racc_yyparse_rb",function(x,Y,a,N){var p,H,Q=this,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r;return H=a,p=B(H),ee=p[0]==null?r:p[0],ne=p[1]==null?r:p[1],V=p[2]==null?r:p[2],Z=p[3]==null?r:p[3],y=p[4]==null?r:p[4],y=p[5]==null?r:p[5],y=p[6]==null?r:p[6],y=p[7]==null?r:p[7],y=p[8]==null?r:p[8],y=p[9]==null?r:p[9],K=p[10]==null?r:p[10],y=p[11]==null?r:p[11],y=p[12]==null?r:p[12],y=p[13]==null?r:p[13],Q.$_racc_init_sysvars(),P=r,j=r,J(Q,"catch",["racc_end_parse"],function O(){var re,te,ie=O.$$s==null?this:O.$$s;for(ie.racc_state==null&&(ie.racc_state=r);!h(j=Z["$[]"](ie.racc_state["$[]"](-1)));)for(;h(P=ie.$_racc_evalact(V["$[]"](ie.racc_state["$[]"](-1)),a)););return J(x,"__send__",[Y],function $e(se,oe){var le,ce,ue=$e.$$s==null?this:$e.$$s,ae=r,_e=r;for(ue.racc_t==null&&(ue.racc_t=r),ue.racc_state==null&&(ue.racc_state=r),ue.racc_read_next==null&&(ue.racc_read_next=r),se==null&&(se=r),oe==null&&(oe=r),h(se)?ue.racc_t=h(ae=K["$[]"](se))?ae:1:ue.racc_t=0,ue.racc_val=oe,ue.racc_read_next=!1,j=L(j,ue.racc_t),h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););for(;h(h(ae=h(_e=(j=Z["$[]"](ue.racc_state["$[]"](-1)))["$!"]())?_e:ue.racc_read_next["$!"]())?ae:ue.racc_t["$=="](0));)for(h(j)&&h(j=L(j,ue.racc_t))&&h(b(j,0))&&h(P=ee["$[]"](j))&&w(ne["$[]"](j),ue.racc_state["$[]"](-1))||(P=V["$[]"](ue.racc_state["$[]"](-1)));h(P=ue.$_racc_evalact(P,a)););},{$$arity:2,$$s:ie})},{$$arity:0,$$s:Q})},4),F($,"$_racc_evalact",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r;if(N=Y,a=B(N),H=a[0]==null?r:a[0],Q=a[1]==null?r:a[1],ee=a[2]==null?r:a[2],ne=a[3]==null?r:a[3],ee=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ee=a[6]==null?r:a[6],ee=a[7]==null?r:a[7],ee=a[8]==null?r:a[8],ee=a[9]==null?r:a[9],ee=a[10]==null?r:a[10],V=a[11]==null?r:a[11],Z=a[12]==null?r:a[12],ee=a[13]==null?r:a[13],ee=a[14]==null?r:a[14],h(M(x,0))&&h(U(x,V)))h(M(p.racc_error_status,0))&&(w(p.racc_t,1)||(p.racc_error_status=S(p.racc_error_status,1))),p.racc_vstack.$push(p.racc_val),p.racc_state.$push(x),p.racc_read_next=!0,h(p.yydebug)&&(p.racc_tstack.$push(p.racc_t),p.$racc_shift(p.racc_t,p.racc_tstack,p.racc_vstack));else if(h(U(x,0))&&h(M(x,Z["$-@"]()))){if(y=J(p,"catch",["racc_jump"],function j(){var O=j.$$s==null?this:j.$$s;return O.racc_state==null&&(O.racc_state=r),O.racc_state.$push(O.$_racc_do_reduce(Y,x)),!1},{$$arity:0,$$s:p}),h(y)){if(D(1,K=y))return p.racc_user_yyerror=!0,Z["$-@"]();if(D(2,K))return V;p.$raise("[Racc Bug] unknown jump code")}}else if(w(x,V))h(p.yydebug)&&p.$racc_accept(),p.$throw("racc_end_parse",p.racc_vstack["$[]"](0));else if(w(x,Z["$-@"]())){for(D(0,K=p.racc_error_status)?h(Y["$[]"](21))||p.$on_error(p.racc_t,p.racc_val,p.racc_vstack):D(3,K)&&(w(p.racc_t,0)&&p.$throw("racc_end_parse",r),p.racc_read_next=!0),p.racc_user_yyerror=!1,p.racc_error_status=3;h(!0)&&!(h(P=ne["$[]"](p.racc_state["$[]"](-1)))&&(P=L(P,1),h(b(P,0))&&h(x=H["$[]"](P))&&w(Q["$[]"](P),p.racc_state["$[]"](-1))));)h(G(p.racc_state.$size(),1))&&p.$throw("racc_end_parse",r),p.racc_state.$pop(),p.racc_vstack.$pop(),h(p.yydebug)&&(p.racc_tstack.$pop(),p.$racc_e_pop(p.racc_state,p.racc_tstack,p.racc_vstack));return x}else p.$raise("[Racc Bug] unknown action "+x.$inspect());return h(p.yydebug)&&p.$racc_next_state(p.racc_state["$[]"](-1),p.racc_state),r},2),F($,"$_racc_do_reduce",function(x,Y){var a,N,p=this,H=r,Q=r,ee=r,ne=r,V=r,Z=r,y=r,K=r,P=r,j=r,O=r,re=r,te=r,ie=r,$e=r,se=r,oe=r,le=r,ce=r,ue=r,ae=r;return N=x,a=B(N),H=a[0]==null?r:a[0],H=a[1]==null?r:a[1],H=a[2]==null?r:a[2],H=a[3]==null?r:a[3],Q=a[4]==null?r:a[4],ee=a[5]==null?r:a[5],ne=a[6]==null?r:a[6],V=a[7]==null?r:a[7],Z=a[8]==null?r:a[8],y=a[9]==null?r:a[9],H=a[10]==null?r:a[10],H=a[11]==null?r:a[11],H=a[12]==null?r:a[12],K=a[13]==null?r:a[13],P=p.racc_state,j=p.racc_vstack,O=p.racc_tstack,re=R(Y,-3),te=y["$[]"](re),ie=y["$[]"](L(re,1)),$e=y["$[]"](L(re,2)),se=[],h(p.yydebug)&&(oe=O["$[]"](te["$-@"](),te)),le=j["$[]"](te["$-@"](),te),h(p.yydebug)&&(ce=[te["$-@"](),te,se],J(O,"[]=",W(ce)),ce[S(ce.length,1)]),ce=[te["$-@"](),te,se],J(j,"[]=",W(ce)),ce[S(ce.length,1)],ce=[te["$-@"](),te,se],J(P,"[]=",W(ce)),ce[S(ce.length,1)],h(K)?j.$push(p.$__send__($e,le,j,le["$[]"](0))):j.$push(p.$__send__($e,le,j)),O.$push(ie),h(p.yydebug)&&p.$racc_reduce(oe,ie,O,j),ue=S(ie,Z),h(re=V["$[]"](ue))&&(re=L(re,P["$[]"](-1)),h(b(re,0))&&h(ae=Q["$[]"](re))&&w(ee["$[]"](re),ue))?ae:ne["$[]"](ue)},2),F($,"$on_error",function(x,Y,a){var N=this,p=r;return N.$raise(d("ParseError"),N.$sprintf(`
parse error on value %s (%s)`,Y.$inspect(),h(p=N.$token_to_str(x))?p:"?"))},3),F($,"$yyerror",function(){var x=this;return x.$throw("racc_jump",1)},0),F($,"$yyaccept",function(){var x=this;return x.$throw("racc_jump",2)},0),F($,"$yyerrok",function(){var x=this;return x.racc_error_status=0},0),F($,"$racc_read_token",function(x,Y,a){var N=this;return N.racc_debug_out.$print("read    "),N.racc_debug_out.$print(Y.$inspect(),"(",N.$racc_token2str(x),") "),N.racc_debug_out.$puts(a.$inspect()),N.racc_debug_out.$puts()},3),F($,"$racc_shift",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("shift   "+N.$racc_token2str(x)),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_reduce",function(x,Y,a,N){var p=this,H=r;return H=p.racc_debug_out,H.$print("reduce "),h(x["$empty?"]())?H.$print(" <none>"):J(x,"each",[],function Q(ee){var ne=Q.$$s==null?this:Q.$$s;return ee==null&&(ee=r),H.$print(" ",ne.$racc_token2str(ee))},{$$arity:1,$$s:p}),H.$puts(" --> "+p.$racc_token2str(Y)),p.$racc_print_stacks(a,N),p.racc_debug_out.$puts()},4),F($,"$racc_accept",function(){var x=this;return x.racc_debug_out.$puts("accept"),x.racc_debug_out.$puts()},0),F($,"$racc_e_pop",function(x,Y,a){var N=this;return N.racc_debug_out.$puts("error recovering mode: pop token"),N.$racc_print_states(x),N.$racc_print_stacks(Y,a),N.racc_debug_out.$puts()},3),F($,"$racc_next_state",function(x,Y){var a=this;return a.racc_debug_out.$puts("goto    "+x),a.$racc_print_states(Y),a.racc_debug_out.$puts()},2),F($,"$racc_print_stacks",function(x,Y){var a=this,N=r;return N=a.racc_debug_out,N.$print("        ["),J(x,"each_index",[],function p(H){var Q=p.$$s==null?this:p.$$s;return H==null&&(H=r),N.$print(" (",Q.$racc_token2str(x["$[]"](H))," ",Y["$[]"](H).$inspect(),")")},{$$arity:1,$$s:a}),N.$puts(" ]")},2),F($,"$racc_print_states",function(x){var Y=this,a=r;return a=Y.racc_debug_out,a.$print("        ["),J(x,"each",[],function(p){return p==null&&(p=r),a.$print(" ",p)},1),a.$puts(" ]")},1),F($,"$racc_token2str",function(x){var Y=this,a=r;return h(a=q(Y.$class(),"Racc_token_to_s_table")["$[]"](x))?a:Y.$raise("[Racc Bug] can't convert token "+x+" to string")},1),F($,"$token_to_str",function(x){var Y=this;return q(Y.$class(),"Racc_token_to_s_table")["$[]"](x)},1)}(u[0],null,u)}(o[0],o)};Opal.modules["bcdice/arithmetic/node"]=function(e){var A=[],o=e.nil,t=e.$$$,r=e.module,q=e.klass,C=e.def,I=e.send2,h=e.find_super,v=e.eqeq,z=e.const_set,T=e.eqeqeq,U=e.rb_divide,J=e.truthy,W=e.alias;return function(S,F){var B=r(S,"BCDice"),X=[B].concat(F);return function(L,w){var b=r(L,"Arithmetic"),M=[b].concat(w);return function(D,G){var R=r(D,"Node"),f=[R].concat(G),E=e.$r(f);return function(g,_){var u=q(g,_,"BinaryOp"),c=u.$$prototype;return c.lhs=c.rhs=c.op=o,C(u,"$initialize",function(i,n,$){var l=this;return l.lhs=i,l.op=n,l.rhs=$},3),C(u,"$eval",function(i){var n=this,$=o,l=o;return $=n.lhs.$eval(i),l=n.rhs.$eval(i),$.$send(n.op,l)},1),C(u,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),C(u,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),C(u,"$op_for_s_exp",function(){var i=this;return i.op},0)}(f[0],null),function(g,_,u){var c=q(g,_,"DivideBase"),s=[c].concat(u),i=e.$r(s),n=c.$$prototype;return n.lhs=n.rhs=n.op=o,C(c,"$initialize",function $(l,d){var m=$.$$p||o,k=this;return delete $.$$p,I(k,h(k,"initialize",$,!1,!0),"initialize",[l,"/",d],null)},2),C(c,"$eval",function(l){var d=this,m=o,k=o;return m=d.lhs.$eval(l),k=d.rhs.$eval(l),v(k,0)&&d.$raise(i("ZeroDivisionError")),d.$divide_and_round(m,k,l)},1),C(c,"$output",function $(){var l=$.$$p||o,d=this;return delete $.$$p,""+I(d,h(d,"output",$,!1,!0),"output",[],l)+d.$rounding_method()},0),c.$private(),C(c,"$rounding_method",function(){var l=this;return t(l.$class(),"ROUNDING_METHOD")},0),C(c,"$op_for_s_exp",function(){var l=this;return""+l.op+l.$rounding_method()},0),C(c,"$divide_and_round",function(l,d,m){var k=this;return k.$raise(i("NotImplementedError"))},3)}(f[0],E("BinaryOp"),f),function(g,_,u){var c=q(g,_,"DivideWithGameSystemDefault"),s=[c].concat(u),i=e.$r(s);return z(s[0],"ROUNDING_METHOD",""),c.$private(),C(c,"$divide_and_round",function($,l,d){var m=o,k=o;return T(t(i("RoundType"),"CEIL"),m=d)?U($.$to_f(),l).$ceil():T(t(i("RoundType"),"ROUND"),m)?(k=U($.$to_f(),l),J(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):U($,l).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithCeil"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","C"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n.$to_f(),$).$ceil()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithRound"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","R"),c.$private(),C(c,"$divide_and_round",function(n,$,l){var d=o;return d=U(n.$to_f(),$),J(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()},3)}(f[0],E("DivideBase"),f),function(g,_,u){var c=q(g,_,"DivideWithFloor"),s=[c].concat(u);return z(s[0],"ROUNDING_METHOD","F"),c.$private(),C(c,"$divide_and_round",function(n,$,l){return U(n,$).$floor()},3)}(f[0],E("DivideBase"),f),function(g,_){var u=q(g,_,"Negative"),c=u.$$prototype;return c.body=o,C(u,"$initialize",function(i){var n=this;return n.body=i},1),C(u,"$eval",function(i){var n=this;return n.body.$eval(i)["$-@"]()},1),C(u,"$output",function(){var i=this;return"-"+i.body.$output()},0),C(u,"$s_exp",function(){var i=this;return"(- "+i.body.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Parenthesis"),c=u.$$prototype;return c.expr=o,C(u,"$initialize",function(i){var n=this;return n.expr=i},1),C(u,"$eval",function(i){var n=this;return n.expr.$eval(i)},1),C(u,"$output",function(){var i=this;return"("+i.expr.$output()+")"},0),C(u,"$s_exp",function(){var i=this;return"(Parenthesis "+i.expr.$s_exp()+")"},0)}(f[0],null),function(g,_){var u=q(g,_,"Number"),c=u.$$prototype;return c.value=o,C(u,"$initialize",function(i){var n=this;return n.value=i},1),C(u,"$eval",function(i){var n=this;return n.value},1),C(u,"$output",function(){var i=this;return i.value.$to_s()},0),W(u,"s_exp","output")}(f[0],null)}(M[0],M)}(X[0],X)}(A[0],A)};Opal.modules.strscan=function(e){var A=[],o=e.nil,t=e.klass,r=e.def,q=e.truthy,C=e.eqeqeq,I=e.Opal,h=e.send,v=e.to_a,z=e.rb_minus,T=e.alias;return function(U,J,W){var S=t(U,J,"StringScanner"),F=[S].concat(W),B=e.$r(F),X=S.$$prototype;return X.pos=X.string=X.working=X.matched=X.prev_pos=X.match=o,S.$attr_reader("pos","matched"),r(S,"$initialize",function(w){var b=this;return b.string=w,b.pos=0,b.matched=o,b.working=w,b.match=[]},1),S.$attr_reader("string"),r(S,"$beginning_of_line?",function(){var w=this;return w.pos===0||w.string.charAt(w.pos-1)===`
`},0),r(S,"$scan",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:typeof M=="object"?(b.prev_pos=b.pos,b.pos+=M[0].length,b.working=b.working.substring(M[0].length),b.matched=M[0],b.match=M,M[0]):typeof M=="string"?(b.pos+=M.length,b.working=b.working.substring(M.length),M):o},1),r(S,"$scan_until",function(w){var b=this;w=b.$anchor(w);for(var M=b.pos,D=b.working,G;;){if(G=w.exec(D),M+=1,D=D.substr(1),G==null){if(D.length===0)return b.match=[],b.matched=o;continue}return b.matched=b.string.substr(b.pos,M-b.pos-1+G[0].length),b.match=G,b.prev_pos=M-1,b.pos=M,b.working=D.substr(G[0].length),b.matched}},1),r(S,"$[]",function(w){var b=this,M=o;if(q(b.match["$empty?"]()))return o;C(B("Symbol"),M=w)?w=w.$to_s():C(B("String"),M)||(w=I["$coerce_to!"](w,B("Integer"),"to_int"));var D=b.match;return w<0&&(w+=D.length),w<0||w>=D.length||D[w]==null?o:D[w]},1),r(S,"$check",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?b.matched=o:b.matched=M[0]},1),r(S,"$check_until",function(w){var b=this,M=b.prev_pos,D=b.pos,G=b.$scan_until(w);return G!==o&&(b.matched=G.substr(-1),b.working=b.string.substr(D)),b.prev_pos=M,b.pos=D,G},1),r(S,"$peek",function(w){var b=this;return b.working.substring(0,w)},1),r(S,"$eos?",function(){var w=this;return w.working.length===0},0),r(S,"$exist?",function(w){var b=this,M=w.exec(b.working);return M==null?o:M.index==0?0:M.index+1},1),r(S,"$skip",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);if(M==null)return b.match=[],b.matched=o;var D=M[0],G=D.length;return b.matched=D,b.match=M,b.prev_pos=b.pos,b.pos+=G,b.working=b.working.substring(G),G},1),r(S,"$skip_until",function(w){var b=this,M=b.$scan_until(w);return M===o?o:(b.matched=M.substr(-1),M.length)},1),r(S,"$get_byte",function(){var w=this,b=o;return w.pos<w.string.length?(w.prev_pos=w.pos,w.pos+=1,b=w.matched=w.working.substring(0,1),w.working=w.working.substring(1)):w.matched=o,b},0),r(S,"$match?",function(w){var b=this;w=b.$anchor(w);var M=w.exec(b.working);return M==null?o:(b.prev_pos=b.pos,M[0].length)},1),r(S,"$pos=",function(w){var b=this;return w<0&&(w+=b.string.$length()),b.pos=w,b.working=b.string.slice(w)},1),r(S,"$matched_size",function(){var w=this;return w.matched===o?o:w.matched.length},0),r(S,"$post_match",function(){var w=this;return w.matched===o?o:w.string.substr(w.pos)},0),r(S,"$pre_match",function(){var w=this;return w.matched===o?o:w.string.substr(0,w.prev_pos)},0),r(S,"$reset",function(){var w=this;return w.working=w.string,w.matched=o,w.pos=0},0),r(S,"$rest",function(){var w=this;return w.working},0),r(S,"$rest?",function(){var w=this;return w.working.length!==0},0),r(S,"$rest_size",function(){var w=this;return w.$rest().$size()},0),r(S,"$terminate",function(){var w=this,b=o;return w.match=o,b=[w.string.$length()],h(w,"pos=",v(b)),b[z(b.length,1)]},0),r(S,"$unscan",function(){var w=this;return w.pos=w.prev_pos,w.prev_pos=o,w.match=o,w},0),T(S,"bol?","beginning_of_line?"),T(S,"getch","get_byte"),S.$private(),r(S,"$anchor",function(w){var b=w.toString().match(/\/([^\/]+)$/);return b=b?b[1]:void 0,new RegExp("^(?:"+w.source+")",b)},1)}(A[0],null,A)};Opal.modules["bcdice/normalize"]=function(e){var A=[],o=e.nil,t=e.module,r=e.eqeqeq,q=e.def,C=e.eqeq;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T){var U=t(T,"Normalize");return U.$module_function(),q(U,"$comparison_operator",function(W){var S=o;return r(/<=|=</,S=W)?"<=":r(/>=|=>/,S)?">=":r(/<>|!=|=!/,S)?"!=":r(/</,S)?"<":r(/>/,S)?">":r(/=/,S)?"==":o},1),q(U,"$target_number",function(W){return C(W,"?")?W:W.$to_i()},1)}(z[0])}(A[0],A)};Opal.modules["bcdice/command/lexer"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.truthy,v=e.send,z=e.def;return A.$require("strscan"),A.$require("bcdice/normalize"),function(T,U){var J=r(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=r(S,"Command"),X=[B].concat(F);return function(L,w,b){var M=q(L,w,"Lexer"),D=[M].concat(b),G=e.$r(D),R=M.$$prototype;return R.scanner=R.notations=t,C(D[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),z(M,"$initialize",function(E,g){var _,u,c=this,s=t;return E=h(s=(u=(_=E,_===t||_==null?t:v(_,"split",[" ",2])),u===t||u==null?t:v(u,"first",[])))?s:"",c.scanner=G("StringScanner").$new(E),c.notations=v(g,"map",[],function(n){return n==null&&(n=t),h(n["$is_a?"](G("String")))?G("Regexp").$new(n):n},1)},2),z(M,"$next_token",function(){try{var E=this,g=t,_=t,u=t,c=t,s=t;return h(E.scanner["$eos?"]())?[!1,"$"]:(v(E.notations,"each",[],function i(n){var $=i.$$s==null?this:i.$$s,l=t;if($.scanner==null&&($.scanner=t),n==null&&(n=t),l=$.scanner.$scan(n),h(l))e.ret(["NOTATION",l]);else return t},{$$arity:1,$$s:E}),h(g=E.scanner.$scan(/\d+/))?["NUMBER",g.$to_i()]:h(_=E.scanner.$scan(/[<>!=]+/))?(_=G("Normalize").$comparison_operator(_),u=h(_)?"CMP_OP":"ILLEGAL",[u,_]):(c=E.scanner.$getch().$upcase(),u=h(s=G("SYMBOLS")["$[]"](c))?s:c.$to_sym(),[u,c]))}catch(i){if(i===e.returner)return i.$v;throw i}},0),z(M,"$source",function(){var E=this;return E.scanner.$string()},0)}(X[0],null,X)}(W[0],W)}(o[0],o)};Opal.modules["bcdice/command/parsed"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.truthy,I=e.eqeqeq;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"Command"),S=[W].concat(J);return function(F,B,X){var L=r(F,B,"Parsed"),w=[L].concat(X),b=e.$r(w),M=L.$$prototype;return M.question_target=M.critical=M.fumble=M.dollar=M.modify_number=M.target_number=M.prefix_number=M.command=M.suffix_number=M.cmp_op=o,L.$attr_accessor("command"),L.$attr_accessor("prefix_number"),L.$attr_accessor("suffix_number"),L.$attr_accessor("critical"),L.$attr_accessor("fumble"),L.$attr_accessor("dollar"),L.$attr_accessor("modify_number"),L.$attr_accessor("cmp_op"),L.$attr_accessor("target_number"),L.$attr_writer("question_target"),q(L,"$initialize",function(){var G=this;return G.prefix_number=o,G.suffix_number=o,G.critical=o,G.fumble=o,G.dollar=o,G.cmp_op=o,G.target_number=o,G.question_target=!1},0),q(L,"$question_target?",function(){var G=this;return G.question_target},0),q(L,"$to_s",function(G){var R=this,f=o,E=o,g=o,_=o,u=o,c=o;return G==null&&(G="after_command"),f=C(R.critical)?"@"+R.critical:o,E=C(R.fumble)?"#"+R.fumble:o,g=C(R.dollar)?"$"+R.dollar:o,_=b("Format").$modifier(R.modify_number),u=C(R.question_target)?"?":R.target_number,I("after_command",c=G)?[R.prefix_number,R.command,R.suffix_number,f,E,g,_,R.cmp_op,u].$join():I("after_modify_number",c)?[R.prefix_number,R.command,R.suffix_number,_,f,E,g,R.cmp_op,u].$join():I("after_target_number",c)?[R.prefix_number,R.command,R.suffix_number,_,R.cmp_op,u,f,E,g].$join():o},-1)}(S[0],null,S)}(T[0],T)}(A[0],A)};Opal.modules["bcdice/command/parser"]=function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.klass,I=e.module,h=e.hash2,v=e.send2,z=e.find_super,T=e.def,U=e.send,J=e.to_a,W=e.rb_minus,S=e.eqeq,F=e.hash,B=e.const_set,X=e.truthy,L=e.to_ary;return A.$require("racc/parser.rb"),A.$require("bcdice/arithmetic/node"),A.$require("bcdice/command/lexer"),A.$require("bcdice/command/parsed"),C(q(t("BCDice"),"Command"),q(t("Racc"),"Parser"),"Parser"),function(w,b){var M=I(w,"BCDice"),D=[M].concat(b);return function(G,R){var f=I(G,"Command"),E=[f].concat(R),g=e.$r(E);return function(_,u,c){var s=C(_,u,"Parser"),i=[s].concat(c),n=e.$r(i),$=r,l=r,d=r,m=r,k=r,x=r,Y=r,a=r,N=r,p=r,H=r,Q=r,ee=r,ne=r,V=s.$$prototype;return V.notations=V.lexer=V.modifier=V.suffix_number=V.prefix_number=V.need_suffix_number=V.need_prefix_number=V.critical=V.fumble=V.dollar=V.allowed_cmp_op=V.question_target=r,T(s,"$initialize",function Z(y,K){var P,j,O,re,te=Z.$$p||r,ie=this;if(delete Z.$$p,P=e.slice.call(arguments),j=e.extract_kwargs(P),j==null)j=h([],{});else if(!j.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(O=P,!e.hasOwnProperty.call(j.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return re=j.$$smap.round_type,v(ie,z(ie,"initialize",Z,!1,!0),"initialize",[],null),ie.notations=O,ie.round_type=re,ie.prefix_number=!1,ie.suffix_number=!1,ie.need_prefix_number=!1,ie.need_suffix_number=!1,ie.modifier=!0,ie.critical=!1,ie.fumble=!1,ie.dollar=!1,ie.allowed_cmp_op=[r,">=",">","<=","<","==","!="],ie.question_target=!1},-2),T(s,"$disable_modifier",function(){var y=this;return y.modifier=!1,y},0),T(s,"$enable_prefix_number",function(){var y=this;return y.prefix_number=!0,y},0),T(s,"$enable_suffix_number",function(){var y=this;return y.suffix_number=!0,y},0),T(s,"$has_prefix_number",function(){var y=this;return y.prefix_number=!0,y.need_prefix_number=!0,y},0),T(s,"$has_suffix_number",function(){var y=this;return y.suffix_number=!0,y.need_suffix_number=!0,y},0),T(s,"$enable_critical",function(){var y=this;return y.critical=!0,y},0),T(s,"$enable_fumble",function(){var y=this;return y.fumble=!0,y},0),T(s,"$enable_dollar",function(){var y=this;return y.dollar=!0,y},0),T(s,"$restrict_cmp_op_to",function(y){var K,P,j=this;return K=e.slice.call(arguments),P=K,j.allowed_cmp_op=P,j},-1),T(s,"$enable_question_target",function(){var y=this;return y.question_target=!0,y},0),T(s,"$parse",function(y){var K=this;try{return K.lexer=n("Lexer").$new(y,K.notations),K.$do_parse()}catch(P){if(e.rescue(P,[n("ParseError"),n("ZeroDivisionError")]))try{return r}finally{e.pop_exception()}else throw P}},1),s.$private(),T(s,"$parsed",function(y,K,P,j){var O=this;return U(n("Parsed").$new(),"tap",[],function re(te){var ie,$e,se,oe,le,ce,ue=re.$$s==null?this:re.$$s,ae=r;return ue.round_type==null&&(ue.round_type=r),te==null&&(te=r),ae=[y["$[]"]("command")],U(te,"command=",J(ae)),ae[W(ae.length,1)],ae=[(ie=y["$[]"]("prefix"),ie===r||ie==null?r:U(ie,"eval",[ue.round_type]))],U(te,"prefix_number=",J(ae)),ae[W(ae.length,1)],ae=[($e=y["$[]"]("suffix"),$e===r||$e==null?r:U($e,"eval",[ue.round_type]))],U(te,"suffix_number=",J(ae)),ae[W(ae.length,1)],ae=[(se=K["$[]"]("critical"),se===r||se==null?r:U(se,"eval",[ue.round_type]))],U(te,"critical=",J(ae)),ae[W(ae.length,1)],ae=[(oe=K["$[]"]("fumble"),oe===r||oe==null?r:U(oe,"eval",[ue.round_type]))],U(te,"fumble=",J(ae)),ae[W(ae.length,1)],ae=[(le=K["$[]"]("dollar"),le===r||le==null?r:U(le,"eval",[ue.round_type]))],U(te,"dollar=",J(ae)),ae[W(ae.length,1)],ae=[P.$eval(ue.round_type)],U(te,"modify_number=",J(ae)),ae[W(ae.length,1)],ae=[j["$[]"]("cmp_op")],U(te,"cmp_op=",J(ae)),ae[W(ae.length,1)],S(j["$[]"]("target"),"?")?(ae=[!0],U(te,"question_target=",J(ae)),ae[W(ae.length,1)],ae=[0],U(te,"target_number=",J(ae)),ae[W(ae.length,1)]):(ae=[!1],U(te,"question_target=",J(ae)),ae[W(ae.length,1)],ae=[(ce=j["$[]"]("target"),ce===r||ce==null?r:U(ce,"eval",[ue.round_type]))],U(te,"target_number=",J(ae)),ae[W(ae.length,1)])},{$$arity:1,$$s:O})},4),T(s,"$next_token",function(){var y=this;return y.lexer.$next_token()},0),$=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],l=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],d=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],m=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],k=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],x=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Y=[r,6,13,3,9,-1,27,-15,-10,-1,-38],a=[r,r,r,r,r,r,19,16,15,r,r],N=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],p=35,H=58,Q=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),ee=19,ne=!0,B(i[0],"Racc_arg",[$,l,m,d,k,x,a,Y,ee,N,Q,H,p,ne]),B(i[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),B(i[0],"Racc_debug_parser",!1),T(s,"$_reduce_1",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return X(re.modifier)||re.$raise(n("ParseError")),O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],se=j[3]==null?r:j[3],P=re.$parsed(te,ie,$e,se),P},3),T(s,"$_reduce_2",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return X(re.modifier)||re.$raise(n("ParseError")),O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],se=j[3]==null?r:j[3],P=re.$parsed(te,$e,ie,se),P},3),T(s,"$_reduce_3",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],P=re.$parsed(te,ie,q(q(n("Arithmetic"),"Node"),"Number").$new(0),$e),P},3),T(s,"$_reduce_4",function(y,K,P){var j=this;return X(j.prefix_number)&&X(j.suffix_number)||j.$raise(n("ParseError")),P=h(["command","prefix","suffix"],{command:y["$[]"](1),prefix:y["$[]"](0),suffix:y["$[]"](2)}),P},3),T(s,"$_reduce_5",function(y,K,P){var j=this;return X(j.prefix_number)||j.$raise(n("ParseError")),X(j.need_suffix_number)&&j.$raise(n("ParseError")),P=h(["command","prefix"],{command:y["$[]"](1),prefix:y["$[]"](0)}),P},3),T(s,"$_reduce_6",function(y,K,P){var j=this;return X(j.suffix_number)||j.$raise(n("ParseError")),X(j.need_prefix_number)&&j.$raise(n("ParseError")),P=h(["command","suffix"],{command:y["$[]"](0),suffix:y["$[]"](1)}),P},3),T(s,"$_reduce_7",function(y,K,P){var j=this;return(X(j.need_prefix_number)||X(j.need_suffix_number))&&j.$raise(n("ParseError")),P=h(["command"],{command:y["$[]"](0)}),P},3),T(s,"$_reduce_8",function(y,K,P){return P=h([],{}),P},3),T(s,"$_reduce_9",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.critical)&&X(te["$[]"]("critical")["$nil?"]())||re.$raise(n("ParseError")),se=["critical",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_10",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.fumble)&&X(te["$[]"]("fumble")["$nil?"]())||re.$raise(n("ParseError")),se=["fumble",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_11",function(y,K,P){var j,O,re=this,te=r,ie=r,$e=r,se=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],$e=j[2]==null?r:j[2],X(re.dollar)&&X(te["$[]"]("dollar")["$nil?"]())||re.$raise(n("ParseError")),se=["dollar",$e],U(te,"[]=",J(se)),se[W(se.length,1)],P=te,P},3),T(s,"$_reduce_12",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_13",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1)),P},3),T(s,"$_reduce_14",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2)),P},3),T(s,"$_reduce_15",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2)),P},3),T(s,"$_reduce_16",function(y,K,P){var j=this;return X(j.allowed_cmp_op["$include?"](r))||j.$raise(n("ParseError")),P=h([],{}),P},3),T(s,"$_reduce_17",function(y,K,P){var j,O,re=this,te=r,ie=r;return O=y,j=L(O),te=j[0]==null?r:j[0],ie=j[1]==null?r:j[1],X(re.allowed_cmp_op["$include?"](te))||re.$raise(n("ParseError")),P=h(["cmp_op","target"],{cmp_op:te,target:ie}),P},3),T(s,"$_reduce_18",function(y,K,P){var j=this,O=r;return O=y["$[]"](0),X(j.question_target)||j.$raise(n("ParseError")),X(j.allowed_cmp_op["$include?"](O))||j.$raise(n("ParseError")),P=h(["cmp_op","target"],{cmp_op:O,target:"?"}),P},3),T(s,"$_reduce_19",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2)),P},3),T(s,"$_reduce_20",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2)),P},3),T(s,"$_reduce_22",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"*",y["$[]"](2)),P},3),T(s,"$_reduce_23",function(y,K,P){var j=r;return j=y["$[]"](3),P=j.$new(y["$[]"](0),y["$[]"](2)),P},3),T(s,"$_reduce_25",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault"),P},3),T(s,"$_reduce_26",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithCeil"),P},3),T(s,"$_reduce_27",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithCeil"),P},3),T(s,"$_reduce_28",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithRound"),P},3),T(s,"$_reduce_29",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"DivideWithFloor"),P},3),T(s,"$_reduce_30",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_31",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1)),P},3),T(s,"$_reduce_33",function(y,K,P){return P=y["$[]"](1),P},3),T(s,"$_reduce_34",function(y,K,P){return P=q(q(n("Arithmetic"),"Node"),"Number").$new(y["$[]"](0)),P},3),T(s,"$_reduce_none",function(y,K,P){return y["$[]"](0)},3)}(E[0],q(g("Racc"),"Parser"),E)}(D[0],D)}(o[0],o)};Opal.modules["bcdice/deprecated/checker"]=function(e){var A=[],o=e.nil,t=e.module,r=e.send,q=e.eqeqeq,C=e.truthy,I=e.def;return function(h,v){var z=t(h,"BCDice"),T=[z].concat(v);return function(U,J){var W=t(U,"Deprecated"),S=[W].concat(J);return function(F,B){var X=t(F,"Checker"),L=[X].concat(B),w=e.$r(L);return X.$private(),I(X,"$check_result_legacy",function(M,D,G,R){var f=this,E=o,g=o,_=o,u=o,c=o;return E=r(D,"map",[],"sides".$to_proc()),g=r(D,"map",[],"value".$to_proc()),_=g.$sum(),u=q([100],c=E)?f.$check_1D100(M,_,G,R):q([20],c)?f.$check_1D20(M,_,G,R):q([6,6],c)?f.$check_2D6(M,_,g,G,R):o,!(C(u["$nil?"]())||C(u["$empty?"]()))||(u=q([10],c=E.$uniq())?f.$check_nD10(M,_,g,G,R):q([6],c)?f.$check_nD6(M,_,g,G,R):o,!(C(u["$nil?"]())||C(u["$empty?"]())))?w("Result").$new(u.$delete_prefix(" \uFF1E ")):o},4),I(X,"$check_1D100",function(M,D,G,R){return o},4),I(X,"$check_1D20",function(M,D,G,R){return o},4),I(X,"$check_nD10",function(M,D,G,R,f){return o},5),I(X,"$check_2D6",function(M,D,G,R,f){return o},5),I(X,"$check_nD6",function(M,D,G,R,f){return o},5)}(S[0],S)}(T[0],T)}(A[0],A)};Opal.modules["bcdice/base"]=function(e){var A=e.top,o=[],t=e.$r(o),r=e.nil,q=e.$$$,C=e.module,I=e.klass,h=e.truthy,v=e.def,z=e.regexp,T=e.rb_plus,U=e.send,J=e.to_a,W=e.rb_minus,S=e.eqeqeq,F=e.eqeq,B=e.range,X=e.rb_divide,L=e.rb_times,w=e.rb_ge,b=r;return A.$require("i18n"),A.$require("i18n/backend/fallbacks"),A.$require("bcdice/randomizer"),A.$require("bcdice/dice_table"),A.$require("bcdice/enum"),A.$require("bcdice/translate"),A.$require("bcdice/result"),A.$require("bcdice/command/parser"),A.$require("bcdice/deprecated/checker"),function(M,D){var G=C(M,"BCDice"),R=[G].concat(D);return function(f,E,g){var _=I(f,E,"Base"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;return s.sort_add_dice=s.sort_barabara_dice=s.enabled_d9=s.raw_input=s.randomizer=s.enabled_upcase_input=s.debug=r,function(i,n){var $=[i].concat(n),l=e.$r($);return i.$attr_reader("prefixes"),v(i,"$register_prefix",function(m){var k,x,Y=this,a=r;return Y.prefixes==null&&(Y.prefixes=r),k=e.slice.call(arguments),x=k,Y.prefixes=h(a=Y.prefixes)?a:[],Y.prefixes.$concat(x.$flatten())},-1),v(i,"$register_prefix_from_super_class",function(){var m=this;return m.$register_prefix(m.$superclass().$prefixes())},0),v(i,"$prefixes_pattern",function(){var m=this,k=r;return m.prefixes_pattern==null&&(m.prefixes_pattern=r),m.prefixes==null&&(m.prefixes=r),m.prefixes_pattern=h(k=m.prefixes_pattern)?k:r,h(m.prefixes_pattern)?m.prefixes_pattern:(m.prefixes=h(k=m.prefixes)?k:[],m.prefixes.$freeze(),m.prefixes_pattern=(h(m.prefixes["$empty?"]())?/(?!)/:z(["^(S)?(",m.prefixes.$join("|"),")"],"i")).$freeze())},0),v(i,"$command_pattern",function(){var m=this,k=r,x=r;return m.command_pattern==null&&(m.command_pattern=r),m.prefixes==null&&(m.prefixes=r),m.command_pattern=h(k=m.command_pattern)?k:r,h(m.command_pattern)?m.command_pattern:(m.prefixes=h(k=m.prefixes)?k:[],m.prefixes.$freeze(),x=T(U(q(l("CommonCommand"),"COMMANDS"),"map",[],function(a){return a==null&&(a=r),q(a,"PREFIX_PATTERN").$source()},1),m.prefixes),m.command_pattern=z(["^S?(",x.$join("|"),")"],"i").$freeze())},0),v(i,"$eval",function(m){var k=this;return k.$new(m).$eval()},1)}(e.get_singleton_class(_),u),_.$include(c("Translate")),_.$include(q(c("Deprecated"),"Checker")),v(_,"$initialize",function(n){var $=this;return $.raw_input=n,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=q(c("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=q(c("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=r,$.reroll_dice_reroll_threshold=r,$.default_cmp_op=r,$.default_target_number=r,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=q(c("BCDice"),"Randomizer").$new(),$.debug=!1},1),_.$attr_accessor("randomizer"),_.$attr_reader("d66_sort_type"),_.$attr_reader("round_type"),_.$attr_reader("sides_implicit_d"),_.$attr_reader("upper_dice_reroll_threshold"),_.$attr_reader("reroll_dice_reroll_threshold"),_.$attr_reader("default_cmp_op"),_.$attr_reader("default_target_number"),v(_,"$sort_add_dice?",function(){var n=this;return n.sort_add_dice},0),v(_,"$sort_barabara_dice?",function(){var n=this;return n.sort_barabara_dice},0),v(_,"$enabled_d9?",function(){var n=this;return n.enabled_d9},0),v(_,"$enable_debug",function(){var n=this;return n.debug=!0},0),v(_,"$eval",function(){var n=this,$=r,l=r,d=r,m=r;return $=q(c("BCDice"),"Preprocessor").$process(n.raw_input,n),l=h(d=n.$dice_command($))?d:n.$eval_common_command(n.raw_input),h(l)?(m=[n.randomizer.$rand_results()],U(l,"rands=",J(m)),m[W(m.length,1)],m=[n.randomizer.$detailed_rand_results()],U(l,"detailed_rands=",J(m)),m[W(m.length,1)],l):r},0),v(_,"$change_text",function(n){return n},1),v(_,"$check_result",function(n,$,l,d){var m=this,k=r,x=r,Y=r,a=r,N=r;return k=m.$check_result_legacy(n,$,l,d),h(k)?k:(x=U($,"map",[],"sides".$to_proc()),Y=U($,"map",[],"value".$to_proc()),a=Y.$sum(),k=S([100],N=x)?m.$result_1d100(n,a,l,d):S([20],N)?m.$result_1d20(n,a,l,d):S([6,6],N)?m.$result_2d6(n,a,Y,l,d):r,F(k,c("Result").$nothing())?r:h(k)?k:(k=S([10],N=x.$uniq())?m.$result_nd10(n,a,Y,l,d):S([6],N)?m.$result_nd6(n,a,Y,l,d):r,F(k,c("Result").$nothing())?r:h(k)?k:m.$result_ndx(n,l,d)))},4),v(_,"$grich_text",function(n,$,l){return r},3),_.$private(),v(_,"$eval_common_command",function(n){try{var $=this;return n=$.$change_text(n),U(q(c("CommonCommand"),"COMMANDS"),"each",[],function l(d){var m=l.$$s==null?this:l.$$s,k=r;if(m.randomizer==null&&(m.randomizer=r),d==null&&(d=r),k=d.$eval(n,m,m.randomizer),h(k))e.ret(k);else return r},{$$arity:1,$$s:$}),r}catch(l){if(l===e.returner)return l.$v;throw l}},1),v(_,"$dice_command",function(n){var $=this,l=r,d=r,m=r,k=r,x=r;return h($.enabled_upcase_input)&&(n=n.$upcase()),l=$.$class().$prefixes_pattern().$match(n),h(l)?(d=l["$[]"](1)["$nil?"]()["$!"](),h(d)&&(n=n["$[]"](B(1,-1,!1))),m=$.$eval_game_system_specific_command(n),h(m["$is_a?"](c("Result")))?(k=[h(x=m["$secret?"]())?x:d],U(m,"secret=",J(k)),k[W(k.length,1)],m):h(m["$nil?"]())||h(m["$empty?"]())||F(m,"1")?r:U(c("Result").$new(),"tap",[],function(a){return a==null&&(a=r),k=[m.$to_s()],U(a,"text=",J(k)),k[W(k.length,1)],k=[d],U(a,"secret=",J(k)),k[W(k.length,1)]},1)):r},1),v(_,"$eval_game_system_specific_command",function(n){return r},1),v(_,"$result_ndx",function(n,$,l){var d=this;return h(l["$is_a?"](c("String")))?r:h(n.$send($,l))?c("Result").$success(d.$translate("success")):c("Result").$failure(d.$translate("failure"))},3),v(_,"$result_1d100",function(n,$,l,d){return r},4),v(_,"$result_1d20",function(n,$,l,d){return r},4),v(_,"$result_nd10",function(n,$,l,d,m){return r},5),v(_,"$result_2d6",function(n,$,l,d,m){return r},5),v(_,"$result_nd6",function(n,$,l,d,m){return r},5),v(_,"$get_table_by_2d6",function(n){var $=this;return $.$get_table_by_nD6(n,2)},1),v(_,"$get_table_by_1d6",function(n){var $=this;return $.$get_table_by_nD6(n,1)},1),v(_,"$get_table_by_nD6",function(n,$){var l=this;return l.$get_table_by_nDx(n,$,6)},2),v(_,"$get_table_by_nDx",function(n,$,l){var d=this,m=r,k=r;return m=d.randomizer.$roll_sum($,l),k=d.$get_table_value(n["$[]"](W(m,$))),h(k["$nil?"]())?["1",0]:[k,m]},3),v(_,"$get_table_by_1d3",function(n){var $=this,l=r,d=r,m=r,k=r;return $.$debug("get_table_by_1d3"),l=1,d=$.randomizer.$roll_sum(l,6),$.$debug("num",d),m=X(W(d,1),2).$to_i(),$.$debug("index",m),k=n["$[]"](m),h(k["$nil?"]())?["1",0]:[k,d]},1),v(_,"$get_table_by_d66_swap",function(n){var $=this,l=r;return l=$.randomizer.$roll_d66(q(c("D66SortType"),"ASC")),[$.$get_table_by_number(l,n),l]},1),v(_,"$get_table_by_d66",function(n){var $=this,l=r,d=r,m=r,k=r,x=r;return l=$.randomizer.$roll_once(6),d=$.randomizer.$roll_once(6),m=T(L(W(l,1),6),W(d,1)),k=n["$[]"](m),x=""+l+d,h(k["$nil?"]())?["1",x]:[k,x]},1),v(_,"$get_table_by_number",function(n,$,l){try{var d=this;return l==null&&(l="1"),U($,"each",[],function m(k){var x=m.$$s==null?this:m.$$s,Y=r;if(k==null&&(k=r),Y=k["$[]"](0),h(w(Y,n)))e.ret(x.$get_table_value(k["$[]"](1)));else return r},{$$arity:1,$$s:d}),d.$get_table_value(l)}catch(m){if(m===e.returner)return m.$v;throw m}},-3),v(_,"$get_table_value",function(n){return h(n["$is_a?"](c("Proc")))?n.$call():n},1),v(_,"$roll_tables",function(n,$){var l=this,d=r;return d=$["$[]"](n),h(d)?d.$roll(l.randomizer).$to_s():r},2),v(_,"$debug",function(n,$){var l,d,m=this,k=r,x=r;return l=e.slice.call(arguments,1),d=l,h(m.debug)?(k=h(n["$is_a?"](c("String")))?n:n.$inspect(),h(d["$empty?"]())?m.$warn(k):(x=U(d,"map",[],function(a){return a==null&&(a=r),h(a["$is_a?"](c("String")))?'"'+a+'"':a.$inspect()},1),m.$warn(""+k+": "+x.$join(", ")))):r},-2)}(R[0],null,R)}(o[0],o),q(q(t("I18n"),"Backend"),"Simple").$include(q(q(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),b=["ja_jp"],U(t("I18n"),"default_locale=",J(b)),b[W(b.length,1)],b=[["ja_jp"]],U(t("I18n").$fallbacks(),"defaults=",J(b)),b[W(b.length,1)]};Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.hash2,h=e.truthy,v=e.send,z=e.def;return A.$require("strscan"),function(T,U){var J=r(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=r(S,"GameSystem"),X=[B].concat(F),L=e.$r(X);return function(w,b,M){var D=q(w,b,"SwordWorld"),G=[D].concat(M);return function(R,f,E){var g=q(R,f,"RatingLexer"),_=[g].concat(E),u=e.$r(_),c=g.$$prototype;return c.scanner=t,C(_[0],"SYMBOLS",I(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),z(g,"$initialize",function(i){var n,$,l=this,d=t;return i=h(d=($=(n=i,n===t||n==null?t:v(n,"split",[" ",2])),$===t||$==null?t:v($,"first",[])))?d:"",l.scanner=u("StringScanner").$new(i)},1),z(g,"$next_token",function(){var i=this,n=t,$=t,l=t,d=t;return h(i.scanner["$eos?"]())?[!1,"$"]:h(n=i.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:($=i.scanner.$getch().$upcase(),l=h(d=u("SYMBOLS")["$[]"]($))?d:$.$to_sym(),[l,$])},0),z(g,"$source",function(){var i=this;return i.scanner.$string()},0)}(G[0],null,G)}(X[0],L("Base"),X)}(W[0],W)}(o[0],o)};Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.def,C=e.truthy,I=e.rb_le,h=e.rb_plus,v=e.rb_lt,z=e.neqeq;return function(T,U){var J=t(T,"BCDice"),W=[J].concat(U);return function(S,F){var B=t(S,"GameSystem"),X=[B].concat(F),L=e.$r(X);return function(w,b,M){var D=r(w,b,"SwordWorld"),G=[D].concat(M);return function(R,f,E){var g=r(R,f,"RatingParsed"),_=[g].concat(E),u=e.$r(_),c=g.$$prototype;return c.modifier_after_half=c.semi_fixed_val=c.kept_modify=c.rate=c.greatest_fortune=c.modifier=o,g.$attr_accessor("rate"),g.$attr_accessor("critical"),g.$attr_accessor("kept_modify"),g.$attr_accessor("first_to"),g.$attr_accessor("first_modify"),g.$attr_accessor("rateup"),g.$attr_accessor("greatest_fortune"),g.$attr_accessor("semi_fixed_val"),g.$attr_accessor("tmp_fixed_val"),g.$attr_accessor("modifier"),g.$attr_accessor("modifier_after_half"),q(g,"$initialize",function(i,n){var $=this;return $.rate=i,$.modifier=n,$.critical=13,$.kept_modify=0,$.first_to=0,$.first_modify=0,$.greatest_fortune=!1,$.rateup=0,$.semi_fixed_val=0,$.tmp_fixed_val=0,$.modifier_after_half=o},2),q(g,"$half",function(){var i=this;return i.modifier_after_half["$nil?"]()["$!"]()},0),q(g,"$min_critical",function(){var i=this;return C(I(i.semi_fixed_val,1))?3:h(h(i.semi_fixed_val,i.kept_modify),2).$clamp(3,13)},0),q(g,"$infinite_roll?",function(){var i=this;return v(i.$critical(),i.$min_critical())},0),q(g,"$to_s",function(){var i=this,n=o;return n="KeyNo."+i.rate,C(v(i.$critical(),13))&&(n=h(n,"c["+i.$critical()+"]")),z(i.$first_modify(),0)&&(n=h(n,"m["+u("Format").$modifier(i.$first_modify())+"]")),z(i.$first_to(),0)&&(n=h(n,"m["+i.$first_to()+"]")),z(i.$rateup(),0)&&(n=h(n,"r["+i.$rateup()+"]")),C(i.greatest_fortune)&&(n=h(n,"gf")),z(i.$semi_fixed_val(),0)&&(n=h(n,"sf["+i.$semi_fixed_val()+"]")),z(i.$tmp_fixed_val(),0)&&(n=h(n,"tf["+i.$tmp_fixed_val()+"]")),z(i.$kept_modify(),0)&&(n=h(n,"a["+u("Format").$modifier(i.$kept_modify())+"]")),z(i.modifier,0)&&(n=h(n,u("Format").$modifier(i.modifier))),n},0)}(G[0],null,G)}(X[0],L("Base"),X)}(W[0],W)}(A[0],A)};Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var A=[],o=e.nil,t=e.module,r=e.klass,q=e.truthy,C=e.def;return function(I,h){var v=t(I,"BCDice"),z=[v].concat(h);return function(T,U){var J=t(T,"GameSystem"),W=[J].concat(U),S=e.$r(W);return function(F,B,X){var L=r(F,B,"SwordWorld"),w=[L].concat(X);return function(b,M){var D=r(b,M,"RatingOptions");return D.$attr_accessor("critical"),D.$attr_accessor("kept_modify"),D.$attr_accessor("first_to"),D.$attr_accessor("first_modify"),D.$attr_accessor("rateup"),D.$attr_accessor("greatest_fortune"),D.$attr_accessor("semi_fixed_val"),D.$attr_accessor("tmp_fixed_val"),D.$attr_accessor("modifier"),D.$attr_accessor("modifier_after_half"),C(D,"$settable_first_roll_adjust_option?",function(){var R=this,f=o;return q(f=R.$first_modify()["$nil?"]())?R.$first_to()["$nil?"]():f},0),C(D,"$settable_non_2d_roll_option?",function(){var R=this,f=o,E=o;return q(f=q(E=R.$greatest_fortune()["$nil?"]())?R.$semi_fixed_val()["$nil?"]():E)?R.$tmp_fixed_val()["$nil?"]():f},0)}(w[0],null)}(W[0],S("Base"),W)}(z[0],z)}(A[0],A)};Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.hash2,h=e.send2,v=e.find_super,z=e.def,T=e.send,U=e.truthy,J=e.to_a,W=e.rb_minus,S=e.not,F=e.hash,B=e.const_set,X=e.to_ary,L=e.eqeq;return A.$require("racc/parser.rb"),A.$require("bcdice/arithmetic/node"),A.$require("bcdice/enum"),A.$require("bcdice/game_system/sword_world/rating_lexer"),A.$require("bcdice/game_system/sword_world/rating_parsed"),A.$require("bcdice/game_system/sword_world/rating_options"),function(w,b){var M=q(w,"BCDice"),D=[M].concat(b);return function(G,R){var f=q(G,"GameSystem"),E=[f].concat(R),g=e.$r(E);return function(_,u,c){var s=C(_,u,"SwordWorld"),i=[s].concat(c),n=e.$r(i);return function($,l,d){var m=C($,l,"RatingParser"),k=[m].concat(d),x=e.$r(k),Y=t,a=t,N=t,p=t,H=t,Q=t,ee=t,ne=t,V=t,Z=t,y=t,K=t,P=t,j=t,O=m.$$prototype;return O.lexer=O.round_type=O.version=t,z(m,"$initialize",function re(te){var ie,$e,se=re.$$p||t,oe=this;if(delete re.$$p,te==null)te=I([],{});else if(!te.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return ie=te.$$smap.version,ie==null&&(ie="v1_0"),$e=te.$$smap.round_type,$e==null&&($e=r(x("RoundType"),"CEIL")),h(oe,v(oe,"initialize",re,!1,!0),"initialize",[],null),oe.version=ie,oe.round_type=$e},-1),z(m,"$set_debug",function(){var te=this;return te.yydebug=!0,te},0),z(m,"$parse",function(te){var ie=this;try{return ie.lexer=x("RatingLexer").$new(te),ie.$do_parse()}catch($e){if(e.rescue($e,[x("ParseError"),x("ZeroDivisionError")]))try{return t}finally{e.pop_exception()}else throw $e}},1),m.$private(),z(m,"$parsed",function(te,ie,$e){var se=this;return T(x("RatingParsed").$new(te,ie),"tap",[],function oe(le){var ce,ue,ae,_e,ve,ge,Ee,ye=oe.$$s==null?this:oe.$$s,fe=t,me=t;return ye.round_type==null&&(ye.round_type=t),le==null&&(le=t),fe=[U(me=(ce=$e.$kept_modify(),ce===t||ce==null?t:T(ce,"eval",[ye.round_type])))?me:0],T(le,"kept_modify=",J(fe)),fe[W(fe.length,1)],fe=[U(me=$e.$first_to())?me:0],T(le,"first_to=",J(fe)),fe[W(fe.length,1)],fe=[U(me=$e.$first_modify())?me:0],T(le,"first_modify=",J(fe)),fe[W(fe.length,1)],fe=[U(me=(ue=$e.$rateup(),ue===t||ue==null?t:T(ue,"eval",[ye.round_type])))?me:0],T(le,"rateup=",J(fe)),fe[W(fe.length,1)],S($e.$greatest_fortune()["$nil?"]())&&(fe=[$e.$greatest_fortune()],T(le,"greatest_fortune=",J(fe)),fe[W(fe.length,1)]),fe=[U(me=(ae=$e.$semi_fixed_val(),ae===t||ae==null?t:T(ae,"clamp",[1,6])))?me:0],T(le,"semi_fixed_val=",J(fe)),fe[W(fe.length,1)],fe=[U(me=(_e=$e.$tmp_fixed_val(),_e===t||_e==null?t:T(_e,"clamp",[1,6])))?me:0],T(le,"tmp_fixed_val=",J(fe)),fe[W(fe.length,1)],fe=[(ve=$e.$modifier_after_half(),ve===t||ve==null?t:T(ve,"eval",[ye.round_type]))],T(le,"modifier_after_half=",J(fe)),fe[W(fe.length,1)],fe=[U(me=(Ee=(ge=$e.$critical(),ge===t||ge==null?t:T(ge,"eval",[ye.round_type])),Ee===t||Ee==null?t:T(Ee,"clamp",[0,13])))?me:U(le.$half())?13:10],T(le,"critical=",J(fe)),fe[W(fe.length,1)]},{$$arity:1,$$s:se})},3),z(m,"$next_token",function(){var te=this;return te.lexer.$next_token()},0),Y=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],a=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],N=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],p=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],H=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],Q=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],ee=[t,5,11,0,t,-11,-11,-23,t],ne=[t,t,t,t,10,42,t,t,28],V=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],Z=33,y=64,K=F(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),P=21,j=!0,B(k[0],"Racc_arg",[Y,a,p,N,H,Q,ne,ee,P,V,K,y,Z,j]),B(k[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),B(k[0],"Racc_debug_parser",!1),z(m,"$_reduce_1",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=U(_e=ue.$modifier())?_e:r(r(x("Arithmetic"),"Node"),"Number").$new(0),$e=le.$parsed(ce,ae.$eval(le.round_type),ue),$e},3),z(m,"$_reduce_2",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t,ve=t,ge=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],U(_e=ae.$modifier_after_half())||(ve=[r(r(x("Arithmetic"),"Node"),"Number").$new(0)],T(ae,"modifier_after_half=",J(ve)),ve[W(ve.length,1)]),ge=U(_e=ae.$modifier())?_e:r(r(x("Arithmetic"),"Node"),"Number").$new(0),$e=le.$parsed(ue,ge.$eval(le.round_type),ae),$e},3),z(m,"$_reduce_3",function(te,ie,$e){return $e=te["$[]"](1).$to_i(),$e},3),z(m,"$_reduce_4",function(te,ie,$e){return $e=x("RatingOptions").$new(),$e},3),z(m,"$_reduce_5",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],U(ce.$modifier()["$nil?"]())||le.$raise(x("ParseError")),ae=[ue],T(ce,"modifier=",J(ae)),ae[W(ae.length,1)],$e=ce,$e},3),z(m,"$_reduce_6",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],ue=se[3]==null?t:se[3],U(ce.$critical()["$nil?"]())||le.$raise(x("ParseError")),_e=[ae],T(ce,"critical=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_7",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],U(ce.$critical()["$nil?"]())||le.$raise(x("ParseError")),_e=[ae],T(ce,"critical=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_8",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],U(ce["$settable_first_roll_adjust_option?"]())||le.$raise(x("ParseError")),_e=[ae.$to_i()],T(ce,"first_to=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_9",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ue=se[2]==null?t:se[2],ae=se[3]==null?t:se[3],U(ce["$settable_first_roll_adjust_option?"]())||le.$raise(x("ParseError")),_e=[ae.$to_i()],T(ce,"first_modify=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_10",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ue=se[2]==null?t:se[2],ae=se[3]==null?t:se[3],U(ce["$settable_first_roll_adjust_option?"]())||le.$raise(x("ParseError")),_e=[ae.$to_i()["$-@"]()],T(ce,"first_modify=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_11",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],U(ce.$modifier_after_half()["$nil?"]())||le.$raise(x("ParseError")),ae=[r(r(x("Arithmetic"),"Node"),"Number").$new(0)],T(ce,"modifier_after_half=",J(ae)),ae[W(ae.length,1)],$e=ce,$e},3),z(m,"$_reduce_12",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],U(ce.$modifier_after_half()["$nil?"]())||le.$raise(x("ParseError")),_e=[ae],T(ce,"modifier_after_half=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_13",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],U(["v2_5","v2_0"]["$include?"](le.version))&&U(ce.$rateup()["$nil?"]())||le.$raise(x("ParseError")),_e=[ae],T(ce,"rateup=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_14",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ue=se[2]==null?t:se[2],U(["v2_5","v2_0"]["$include?"](le.version))&&U(ce["$settable_non_2d_roll_option?"]())||le.$raise(x("ParseError")),ae=[!0],T(ce,"greatest_fortune=",J(ae)),ae[W(ae.length,1)],$e=ce,$e},3),z(m,"$_reduce_15",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ue=se[2]==null?t:se[2],ae=se[3]==null?t:se[3],U(["v2_5","v2_0"]["$include?"](le.version))&&U(ce["$settable_non_2d_roll_option?"]())||le.$raise(x("ParseError")),_e=[ae.$to_i()],T(ce,"semi_fixed_val=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_16",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ue=se[2]==null?t:se[2],ae=se[3]==null?t:se[3],U(["v2_5","v2_0"]["$include?"](le.version))&&U(ce["$settable_non_2d_roll_option?"]())||le.$raise(x("ParseError")),_e=[ae.$to_i()],T(ce,"tmp_fixed_val=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_17",function(te,ie,$e){var se,oe,le=this,ce=t,ue=t,ae=t,_e=t;return oe=te,se=X(oe),ce=se[0]==null?t:se[0],ue=se[1]==null?t:se[1],ae=se[2]==null?t:se[2],L(le.version,"v2_5")&&U(ce.$kept_modify()["$nil?"]())||le.$raise(x("ParseError")),_e=[ae],T(ce,"kept_modify=",J(_e)),_e[W(_e.length,1)],$e=ce,$e},3),z(m,"$_reduce_18",function(te,ie,$e){return $e=te["$[]"](1),$e},3),z(m,"$_reduce_19",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"Negative").$new(te["$[]"](1)),$e},3),z(m,"$_reduce_20",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"BinaryOp").$new(te["$[]"](0),"+",te["$[]"](2)),$e},3),z(m,"$_reduce_21",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"BinaryOp").$new(te["$[]"](0),"-",te["$[]"](2)),$e},3),z(m,"$_reduce_22",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"BinaryOp").$new(te["$[]"](0),"+",te["$[]"](2)),$e},3),z(m,"$_reduce_23",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"BinaryOp").$new(te["$[]"](0),"-",te["$[]"](2)),$e},3),z(m,"$_reduce_25",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"BinaryOp").$new(te["$[]"](0),"*",te["$[]"](2)),$e},3),z(m,"$_reduce_26",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(te["$[]"](0),te["$[]"](2)),$e},3),z(m,"$_reduce_28",function(te,ie,$e){return $e=te["$[]"](1),$e},3),z(m,"$_reduce_29",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"Negative").$new(te["$[]"](1)),$e},3),z(m,"$_reduce_31",function(te,ie,$e){return $e=te["$[]"](1),$e},3),z(m,"$_reduce_32",function(te,ie,$e){return $e=r(r(x("Arithmetic"),"Node"),"Number").$new(te["$[]"](0)),$e},3),z(m,"$_reduce_none",function(te,ie,$e){return te["$[]"](0)},3)}(i[0],r(n("Racc"),"Parser"),i)}(E[0],g("Base"),E)}(D[0],D)}(o[0],o)};Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.const_set,I=e.send2,h=e.find_super,v=e.def,z=e.truthy,T=e.rb_ge,U=e.rb_le,J=e.eqeq,W=e.neqeq,S=e.rb_minus,F=e.rb_gt,B=e.hash2,X=e.send,L=e.to_ary,w=e.rb_plus,b=e.rb_lt,M=e.rb_times,D=e.to_a,G=e.rb_divide;return A.$require("bcdice/base"),A.$require("bcdice/game_system/sword_world/rating_parser"),function(R,f){var E=r(R,"BCDice"),g=[E].concat(f);return function(_,u){var c=r(_,"GameSystem"),s=[c].concat(u),i=e.$r(s);return function(n,$,l){var d=q(n,$,"SwordWorld"),m=[d].concat(l),k=e.$r(m),x=d.$$prototype;return x.rating_table=x.randomizer=t,C(m[0],"ID","SwordWorld"),C(m[0],"NAME","\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C9RPG"),C(m[0],"SORT_KEY","\u305D\u304A\u3068\u308F\u3042\u308B\u3068"),C(m[0],"HELP_MESSAGE",`\u30FBSW\u3000\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3000(Kx[c]+m$f) (x:\u30AD\u30FC, c:\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024, m:\u30DC\u30FC\u30CA\u30B9, f:\u51FA\u76EE\u4FEE\u6B63)
`),d.$register_prefix("H?K"),v(d,"$initialize",function Y(a){var N=Y.$$p||t,p=this;return delete Y.$$p,I(p,h(p,"initialize",Y,!1,!0),"initialize",[a],null),p.rating_table=0},1),v(d,"$result_2d6",function(a,N,p,H,Q){var ee=this;return z(T(N,12))?k("Result").$critical(ee.$translate("SwordWorld.critical")):z(U(N,2))?k("Result").$fumble(ee.$translate("SwordWorld.fumble")):W(H,">=")||J(Q,"?")?t:z(T(a,Q))?k("Result").$success(ee.$translate("success")):k("Result").$failure(ee.$translate("failure"))},5),v(d,"$eval_game_system_specific_command",function(a){var N=this;return N.$rating(a)},1),d.$private(),v(d,"$rating_parser",function(){return k("RatingParser").$new()},0),v(d,"$rating",function(a){var N,p,H=this,Q=t,ee=t,ne=t,V=t,Z=t,y=t,K=t,P=t,j=t,O=t,re=t,te=t,ie=t,$e=t,se=t,oe=t,le=t;return H.$debug("rating string",a),Q=H.$rating_parser().$parse(a),z(Q)?(ee=H.$getSW2_0_RatingTable(),ne=S(ee.$length(),1),H.$debug("keyMax",ne),z(F(Q.$rate(),ne))?k("Result").$new(H.$translate("SwordWorld.keynumber_exceeds",B(["keyMax"],{keyMax:ne}))):z(Q["$infinite_roll?"]())?k("Result").$new(H.$translate("SwordWorld.infinite_critical",B(["min_critical"],{min_critical:Q.$min_critical()}))):(V=H.$getNewRates(ee),Z=""+Q+" \uFF1E ",y=[],K=[],P=[],j=0,O=0,re=0,te=0,ie=Q.$first_to(),$e=Q.$first_modify(),function(){var ce=e.new_brk();try{return X(H,"loop",[],function ue(){var ae,_e,ve=ue.$$s==null?this:ue.$$s,ge=t,Ee=t,ye=t,fe=t;if(_e=ve.$rollDice(Q,te),ae=L(_e),ge=ae[0]==null?t:ae[0],Ee=ae[1]==null?t:ae[1],j=ge,W(ie,0)?(j=ge=ie,ie=0):W($e,0)&&(j=w(j,$e),$e=0),z(U(ge,2))&&(y["$<<"](ge.$to_s()),K["$<<"](Ee.$to_s()),P["$<<"]("**"),te=w(te,1),e.brk(t,ce)),W(Q.$kept_modify(),0)&&W(j,2)&&(j=w(j,Q.$kept_modify())),z(b(j,2))&&(j=2),z(F(j,12))&&(j=12),ye=[w(Q.$rate(),M(te,Q.$rateup())),ne].$min(),ve.$debug("currentKey",ye),fe=V["$[]"](j)["$[]"](ye),ve.$debug("rateValue",fe),re=w(re,fe),O=w(O,j),y["$<<"](j.$to_s()),K["$<<"](Ee.$to_s()),P["$<<"](z(F(j,2))?fe:"**"),te=w(te,1),z(T(j,Q.$critical())))return t;e.brk(t,ce)},{$$arity:0,$$s:H,$$brk:ce})}catch(ue){if(ue===ce)return ue.$v;throw ue}}(),p=H.$getResultText(re,Q,K,y,P,O,te),N=L(p),se=N[0]==null?t:N[0],oe=N[1]==null?t:N[1],le=N[2]==null?t:N[2],Z=w(Z,se),X(k("Result").$new(),"tap",[],function(ue){var ae=t;return ue==null&&(ue=t),ae=[Z],X(ue,"text=",D(ae)),ae[S(ae.length,1)],ae=[oe],X(ue,"critical=",D(ae)),ae[S(ae.length,1)],ae=[le],X(ue,"fumble=",D(ae)),ae[S(ae.length,1)]},1))):(H.$debug("not matched"),"1")},1),v(d,"$getSW2_0_RatingTable",function(){var a=t;return a=["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"],a},0),v(d,"$getNewRates",function(a){var N=this,p=t,H=t,Q=t,ee=t,ne=t,V=t,Z=t,y=t,K=t,P=t,j=t,O=t,re=t;return p=[],H=[],Q=[],ee=[],ne=[],V=[],Z=[],y=[],K=[],P=[],j=[],X(a,"each",[],function(ie){var $e=t;return ie==null&&(ie=t),$e=ie.$split(/,/),j.$push(0),p.$push($e["$[]"](1).$to_i()),H.$push($e["$[]"](2).$to_i()),Q.$push($e["$[]"](3).$to_i()),ee.$push($e["$[]"](4).$to_i()),ne.$push($e["$[]"](5).$to_i()),V.$push($e["$[]"](6).$to_i()),Z.$push($e["$[]"](7).$to_i()),y.$push($e["$[]"](8).$to_i()),K.$push($e["$[]"](9).$to_i()),P.$push($e["$[]"](10).$to_i())},1),J(N.rating_table,1)&&(O=[31,(O=[32,(O=[33,10],X(P,"[]=",D(O)),O[S(O.length,1)])],X(P,"[]=",D(O)),O[S(O.length,1)])],X(P,"[]=",D(O)),O[S(O.length,1)]),re=[j,j,j,p,H,Q,ee,ne,V,Z,y,K,P],re},1),v(d,"$rollDice",function(a,N){var p=this,H=t,Q=t,ee=t;return H=p.randomizer.$roll_barabara(2,6),Q=H.$sum(),ee=H.$join(","),[Q,ee]},2),v(d,"$getResultText",function(a,N,p,H,Q,ee,ne){var V=t,Z=t,y=t,K=t,P=t;return V=[],V.$push("2D:["+p.$join(" ")+"]="+H.$join(",")),z(U(ee,2))?(V.$push(Q.$join(",")),V.$push("\u81EA\u52D5\u7684\u5931\u6557"),[V.$join(" \uFF1E "),!1,!0]):(z(F(Q.$size(),1))||W(N.$modifier(),0)?(Z=w(Q.$join(","),k("Format").$modifier(N.$modifier())),z(N.$half())&&(Z="("+Z+")/2",W(N.$modifier_after_half(),0)&&(Z=w(Z,k("Format").$modifier(N.$modifier_after_half())))),V.$push(Z)):z(N.$half())&&(Z=""+Q.$first()+"/2",W(N.$modifier_after_half(),0)&&(Z=w(Z,k("Format").$modifier(N.$modifier_after_half()))),V.$push(Z)),z(F(ne,1))&&(y=""+S(ne,1)+"\u56DE\u8EE2",V.$push(y)),K=w(a,N.$modifier()),z(N.$half())&&(K=G(K,2).$ceil(),W(N.$modifier_after_half(),0)&&(K=w(K,N.$modifier_after_half()))),P=K.$to_s(),V.$push(P),[V.$join(" \uFF1E "),F(ne,1),!1])},7)}(s[0],i("Base"),s)}(g[0],g)}(o[0],o)};Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){var A=e.top,o=[],t=e.nil,r=e.module,q=e.klass,C=e.def,I=e.truthy,h=e.rb_lt,v=e.hash2,z=e.not,T=e.rb_ge,U=e.rb_plus,J=e.send,W=e.to_a,S=e.rb_minus;return A.$require("bcdice/result"),A.$require("bcdice/translate"),function(F,B){var X=r(F,"BCDice"),L=[X].concat(B);return function(w,b){var M=r(w,"GameSystem"),D=[M].concat(b),G=e.$r(D);return function(R,f,E){var g=q(R,f,"SwordWorld2_0"),_=[g].concat(E);return function(u,c,s){var i=q(u,c,"TranscendentTest"),n=[i].concat(s),$=e.$r(n),l=i.$$prototype;return l.modifier=l.critical_value=l.expression=l.modifier_str=l.target=l.cmp_op=t,i.$include($("Translate")),C(i,"$initialize",function(m,k,x,Y,a){var N=this;return N.critical_value=m,N.modifier=k,N.cmp_op=x,N.target=Y,N.locale=a,N.modifier_str=$("Format").$modifier(N.modifier),N.expression=N.$node_expression()},5),C(i,"$execute",function(m){var k,x=this,Y=t,a=t,N=t,p=t,H=t,Q=t,ee=t,ne=t,V=t;if(I(h(x.critical_value,3)))return x.$translate("SwordWorld2_0.transcendent_critical_too_small",v(["expression"],{expression:x.expression}));if(Y=m.$roll_barabara(2,6),a=[Y],N=Y["$=="]([1,1]),p=Y["$=="]([6,6]),z(N)&&z(p))for(;I(T(x.$sum_of_dice(a.$last()),x.critical_value));)a.$push(m.$roll_barabara(2,6));return H=x.$sum_of_dice(a),Q=U(H,x.modifier),ee=x.$result_status(Q,a.$length(),N,p),ne=v(["success","failure","super_success","critical","fumble"],{success:x.$translate("success"),failure:x.$translate("failure"),super_success:x.$translate("SwordWorld2_0.super_success"),critical:x.$translate("SwordWorld.critical"),fumble:x.$translate("SwordWorld.fumble")}).$freeze()["$[]"](ee),V=["("+x.expression+")",""+x.$dice_str(a,H)+x.modifier_str,Q,ne].$compact(),J($("Result").$new(),"tap",[],function(y){var K=t;return y==null&&(y=t),K=[V.$join(" \uFF1E ")],J(y,"text=",W(K)),K[S(K.length,1)],K=[ee["$=="]("fumble")],J(y,"fumble=",W(K)),K[S(K.length,1)],K=[ee["$=="]("critical")],J(y,"critical=",W(K)),K[S(K.length,1)],K=[["success","super_success","critical"]["$include?"](ee)],J(y,"success=",W(K)),K[S(K.length,1)],K=[["failure","fumble"]["$include?"](ee)],J(y,"failure=",W(K)),K[S(K.length,1)]},1)},1),i.$private(),C(i,"$node_expression",function(){var m=this,k=t;return k="2D6@"+m.critical_value+m.modifier_str,I(m.target)?""+k+m.cmp_op+m.target:k},0),C(i,"$sum_of_dice",function(m){return m.$flatten().$sum()},1),C(i,"$dice_str",function(m,k){var x=t;return x=J(m,"map",[],function(a){return a==null&&(a=t),"["+a.$join(",")+"]"},1).$join(),""+k+x},2),C(i,"$result_status",function(m,k,x,Y){var a=this;return I(a.target)?I(x)?"fumble":I(Y)?"critical":I(m.$send(a.cmp_op,a.target))?I(T(k,2))&&I(T(m,41))?"super_success":"success":"failure":"no_target"},4)}(_[0],null,_)}(D[0],G("SwordWorld"),D)}(L[0],L)}(o[0],o)};Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.const_set,h=e.send2,v=e.find_super,z=e.def,T=e.eqeqeq,U=e.truthy,J=e.hash2,W=e.rb_gt,S=e.rb_plus,F=e.eqeq,B=e.rb_times,X=e.send,L=e.neqeq;return A.$require("bcdice/arithmetic_evaluator"),A.$require("bcdice/game_system/SwordWorld"),A.$require("bcdice/game_system/sword_world/transcendent_test"),function(w,b){var M=q(w,"BCDice"),D=[M].concat(b);return function(G,R){var f=q(G,"GameSystem"),E=[f].concat(R),g=e.$r(E);return function(_,u,c){var s=C(_,u,"SwordWorld2_0"),i=[s].concat(c),n=e.$r(i),$=s.$$prototype;return $.locale=$.randomizer=t,I(i[0],"ID","SwordWorld2.0"),I(i[0],"NAME","\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C92.0"),I(i[0],"SORT_KEY","\u305D\u304A\u3068\u308F\u3042\u308B\u30682.0"),I(i[0],"HELP_MESSAGE",`\u81EA\u52D5\u7684\u6210\u529F\u3001\u6210\u529F\u3001\u5931\u6557\u3001\u81EA\u52D5\u7684\u5931\u6557\u306E\u81EA\u52D5\u5224\u5B9A\u3092\u884C\u3044\u307E\u3059\u3002

\u30FB\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3000(Kx)
\u3000"K\u30AD\u30FC\u30CA\u30F3\u30D0\u30FC+\u30DC\u30FC\u30CA\u30B9"\u306E\u5F62\u3067\u8A18\u5165\u3057\u307E\u3059\u3002
\u3000\u30DC\u30FC\u30CA\u30B9\u306E\u90E8\u5206\u306B\u300CK20+K30\u300D\u306E\u3088\u3046\u306B\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u3092\u53D6\u308B\u3053\u3068\u306F\u51FA\u6765\u307E\u305B\u3093\u3002
\u3000\u307E\u305F\u3001\u30DC\u30FC\u30CA\u30B9\u306F\u8907\u6570\u53D6\u308B\u3053\u3068\u304C\u51FA\u6765\u307E\u3059\u3002
\u3000\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3082\u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\u3068\u540C\u69D8\u306B\u3001\u4ED6\u306E\u30D7\u30EC\u30A4\u30E4\u30FC\u306B\u96A0\u308C\u3066\u30ED\u30FC\u30EB\u3059\u308B\u3053\u3068\u3082\u53EF\u80FD\u3067\u3059\u3002
\u3000\u4F8B\uFF09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2

\u30FB\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u306E\u8A2D\u5B9A
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u306F"[\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024]"\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002
\u3000\u6307\u5B9A\u3057\u306A\u3044\u5834\u5408\u306F\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u502410\u3068\u3057\u307E\u3059\u3002
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u51E6\u7406\u304C\u5FC5\u8981\u306A\u3044\u3068\u304D\u306F13\u306A\u3069\u3068\u3057\u3066\u304F\u3060\u3055\u3044\u3002(\u9632\u5FA1\u6642\u306A\u3069\u306E\u5BFE\u5FDC)
\u3000\u307E\u305F\u30BF\u30A4\u30D7\u306E\u8EFD\u6E1B\u5316\u306E\u305F\u3081\u306B\u672B\u5C3E\u306B\u300C@\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u300D\u3067\u3082\u51E6\u7406\u3059\u308B\u3088\u3046\u306B\u3057\u307E\u3057\u305F\u3002
\u3000\u4F8B\uFF09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9

\u30FB\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u306E\u534A\u6E1B (HKx, KxH+N)
\u3000\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u306E\u5148\u982D\u307E\u305F\u306F\u672B\u5C3E\u306B"H"\u3092\u3064\u3051\u308B\u3068\u3001\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3092\u632F\u3063\u3066\u6700\u7D42\u7D50\u679C\u3092\u534A\u6E1B\u3055\u305B\u307E\u3059\u3002
\u3000\u672B\u5C3E\u306B\u3064\u3051\u305F\u5834\u5408\u3001\u76F4\u5F8C\u306B\u4FEE\u6B63\u3092\u3092\u3064\u3051\u308B\u3053\u3068\u3067\u3001\u534A\u6E1B\u5F8C\u306E\u52A0\u6E1B\u7B97\u3092\u884C\u3046\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002
\u3000\u3053\u306E\u969B\u3001\u8907\u6570\u306E\u9805\u306B\u3088\u308B\u4FEE\u6B63\u306B\u306F\u30AB\u30C3\u30B3\u3067\u56F2\u3046\u3053\u3068\u304C\u5FC5\u8981\u3067\u3059\uFF08\u30AB\u30C3\u30B3\u304C\u306A\u3044\u3068\u30D1\u30FC\u30B9\u306B\u5931\u6557\u3057\u307E\u3059\uFF09
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u3092\u6307\u5B9A\u3057\u306A\u3044\u5834\u5408\u3001\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u306A\u3057\u3068\u6271\u308F\u308C\u307E\u3059\u3002
\u3000\u4F8B\uFF09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)

\u30FB\u30C0\u30A4\u30B9\u76EE\u306E\u4FEE\u6B63\uFF08\u904B\u547D\u5909\u8EE2\u3084\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u30EC\u30A4\u7528\uFF09
\u3000\u672B\u5C3E\u306B\u300C$\u4FEE\u6B63\u5024\u300D\u3067\u30C0\u30A4\u30B9\u76EE\u306B\u4FEE\u6B63\u304C\u304B\u304B\u308A\u307E\u3059\u3002
\u3000$\uFF0B\uFF11\u3068\u4FEE\u6B63\u8868\u8A18\u306A\u3089\u30C0\u30A4\u30B9\u76EE\u306B\uFF0B\u4FEE\u6B63\u3001\uFF04\uFF19\u306E\u3088\u3046\u306B\u56FA\u5B9A\u5024\u306A\u3089\u30C0\u30A4\u30B9\u76EE\u3092\u305D\u306E\u51FA\u76EE\u306B\u5DEE\u3057\u66FF\u3048\u3002
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u3057\u305F\u5834\u5408\u3067\u3082\u56FA\u5B9A\u5024\u3084\u4FEE\u6B63\u5024\u306E\u9069\u7528\u306F\u6700\u521D\u306E\u4E00\u56DE\u3060\u3051\u3067\u3059\u3002
\u3000\u4F8B\uFF09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9

\u30FB\u9996\u5207\u308A\u5200\u7528\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u4E0A\u6607 r10
\u3000\u4F8B\uFF09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10

\u30FB\u30B0\u30EC\u30A4\u30C6\u30B9\u30C8\u30D5\u30A9\u30FC\u30C1\u30E5\u30F3\u306F\u672B\u5C3E\u306B gf
\u3000\u4F8B\uFF09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf

\u30FB\u5A01\u529B\u8868\u30921d+sf\u3067\u53C2\u7167 \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5F8C\u3082\u7D99\u7D9A sf4
\u3000\u4F8B\uFF09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9

\u30FB\u5A01\u529B\u8868\u30921d+tf\u3067\u53C2\u7167 \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5F8C\u306F2d\u3067\u53C2\u7167 tf3
\u3000\u4F8B\uFF09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9

\u30FB\u8D85\u8D8A\u5224\u5B9A\u7528\u306B2d6\u30ED\u30FC\u30EB\u306B 2D6@10 \u66F8\u5F0F\u3067\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u4ED8\u4E0E\u304C\u53EF\u80FD\u306B\u3002
\u3000\u4F8B\uFF092D6@10\u30002D6@10+11>=30

\u30FB\u6210\u9577\u3000(Gr)
\u3000\u672B\u5C3E\u306B\u6570\u5B57\u3092\u4ED8\u52A0\u3059\u308B\u3053\u3068\u3067\u3001\u8907\u6570\u56DE\u306E\u6210\u9577\u3092\u307E\u3068\u3081\u3066\u884C\u3048\u307E\u3059\u3002
\u3000\u4F8B\uFF09Gr3

\u30FB\u9632\u5FA1\u30D5\u30A1\u30F3\u30D6\u30EB\u8868\u3000(FT)
\u3000\u9632\u5FA1\u30D5\u30A1\u30F3\u30D6\u30EB\u8868\u3092\u51FA\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002

\u30FB\u7D61\u307F\u52B9\u679C\u8868\u3000(TT)
\u3000\u7D61\u307F\u52B9\u679C\u8868\u3092\u51FA\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002
`),s.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),z(s,"$initialize",function l(d){var m=l.$$p||t,k=this;return delete l.$$p,h(k,v(k,"initialize",l,!1,!0),"initialize",[d],null),k.rating_table=2},1),z(s,"$eval_game_system_specific_command",function l(d){var m=l.$$p||t,k=this,x=t,Y=t,a=t,N=t;return delete l.$$p,T(/^Gr(\d+)?/i,x=d)?U(d["$=~"](/^Gr(\d+)/i))?k.$growth(n("Regexp").$last_match(1).$to_i()):k.$growth():T(/^2D6?@\d+/i,x)?(Y=r(n("Command"),"Parser").$new(/2D6?/i,J(["round_type"],{round_type:r(r(n("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(t,">=",">"),a=Y.$parse(d),U(a)?(N=n("TranscendentTest").$new(a.$critical(),a.$modify_number(),a.$cmp_op(),a.$target_number(),k.locale),N.$execute(k.randomizer)):t):T("FT",x)?k.$get_fumble_table():T("TT",x)?k.$get_tangle_table():h(k,v(k,"eval_game_system_specific_command",l,!1,!0),"eval_game_system_specific_command",[d],null)},1),z(s,"$rating_parser",function(){return n("RatingParser").$new(J(["version"],{version:"v2_0"}))},0),z(s,"$rollDice",function l(d,m){var k=l.$$p||t,x=this,Y=t;return delete l.$$p,U(W(d.$semi_fixed_val(),0))?(Y=x.randomizer.$roll_once(6),[S(Y,d.$semi_fixed_val()),""+Y+","+d.$semi_fixed_val()]):F(m,0)&&U(W(d.$tmp_fixed_val(),0))?(Y=x.randomizer.$roll_once(6),[S(Y,d.$tmp_fixed_val()),""+Y+","+d.$tmp_fixed_val()]):U(d.$greatest_fortune())?(Y=x.randomizer.$roll_once(6),[B(Y,2),""+Y+","+Y]):h(x,v(x,"rollDice",l,!1,!0),"rollDice",[d,m],null)},2),z(s,"$growth",function(d){var m=this;return d==null&&(d=1),X(e.Range.$new(1,d,!1),"map",[],function k(){var x=k.$$s==null?this:k.$$s;return x.$growth_step()},{$$arity:0,$$s:m}).$join(" | ")},-1),z(s,"$growth_step",function(){var d=this,m=t,k=t,x=t;return m=r(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",d.locale),k=m.$roll(d.randomizer),x=m.$roll(d.randomizer),L(k.$value(),x.$value())?"["+k.$value()+","+x.$value()+"]->("+k.$body()+" or "+x.$body()+")":"["+k.$value()+","+x.$value()+"]->("+k.$body()+")"},0),z(s,"$get_fumble_table",function(){var d=this,m=t;return m=r(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",d.locale),m.$roll(d.randomizer)},0),z(s,"$get_tangle_table",function(){var d=this,m=t;return m=r(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",d.locale),m.$roll(d.randomizer)},0)}(E[0],g("SwordWorld"),E)}(D[0],D)}(o[0],o)};Opal.queue(function(e){var A=e.top,o=[],t=e.nil,r=e.$$$,q=e.module,C=e.klass,I=e.const_set,h=e.eqeqeq,v=e.send,z=e.hash2,T=e.truthy,U=e.send2,J=e.find_super,W=e.def,S=e.range,F=e.rb_plus;return A.$require("bcdice/game_system/SwordWorld2_0"),function(B,X){var L=q(B,"BCDice"),w=[L].concat(X);return function(b,M){var D=q(b,"GameSystem"),G=[D].concat(M),R=e.$r(G);return function(f,E,g){var _=C(f,E,"SwordWorld2_5"),u=[_].concat(g),c=e.$r(u),s=_.$$prototype;return s.randomizer=s.locale=t,I(u[0],"ID","SwordWorld2.5"),I(u[0],"NAME","\u30BD\u30FC\u30C9\u30FB\u30EF\u30FC\u30EB\u30C92.5"),I(u[0],"SORT_KEY","\u305D\u304A\u3068\u308F\u3042\u308B\u30682.5"),I(u[0],"HELP_MESSAGE",`\u81EA\u52D5\u7684\u6210\u529F\u3001\u6210\u529F\u3001\u5931\u6557\u3001\u81EA\u52D5\u7684\u5931\u6557\u306E\u81EA\u52D5\u5224\u5B9A\u3092\u884C\u3044\u307E\u3059\u3002

\u30FB\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3000(Kx)
\u3000"K\u30AD\u30FC\u30CA\u30F3\u30D0\u30FC+\u30DC\u30FC\u30CA\u30B9"\u306E\u5F62\u3067\u8A18\u5165\u3057\u307E\u3059\u3002
\u3000\u30DC\u30FC\u30CA\u30B9\u306E\u90E8\u5206\u306B\u300CK20+K30\u300D\u306E\u3088\u3046\u306B\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u3092\u53D6\u308B\u3053\u3068\u306F\u51FA\u6765\u307E\u305B\u3093\u3002
\u3000\u307E\u305F\u3001\u30DC\u30FC\u30CA\u30B9\u306F\u8907\u6570\u53D6\u308B\u3053\u3068\u304C\u51FA\u6765\u307E\u3059\u3002
\u3000\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3082\u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\u3068\u540C\u69D8\u306B\u3001\u4ED6\u306E\u30D7\u30EC\u30A4\u30E4\u30FC\u306B\u96A0\u308C\u3066\u30ED\u30FC\u30EB\u3059\u308B\u3053\u3068\u3082\u53EF\u80FD\u3067\u3059\u3002
\u3000\u4F8B\uFF09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2

\u30FB\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u306E\u8A2D\u5B9A
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u306F"[\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024]"\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002
\u3000\u6307\u5B9A\u3057\u306A\u3044\u5834\u5408\u306F\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u502410\u3068\u3057\u307E\u3059\u3002
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u51E6\u7406\u304C\u5FC5\u8981\u306A\u3044\u3068\u304D\u306F13\u306A\u3069\u3068\u3057\u3066\u304F\u3060\u3055\u3044\u3002(\u9632\u5FA1\u6642\u306A\u3069\u306E\u5BFE\u5FDC)
\u3000\u307E\u305F\u30BF\u30A4\u30D7\u306E\u8EFD\u6E1B\u5316\u306E\u305F\u3081\u306B\u672B\u5C3E\u306B\u300C@\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u300D\u3067\u3082\u51E6\u7406\u3059\u308B\u3088\u3046\u306B\u3057\u307E\u3057\u305F\u3002
\u3000\u4F8B\uFF09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9

\u30FB\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u306E\u534A\u6E1B (HKx, KxH+N)
\u3000\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u306E\u5148\u982D\u307E\u305F\u306F\u672B\u5C3E\u306B"H"\u3092\u3064\u3051\u308B\u3068\u3001\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u8868\u3092\u632F\u3063\u3066\u6700\u7D42\u7D50\u679C\u3092\u534A\u6E1B\u3055\u305B\u307E\u3059\u3002
\u3000\u672B\u5C3E\u306B\u3064\u3051\u305F\u5834\u5408\u3001\u76F4\u5F8C\u306B\u4FEE\u6B63\u3092\u3092\u3064\u3051\u308B\u3053\u3068\u3067\u3001\u534A\u6E1B\u5F8C\u306E\u52A0\u6E1B\u7B97\u3092\u884C\u3046\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002
\u3000\u3053\u306E\u969B\u3001\u8907\u6570\u306E\u9805\u306B\u3088\u308B\u4FEE\u6B63\u306B\u306F\u30AB\u30C3\u30B3\u3067\u56F2\u3046\u3053\u3068\u304C\u5FC5\u8981\u3067\u3059\uFF08\u30AB\u30C3\u30B3\u304C\u306A\u3044\u3068\u30D1\u30FC\u30B9\u306B\u5931\u6557\u3057\u307E\u3059\uFF09
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u3092\u6307\u5B9A\u3057\u306A\u3044\u5834\u5408\u3001\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u306A\u3057\u3068\u6271\u308F\u308C\u307E\u3059\u3002
\u3000\u4F8B\uFF09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)

\u30FB\u30C0\u30A4\u30B9\u76EE\u306E\u4FEE\u6B63\uFF08\u904B\u547D\u5909\u8EE2\u3084\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u30EC\u30A4\u7528\uFF09
\u3000\u672B\u5C3E\u306B\u300C$\u4FEE\u6B63\u5024\u300D\u3067\u30C0\u30A4\u30B9\u76EE\u306B\u4FEE\u6B63\u304C\u304B\u304B\u308A\u307E\u3059\u3002
\u3000$\uFF0B\uFF11\u3068\u4FEE\u6B63\u8868\u8A18\u306A\u3089\u30C0\u30A4\u30B9\u76EE\u306B\uFF0B\u4FEE\u6B63\u3001\uFF04\uFF19\u306E\u3088\u3046\u306B\u56FA\u5B9A\u5024\u306A\u3089\u30C0\u30A4\u30B9\u76EE\u3092\u305D\u306E\u51FA\u76EE\u306B\u5DEE\u3057\u66FF\u3048\u3002
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u3057\u305F\u5834\u5408\u3067\u3082\u56FA\u5B9A\u5024\u3084\u4FEE\u6B63\u5024\u306E\u9069\u7528\u306F\u6700\u521D\u306E\u4E00\u56DE\u3060\u3051\u3067\u3059\u3002
\u3000\u4F8B\uFF09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9

\u30FB\u30C0\u30A4\u30B9\u76EE\u306E\u4FEE\u6B63\uFF08\u5FC5\u6BBA\u653B\u6483\u7528\uFF09
\u3000\u300C\uFF03\u4FEE\u6B63\u5024\u300D\u3067\u30C0\u30A4\u30B9\u76EE\u306B\u4FEE\u6B63\u304C\u304B\u304B\u308A\u307E\u3059\u3002
\u3000\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u3057\u305F\u5834\u5408\u3067\u3082\u4FEE\u6B63\u5024\u306E\u9069\u7528\u306F\u7D99\u7D9A\u3055\u308C\u307E\u3059\u3002
\u3000\u4F8B\uFF09K20#1\u3000\u3000\u3000k10-5@9#2

\u30FB\u9996\u5207\u308A\u5200\u7528\u30EC\u30FC\u30C6\u30A3\u30F3\u30B0\u4E0A\u6607 r5
\u3000\u4F8B\uFF09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5

\u30FB\u30B0\u30EC\u30A4\u30C6\u30B9\u30C8\u30D5\u30A9\u30FC\u30C1\u30E5\u30F3\u306F\u672B\u5C3E\u306B gf
\u3000\u4F8B\uFF09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf

\u30FB\u5A01\u529B\u8868\u30921d+sf\u3067\u53C2\u7167 \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5F8C\u3082\u7D99\u7D9A sf4
\u3000\u4F8B\uFF09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9

\u30FB\u5A01\u529B\u8868\u30921d+tf\u3067\u53C2\u7167 \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5F8C\u306F2d\u3067\u53C2\u7167 tf3
\u3000\u4F8B\uFF09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9

\u30FB\u8D85\u8D8A\u5224\u5B9A\u7528\u306B2d6\u30ED\u30FC\u30EB\u306B 2D6@10 \u66F8\u5F0F\u3067\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\u4ED8\u4E0E\u304C\u53EF\u80FD\u306B\u3002
\u3000\u4F8B\uFF092D6@10\u30002D6@10+11>=30

\u30FB\u6210\u9577\u3000(Gr)
\u3000\u672B\u5C3E\u306B\u6570\u5B57\u3092\u4ED8\u52A0\u3059\u308B\u3053\u3068\u3067\u3001\u8907\u6570\u56DE\u306E\u6210\u9577\u3092\u307E\u3068\u3081\u3066\u884C\u3048\u307E\u3059\u3002
\u3000\u4F8B\uFF09Gr3

\u30FB\u9632\u5FA1\u30D5\u30A1\u30F3\u30D6\u30EB\u8868\u3000(FT)
\u3000\u9632\u5FA1\u30D5\u30A1\u30F3\u30D6\u30EB\u8868\u3092\u51FA\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002

\u30FB\u7D61\u307F\u52B9\u679C\u8868\u3000(TT)
\u3000\u7D61\u307F\u52B9\u679C\u8868\u3092\u51FA\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002

\u30FB\u30C9\u30EB\u30A4\u30C9\u306E\u7269\u7406\u9B54\u6CD5\u7528\u8868\u3000(Dru[2-6\u306E\u5024,7-9\u306E\u5024,10-12\u306E\u5024])
\u3000\u4F8B\uFF09Dru[0,3,6]+10-3

\u30FB\u30A2\u30D3\u30B9\u30AB\u30FC\u30B9\u8868\u3000(ABT)
\u3000\u30A2\u30D3\u30B9\u30AB\u30FC\u30B9\u8868\u3092\u51FA\u3059\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002
`),_.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT","Dru","ABT"),W(_,"$eval_game_system_specific_command",function i(n){var $=i.$$p||t,l=this,d=t,m=t,k=t,x=t;return delete i.$$p,h(/^dru\[(\d+),(\d+),(\d+)\]/i,d=n)?(m=v(c("Regexp").$last_match().$captures(),"map",[],"to_i".$to_proc()),k=r(c("Command"),"Parser").$new(/dru\[\d+,\d+,\d+\]/i,z(["round_type"],{round_type:r(r(c("BCDice"),"RoundType"),"CEIL")})),x=k.$parse(n),T(x)?l.$druid_dice(x,m):t):h("ABT",d)?l.$get_abyss_curse_table():U(l,J(l,"eval_game_system_specific_command",i,!1,!0),"eval_game_system_specific_command",[n],null)},1),W(_,"$rating_parser",function(){return c("RatingParser").$new(z(["version"],{version:"v2_5"}))},0),W(_,"$druid_dice",function(n,$){var l=this,d=t,m=t,k=t,x=t,Y=t,a=t,N=t;return d=l.randomizer.$roll_barabara(2,6),m=d.$sum(),k=h(S(2,6,!1),x=m)?0:h(S(7,9,!1),x)?1:h(S(10,12,!1),x)?2:t,Y=$["$[]"](k),a=F(Y,n.$modify_number()),N=["("+n.$command().$capitalize()+c("Format").$modifier(n.$modify_number())+")","2D["+d.$join(",")+"]="+m,""+Y+c("Format").$modifier(n.$modify_number()),a],N.$join(" \uFF1E ")},2),W(_,"$get_abyss_curse_table",function(){var n=this,$=t,l=t,d=t,m=t;return $=r(c("DiceTable"),"D66GridTable").$from_i18n("SwordWorld2_5.AbyssCurseTable",n.locale).$roll(n.randomizer),l=h(14,d=$.$value())?r(c("DiceTable"),"D66ParityTable").$from_i18n("SwordWorld2_5.AbyssCurseCategoryTable",n.locale).$roll(n.randomizer).$to_s():h(25,d)?r(c("DiceTable"),"D66ParityTable").$from_i18n("SwordWorld2_5.AbyssCurseAttrTable",n.locale).$roll(n.randomizer).$to_s():t,m=[$.$to_s(),l].$compact(),m.$join(`
`)},0)}(G[0],R("SwordWorld2_0"),G)}(w[0],w)}(o[0],o)});var vr=Ie(Fe()),Se=class extends vr.default{dynamicImportI18n(A,o){return new Promise(t=>t({}))}dynamicImport(A){return new Promise(o=>o())}};function gr(e){let A=[],o=[];for(let r=0;r<e.length;r++)switch(e[r]){case"{":{A.push(r);break}case"}":{if(!A.length)throw new Error("\u5B58\u5728 } \u4F46\u627E\u4E0D\u5230\u5BF9\u5E94\u7684 {");let C=A.pop();C!==void 0&&o.push([C,r]);break}}if(A.length)throw new Error("\u53E5\u4E2D\u6709\u672A\u7ED3\u675F\u7684 {");let t=[];for(let r=0;r<o.length;r++){let q=o[r],C=!0;for(let I=0;I<o.length;I++){let h=o[I];if(q[0]>h[0]&&q[1]<h[1]){C=!1;break}}C&&t.push(q)}return t}var Ge,st=new Se;st.dynamicLoad("SwordWorld2.5").then(e=>{Ge=e,ot()}).catch(e=>{console.error("JS\u63D2\u4EF6\u5251\u4E16\u754C2.5\u52A0\u8F7D\u5931\u8D25:"+e.toString())});var at={"\uFF1E":">","<":"<","\uFF0C":","},ut=function(e,A,o){return e.replace(new RegExp(A,"gm"),o)},ot=()=>{let e=seal.ext.find("sw");e||(e=seal.ext.new("sw","\u6728\u843D","1.0.0"),seal.ext.register(e));let A=seal.ext.newCmdItemInfo();A.name="sw",A.help=`\u5251\u4E16\u754C\u9AB0\u70B9\uFF0C\u683C\u5F0F\u4E3A .sw <\u5F0F\u5B50>\uFF0C\u4EE5\u4E0B\u8BF4\u660E\u4E3A\u7CFB\u7EDF\u539F\u6587:

`+Ge.HELP_MESSAGE,A.solve=(o,t,r)=>{let q=r.getArgN(1);switch(q){case"help":case"":{let C=seal.ext.newCmdExecuteResult(!0);return C.showHelp=!0,C}case"ver":case"version":{seal.replyToSender(o,t,`BCDice Version ${pr.Version}`);break}default:{let C="";q=r.cleanArgs;for(let[h,v]of Object.entries(at))q=ut(q,h,v);if(q)try{let h=gr(q),v=q.length;for(let z=h.length-1;z>=0;z--){let T=h[z];C=seal.format(o,q.slice(T[0],T[1]+1))+q.slice(T[1]+1,v)+C,v=T[0]}C=q.slice(0,v)+C,console.log(">DiceText: "+C)}catch(h){return seal.replyToSender(o,t,"\u6267\u884C\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u5BF9 {} \u7684\u4F7F\u7528\u4E0D\u89C4\u8303: "+h.toString()),seal.ext.newCmdExecuteResult(!0)}let I=Ge.eval(C||"");I?seal.replyToSender(o,t,I.text):seal.replyToSender(o,t,"\u6267\u884C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u4F60\u7684\u5F0F\u5B50")}}return seal.ext.newCmdExecuteResult(!0)},e.cmdMap.sw=A};})();
